(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5129],{50615:function(n,e,t){"use strict";t.d(e,{Z:function(){return InfoLayout}});var a=t(85893),s=t(51731);function InfoLayout(n){let{title:e,children:t}=n;return(0,a.jsxs)(s.Zb,{children:[e&&(0,a.jsx)(s.Ol,{className:"font-medium",children:e}),(0,a.jsx)(s.aY,{className:"flex flex-col flex-wrap gap-3 break-all",children:t})]})}},84586:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return App}});var a=t(85893);let s=[{name:"SEAM",url:"https://app.seam.money/"},{name:"Aptos Names",url:"https://www.aptosnames.com/"},{name:"Liquid Swap",url:"https://liquidswap.com/#/"}];var r=t(6912),o=t(67294),i=t(66409),l=t(99710),c=t(23225),u=t(8590),d=t(30202),g=t(6793),f={signMessage:[{id:"signMessage",name:"signMessage",value:JSON.stringify({address:!1,application:!0,chainId:!0,message:"This is a sample message",nonce:12345})}],signTransaction:n=>[{id:"signTransaction-native",name:"transfer native coin",value:JSON.stringify({data:{type:"entry_function_payload",function:"0x1::coin::transfer",typeArguments:["0x1::aptos_coin::AptosCoin"],functionArguments:[n,"100000"]}})},{id:"signTransaction-native-options",name:"transfer native coin - options",value:JSON.stringify({data:{type:"entry_function_payload",function:"0x1::coin::transfer",typeArguments:["0x1::aptos_coin::AptosCoin"],functionArguments:[n,"100000"]},options:{maxGasAmount:1e6,gasUnitPrice:1e6}})},{id:"signTransaction-usdc-legacy",name:"transfer usdc coin (legacy)",value:JSON.stringify({data:{type:"entry_function_payload",function:"0x1::coin::transfer",typeArguments:["0xf22bede237a07e121b56d91a491eb7bcdfd1f5907926a9e58338f964a01b17fa::asset::USDC"],functionArguments:[n,1e4]}})},{id:"signTransaction-usdc-fa",name:"transfer usdc coin",value:JSON.stringify({data:{type:"entry_function_payload",function:"0x1::primary_fungible_store::transfer",typeArguments:["0x1::fungible_asset::Metadata"],functionArguments:["0x357b0b74bc833e95a115ad22604854d6b0fca151cecd94111770e5d6ffc9dc2b",n,1e4]}})}],signAndSubmitTransaction:n=>[{id:"transaction-native-pure",name:"transfer native coin pure",value:JSON.stringify({sender:n,data:{function:"0x1::coin::transfer",typeArguments:["0x1::aptos_coin::AptosCoin"],functionArguments:[n,"100000"]}})},{id:"signTransaction-native-pure-options",name:"transfer native coin pure - options",value:JSON.stringify({sender:n,data:{function:"0x1::coin::transfer",typeArguments:["0x1::aptos_coin::AptosCoin"],functionArguments:[n,"100000"]},options:{maxGasAmount:1e6,gasUnitPrice:1e6}})}]},p=t(50780),m=t.n(p),S=t(22751),y=t(63186),x=t(96423),v=t(65446),h=t(16427),b=t(50615);function jsonToUint8Array(n){let e="string"==typeof n?JSON.parse(n):n,t=Object.keys(e).map(n=>e[n]);return new Uint8Array(t)}var w=t(27361),A=t.n(w),T=t(25618);let j=new x.ScN({network:x.ZcK.DEVNET}),N=new x.gZG(j),E=new x.ScN({network:x.ZcK.TESTNET}),O=new x.gZG(E),C=new x.ScN({network:x.ZcK.MAINNET}),P=new x.gZG(C),aptosClient=n=>{if((null==n?void 0:n.name)===x.ZcK.DEVNET)return N;if((null==n?void 0:n.name)===x.ZcK.TESTNET)return O;if((null==n?void 0:n.name)===x.ZcK.MAINNET)return P;{let e=new x.ScN({network:x.ZcK.CUSTOM,fullnode:null==n?void 0:n.url});return new x.gZG(e)}};var k=t(88240),K=t(48764).Buffer;function MultiAgentTransactionFlow(){let{account:n,network:e,signTransaction:t,submitTransaction:s}=(0,h.Os)(),[r,i]=(0,o.useState)(),[l,c]=(0,o.useState)(null),[u,d]=(0,o.useState)(),[g,f]=(0,o.useState)(),p=(0,o.useRef)(null),generateTransaction=async()=>{var t;if(!n)throw Error("no account");if(!e)throw Error("no network");let a=x.mRj.generate();i(a),null===(t=p.current)||void 0===t||t.setJsonValue("secondarySignerInfoResponse",{"此为自动生成，请勿修改，否则会导致交易失败":"",Address:a.accountAddress.toString(),"Private Key":a.privateKey.toString(),"Public Key":a.publicKey.toString()});let s=await aptosClient(e).transaction.build.multiAgent({sender:n.address,secondarySignerAddresses:[a.accountAddress],data:{bytecode:"0xa11ceb0b0700000a0601000203020605080d071525083a40107a1f010200030201000104060c060c05030003060c0503083c53454c463e5f30046d61696e0d6170746f735f6163636f756e74087472616e73666572ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000114636f6d70696c6174696f6e5f6d65746164617461090003322e3003322e31000001070b000b01010b020b03110002",typeArguments:[],functionArguments:[n.address,new x.G90(1)]},options:{expireTimestamp:Math.floor(Date.now()/1e3)+300}});return console.log("=== DEBUG: Transaction generation ==="),console.log("Sender address:",n.address),console.log("Secondary signer address:",a.accountAddress.toString()),console.log("Transaction to sign:",s),s},onSenderSignTransaction=async()=>{let n=await generateTransaction();c(n);try{var e;let a=await t({transactionOrPayload:n});console.log("=== DEBUG: Sender signing ==="),console.log("Sender sign response:",a);let s=a.authenticator;console.log("===== senderAuth ===== ","isEd25519: ".concat(s.isEd25519()?"true":"false",", isMultiEd25519: ").concat(s.isMultiEd25519()?"true":"false",", isSingleKey: ").concat(s.isSingleKey()?"true":"false",", isMultiKey: ").concat(s.isMultiKey()?"true":"false")),d(s),null===(e=p.current)||void 0===e||e.setJsonValue("senderSignResponse",a.authenticator)}catch(n){console.error("Sender signing error:",n)}},onSecondarySignerSignTransaction=async()=>{if(!l)throw Error("No Transaction to sign");if(!r)throw Error("No secondarySignerAccount");try{var n;console.log("=== DEBUG: Secondary signer signing ==="),console.log("Secondary signer account:",r.accountAddress.toString());let t=aptosClient(e).sign({signer:r,transaction:l});return console.log("Secondary signer authenticator:",t),f(t),console.log("===== secondaryAuth ===== ","isEd25519: ".concat(t.isEd25519()?"true":"false",", isMultiEd25519: ").concat(t.isMultiEd25519()?"true":"false",", isSingleKey: ").concat(t.isSingleKey()?"true":"false",", isMultiKey: ").concat(t.isMultiKey()?"true":"false")),null===(n=p.current)||void 0===n||n.setJsonValue("secondarySignerSignResponse",t),Promise.resolve()}catch(n){console.error("Secondary signer signing error:",n)}},onSubmitTransaction=async()=>{var n,e;try{if(!l)throw Error("No Transaction to sign");if(!u)throw Error("No senderAuthenticator");if(!g)throw Error("No secondarySignerAuthenticator");console.log("=== DEBUG: Transaction submission ==="),console.log("Transaction to submit:",l),console.log("Sender authenticator:",u),console.log("Secondary authenticator:",g);let e=await s({transaction:l,senderAuthenticator:u,additionalSignersAuthenticators:[g]});null===(n=p.current)||void 0===n||n.setJsonValue("submitTransactionResponse",e),window&&window.open&&e.hash&&window.open("https://explorer.aptoslabs.com/txn/".concat(e.hash),"_blank")}catch(n){null===(e=p.current)||void 0===e||e.setJsonValue("submitTransactionResponse",{error:n}),console.error("Submit transaction error:",n)}};return(0,a.jsxs)(T.s,{title:"MultiAgent Transaction Flow",description:"通过第二个账户签字实现第一个账户给第一个账户转账。 需要两个账户，一个作为发送者，一个作为第二签名账户, 发送者账户需要先签名，然后第二签名账户再签名，最后一起提交。",ref:p,children:[(0,a.jsx)(T.s.TextArea,{id:"secondarySignerInfoResponse",label:"第二签名账户信息"}),(0,a.jsx)(T.s.Button,{id:"onSenderSignTransaction",label:"1. Sign as sender & generate secondary account",onClick:onSenderSignTransaction}),(0,a.jsx)(T.s.TextArea,{id:"senderSignResponse",label:"执行结果"}),(0,a.jsx)(T.s.Button,{id:"onSecondarySignerSignTransaction",label:"2. Sign as secondary signer",onClick:onSecondarySignerSignTransaction,disabled:!r}),(0,a.jsx)(T.s.TextArea,{id:"secondarySignerSignResponse",label:"执行结果"}),(0,a.jsx)(T.s.Button,{id:"submitTransaction",label:"3. Submit transaction",onClick:onSubmitTransaction,disabled:!u||!g}),(0,a.jsx)(T.s.JsonEdit,{id:"submitTransactionResponse",label:"执行结果"})]})}function SponsorTransactionFlow(){let{account:n,network:e,signTransaction:t,submitTransaction:s}=(0,h.Os)(),[r,i]=(0,o.useState)(null),[l,c]=(0,o.useState)(),[u,d]=(0,o.useState)(),[g,f]=(0,o.useState)(),p=(0,o.useRef)(null),generateTransaction=async t=>{if(!n)throw Error("no account");if(!e)throw Error("no network");console.log("===  01, generateTransaction ===");let a=await aptosClient(e).transaction.build.simple({sender:t.accountAddress,withFeePayer:!0,data:{function:"0x1::resource_account::create_resource_account",typeArguments:[],functionArguments:[n.address.toString(),x.kxK.from("0x0").toUint8Array()]},options:{expireTimestamp:Math.floor(Date.now()/1e3)+300}});return console.log("===  02, transactionToSign ===",a),a.feePayerAddress=n.address,a},onSignTransaction=async()=>{var n,t;let a=x.mRj.generate();c(a),null===(n=p.current)||void 0===n||n.setJsonValue("senderInfoResponse",{"此为自动生成，请勿修改，否则会导致交易失败":"",Address:a.accountAddress.toString(),"Private Key":a.privateKey.toString(),"Public Key":a.publicKey.toString()}),console.log("=== DEBUG: Transaction generation ==="),console.log("Sender address:",a.accountAddress.toString());let s=await generateTransaction(a);i(s),console.log("=== DEBUG: Transaction generation ==="),console.log("Transaction to sign:",s);try{let n=aptosClient(e).sign({signer:a,transaction:s});d(n),null===(t=p.current)||void 0===t||t.setJsonValue("senderSignResponse",n)}catch(n){console.error(n)}},onSignTransactionAsSponsor=async()=>{if(!r)throw Error("No Transaction to sign");try{var n;let e=await t({transactionOrPayload:r,asFeePayer:!0});f(e.authenticator),null===(n=p.current)||void 0===n||n.setJsonValue("sponsorSignResponse",e.authenticator)}catch(n){console.error(n)}},onSubmitTransaction=async()=>{var n,e;if(!r)throw Error("No Transaction to sign");if(!u)throw Error("No senderAuthenticator");if(!g)throw Error("No feepayerAuthenticator");try{let e=await s({transaction:r,senderAuthenticator:u,feePayerAuthenticator:g});null===(n=p.current)||void 0===n||n.setJsonValue("submitTransactionResponse",e),window&&window.open&&e.hash&&window.open("https://explorer.aptoslabs.com/txn/".concat(e.hash),"_blank")}catch(n){null===(e=p.current)||void 0===e||e.setJsonValue("submitTransactionResponse",{error:n}),console.error(n)}};return(0,a.jsxs)(T.s,{title:"Sponsor Transaction Flow",description:"第一个用户发起一个创建账户的交易，第二个用户作为赞助者，支付交易费用",ref:p,children:[(0,a.jsx)(T.s.TextArea,{id:"senderInfoResponse",label:"交易发送者信息"}),(0,a.jsx)(T.s.Button,{id:"onSignTransaction",label:"1. Sign as sender",onClick:onSignTransaction}),(0,a.jsx)(T.s.TextArea,{id:"senderSignResponse",label:"执行结果"}),(0,a.jsx)(T.s.Button,{id:"onSignTransactionAsSponsor",label:"2. Sign as sponsor, 帮助发送者支付交易费用",onClick:onSignTransactionAsSponsor,disabled:!l||!r}),(0,a.jsx)(T.s.TextArea,{id:"sponsorSignResponse",label:"执行结果"}),(0,a.jsx)(T.s.Button,{id:"submitTransaction",label:"3. Submit transaction",onClick:onSubmitTransaction,disabled:!u||!g}),(0,a.jsx)(T.s.JsonEdit,{id:"submitTransactionResponse",label:"执行结果"})]})}function Example(){var n,e,t,r,o,c,u;let{connected:d,account:p,network:v,signAndSubmitTransaction:b,signMessageAndVerify:w,signMessage:T,signTransaction:j,submitTransaction:N,signIn:E}=(0,h.Os)(),O=new x.gZG(new x.ScN({network:x.ZcK.MAINNET}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.s,{title:"Basics",children:[(0,a.jsx)(l.u,{title:"getNetwork",description:"getNetwork",disableRequestContent:!0,allowCallWithoutProvider:!0,onExecute:async()=>Promise.resolve(v)}),(0,a.jsx)(l.u,{title:"isConnected",description:"isConnected",disableRequestContent:!0,allowCallWithoutProvider:!0,onExecute:async()=>Promise.resolve(d)}),(0,a.jsx)(l.u,{title:"account",description:"当前账户",disableRequestContent:!0,allowCallWithoutProvider:!0,onExecute:async()=>Promise.resolve(p)}),(0,a.jsx)(l.u,{title:"network",description:"当前网络",disableRequestContent:!0,allowCallWithoutProvider:!0,onExecute:async()=>Promise.resolve(v)})]}),(0,a.jsxs)(l.s,{title:"Transfer",children:[(0,a.jsx)(l.u,{title:"signMessage",description:"signMessage",presupposeParams:f.signMessage,onExecute:async n=>{let e=JSON.parse(n),t=await T(e);return(0,k.a)(t).replace(/\\n/g,"\\\\n").replace(/\\r/g,"\\\\r").replace(/\\t/g,"\\\\t")},onValidate:(n,e)=>{var t;let{fullMessage:a,signature:s}=JSON.parse(e),r=jsonToUint8Array(A()(s,"data.data")),o=m().sign.detached.verify(K.from(a),r,(0,i.nr)((0,S.stripHexPrefix)(null!==(t=null==p?void 0:p.publicKey.toString())&&void 0!==t?t:"")));return Promise.resolve(o.toString())}}),(0,a.jsx)(l.u,{title:"signMessageAndVerify",description:"signMessageAndVerify",presupposeParams:f.signMessage,onExecute:async n=>{let e=JSON.parse(n);return w(e)}}),(0,a.jsx)(l.u,{title:"signIn",description:"signIn",presupposeParams:[{id:"signIn",name:"signIn",value:JSON.stringify({walletName:"OneKey",input:{domain:"localhost:3000",nonce:Math.random().toString(16),statement:"Signing into demo application",notBefore:new Date().toISOString(),expirationTime:new Date(Date.now()+864e5).toISOString(),issuedAt:new Date().toISOString(),requestId:"abc",resources:["resource.1","resource.2"]}})}],onExecute:async n=>{let e=JSON.parse(n);return E(e)},onValidate:async(n,e)=>{let{account:t,input:a,signature:s}=JSON.parse(e),r=jsonToUint8Array(A()(t,"publicKey.key.data")),o=jsonToUint8Array(A()(s,"data.data")),i=(0,y.uM)((0,y.SW)(a)),l=m().sign.detached.verify(K.from(i),o,r);return Promise.resolve(l.toString())}}),(0,a.jsx)(l.u,{title:"signTransaction",description:"signTransaction",presupposeParams:f.signTransaction(null!==(n=null==p?void 0:p.address.toString())&&void 0!==n?n:""),onExecute:async n=>{let e=JSON.parse(n),{data:t,asFeePayer:a,options:s}=e,r=await j({transactionOrPayload:{data:t,options:s||void 0},asFeePayer:a});return r}}),(0,a.jsx)(l.u,{title:"signAndSubmitTransaction",description:"signAndSubmitTransaction",presupposeParams:f.signAndSubmitTransaction(null!==(e=null==p?void 0:p.address.toString())&&void 0!==e?e:""),onExecute:async n=>{let e=JSON.parse(n),t=await b(e);return JSON.stringify(t)}})]}),(0,a.jsxs)(l.s,{title:"SDK Build Transaction",children:[(0,a.jsx)(l.u,{title:"signTransaction-SDK-build transaction",description:"使用 SDK 构造 Coin 转账",presupposeParams:[{id:"sender",name:"sender",value:JSON.stringify({recipient:null!==(t=null==p?void 0:p.address.toString())&&void 0!==t?t:"",amount:1e5})}],onExecute:async n=>{var e;let{recipient:t,amount:a}=JSON.parse(n),s=await O.coin.transferCoinTransaction({sender:null!==(e=null==p?void 0:p.address.toString())&&void 0!==e?e:"",recipient:t,amount:a});return{txn:s.bcsToHex().toStringWithoutPrefix(),result:await j({transactionOrPayload:s})}},onValidate:async(n,e)=>{let{txn:t,result:a}=JSON.parse(e),s=jsonToUint8Array(A()(a,"authenticator.public_key.key.data")),r=jsonToUint8Array(A()(a,"authenticator.signature.data.data")),o=x._tO.deserialize(new x.ZKs((0,i.nr)(t))),l=await N({transaction:o,senderAuthenticator:new x.rEE(new x.EZS(s),new x.AoU(r))});return Promise.resolve(JSON.stringify(l))}}),(0,a.jsx)(l.u,{title:"signTransaction-SDK-build transaction",description:"使用 SDK 构造 Legacy Token 转账",presupposeParams:[{id:"sender",name:"sender",value:JSON.stringify({recipient:null!==(r=null==p?void 0:p.address.toString())&&void 0!==r?r:"",amount:1e5,coinType:"0xf22bede237a07e121b56d91a491eb7bcdfd1f5907926a9e58338f964a01b17fa::asset::USDC"})}],onExecute:async n=>{var e;let{recipient:t,amount:a,coinType:s}=JSON.parse(n),r=await O.coin.transferCoinTransaction({sender:null!==(e=null==p?void 0:p.address.toString())&&void 0!==e?e:"",recipient:t,amount:a,coinType:s});return{txn:r.bcsToHex().toStringWithoutPrefix(),result:await j({transactionOrPayload:r})}},onValidate:async(n,e)=>{let{txn:t,result:a}=JSON.parse(e),s=jsonToUint8Array(A()(a,"authenticator.public_key.key.data")),r=jsonToUint8Array(A()(a,"authenticator.signature.data.data")),o=x._tO.deserialize(new x.ZKs((0,i.nr)(t))),l=await N({transaction:o,senderAuthenticator:new x.rEE(new x.EZS(s),new x.AoU(r))});return Promise.resolve(JSON.stringify(l))}}),(0,a.jsx)(l.u,{title:"signTransaction-SDK-build transaction",description:"使用 SDK 构造 Token 转账",presupposeParams:[{id:"sender",name:"sender",value:JSON.stringify({recipient:null!==(o=null==p?void 0:p.address)&&void 0!==o?o:"",amount:1e5,coinType:"0x357b0b74bc833e95a115ad22604854d6b0fca151cecd94111770e5d6ffc9dc2b"})}],onExecute:async n=>{let{recipient:e,amount:t,coinType:a}=JSON.parse(n);try{var s;let n=await O.transaction.build.simple({sender:null!==(s=null==p?void 0:p.address)&&void 0!==s?s:"",data:{function:"0x1::primary_fungible_store::transfer",typeArguments:["0x1::fungible_asset::Metadata"],functionArguments:[a,e,t],abi:{typeParameters:[{constraints:[]}],parameters:[(0,x._LL)("0x1::object::Object"),new x.iep,new x.VwW]}}});return{txn:n.bcsToHex().toStringWithoutPrefix(),result:await j({transactionOrPayload:n})}}catch(n){console.log(n)}},onValidate:async(n,e)=>{let{txn:t,result:a}=JSON.parse(e),s=jsonToUint8Array(A()(a,"authenticator.public_key.key.data")),r=jsonToUint8Array(A()(a,"authenticator.signature.data.data")),o=x._tO.deserialize(new x.ZKs((0,i.nr)(t))),l=await N({transaction:o,senderAuthenticator:new x.rEE(new x.EZS(s),new x.AoU(r))});return Promise.resolve(JSON.stringify(l))}})]}),(0,a.jsxs)(l.s,{title:"SignAndSubmitTransaction Test",children:[(0,a.jsx)(l.u,{title:"signAndSubmitTransaction Normal Argument",description:"Normal Argument 测试",presupposeParams:[{id:"sender",name:"sender",value:JSON.stringify({recipient:null!==(c=null==p?void 0:p.address.toString())&&void 0!==c?c:"",amount:1e5,coinType:"0x357b0b74bc833e95a115ad22604854d6b0fca151cecd94111770e5d6ffc9dc2b"})}],onExecute:async n=>{var e;let{recipient:t,amount:a,coinType:s}=JSON.parse(n);return{result:await b({sender:null!==(e=null==p?void 0:p.address.toString())&&void 0!==e?e:"",data:{function:"0x1::primary_fungible_store::transfer",typeArguments:["0x1::fungible_asset::Metadata"],functionArguments:[s,t,a]}})}}}),(0,a.jsx)(l.u,{title:"signAndSubmitTransaction Encode Argument",description:"Encode Argument 测试 (OneKey、OKX、MizuWallet 等都不支持)",presupposeParams:[{id:"sender",name:"sender",value:JSON.stringify({recipient:null!==(u=null==p?void 0:p.address.toString())&&void 0!==u?u:"",amount:1e5,coinType:"0x357b0b74bc833e95a115ad22604854d6b0fca151cecd94111770e5d6ffc9dc2b"})}],onExecute:async n=>{var e;let{recipient:t,amount:a,coinType:s}=JSON.parse(n);return{result:await b({sender:null!==(e=null==p?void 0:p.address.toString())&&void 0!==e?e:"",data:{function:"0x1::primary_fungible_store::transfer",typeArguments:["0x1::fungible_asset::Metadata"],functionArguments:[s,x.kxK.from(t),new x.G90(a)]}})}}}),(0,a.jsx)(l.u,{title:"signAndSubmitTransaction Script",description:"Script 测试",presupposeParams:[{id:"sign with script payload",name:"with script payload",value:""}],onExecute:async n=>{var e,t;return{result:await b({sender:null!==(e=null==p?void 0:p.address.toString())&&void 0!==e?e:"",data:{bytecode:"a11ceb0b060000000701000402040a030e0c041a04051e20073e30086e2000000001010204010001000308000104030401000105050601000002010203060c0305010b0001080101080102060c03010b0001090002050b00010900000a6170746f735f636f696e04636f696e04436f696e094170746f73436f696e087769746864726177076465706f7369740000000000000000000000000000000000000000000000000000000000000001000001080b000b0138000c030b020b03380102",functionArguments:[new x.G90(1),x.kxK.from(null!==(t=null==p?void 0:p.address.toString())&&void 0!==t?t:"")]}})}}}),(0,a.jsx)(l.u,{title:"signAndSubmitTransaction test set gas",description:"测试设置 gas",presupposeParams:[{id:"sign with options",name:"with options",value:""}],onExecute:async n=>{var e;let t=await b({sender:null!==(e=null==p?void 0:p.address.toString())&&void 0!==e?e:"",data:{function:"0x1::coin::transfer",typeArguments:["0x1::aptos_coin::AptosCoin"],functionArguments:[p.address.toString(),1]},options:{maxGasAmount:1e4}}),a=await O.waitForTransaction({transactionHash:t.hash});return 1e4==a.max_gas_amount?Promise.resolve({title:"Success",description:"transaction ".concat(a.hash," executed with a max gas amount of ").concat(1e4)}):Promise.resolve({variant:"destructive",title:"Error",description:"transaction ".concat(a.hash," executed with a max gas amount of ").concat(A()(a,"max_gas_amount"))})}})]}),(0,a.jsxs)(l.s,{title:"Advanced Transaction Flow",children:[(0,a.jsx)(MultiAgentTransactionFlow,{}),(0,a.jsx)(SponsorTransactionFlow,{})]}),(0,a.jsx)(g.Z,{dapps:s})]})}function AptosConnectButton(){var n,e,t,s,i,l,u,d,g,f,p;let{connected:m,wallets:S,account:y,network:x,connect:w,disconnect:T}=(0,h.Os)(),{setProvider:j}=(0,c.O)(),N=(0,o.useRef)([]);N.current=S.filter(n=>n.readyState===v.i1.Installed),(0,o.useEffect)(()=>{console.log("Aptos Standard Wallets:",S)},[S]);let E=(0,o.useCallback)(async n=>{let e=N.current.find(e=>e.name===n.id);return e?(w(e.name),{provider:void 0}):Promise.reject("Wallet not found")},[w]);return(0,o.useEffect)(()=>{console.log("account changed",y),j(y)},[y,j]),(0,o.useEffect)(()=>{console.log("network changed",x)},[x]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Z,{fetchWallets:()=>Promise.resolve(N.current.map(n=>({id:n.name,name:n.name,tags:[A()(n,"isAIP62Standard")?"AIP62":"",A()(n,"isAptosNativeWallet")?"Aptos Native":""]}))),onConnect:E,onDisconnect:()=>void T()}),(0,a.jsxs)(b.Z,{title:"Base Info",children:[y&&(0,a.jsxs)("p",{children:["Account:",null!==(l=null==y?void 0:null===(n=y.address)||void 0===n?void 0:n.toString())&&void 0!==l?l:""]}),y&&(0,a.jsxs)("p",{children:["PubKey:",null!==(u=null==y?void 0:null===(e=y.publicKey)||void 0===e?void 0:e.toString())&&void 0!==u?u:""]}),y&&(0,a.jsxs)("p",{children:["ansName:",null!==(d=null==y?void 0:null===(t=y.ansName)||void 0===t?void 0:t.toString())&&void 0!==d?d:""]}),x&&(0,a.jsxs)("p",{children:["chainId:",null!==(g=null==x?void 0:x.chainId)&&void 0!==g?g:""]}),x&&(0,a.jsxs)("p",{children:["networkName:",null!==(f=null==x?void 0:null===(s=x.name)||void 0===s?void 0:s.toString())&&void 0!==f?f:""]}),x&&(0,a.jsxs)("p",{children:["networkUrl:",null!==(p=null==x?void 0:null===(i=x.url)||void 0===i?void 0:i.toString())&&void 0!==p?p:""]}),y&&(0,a.jsxs)("p",{children:["Status :",m?"Connected":"Disconnected"]})]})]})}let _=new u.S;function App(){return(0,a.jsx)(d.aH,{client:_,children:(0,a.jsxs)(h.Ay,{autoConnect:!0,dappConfig:{network:x.ZcK.MAINNET},optInWallets:["Petra","OneKey","OKX Wallet","Nightly","Mizu Wallet","Pontem Wallet"],onError:n=>{console.log("error",n)},children:[(0,a.jsx)(AptosConnectButton,{}),(0,a.jsx)(Example,{})]})})}},6912:function(n,e,t){"use strict";t.d(e,{Z:function(){return ConnectButton}});var a=t(85893),s=t(67294),r=t(9663),o=t(51731),i=t(53617),l=t(23225),c=t(96544),u=t(27361),d=t.n(u),g=t(78299);let f={address:"地址",publicKey:"公钥",chainId:"网络"};function ConnectButton(n){let{fetchWallets:e,onConnect:t,onDisconnect:u}=n,{settings:p}=(0,g.r)(),m=(0,s.useRef)(null),S=(0,s.useRef)(!1),[y,x]=(0,s.useState)([]),{setProvider:v,setAccount:h,provider:b,account:w}=(0,l.O)(),A=(0,s.useCallback)(async n=>{try{let{provider:e,...a}=await t(n);v(e),h(a)}catch(n){console.log("connectWallet error",n),(0,c.Am)({title:"连接失败",description:d()(n,"message","")})}},[t,h,v]),T=(0,s.useCallback)(async()=>{S.current=!1,await (null==u?void 0:u()),v(null),h(null)},[u,h,v]),j=(0,s.useCallback)(()=>{setTimeout(()=>{try{var n;null===(n=m.current)||void 0===n||n.click()}catch(n){}},150)},[]),N=(0,s.useCallback)(async n=>{let t=await (null==e?void 0:e());if((null==t?void 0:t.length)===0){j();return}let{directConnection:a}=null!=n?n:{directConnection:!1};(null==t?void 0:t.length)===1||(null==t?void 0:t.length)>0&&a?(j(),await A(t[0])):x(t)},[j,A,e]);return(0,s.useEffect)(()=>{let n=setTimeout(async()=>{!S.current&&(console.log("settings.autoConnect",p.autoConnect),p.autoConnect&&(S.current=!0,await N({directConnection:!0})))},500);return()=>{clearTimeout(n)}},[p.autoConnect]),(0,a.jsx)(o.Zb,{children:(0,a.jsxs)(o.aY,{className:"flex flex-col flex-wrap gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-row flex-wrap justify-between",children:[(0,a.jsxs)(i.Vq,{children:[(0,a.jsx)(i.hg,{asChild:!0,children:(0,a.jsx)(r.z,{onClick:()=>N(),children:"Connect Wallet"})}),(0,a.jsxs)(i.cZ,{children:[(0,a.jsx)(i.GG,{ref:m}),(0,a.jsxs)(i.fK,{children:[(0,a.jsx)(i.$N,{children:"选择钱包开始连接"}),!!y&&y.map(n=>{var e;return(0,a.jsx)(i.GG,{asChild:!0,children:(0,a.jsxs)(r.z,{onClick:()=>A(n),className:"gap-2",children:[n.logo&&(0,a.jsx)("img",{alt:n.name,src:n.logo,className:"w-5 h-5 rounded-full"}),(0,a.jsx)("span",{className:"font-medium",children:n.name}),null===(e=n.tags)||void 0===e?void 0:e.map(n=>(0,a.jsx)("span",{className:"text-xs font-light",children:n},n))]})},n.id)}),!y||0===y.length&&(0,a.jsxs)(i.Be,{children:["没有钱包可用，请安装 OneKey Extension",(0,a.jsx)("a",{target:"_blank",href:"https://www.onekey.so/download/",children:"Install OneKey Extension →"})]})]})]})]}),b&&(0,a.jsx)(r.z,{variant:"destructive",onClick:T,children:"断开链接"})]}),w&&(0,a.jsx)("div",{className:"flex grid-cols-1 xl:grid-cols-2 flex-wrap gap-x-6 gap-y-3 mt-4",children:Object.keys(w).map(n=>{var e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{children:["".concat(null!==(e=null==f?void 0:f[n])&&void 0!==e?e:n),": "]}),(0,a.jsx)("span",{className:"font-normal flex flex-wrap text-break",children:"".concat(null==w?void 0:w[n])})]},n)})})]})})}},46601:function(){},89214:function(){},85568:function(){},52361:function(){},94616:function(){}}]);
//# sourceMappingURL=5129.0f6d1bda4655314d.js.map