"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1491],{6793:function(e,t,n){var a=n(85893);n(67294);var s=n(41664),l=n.n(s),o=n(51731);t.Z=e=>{let{dapps:t}=e;return(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.ll,{className:"text-xl",children:"Dapp Bookmarks"}),(0,a.jsx)(o.aY,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:t.map((e,t)=>(0,a.jsx)("div",{className:"border p-2 rounded-lg shadow-sm hover:shadow-md",children:(0,a.jsx)(l(),{href:e.url,legacyBehavior:!0,children:(0,a.jsxs)("a",{className:"text-blue-500 hover:underline text-lg block",children:[e.name," →"]})})},t))})]})}},64044:function(e,t,n){n.d(t,{D:function(){return InputWithSave}});var a=n(85893),s=n(67294),l=n(23279),o=n.n(l),r=n(40293);function InputWithSave(e){let{storageKey:t,onChange:n,defaultValue:l,type:i="text"}=e,[d,c]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=localStorage.getItem(t)||l||"";c(e),n(e)},[t,l,n]);let u=(0,s.useCallback)(o()(e=>{localStorage.setItem(t,e),n(e)},300),[t,n]);return(0,s.useEffect)(()=>()=>u.cancel(),[u]),(0,a.jsx)(r.I,{type:i,value:d,className:"w-full p-2 border border-gray-300 rounded-md",onChange:e=>{let{value:t}=e.target;c(t),u(t)},placeholder:"输入内容"},t)}},92159:function(e,t,n){n.d(t,{F:function(){return a}});let a=[{name:"Minswap",url:"https://app.minswap.org/"},{name:"SundaeSwap",url:"https://sundaeswap.finance/"}]},61491:function(e,t,n){n.a(e,async function(e,a){try{n.r(t),n.d(t,{default:function(){return Example}});var s=n(85893),l=n(92159),o=n(6912),r=n(67294),i=n(27361),d=n.n(i),c=n(41609),u=n.n(c),f=n(99710),g=n(23225),x=n(6793),p=n(10542),m=n(96544),h=n(40293),b=n(30571),v=n(64044),j=n(66409),y=e([b]);function cborToAddress(e){return b.C.Address.from_bytes((0,j.nr)(e)).to_bech32(void 0)}b=(y.then?(await y)():y)[0];let w={ADA:{unit:"lovelace",decimals:6},MIN:{unit:"29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c64d494e",decimals:6}};function Example(){let e=(0,r.useRef)([{uuid:"injected",name:"Injected Wallet",inject:"cardano"},{uuid:"injected-onekey",name:"Injected OneKey",inject:"$onekey.cardano"}]),{provider:t,setAccount:n,account:a}=(0,g.O)(),i=(0,r.useRef)(null),[c,y]=(0,r.useState)(null),[C,N]=(0,r.useState)(null),onConnectWallet=async t=>{var n;let a;i.current;let s=null===(n=e.current)||void 0===n?void 0:n.find(e=>e.uuid===t.id);if(!s)return Promise.reject("Wallet not found");console.log("providerDetail",s);let l=d()(window,s.inject);if(console.log("provider",l),!l){(0,m.Am)({title:"Wallet not found",description:"Please install the wallet extension"});return}let o=await (null==l?void 0:l.enable());y(o);try{a=await o.getNetworkId()}catch(e){console.log("error",e)}let r=i.current;(!r||u()(r))&&(r="mainnetJ38poK8wVFdWKW1cdjC975b12vxqz1qz");let c=await b._k.new(new b.sn("https://cardano-mainnet.blockfrost.io/api/v0",r),"Mainnet");c.selectWallet(o),N(c);let f=await c.wallet.address();return{provider:l,address:f,chainId:a.toString()}};return(0,r.useEffect)(()=>{var e;if(!t)return;let onConnectListener=e=>{console.log("cardano on [connect] ".concat(e))},onAccountChangeListener=e=>{console.log("cardano on [accountChange] ".concat(e)),e.length&&n({...a,address:e[0]})},onNetworkChangeListener=e=>{console.log("cardano on [networkChange] ".concat(e))},s=(null==c?void 0:null===(e=c.experimental)||void 0===e?void 0:e.on)||(null==t?void 0:t.on);if(s)try{null==s||s("connect",onConnectListener),null==s||s("accountChange",onAccountChangeListener),null==s||s("networkChange",onNetworkChangeListener)}catch(e){}return()=>{var e;let n=(null==t?void 0:null===(e=t.experimental)||void 0===e?void 0:e.off)||(null==t?void 0:t.off);if(n)try{null==n||n("connect",onConnectListener),null==n||n("networkChange",onAccountChangeListener),null==n||n("networkChange",onNetworkChangeListener)}catch(e){}}},[a,t,n]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.s,{title:"Blockfrost Project ID",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("p",{children:"动态生成交易需要一个公开的 RPC 节点，在这里 https://cardano-mainnet.blockfrost.io 创建一个 Project 复制 project_id 粘贴到这里（会自动保存）"}),(0,s.jsx)(v.D,{storageKey:"cardano-wallet-projectid",onChange:e=>i.current=e})]})}),(0,s.jsx)(o.Z,{fetchWallets:()=>{var t,n;let a=Object.keys(null!==(n=null===(t=window)||void 0===t?void 0:t.cardano)&&void 0!==n?n:{}).filter(e=>["onekey","lace","nami","yoroi"].includes(e)).map(e=>({uuid:e,name:e,inject:"cardano.".concat(e)}));return a.forEach(t=>{e.current.find(e=>e.uuid===t.uuid)||e.current.push(t)}),Promise.resolve(e.current.map(e=>({id:e.uuid,name:e.name})))},onConnect:onConnectWallet,onDisconnect:()=>(y(null),Promise.resolve())}),(0,s.jsxs)(f.s,{title:"Basics",children:[(0,s.jsx)(f.u,{title:"enable",description:"获取账户权限",disableRequestContent:!0,onExecute:async e=>{let n=await (null==t?void 0:t.enable());return y(n),JSON.stringify(n)}}),(0,s.jsx)(f.u,{title:"isEnabled",description:"是否已经连接",disableRequestContent:!0,onExecute:async e=>{let n=await (null==t?void 0:t.isEnabled());return JSON.stringify(n)}}),(0,s.jsx)(f.u,{title:"apiVersion",description:"获取 API 版本",disableRequestContent:!0,onExecute:async e=>null==t?void 0:t.apiVersion}),(0,s.jsx)(f.u,{title:"name",description:"获取钱包名称",disableRequestContent:!0,onExecute:async e=>null==t?void 0:t.name}),(0,s.jsx)(f.u,{title:"icon",description:"获取图标",disableRequestContent:!0,onExecute:async e=>null==t?void 0:t.icon}),(0,s.jsx)(f.u,{title:"getNetworkId",description:"获取网络 ID",disableRequestContent:!0,onExecute:async e=>{let t=await (null==c?void 0:c.getNetworkId());return t.toString()}}),(0,s.jsx)(f.u,{title:"getUsedAddresses",description:"获取地址列表。(origin 是接口原始信息，decode 是本网站解析的结果)",disableRequestContent:!0,onExecute:async e=>{let t=await (null==c?void 0:c.getUsedAddresses()),n=t.map(e=>cborToAddress(e));return JSON.stringify({origin:t,decode:n})}}),(0,s.jsx)(f.u,{title:"getUnusedAddresses",description:"获取未使用地址。(origin 是接口原始信息，decode 是本网站解析的结果)",disableRequestContent:!0,onExecute:async e=>{let t=await (null==c?void 0:c.getUnusedAddresses()),n=t.map(e=>cborToAddress(e));return JSON.stringify({origin:t,decode:n})}}),(0,s.jsx)(f.u,{title:"getChangeAddress",description:"获取找零地址。(origin 是接口原始信息，decode 是本网站解析的结果)",disableRequestContent:!0,onExecute:async e=>{let t=await (null==c?void 0:c.getChangeAddress()),n=cborToAddress(t);return JSON.stringify({origin:t,decode:n})}}),(0,s.jsx)(f.u,{title:"getRewardAddresses",description:"获取奖励地址。(origin 是接口原始信息，decode 是本网站解析的结果)",disableRequestContent:!0,onExecute:async e=>{let t=await (null==c?void 0:c.getRewardAddresses()),n=t.map(e=>cborToAddress(e));return JSON.stringify({origin:t,decode:n})}}),(0,s.jsx)(f.u,{title:"getBalance",description:"获取余额。(origin 是接口原始信息，decode 是本网站解析的结果)",disableRequestContent:!0,onExecute:async e=>{let t=await (null==c?void 0:c.getBalance()),n=b.C.Value.from_bytes((0,j.nr)(t));return JSON.stringify({origin:t,decode:JSON.parse(n.to_json())})}}),(0,s.jsx)(f.u,{title:"getUtxos",description:"获取 UTXO 列表。(origin 是接口原始信息，decode 是本网站解析的结果)",disableRequestContent:!0,onExecute:async e=>{let t=await (null==c?void 0:c.getUtxos()),n=t.map(e=>{let t=b.C.TransactionUnspentOutput.from_bytes((0,j.nr)(e));return(0,b.lo)(t)});return JSON.stringify({origin:t,decode:n},(e,t)=>"bigint"==typeof t?t.toString():t)}}),(0,s.jsx)(f.u,{title:"getCollateral",description:"（暂不支持）获取抵押物",disableRequestContent:!0,onExecute:async e=>{var t;let n=await (null==c?void 0:null===(t=c.experimental)||void 0===t?void 0:t.getCollateral());return JSON.stringify(n)}})]}),(0,s.jsx)(f.s,{title:"Sign Message",children:(0,s.jsx)(f.u,{title:"signData",description:"(报错) 签名消息",presupposeParams:p.Z.signData,onExecute:async e=>{let t=await C.newMessage(a.address,e).sign();return JSON.stringify(t)},onValidate:async(e,t)=>{let n=JSON.parse(t);console.log("signedMessage",n);let s=C.verifyMessage(a.address,e,n);return Promise.resolve(JSON.stringify(s))}})}),(0,s.jsxs)(f.s,{title:"Transafer",children:[(0,s.jsx)(f.u,{title:"signTx",description:"签署交易",onExecute:async e=>{let t=await C.fromTx(e).sign().complete();return t.toString()},generateRequestFrom:()=>{var e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.I,{label:"收款地址",type:"text",name:"toAddress",defaultValue:null!==(e=null==a?void 0:a.address)&&void 0!==e?e:""}),(0,s.jsx)("select",{name:"coin",defaultValue:"ADA",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:Object.keys(w).map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),(0,s.jsx)(h.I,{label:"转账金额(转ADA最小值大约 0.96 ADA)",type:"number",name:"amount",defaultValue:"1000000"})]})},onGenerateRequest:async e=>{var t;let n=e.toAddress,a=parseInt(e.amount),s=null===(t=e.coin)||void 0===t?void 0:t.toUpperCase();if(!c)throw Error("walletApi is required");if(!n||!a)throw Error("toAddress or amount is required");try{let e=w[s];if(!e)throw Error("不支持的代币: ".concat(s));let t={[e.unit]:BigInt(a)};"ADA"!==s&&(t.lovelace=BigInt(2e6));let l=await C.newTx().payToAddress(n,t).complete({coinSelection:!0});return Promise.resolve(l.toString())}catch(e){if(console.log("error",e),"InputsExhaustedError"===e)throw Error("余额不足, InputsExhaustedError");throw e}}}),(0,s.jsx)(f.u,{title:"submitTx",description:"广播交易",presupposeParams:[{id:"submitTx",name:"submitTx",value:"复制 signTx 签名结果到这里、然后点击执行。\nsignTx 验证流程会自动广播交易。重复广播会报错。"}],onExecute:async e=>{let t=await (null==c?void 0:c.submitTx(e));return t}})]}),(0,s.jsx)(x.Z,{dapps:l.F})]})}a()}catch(e){a(e)}})},10542:function(e,t){t.Z={signData:[{id:"signData hello",name:"signData Hello",value:"48656c6c6f204f6e654b6579"},{id:"signData",name:"signData 010203",value:"010203"}],signTx:[{id:"signTx",name:"signTx",value:"84a300818258200528ed5dd2134534df4d999c9cd712e8b47441a0363cc972bf5d5c72635c3e5100018282583901cd5aa28518568615ed6bd4ad40e6cecd65734373bf578489b02830e38d6dc22f3b6dfd333cf6495e8fb3fffbc2936cc010827b32d92eca1b1a000f424082583901922941c2e490c9f9f8706c66f7f46b5abec243fcb663f02817fb9b83aa618af8973bc5f1fdb9c9db97d1c55f0d4d4a1e633bbb14ab43b4fc1a001449d5021a00029075a0f5f6"}]}},6912:function(e,t,n){n.d(t,{Z:function(){return ConnectButton}});var a=n(85893),s=n(67294),l=n(9663),o=n(51731),r=n(53617),i=n(23225),d=n(96544),c=n(27361),u=n.n(c),f=n(78299);let g={address:"地址",publicKey:"公钥",chainId:"网络"};function ConnectButton(e){let{fetchWallets:t,onConnect:n,onDisconnect:c}=e,{settings:x}=(0,f.r)(),p=(0,s.useRef)(null),m=(0,s.useRef)(!1),[h,b]=(0,s.useState)([]),{setProvider:v,setAccount:j,provider:y,account:w}=(0,i.O)(),C=(0,s.useCallback)(async e=>{try{let{provider:t,...a}=await n(e);v(t),j(a)}catch(e){console.log("connectWallet error",e),(0,d.Am)({title:"连接失败",description:u()(e,"message","")})}},[n,j,v]),N=(0,s.useCallback)(async()=>{m.current=!1,await (null==c?void 0:c()),v(null),j(null)},[c,j,v]),k=(0,s.useCallback)(()=>{setTimeout(()=>{try{var e;null===(e=p.current)||void 0===e||e.click()}catch(e){}},150)},[]),E=(0,s.useCallback)(async e=>{let n=await (null==t?void 0:t());if((null==n?void 0:n.length)===0){k();return}let{directConnection:a}=null!=e?e:{directConnection:!1};(null==n?void 0:n.length)===1||(null==n?void 0:n.length)>0&&a?(k(),await C(n[0])):b(n)},[k,C,t]);return(0,s.useEffect)(()=>{let e=setTimeout(async()=>{!m.current&&(console.log("settings.autoConnect",x.autoConnect),x.autoConnect&&(m.current=!0,await E({directConnection:!0})))},500);return()=>{clearTimeout(e)}},[x.autoConnect]),(0,a.jsx)(o.Zb,{children:(0,a.jsxs)(o.aY,{className:"flex flex-col flex-wrap gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-row flex-wrap justify-between",children:[(0,a.jsxs)(r.Vq,{children:[(0,a.jsx)(r.hg,{asChild:!0,children:(0,a.jsx)(l.z,{onClick:()=>E(),children:"Connect Wallet"})}),(0,a.jsxs)(r.cZ,{children:[(0,a.jsx)(r.GG,{ref:p}),(0,a.jsxs)(r.fK,{children:[(0,a.jsx)(r.$N,{children:"选择钱包开始连接"}),!!h&&h.map(e=>{var t;return(0,a.jsx)(r.GG,{asChild:!0,children:(0,a.jsxs)(l.z,{onClick:()=>C(e),className:"gap-2",children:[e.logo&&(0,a.jsx)("img",{alt:e.name,src:e.logo,className:"w-5 h-5 rounded-full"}),(0,a.jsx)("span",{className:"font-medium",children:e.name}),null===(t=e.tags)||void 0===t?void 0:t.map(e=>(0,a.jsx)("span",{className:"text-xs font-light",children:e},e))]})},e.id)}),!h||0===h.length&&(0,a.jsxs)(r.Be,{children:["没有钱包可用，请安装 OneKey Extension",(0,a.jsx)("a",{target:"_blank",href:"https://www.onekey.so/download/",children:"Install OneKey Extension →"})]})]})]})]}),y&&(0,a.jsx)(l.z,{variant:"destructive",onClick:N,children:"断开链接"})]}),w&&(0,a.jsx)("div",{className:"flex grid-cols-1 xl:grid-cols-2 flex-wrap gap-x-6 gap-y-3 mt-4",children:Object.keys(w).map(e=>{var t;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{children:["".concat(null!==(t=null==g?void 0:g[e])&&void 0!==t?t:e),": "]}),(0,a.jsx)("span",{className:"font-normal flex flex-wrap text-break",children:"".concat(null==w?void 0:w[e])})]},e)})})]})})}},53617:function(e,t,n){n.d(t,{$N:function(){return x},Be:function(){return p},GG:function(){return u},Vq:function(){return i},cZ:function(){return g},fK:function(){return DialogHeader},hg:function(){return d}});var a=n(85893),s=n(67294),l=n(12854),o=n(41352),r=n(13441);let i=l.fC,d=l.xz,c=l.h_,u=l.x8,f=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)(l.aV,{ref:t,className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...s})});f.displayName=l.aV.displayName;let g=s.forwardRef((e,t)=>{let{className:n,children:s,...i}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(f,{}),(0,a.jsxs)(l.VY,{ref:t,className:(0,r.cn)("fixed left-[50%] top-[35%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...i,children:[s,(0,a.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});g.displayName=l.VY.displayName;let DialogHeader=e=>{let{className:t,...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...n})};DialogHeader.displayName="DialogHeader";let x=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)(l.Dx,{ref:t,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight",n),...s})});x.displayName=l.Dx.displayName;let p=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)(l.dk,{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",n),...s})});p.displayName=l.dk.displayName}}]);
//# sourceMappingURL=1491.6a379e22111e42e5.js.map