"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4084],{6793:function(e,n,t){var a=t(85893);t(67294);var l=t(41664),s=t.n(l),r=t(51731);n.Z=e=>{let{dapps:n}=e;return(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.ll,{className:"text-xl",children:"Dapp Bookmarks"}),(0,a.jsx)(r.aY,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.map((e,n)=>(0,a.jsx)("div",{className:"border p-2 rounded-lg shadow-sm hover:shadow-md",children:(0,a.jsx)(s(),{href:e.url,legacyBehavior:!0,children:(0,a.jsxs)("a",{className:"text-blue-500 hover:underline text-lg block",children:[e.name," →"]})})},n))})]})}},24084:function(e,n,t){t.r(n),t.d(n,{default:function(){return Example}});var a=t(85893);let l=[{name:"OpenSea",url:"https://opensea.io/"}];var s=t(6912),r=t(67294),i=t(27361),o=t.n(i),c=t(99710),d=t(23225),u=t(6793),p={signEvent:[{id:"signEvent",name:"signEvent",value:JSON.stringify({created_at:17e8,kind:1,content:"OneKey \uD83D\uDE80",tags:[]})}],signSchnorr:[{id:"signSchnorr-32HexString",name:"32 位 Hex String",value:"2118c65161c7d68b4bdbe1374f658532670057ab1bb0c99937d0ff7cff45cb5e"},{id:"signSchnorr",name:"Hex String - 硬件报错符合预期",value:"010203"}],nip04encrypt:[{id:"nip04encrypt",name:"nip04encrypt",value:"010203"}]},f=t(24992),x=t.n(f),g=t(96544),m=t(48764).Buffer;function Example(){let e=(0,r.useRef)([{uuid:"injected",name:"Injected Wallet",inject:"nostr"},{uuid:"injected-onekey",name:"Injected OneKey",inject:"$onekey.nostr"}]),{provider:n,setAccount:t,account:i}=(0,d.O)(),onConnectWallet=async n=>{var t;let a=null===(t=e.current)||void 0===t?void 0:t.find(e=>e.uuid===n.id);if(!a)return Promise.reject("Wallet not found");let l=o()(window,a.inject);if(!l){(0,g.Am)({title:"Wallet not found",description:"Please install the wallet extension"});return}let s=await (null==l?void 0:l.getPublicKey());return{provider:l,address:"",publicKey:s}};return(0,r.useEffect)(()=>{let accountsChangedHandler=e=>{console.log("nostr [accountsChanged]",e),e.length&&t({...i,address:e})},connectHandler=e=>{console.log("nostr connect",e)},disconnectHandler=e=>{console.log("nostr disconnect",e)};return null==n||n.on("accountsChanged",accountsChangedHandler),null==n||n.on("connect",connectHandler),null==n||n.on("disconnect",disconnectHandler),()=>{null==n||n.removeListener("accountsChanged",accountsChangedHandler),null==n||n.removeListener("connect",connectHandler),null==n||n.removeListener("disconnect",disconnectHandler)}},[i,n,t]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{fetchWallets:()=>Promise.resolve(e.current.map(e=>({id:e.uuid,name:e.name}))),onConnect:onConnectWallet}),(0,a.jsxs)(c.s,{title:"Basics",children:[(0,a.jsx)(c.u,{title:"getPublicKey",description:"获取账户权限",onExecute:async e=>{let t=await (null==n?void 0:n.getPublicKey());return JSON.stringify(t)}}),(0,a.jsx)(c.u,{title:"signEvent",description:"signEvent",presupposeParams:p.signEvent,onExecute:async e=>{let t=JSON.parse(e),a=await (null==n?void 0:n.signEvent(t));return JSON.stringify(a)}}),(0,a.jsx)(c.u,{title:"getRelays",description:"getRelays",disableRequestContent:!0,onExecute:async e=>{let t=await (null==n?void 0:n.getRelays());return JSON.stringify(t)}}),(0,a.jsx)(c.u,{title:"signSchnorr",description:"signSchnorr",presupposeParams:p.signSchnorr,onExecute:async e=>{let t=await (null==n?void 0:n.signSchnorr(e));return t},onValidate:(e,n)=>{let t=m.from(e,"hex"),a=m.from(null==i?void 0:i.publicKey,"hex"),l=m.from(n,"hex"),s=x().verify(t,l,a);return Promise.resolve(s.toString())}}),(0,a.jsx)(c.u,{title:"nip04.encrypt and nip04.decrypt",description:"nip04.encrypt",presupposeParams:p.nip04encrypt,onExecute:async e=>{let t=null==i?void 0:i.publicKey,a=await n.nip04.encrypt(t,e),l=await n.nip04.decrypt(t,a);return JSON.stringify(l)}}),(0,a.jsx)(c.u,{title:"nip04.encrypt ",description:"nip04.encrypt",presupposeParams:p.nip04encrypt,onExecute:async e=>{let t=null==i?void 0:i.publicKey,a=await n.nip04.encrypt(t,e);return JSON.stringify(a)}})]}),(0,a.jsx)(u.Z,{dapps:l})]})}},6912:function(e,n,t){t.d(n,{Z:function(){return ConnectButton}});var a=t(85893),l=t(67294),s=t(9663),r=t(51731),i=t(53617),o=t(23225),c=t(96544),d=t(27361),u=t.n(d),p=t(78299);let f={address:"地址",publicKey:"公钥",chainId:"网络"};function ConnectButton(e){let{fetchWallets:n,onConnect:t,onDisconnect:d}=e,{settings:x}=(0,p.r)(),g=(0,l.useRef)(null),m=(0,l.useRef)(!1),[h,y]=(0,l.useState)([]),{setProvider:v,setAccount:j,provider:b,account:N}=(0,o.O)(),w=(0,l.useCallback)(async e=>{try{let{provider:n,...a}=await t(e);v(n),j(a)}catch(e){console.log("connectWallet error",e),(0,c.Am)({title:"连接失败",description:u()(e,"message","")})}},[t,j,v]),C=(0,l.useCallback)(async()=>{m.current=!1,await (null==d?void 0:d()),v(null),j(null)},[d,j,v]),k=(0,l.useCallback)(()=>{setTimeout(()=>{try{var e;null===(e=g.current)||void 0===e||e.click()}catch(e){}},150)},[]),E=(0,l.useCallback)(async e=>{let t=await (null==n?void 0:n());if((null==t?void 0:t.length)===0){k();return}let{directConnection:a}=null!=e?e:{directConnection:!1};(null==t?void 0:t.length)===1||(null==t?void 0:t.length)>0&&a?(k(),await w(t[0])):y(t)},[k,w,n]);return(0,l.useEffect)(()=>{let e=setTimeout(async()=>{!m.current&&(console.log("settings.autoConnect",x.autoConnect),x.autoConnect&&(m.current=!0,await E({directConnection:!0})))},500);return()=>{clearTimeout(e)}},[x.autoConnect]),(0,a.jsx)(r.Zb,{children:(0,a.jsxs)(r.aY,{className:"flex flex-col flex-wrap gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-row flex-wrap justify-between",children:[(0,a.jsxs)(i.Vq,{children:[(0,a.jsx)(i.hg,{asChild:!0,children:(0,a.jsx)(s.z,{onClick:()=>E(),children:"Connect Wallet"})}),(0,a.jsxs)(i.cZ,{children:[(0,a.jsx)(i.GG,{ref:g}),(0,a.jsxs)(i.fK,{children:[(0,a.jsx)(i.$N,{children:"选择钱包开始连接"}),!!h&&h.map(e=>{var n;return(0,a.jsx)(i.GG,{asChild:!0,children:(0,a.jsxs)(s.z,{onClick:()=>w(e),className:"gap-2",children:[e.logo&&(0,a.jsx)("img",{alt:e.name,src:e.logo,className:"w-5 h-5 rounded-full"}),(0,a.jsx)("span",{className:"font-medium",children:e.name}),null===(n=e.tags)||void 0===n?void 0:n.map(e=>(0,a.jsx)("span",{className:"text-xs font-light",children:e},e))]})},e.id)}),!h||0===h.length&&(0,a.jsxs)(i.Be,{children:["没有钱包可用，请安装 OneKey Extension",(0,a.jsx)("a",{target:"_blank",href:"https://www.onekey.so/download/",children:"Install OneKey Extension →"})]})]})]})]}),b&&(0,a.jsx)(s.z,{variant:"destructive",onClick:C,children:"断开链接"})]}),N&&(0,a.jsx)("div",{className:"flex grid-cols-1 xl:grid-cols-2 flex-wrap gap-x-6 gap-y-3 mt-4",children:Object.keys(N).map(e=>{var n;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{children:["".concat(null!==(n=null==f?void 0:f[e])&&void 0!==n?n:e),": "]}),(0,a.jsx)("span",{className:"font-normal flex flex-wrap text-break",children:"".concat(null==N?void 0:N[e])})]},e)})})]})})}},53617:function(e,n,t){t.d(n,{$N:function(){return x},Be:function(){return g},GG:function(){return u},Vq:function(){return o},cZ:function(){return f},fK:function(){return DialogHeader},hg:function(){return c}});var a=t(85893),l=t(67294),s=t(12854),r=t(41352),i=t(13441);let o=s.fC,c=s.xz,d=s.h_,u=s.x8,p=l.forwardRef((e,n)=>{let{className:t,...l}=e;return(0,a.jsx)(s.aV,{ref:n,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l})});p.displayName=s.aV.displayName;let f=l.forwardRef((e,n)=>{let{className:t,children:l,...o}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(p,{}),(0,a.jsxs)(s.VY,{ref:n,className:(0,i.cn)("fixed left-[50%] top-[35%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o,children:[l,(0,a.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(r.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=s.VY.displayName;let DialogHeader=e=>{let{className:n,...t}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",n),...t})};DialogHeader.displayName="DialogHeader";let x=l.forwardRef((e,n)=>{let{className:t,...l}=e;return(0,a.jsx)(s.Dx,{ref:n,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",t),...l})});x.displayName=s.Dx.displayName;let g=l.forwardRef((e,n)=>{let{className:t,...l}=e;return(0,a.jsx)(s.dk,{ref:n,className:(0,i.cn)("text-sm text-muted-foreground",t),...l})});g.displayName=s.dk.displayName}}]);
//# sourceMappingURL=4084.ef606c09d4c93603.js.map