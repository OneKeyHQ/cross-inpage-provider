(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5513],{6793:function(e,n,t){"use strict";var a=t(85893);t(67294);var s=t(41664),r=t.n(s),i=t(51731);n.Z=e=>{let{dapps:n}=e;return(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.ll,{className:"text-xl",children:"Dapp Bookmarks"}),(0,a.jsx)(i.aY,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.map((e,n)=>(0,a.jsx)("div",{className:"border p-2 rounded-lg shadow-sm hover:shadow-md",children:(0,a.jsx)(r(),{href:e.url,legacyBehavior:!0,children:(0,a.jsxs)("a",{className:"text-blue-500 hover:underline text-lg block",children:[e.name," →"]})})},n))})]})}},51587:function(e,n,t){"use strict";t.d(n,{Fb:function(){return hasVersionedTx},QM:function(){return createVersionedTransaction},QS:function(){return createTransferTransaction},UP:function(){return createVersionedLegacyTransaction},aN:function(){return createTokenTransferTransaction}});var a=t(59917),s=t(45423),r=t(72655);let createTransferTransaction=(e,n,t,s)=>{let r=new a.nh(n),i=new a.YW().add(a.yc.transfer({fromPubkey:e,toPubkey:r,lamports:s}));return i.feePayer=e,i.recentBlockhash=t,i},hasVersionedTx=e=>"version"in e,createVersionedLegacyTransaction=(e,n,t,s)=>{let r=new a.nh(n),i=[a.yc.createAccount({fromPubkey:e,newAccountPubkey:r,lamports:s,space:0,programId:a.yc.programId}),a.yc.transfer({fromPubkey:e,toPubkey:r,lamports:s})],o=new a.$Z({payerKey:e,recentBlockhash:t,instructions:i}).compileToLegacyMessage(),l=new a.GS(o);return l},createVersionedTransaction=(e,n,t,s)=>{let r=new a.nh(n),i=[a.yc.transfer({fromPubkey:e,toPubkey:r,lamports:s})],o=new a.$Z({payerKey:e,recentBlockhash:t,instructions:i}).compileToV0Message(),l=new a.GS(o);return l},createTokenTransferTransaction=async(e,n,t,i,o,l,c)=>{let u=new a.YW,d=await (0,s.Am)(i,n),f=await (0,s.Am)(i,t);return u.add((0,r.$B)(d,f,n,BigInt(l*Math.pow(10,c)))),u.feePayer=n,u.recentBlockhash=o,u}},78782:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Example}});var a=t(85893);let s=[{name:"Magic Eden",url:"https://magiceden.io/"},{name:"Jupiter",url:"https://jup.ag"},{name:"Mean Finance",url:"https://app.meanfi.com/"},{name:"Saber",url:"https://app.saber.so/"},{name:"ORCA",url:"https://www.orca.so/"},{name:"Rarible",url:"https://rarible.com/connect"},{name:"Raydium",url:"https://raydium.io/swap/"},{name:"官方测试",url:"https://r3byv.csb.app/"}];var r=t(6912),i=t(67294),o=t(26815),l=t(99710),c=t(23225),u=t(6793),d=t(59917),f=t(72269),g=t(51587),m=t(50780),h=t.n(m),p=t(96544),y=t(76894),x=t(70252),v=t(48764).Buffer;function Example(){let e=(0,i.useRef)([{uuid:"injected",name:"Injected Wallet",inject:"solana"},{uuid:"injected-onekey",name:"Injected OneKey",inject:"$onekey.solana"},{uuid:"injected-phantom",name:"Injected Phantom",inject:"phantom.solana"}]),{provider:n,setAccount:t,account:m}=(0,c.O)(),w=(0,i.useMemo)(()=>new d.ew("https://go.getblock.io/".concat((0,x.P)("DEwWFkUCHktXRF8YWw1QCQQcEgQWTE1QDlgKRRVDRw8="))),[]),onConnectWallet=async n=>{var t;let a=null===(t=e.current)||void 0===t?void 0:t.find(e=>e.uuid===n.id);if(!a)return Promise.reject("Wallet not found");let s=(0,o.Z)(window,a.inject);if(!s){(0,p.Am)({title:"Wallet not found",description:"Please install the wallet extension"});return}let{publicKey:r}=await (null==s?void 0:s.connect());return{provider:s,publicKey:r.toBase58()}},onDisconnectWallet=async()=>{await (null==n?void 0:n.disconnect())};return(0,i.useEffect)(()=>{if(!n)return;let onConnectListener=e=>{console.log("solana [connect] ".concat(e.toBase58())),t({...m,publicKey:e.toBase58()})},onDisconnectListener=()=>{console.log("solana [disconnect] \uD83D\uDC4B")},onAccountChangeListener=e=>{e?(console.log("solana [accountChanged] Switched account to ".concat(null==e?void 0:e.toBase58())),t({...m,publicKey:e.toBase58()})):console.log("solana [accountChanged] Switched unknown account")};return n.on("connect",onConnectListener),n.on("disconnect",onDisconnectListener),n.on("accountChanged",onAccountChangeListener),()=>{n.removeListener("connect",onConnectListener),n.removeListener("disconnect",onDisconnectListener),n.removeListener("accountChanged",onAccountChangeListener)}},[m,n,t]),console.log("createTokenTransferTransaction exists:",typeof g.aN),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Z,{fetchWallets:()=>Promise.resolve(e.current.map(e=>({id:e.uuid,name:e.name}))),onConnect:onConnectWallet,onDisconnect:onDisconnectWallet}),(0,a.jsx)(l.s,{title:"Basics",children:(0,a.jsx)(l.u,{title:"connect",description:"连接钱包并获取公钥",disableRequestContent:!0,onExecute:async e=>{let t=await (null==n?void 0:n.connect());return JSON.stringify(t)}})}),(0,a.jsxs)(l.s,{title:"Sign Message",children:[(0,a.jsx)(l.u,{title:"signMessage",description:"签名消息(存在风险，硬件无法使用)",presupposeParams:f.Z.signMessage,onExecute:async e=>await (null==n?void 0:n.signMessage(v.from(e,"utf8"))),onValidate:(e,n)=>{let t;let{signature:a,publicKey:s}=JSON.parse(n);t=Array.isArray(a)?new Uint8Array(a):new Uint8Array(a.data);let r=new d.nh(s),i=h().sign.detached.verify(v.from(e,"utf8"),t,r.toBytes());return Promise.resolve(i.toString())}}),(0,a.jsx)(l.u,{title:"solSignOffchainMessage",description:"签名消息(OneKey 私有方法)",presupposeParams:f.Z.signMessage,onExecute:async e=>await (null==n?void 0:n.solSignOffchainMessage(v.from(e,"utf8"))),onValidate:(e,n)=>{let t;let{signature:a,publicKey:s}=JSON.parse(n);t=Array.isArray(a)?new Uint8Array(a):new Uint8Array(a.data);let r=new d.nh(s),i=new y.D({message:v.from(e,"utf8")}),o=h().sign.detached.verify(i.serialize(),t,r.toBytes());return Promise.resolve(o.toString())}})]}),(0,a.jsxs)(l.s,{title:"Transfer",children:[(0,a.jsx)(l.u,{title:"signAndSendTransaction",description:"签署并发送交易",presupposeParams:f.Z.signAndSendTransaction(null==m?void 0:m.publicKey),onExecute:async e=>{let{toPubkey:t,amount:a}=JSON.parse(e),s=(await w.getLatestBlockhash()).blockhash,r=(0,g.QS)(new d.nh(null==m?void 0:m.publicKey),t,s,a),i=await (null==n?void 0:n.signAndSendTransaction(r));return JSON.stringify(i)}}),(0,a.jsx)(l.u,{title:"signTransaction",description:"签署交易",presupposeParams:f.Z.signAndSendTransaction(null==m?void 0:m.publicKey),onExecute:async e=>{let{toPubkey:t,amount:a}=JSON.parse(e),s=(await w.getLatestBlockhash()).blockhash,r=(0,g.QS)(new d.nh(null==m?void 0:m.publicKey),t,s,a),i=await (null==n?void 0:n.signTransaction(r));return(0,g.Fb)(i)?"error: Tx is Versioned Transaction":v.from(i.serialize()).toString("hex")},onValidate:async(e,n)=>{let t=d.YW.from(v.from(n,"hex")),a=t.verifySignatures(),s=await w.simulateTransaction(t);return{success:null===s.value.err,verified:a,tryRun:s,tx:t}}}),(0,a.jsx)(l.u,{title:"signTransaction (Versioned)",description:"签署 Versioned 交易",presupposeParams:f.Z.signAndSendTransaction(null==m?void 0:m.publicKey),onExecute:async e=>{let{toPubkey:t,amount:a}=JSON.parse(e),s=(await w.getLatestBlockhash()).blockhash,r=(0,g.QM)(new d.nh(null==m?void 0:m.publicKey),t,s,a),i=await (null==n?void 0:n.signTransaction(r));return(0,g.Fb)(i)?v.from(i.serialize()).toString("hex"):"error: Tx is legacy Transaction"},onValidate:async(e,n)=>{let t=d.GS.deserialize(v.from(n,"hex")),a=await w.simulateTransaction(t);return{success:null===a.value.err,tryRun:a,tx:t}}}),(0,a.jsx)(l.u,{title:"signTransaction (Versioned legacy)",description:"签署 Versioned legacy 交易, legacy 旧版本交易，但是返回值是 Versioned 的 Tx",presupposeParams:f.Z.signAndSendTransaction(null==m?void 0:m.publicKey),onExecute:async e=>{let{toPubkey:t,amount:a}=JSON.parse(e),s=(await w.getLatestBlockhash()).blockhash,r=(0,g.UP)(new d.nh(null==m?void 0:m.publicKey),t,s,a);console.log("transfer",r);let i=await (null==n?void 0:n.signTransaction(r));return(console.log("res",i),(0,g.Fb)(i))?v.from(i.serialize()).toString("hex"):"error:Tx is legacy Transaction"}}),(0,a.jsx)(l.u,{title:"signAllTransactions",description:"签署多个交易",presupposeParams:f.Z.signMultipleTransaction(null==m?void 0:m.publicKey),onExecute:async e=>{let t=JSON.parse(e),a=(await w.getLatestBlockhash()).blockhash,s=t.map(e=>(0,g.QS)(new d.nh(null==m?void 0:m.publicKey),e.toPubkey,a,e.amount)),r=await (null==n?void 0:n.signAllTransactions(s));return r.map(e=>v.from(e.serialize()).toString("hex"))},onValidate:async(e,n)=>{let t=JSON.parse(n),a=t.map(e=>d.YW.from(v.from(e,"hex"))),s=[];for(let e of a){let n=e.verifySignatures(),t=await w.simulateTransaction(e);s.push({success:null===t.value.err,verified:n,tryRun:t})}return s}}),(0,a.jsx)(l.u,{title:"transferToken",description:"代币转账",presupposeParams:f.Z.signAndSendTokenTransaction(null==m?void 0:m.publicKey),onExecute:async e=>{let{tokenMint:t,toPubkey:a,amount:s,decimals:r}=JSON.parse(e),i=(await w.getLatestBlockhash()).blockhash,o=await (0,g.aN)(w,new d.nh(null==m?void 0:m.publicKey),new d.nh(a),new d.nh(t),i,s,r),l=await (null==n?void 0:n.signAndSendTransaction(o));return JSON.stringify(l)}})]}),(0,a.jsx)(u.Z,{dapps:s})]})}(0,d.Wf)("mainnet-beta")},72269:function(e,n){"use strict";let t=[{symbol:"USDT",tokenMint:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",decimals:6},{symbol:"USDC",tokenMint:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",decimals:6}];n.Z={signMessage:[{id:"signMessage",name:"signMessage",value:"Hello OneKey"}],signAndSendTransaction:e=>[{id:"signAndSendTransaction",name:"Normal Transaction",value:JSON.stringify({toPubkey:e,amount:100})}],signAndSendTokenTransaction:e=>t.map(n=>({id:"signAndSendTokenTransaction_".concat(n.symbol),name:"Send ".concat(n.symbol," Token"),value:JSON.stringify({tokenMint:n.tokenMint,toPubkey:e,amount:1e-6,decimals:n.decimals})})),signMultipleTransaction:e=>[{id:"signMultipleTransaction",name:"Sign Multiple Transaction",value:JSON.stringify([{toPubkey:e,amount:100},{toPubkey:e,amount:100}])}],signRawTransaction:[{id:"sign raw tx Transaction",name:"stake io",value:JSON.stringify({message:"78NZKdHqXG3dk1M3BzEuRStNSqZs7R7HpJqDC4XseXJdjvXCyY637Gpod7K2qSccnHkBiNoNLbjtDp5CAXzZNhY35qhfdW6imBpT8UwJJArJukctXz9uGFezAMpmHC8qyeUKeeW9DL9UpVLPrjRcq8UXxv4NaoGLsTenuziN76voXyd5Lo44EsLysFNBGELtHKzGXGznAhmabQnqnBJn64HadjRfZvjprcNiy6nbcrvjQQEZnDEXZ4WunuR7zfCZZPk1TUW2KFDymfyLYcY44cJvYi9L5VZdxvG1ifHRrxXefagfwAjL5a1wTRConmZTcVx5ayZ2SYDGxVdkrGDqLaFonGHxrzJmk1gs1mrLjqiQvQn79EQdxyvZyUDgUEMzV18yjm6nya57VXQfvei93zPDesRQTYs3yQzD1aYSjy2up3cgFNhRPt9vYZFHNBFnd9v1kPzffGbyMeNbeK8M3TPBbCxP6NEgzxmDsihB2s9bajKb3tpgaVUKQQrJiK8c5AvXWcewVFfSWBk6R7whTunRfUVXotR4d9VRfCoYgVUFZoUpSHGh111kKd4aygt4q9vh2MzoNkyoPJU32WtA899rXZ1baNKrkoeLmS7FxaSBa6jJLr1F3BHMLCnzWvPG2EE3y1afpjwkKz7Hf59rfSQFMghkHYc9DJPkbLiE4DcZiBf4q1gAva32ZZaSBruzFwLMjkm5roBx7CsmQ5tFnBtcYrF5eTke9TNNRxSLeZwU6ht1yMBsScKogN9Kmgq5uXFyAQ8BXnero7UaV7CYxeYjzeCSvsv3R"})}]}},76894:function(e,n,t){"use strict";t.d(n,{D:function(){return OffchainMessage}});var a=t(48764).Buffer;let OffchainMessage=class OffchainMessage{static guessMessageFormat(e){if("[object Uint8Array]"===Object.prototype.toString.call(e)){if(e.length<=1212){if(OffchainMessage.isPrintableASCII(e))return 0;if(OffchainMessage.isUTF8(e))return 1}else if(e.length<=65515&&OffchainMessage.isUTF8(e))return 2}}static isPrintableASCII(e){return e&&e.every(e=>e>=32&&e<=126)}static isUTF8(e){return e&&function(e){let n=e.length,t=0;for(;t<n;)if(e[t]<128)++t;else if((224&e[t])==192){if(t+1>=n||(192&e[t+1])!=128||(254&e[t])==192)return!1;t+=2}else if((240&e[t])==224){if(t+2>=n||(192&e[t+1])!=128||(192&e[t+2])!=128||224==e[t]&&(224&e[t+1])==128||237==e[t]&&(224&e[t+1])==160||239==e[t]&&191==e[t+1]&&(254&e[t+2])==190)return!1;t+=3}else{if((248&e[t])!=240||t+3>=n||(192&e[t+1])!=128||(192&e[t+2])!=128||(192&e[t+3])!=128||240==e[t]&&(240&e[t+1])==128||244==e[t]&&e[t+1]>143||e[t]>244)return!1;t+=4}return!0}(e)}isValid(){if(0!==this.version||!this.message)return!1;let e=OffchainMessage.guessMessageFormat(this.message);return null!=e&&e===this.messageFormat}isLedgerSupported(e){return this.isValid()&&(0===this.messageFormat||1===this.messageFormat&&e)}serialize(){if(!this.isValid())throw Error("Invalid OffchainMessage: ".concat(JSON.stringify(this)));let e=a.alloc(4),n=e.writeUInt8(this.version);return n=e.writeUInt8(this.messageFormat,n),n=e.writeUInt16LE(this.message.length,n),a.concat([a.from([255]),a.from("solana offchain"),e,this.message])}constructor(e){if(this.version=0,this.messageFormat=void 0,this.message=void 0,!e)return;e.version&&(this.version=e.version),e.messageFormat&&(this.messageFormat=e.messageFormat),e.message&&(this.message=a.from(e.message),0!==this.version||this.messageFormat||(this.messageFormat=OffchainMessage.guessMessageFormat(this.message)))}}},6912:function(e,n,t){"use strict";t.d(n,{Z:function(){return ConnectButton}});var a=t(85893),s=t(67294),r=t(9663),i=t(51731),o=t(53617),l=t(23225),c=t(96544),u=t(27361),d=t.n(u),f=t(78299);let g={address:"地址",publicKey:"公钥",chainId:"网络"};function ConnectButton(e){let{fetchWallets:n,onConnect:t,onDisconnect:u}=e,{settings:m}=(0,f.r)(),h=(0,s.useRef)(null),p=(0,s.useRef)(!1),[y,x]=(0,s.useState)([]),{setProvider:v,setAccount:w,provider:b,account:k}=(0,l.O)(),j=(0,s.useCallback)(async e=>{try{let{provider:n,...a}=await t(e);v(n),w(a)}catch(e){console.log("connectWallet error",e),(0,c.Am)({title:"连接失败",description:d()(e,"message","")})}},[t,w,v]),T=(0,s.useCallback)(async()=>{p.current=!1,await (null==u?void 0:u()),v(null),w(null)},[u,w,v]),S=(0,s.useCallback)(()=>{setTimeout(()=>{try{var e;null===(e=h.current)||void 0===e||e.click()}catch(e){}},150)},[]),N=(0,s.useCallback)(async e=>{let t=await (null==n?void 0:n());if((null==t?void 0:t.length)===0){S();return}let{directConnection:a}=null!=e?e:{directConnection:!1};(null==t?void 0:t.length)===1||(null==t?void 0:t.length)>0&&a?(S(),await j(t[0])):x(t)},[S,j,n]);return(0,s.useEffect)(()=>{let e=setTimeout(async()=>{!p.current&&(console.log("settings.autoConnect",m.autoConnect),m.autoConnect&&(p.current=!0,await N({directConnection:!0})))},500);return()=>{clearTimeout(e)}},[m.autoConnect]),(0,a.jsx)(i.Zb,{children:(0,a.jsxs)(i.aY,{className:"flex flex-col flex-wrap gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-row flex-wrap justify-between",children:[(0,a.jsxs)(o.Vq,{children:[(0,a.jsx)(o.hg,{asChild:!0,children:(0,a.jsx)(r.z,{onClick:()=>N(),children:"Connect Wallet"})}),(0,a.jsxs)(o.cZ,{children:[(0,a.jsx)(o.GG,{ref:h}),(0,a.jsxs)(o.fK,{children:[(0,a.jsx)(o.$N,{children:"选择钱包开始连接"}),!!y&&y.map(e=>{var n;return(0,a.jsx)(o.GG,{asChild:!0,children:(0,a.jsxs)(r.z,{onClick:()=>j(e),className:"gap-2",children:[e.logo&&(0,a.jsx)("img",{alt:e.name,src:e.logo,className:"w-5 h-5 rounded-full"}),(0,a.jsx)("span",{className:"font-medium",children:e.name}),null===(n=e.tags)||void 0===n?void 0:n.map(e=>(0,a.jsx)("span",{className:"text-xs font-light",children:e},e))]})},e.id)}),!y||0===y.length&&(0,a.jsxs)(o.Be,{children:["没有钱包可用，请安装 OneKey Extension",(0,a.jsx)("a",{target:"_blank",href:"https://www.onekey.so/download/",children:"Install OneKey Extension →"})]})]})]})]}),b&&(0,a.jsx)(r.z,{variant:"destructive",onClick:T,children:"断开链接"})]}),k&&(0,a.jsx)("div",{className:"flex grid-cols-1 xl:grid-cols-2 flex-wrap gap-x-6 gap-y-3 mt-4",children:Object.keys(k).map(e=>{var n;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{children:["".concat(null!==(n=null==g?void 0:g[e])&&void 0!==n?n:e),": "]}),(0,a.jsx)("span",{className:"font-normal flex flex-wrap text-break",children:"".concat(null==k?void 0:k[e])})]},e)})})]})})}},53617:function(e,n,t){"use strict";t.d(n,{$N:function(){return m},Be:function(){return h},GG:function(){return d},Vq:function(){return l},cZ:function(){return g},fK:function(){return DialogHeader},hg:function(){return c}});var a=t(85893),s=t(67294),r=t(12854),i=t(41352),o=t(13441);let l=r.fC,c=r.xz,u=r.h_,d=r.x8,f=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)(r.aV,{ref:n,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})});f.displayName=r.aV.displayName;let g=s.forwardRef((e,n)=>{let{className:t,children:s,...l}=e;return(0,a.jsxs)(u,{children:[(0,a.jsx)(f,{}),(0,a.jsxs)(r.VY,{ref:n,className:(0,o.cn)("fixed left-[50%] top-[35%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l,children:[s,(0,a.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});g.displayName=r.VY.displayName;let DialogHeader=e=>{let{className:n,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",n),...t})};DialogHeader.displayName="DialogHeader";let m=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)(r.Dx,{ref:n,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});m.displayName=r.Dx.displayName;let h=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)(r.dk,{ref:n,className:(0,o.cn)("text-sm text-muted-foreground",t),...s})});h.displayName=r.dk.displayName},70252:function(e,n,t){"use strict";t.d(n,{P:function(){return function getApiKey(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(n){let n=a.from(e,"base64").toString();return getApiKey(n,!1)}let t="";for(let n=0;n<e.length;n++){let a=e.charCodeAt(n),r=s.charCodeAt(n%s.length);t+=String.fromCharCode(a^r)}return t}}});var a=t(48764).Buffer;let s="https://api.onekeytest.com"},46601:function(){}}]);
//# sourceMappingURL=5513.980728a333c383bf.js.map