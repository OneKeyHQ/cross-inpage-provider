(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7558],{18552:function(e,t,n){var r=n(10852)(n(55639),"DataView");e.exports=r},53818:function(e,t,n){var r=n(10852)(n(55639),"Promise");e.exports=r},58525:function(e,t,n){var r=n(10852)(n(55639),"Set");e.exports=r},70577:function(e,t,n){var r=n(10852)(n(55639),"WeakMap");e.exports=r},9454:function(e,t,n){var r=n(44239),o=n(37005);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},38749:function(e,t,n){var r=n(44239),o=n(41780),s=n(37005),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&o(e.length)&&!!i[r(e)]}},280:function(e,t,n){var r=n(25726),o=n(86916),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}},7518:function(e){e.exports=function(e){return function(t){return e(t)}}},64160:function(e,t,n){var r=n(18552),o=n(57071),s=n(53818),i=n(58525),a=n(70577),u=n(44239),l=n(80346),c="[object Map]",d="[object Promise]",p="[object Set]",f="[object WeakMap]",b="[object DataView]",v=l(r),y=l(o),x=l(s),g=l(i),j=l(a),w=u;(r&&w(new r(new ArrayBuffer(1)))!=b||o&&w(new o)!=c||s&&w(s.resolve())!=d||i&&w(new i)!=p||a&&w(new a)!=f)&&(w=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?l(n):"";if(r)switch(r){case v:return b;case y:return c;case x:return d;case g:return p;case j:return f}return t}),e.exports=w},25726:function(e){var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},86916:function(e,t,n){var r=n(5569)(Object.keys,Object);e.exports=r},31167:function(e,t,n){e=n.nmd(e);var r=n(31957),o=t&&!t.nodeType&&t,s=o&&e&&!e.nodeType&&e,i=s&&s.exports===o&&r.process,a=function(){try{var e=s&&s.require&&s.require("util").types;if(e)return e;return i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=a},5569:function(e){e.exports=function(e,t){return function(n){return e(t(n))}}},35694:function(e,t,n){var r=n(9454),o=n(37005),s=Object.prototype,i=s.hasOwnProperty,a=s.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return o(e)&&i.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},98612:function(e,t,n){var r=n(23560),o=n(41780);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},44144:function(e,t,n){e=n.nmd(e);var r=n(55639),o=n(95062),s=t&&!t.nodeType&&t,i=s&&e&&!e.nodeType&&e,a=i&&i.exports===s?r.Buffer:void 0,u=a?a.isBuffer:void 0;e.exports=u||o},41609:function(e,t,n){var r=n(280),o=n(64160),s=n(35694),i=n(1469),a=n(98612),u=n(44144),l=n(25726),c=n(36719),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||u(e)||c(e)||s(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!r(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},41780:function(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},36719:function(e,t,n){var r=n(38749),o=n(7518),s=n(31167),i=s&&s.isTypedArray,a=i?o(i):r;e.exports=a},95062:function(e){e.exports=function(){return!1}},32574:function(e,t,n){"use strict";n.d(t,{F:function(){return r}});let r=[{name:"Satflow",url:"https://satflow.com/connect"},{name:"UniSat",url:"https://unisat.io/"},{name:"Magiceden",url:"https://magiceden.io/ordinals"}]},77558:function(e,t,n){"use strict";n.a(e,async function(e,r){try{n.r(t),n.d(t,{default:function(){return BTCExample}});var o=n(85893),s=n(32574),i=n(6912),a=n(67294),u=n(27361),l=n.n(u),c=n(41609),d=n.n(c),p=n(99710),f=n(23225),b=n(6793),v=n(92602),y=n(15640),x=n(96544),g=n(40293),j=n(44174),w=n(17656),h=n(57208),m=e([j]);function BTCExample(){var e;let t=(0,a.useRef)([{uuid:"injected",name:"Injected Wallet",inject:"unisat"},{uuid:"injected-onekey",name:"Injected OneKey",inject:"$onekey.btc"}]),{provider:n,setAccount:r,account:u}=(0,f.O)(),onConnectWallet=async e=>{var n;let r=null===(n=t.current)||void 0===n?void 0:n.find(t=>t.uuid===e.id);if(!r)return Promise.reject("Wallet not found");let o=l()(window,r.inject);if(!o){(0,x.Am)({title:"Wallet not found",description:"Please install the wallet extension"});return}let[s]=await (null==o?void 0:o.requestAccounts()),i=await (null==o?void 0:o.getNetwork());return{provider:o,address:s,chainId:i}};return(0,a.useEffect)(()=>{let accountsChangedHandler=e=>{console.log("btc [accountsChanged]",e),e.length&&r({...u,address:e[0]})},networkChangedHandler=e=>{console.log("btc [networkChanged]",e),e&&r({...u,chainId:e})};return null==n||n.on("accountsChanged",accountsChangedHandler),null==n||n.on("networkChanged",networkChangedHandler),()=>{null==n||n.removeListener("accountsChanged",accountsChangedHandler),null==n||n.removeListener("networkChanged",networkChangedHandler)}},[u,n,r]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.Z,{fetchWallets:()=>Promise.resolve(t.current.map(e=>({id:e.uuid,name:e.name}))),onConnect:onConnectWallet}),(0,o.jsxs)(p.s,{title:"Basics",children:[(0,o.jsx)(p.u,{title:"requestAccounts",description:"请求连接 Wallet 获取账户",disableRequestContent:!0,allowCallWithoutProvider:!0,onExecute:async e=>{let t=await (null==n?void 0:n.requestAccounts());return JSON.stringify(t)}}),(0,o.jsx)(p.u,{title:"getAccounts",description:"获取当前账户地址",disableRequestContent:!0,onExecute:async()=>{let e=await (null==n?void 0:n.getAccounts());return JSON.stringify(e)}}),(0,o.jsx)(p.u,{title:"getPublicKey",description:"获取当前账户公钥",disableRequestContent:!0,onExecute:async()=>{let e=await (null==n?void 0:n.getPublicKey());return e}}),(0,o.jsx)(p.u,{title:"getBalance",description:"获取当前账户余额",disableRequestContent:!0,onExecute:async()=>{let e=await (null==n?void 0:n.getBalance());return JSON.stringify(e)}}),(0,o.jsx)(p.u,{title:"getNetwork",description:"获取当前网络",disableRequestContent:!0,onExecute:async()=>{let e=await (null==n?void 0:n.getNetwork());return e}}),(0,o.jsx)(p.u,{title:"switchNetwork",description:"切换当前网络",presupposeParams:v.Z.switchNetwork,onExecute:async e=>{let t=await (null==n?void 0:n.switchNetwork(e));return t}}),(0,o.jsx)(p.u,{title:"getChain",description:"获取当前链",disableRequestContent:!0,onExecute:async()=>{let e=await (null==n?void 0:n.getChain());return e}}),(0,o.jsx)(p.u,{title:"switchChain",description:"切换当前链",presupposeParams:v.Z.switchChain,onExecute:async e=>{let t=await (null==n?void 0:n.switchChain(e));return t}})]}),(0,o.jsx)(p.s,{title:"Sign Message",children:(0,o.jsx)(p.u,{title:"SignMessage",description:"签名消息",presupposeParams:v.Z.signMessage,onExecute:async e=>{let t=JSON.parse(e),r=await (null==n?void 0:n.signMessage(t.msg,t.type));return r},onValidate:async(e,t)=>{let r=JSON.parse(e),o=await (null==n?void 0:n.getPublicKey());return r.type&&"ecdsa"!==r.type?"bip322-simple"===r.type?h.Verifier.verifySignature(u.address,r.msg,t):"Dapp Example: 不支持的类型签字的验证":(0,y.n)(o,r.msg,t)}})}),(0,o.jsxs)(p.s,{title:"Transaction",children:[(0,o.jsx)(p.u,{title:"sendBitcoin",description:"发送交易",presupposeParams:v.Z.sendBitcoin(null!==(e=null==u?void 0:u.address)&&void 0!==e?e:""),onExecute:async e=>{let t=JSON.parse(e),r=await (null==n?void 0:n.sendBitcoin(t.toAddress,t.satoshis));return JSON.stringify(r)}}),(0,o.jsx)(p.u,{title:"pushTx",description:"广播交易",onExecute:async e=>{if(!e||d()(e))throw(0,x.Am)({title:"Error",description:"请填写需要广播的交易信息"}),Error("request is empty");let t=await (null==n?void 0:n.pushTx({rawtx:e}));return JSON.stringify(t)}}),(0,o.jsx)(p.u,{title:"signPsbt",description:"signPsbt",presupposeParams:v.Z.signPsbt,onExecute:async e=>{let{psbtHex:t,options:r}=JSON.parse(e),o=await (null==n?void 0:n.signPsbt(t,r)),s=w.Psbt.fromHex(o);return(null==r?void 0:r.autoFinalized)||s.finalizeAllInputs(),s.toHex()},generateRequestFrom:()=>{var e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.I,{label:"收款地址",type:"text",name:"toAddress",defaultValue:null!==(e=null==u?void 0:u.address)&&void 0!==e?e:""}),(0,o.jsx)(g.I,{label:"转账金额",type:"number",name:"amount",defaultValue:"1000"}),(0,o.jsx)(g.I,{label:"手续费 sat/vB",type:"number",name:"gasPrice",defaultValue:"20"})]})},onGenerateRequest:async e=>{var t,r;let o=e.toAddress,s=parseInt(e.amount),i=parseInt(null!==(t=e.gasPrice)&&void 0!==t?t:"20");if(!o||!s)throw Error("toAddress or amount is required");let a=await (null==n?void 0:n.getNetwork()),l=(0,j.X)(null!==(r=null==u?void 0:u.address)&&void 0!==r?r:"",o,s,i,"livenet"===a?w.networks.bitcoin:w.networks.testnet);return Promise.resolve(l)},onValidate:async(e,t)=>{let r=await (null==n?void 0:n.pushPsbt(t));return JSON.stringify(r)}}),(0,o.jsx)(p.u,{title:"signPsbts",description:"signPsbts、验证流程尝试广播第一个交易",presupposeParams:v.Z.signPsbts,onExecute:async e=>{let{psbtHexs:t,options:r}=JSON.parse(e),o=await (null==n?void 0:n.signPsbts(t,r)),s=[];return o.forEach((e,t)=>{var n;let o=w.Psbt.fromHex(e);(null==r?void 0:null===(n=r[t])||void 0===n?void 0:n.autoFinalized)||o.finalizeAllInputs(),s.push(o.toHex())}),JSON.stringify(s)},generateRequestFrom:()=>{var e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.I,{label:"收款地址",type:"text",name:"toAddress",defaultValue:null!==(e=null==u?void 0:u.address)&&void 0!==e?e:""}),(0,o.jsx)(g.I,{label:"转账金额",type:"number",name:"amount",defaultValue:"1000"}),(0,o.jsx)(g.I,{label:"手续费 sat/vB",type:"number",name:"gasPrice",defaultValue:"20"})]})},onGenerateRequest:async e=>{var t,r;let o=e.toAddress,s=parseInt(e.amount),i=parseInt(null!==(t=e.gasPrice)&&void 0!==t?t:"20");if(!o||!s)throw Error("toAddress or amount is required");let a=await (null==n?void 0:n.getNetwork()),l=await (0,j.X)(null!==(r=null==u?void 0:u.address)&&void 0!==r?r:"",o,s,i,"livenet"===a?w.networks.bitcoin:w.networks.testnet),c=JSON.parse(l);return Promise.resolve(JSON.stringify({psbtHexs:[c.psbtHex],options:[c.options]}))},onValidate:async(e,t)=>{let[r]=JSON.parse(t);return await (null==n?void 0:n.pushPsbt(r))}}),(0,o.jsx)(p.u,{title:"pushPsbt",description:"pushPsbt",onExecute:async e=>{if(!e||d()(e))throw(0,x.Am)({title:"Error",description:"请填写需要广播的交易信息"}),Error("request is empty");let t=await (null==n?void 0:n.pushPsbt(e));return t}})]}),(0,o.jsx)(b.Z,{dapps:s.F})]})}j=(m.then?(await m)():m)[0],r()}catch(e){r(e)}})}}]);
//# sourceMappingURL=7558.4ea3a03cb160ca95.js.map