(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[935],{77235:function(t,e,i){"use strict";var n=i(33497),s=i(94632),o=i(40219);function _interopNamespaceDefault(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,Object.freeze(e)}var a=_interopNamespaceDefault(s),u=_interopNamespaceDefault(o);let c=n.secp256k1.ProjectivePoint,p="Expected Private",y="Expected Point",g="Expected Tweak",m="Expected Signature",b="Expected Extra Data (32 bytes)",S="Expected Scalar",v=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65]),_=new Uint8Array(32),P=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,69,81,35,25,80,183,95,196,64,45,161,114,47,201,186,238]),w=BigInt(1);function cmpBN32(t,e){for(let i=0;i<32;++i)if(t[i]!==e[i])return t[i]<e[i]?-1:1;return 0}function isTweak(t){return!(!(t instanceof Uint8Array)||32!==t.length||cmpBN32(t,v)>=0)}function isSignature(t){return t instanceof Uint8Array&&64===t.length&&0>cmpBN32(t.subarray(0,32),v)&&0>cmpBN32(t.subarray(32,64),v)}function isHash(t){return t instanceof Uint8Array&&32===t.length}function isExtraData(t){return void 0===t||t instanceof Uint8Array&&32===t.length}function normalizeScalar(t){let e;if("bigint"==typeof t)e=t;else if("number"==typeof t&&Number.isSafeInteger(t)&&t>=0)e=BigInt(t);else if("string"==typeof t){if(64!==t.length)throw Error("Expected 32 bytes of private scalar");e=u.hexToNumber(t)}else if(t instanceof Uint8Array){if(32!==t.length)throw Error("Expected 32 bytes of private scalar");e=u.bytesToNumberBE(t)}else throw TypeError("Expected valid private scalar");if(e<0)throw Error("Expected private scalar >= 0");return e}function normalizePrivateKey(t){return n.secp256k1.utils.normPrivateKeyToScalar(t)}function _pointAddScalar(t,e,i){let n=fromHex(t),s=normalizeScalar(e),o=c.BASE.multiplyAndAddUnsafe(n,s,w);if(!o)throw Error("Tweaked point at infinity");return o.toRawBytes(i)}function assumeCompression(t,e){return void 0===t?void 0===e||isPointCompressed(e):!!t}function throwToNull(t){try{return t()}catch(t){return null}}function fromXOnly(t){return n.schnorr.utils.lift_x(u.bytesToNumberBE(t))}function fromHex(t){return 32===t.length?fromXOnly(t):c.fromHex(t)}function _isPoint(t,e){if(32===t.length!==e)return!1;try{if(e)return!!fromXOnly(t);return!!c.fromHex(t)}catch(t){return!1}}function isPoint(t){return _isPoint(t,!1)}function isPointCompressed(t){return _isPoint(t,!1)&&33===t.length}function isPrivate(t){return n.secp256k1.utils.isValidPrivateKey(t)}function isXOnlyPoint(t){return _isPoint(t,!0)}function xOnlyPointFromPoint(t){if(!isPoint(t))throw Error(y);return t.slice(1,33)}function pointFromScalar(t,e){if(!isPrivate(t))throw Error(p);return throwToNull(()=>n.secp256k1.getPublicKey(t,assumeCompression(e)))}e.isPoint=isPoint,e.isPointCompressed=isPointCompressed,e.isPrivate=isPrivate,e.isXOnlyPoint=isXOnlyPoint,e.pointAdd=function(t,e,i){if(!isPoint(t)||!isPoint(e))throw Error(y);return throwToNull(()=>{let n=fromHex(t),s=fromHex(e);return n.equals(s.negate())?null:n.add(s).toRawBytes(assumeCompression(i,t))})},e.pointAddScalar=function(t,e,i){if(!isPoint(t))throw Error(y);if(!isTweak(e))throw Error(g);return throwToNull(()=>_pointAddScalar(t,e,assumeCompression(i,t)))},e.pointCompress=function(t,e){if(!isPoint(t))throw Error(y);return fromHex(t).toRawBytes(assumeCompression(e,t))},e.pointFromScalar=pointFromScalar,e.pointMultiply=function(t,e,i){if(!isPoint(t))throw Error(y);if(!isTweak(e))throw Error(g);return throwToNull(()=>(function(t,e,i){let n=fromHex(t),s="string"==typeof e?e:u.bytesToHex(e),o=u.hexToNumber(s);return n.multiply(o).toRawBytes(i)})(t,e,assumeCompression(i,t)))},e.privateAdd=function(t,e){if(!isPrivate(t))throw Error(p);if(!isTweak(e))throw Error(g);return throwToNull(()=>(function(t,e){let i=normalizePrivateKey(t),s=normalizeScalar(e),o=u.numberToBytesBE(a.mod(i+s,n.secp256k1.CURVE.n),32);return n.secp256k1.utils.isValidPrivateKey(o)?o:null})(t,e))},e.privateNegate=function(t){if(!isPrivate(t))throw Error(p);return function(t){let e=normalizePrivateKey(t),i=u.numberToBytesBE(n.secp256k1.CURVE.n-e,32);return n.secp256k1.utils.isValidPrivateKey(i)?i:null}(t)},e.privateSub=function(t,e){if(!isPrivate(t))throw Error(p);if(!isTweak(e))throw Error(g);return throwToNull(()=>(function(t,e){let i=normalizePrivateKey(t),s=normalizeScalar(e),o=u.numberToBytesBE(a.mod(i-s,n.secp256k1.CURVE.n),32);return n.secp256k1.utils.isValidPrivateKey(o)?o:null})(t,e))},e.recover=function(t,e,i,s){if(!isHash(t))throw Error("Expected Hash");if(!isSignature(e)||0===cmpBN32(e.subarray(0,32),_)||0===cmpBN32(e.subarray(32,64),_))throw Error(m);if(2&i&&!(e instanceof Uint8Array&&64===e.length&&0>cmpBN32(e.subarray(0,32),P)))throw Error("Bad Recovery Id");if(!isXOnlyPoint(e.subarray(0,32)))throw Error(m);let o=n.secp256k1.Signature.fromCompact(e).addRecoveryBit(i),a=o.recoverPublicKey(t);if(!a)throw Error(m);return a.toRawBytes(assumeCompression(s))},e.sign=function(t,e,i){if(!isPrivate(e))throw Error(p);if(!isHash(t))throw Error(S);if(!isExtraData(i))throw Error(b);return n.secp256k1.sign(t,e,{extraEntropy:i}).toCompactRawBytes()},e.signRecoverable=function(t,e,i){if(!isPrivate(e))throw Error(p);if(!isHash(t))throw Error(S);if(!isExtraData(i))throw Error(b);let s=n.secp256k1.sign(t,e,{extraEntropy:i});return{signature:s.toCompactRawBytes(),recoveryId:s.recovery}},e.signSchnorr=function(t,e,i){if(!isPrivate(e))throw Error(p);if(!isHash(t))throw Error(S);if(!isExtraData(i))throw Error(b);return n.schnorr.sign(t,e,i)},e.verify=function(t,e,i,s){if(!isPoint(e))throw Error(y);if(!isSignature(i))throw Error(m);if(!isHash(t))throw Error(S);return n.secp256k1.verify(i,t,e,{lowS:s})},e.verifySchnorr=function(t,e,i){if(!isXOnlyPoint(e))throw Error(y);if(!isSignature(i))throw Error(m);if(!isHash(t))throw Error(S);return n.schnorr.verify(i,t,e)},e.xOnlyPointAddTweak=function(t,e){if(!isXOnlyPoint(t))throw Error(y);if(!isTweak(e))throw Error(g);return throwToNull(()=>{let i=_pointAddScalar(t,e,!0),n=i[0]%2==1?1:0;return{parity:n,xOnlyPubkey:i.slice(1)}})},e.xOnlyPointFromPoint=xOnlyPointFromPoint,e.xOnlyPointFromScalar=function(t){if(!isPrivate(t))throw Error(p);return xOnlyPointFromPoint(pointFromScalar(t))}},79082:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getHash=getHash,e.createCurve=function(t,e){let create=e=>(0,o.weierstrass)({...t,...getHash(e)});return{...create(e),create}};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let n=i(79569),s=i(98089),o=i(96551);function getHash(t){return{hash:t,hmac:(e,...i)=>(0,n.hmac)(t,e,(0,s.concatBytes)(...i)),randomBytes:s.randomBytes}}},81525:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wNAF=function(t,e){return{constTimeNegate,hasPrecomputes:t=>1!==getW(t),unsafeLadder(e,i,n=t.ZERO){let s=e;for(;i>o;)i&a&&(n=n.add(s)),s=s.double(),i>>=a;return n},precomputeWindow(t,i){let{windows:n,windowSize:s}=calcWOpts(i,e),o=[],a=t,u=a;for(let t=0;t<n;t++){u=a,o.push(u);for(let t=1;t<s;t++)u=u.add(a),o.push(u);a=u.double()}return o},wNAF(i,n,s){let{windows:o,windowSize:u}=calcWOpts(i,e),c=t.ZERO,p=t.BASE,y=BigInt(2**i-1),g=2**i,m=BigInt(i);for(let t=0;t<o;t++){let e=t*u,i=Number(s&y);s>>=m,i>u&&(i-=g,s+=a);let o=e+Math.abs(i)-1,b=t%2!=0,S=i<0;0===i?p=p.add(constTimeNegate(b,n[e])):c=c.add(constTimeNegate(S,n[o]))}return{p:c,f:p}},wNAFUnsafe(i,n,s,u=t.ZERO){let{windows:c,windowSize:p}=calcWOpts(i,e),y=BigInt(2**i-1),g=2**i,m=BigInt(i);for(let t=0;t<c;t++){let e=t*p;if(s===o)break;let i=Number(s&y);if(s>>=m,i>p&&(i-=g,s+=a),0===i)continue;let c=n[e+Math.abs(i)-1];i<0&&(c=c.negate()),u=u.add(c)}return u},getPrecomputes(t,e,i){let n=u.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&u.set(e,i(n))),n},wNAFCached(t,e,i){let n=getW(t);return this.wNAF(n,this.getPrecomputes(n,t,i),e)},wNAFCachedUnsafe(t,e,i,n){let s=getW(t);return 1===s?this.unsafeLadder(t,e,n):this.wNAFUnsafe(s,this.getPrecomputes(s,t,i),e,n)},setWindowSize(t,i){validateW(i,e),c.set(t,i),u.delete(t)}}},e.pippenger=function(t,e,i,n){if(validateMSMPoints(i,t),validateMSMScalars(n,e),i.length!==n.length)throw Error("arrays of points and scalars must have equal length");let o=t.ZERO,a=(0,s.bitLen)(BigInt(i.length)),u=a>12?a-3:a>4?a-2:a?2:1,c=(1<<u)-1,p=Array(c+1).fill(o),y=Math.floor((e.BITS-1)/u)*u,g=o;for(let t=y;t>=0;t-=u){p.fill(o);for(let e=0;e<n.length;e++){let s=n[e],o=Number(s>>BigInt(t)&BigInt(c));p[o]=p[o].add(i[e])}let e=o;for(let t=p.length-1,i=o;t>0;t--)i=i.add(p[t]),e=e.add(i);if(g=g.add(e),0!==t)for(let t=0;t<u;t++)g=g.double()}return g},e.precomputeMSMUnsafe=function(t,e,i,n){validateW(n,e.BITS),validateMSMPoints(i,t);let s=t.ZERO,o=2**n-1,a=Math.ceil(e.BITS/n),u=BigInt((1<<n)-1),c=i.map(t=>{let e=[];for(let i=0,n=t;i<o;i++)e.push(n),n=n.add(t);return e});return t=>{if(validateMSMScalars(t,e),t.length>i.length)throw Error("array of scalars must be smaller than array of points");let o=s;for(let e=0;e<a;e++){if(o!==s)for(let t=0;t<n;t++)o=o.double();let i=BigInt(a*n-(e+1)*n);for(let e=0;e<t.length;e++){let n=t[e],s=Number(n>>i&u);s&&(o=o.add(c[e][s-1]))}}return o}},e.validateBasic=function(t){return(0,n.validateField)(t.Fp),(0,s.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,n.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let n=i(94632),s=i(40219),o=BigInt(0),a=BigInt(1);function constTimeNegate(t,e){let i=e.negate();return t?i:e}function validateW(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw Error("invalid window size, expected [1.."+e+"], got W="+t)}function calcWOpts(t,e){validateW(t,e);let i=Math.ceil(e/t)+1,n=2**(t-1);return{windows:i,windowSize:n}}function validateMSMPoints(t,e){if(!Array.isArray(t))throw Error("array expected");t.forEach((t,i)=>{if(!(t instanceof e))throw Error("invalid point at index "+i)})}function validateMSMScalars(t,e){if(!Array.isArray(t))throw Error("array of scalars expected");t.forEach((t,i)=>{if(!e.isValid(t))throw Error("invalid scalar at index "+i)})}let u=new WeakMap,c=new WeakMap;function getW(t){return c.get(t)||1}},15134:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.expand_message_xmd=expand_message_xmd,e.expand_message_xof=expand_message_xof,e.hash_to_field=hash_to_field,e.isogenyMap=function(t,e){let i=e.map(t=>Array.from(t).reverse());return(e,n)=>{let[s,o,a,u]=i.map(i=>i.reduce((i,n)=>t.add(t.mul(i,e),n)));return e=t.div(s,o),n=t.mul(n,t.div(a,u)),{x:e,y:n}}},e.createHasher=function(t,e,i){if("function"!=typeof e)throw Error("mapToCurve() must be defined");return{hashToCurve(n,s){let o=hash_to_field(n,2,{...i,DST:i.DST,...s}),a=t.fromAffine(e(o[0])),u=t.fromAffine(e(o[1])),c=a.add(u).clearCofactor();return c.assertValidity(),c},encodeToCurve(n,s){let o=hash_to_field(n,1,{...i,DST:i.encodeDST,...s}),a=t.fromAffine(e(o[0])).clearCofactor();return a.assertValidity(),a},mapToCurve(i){if(!Array.isArray(i))throw Error("mapToCurve: expected array of bigints");for(let t of i)if("bigint"!=typeof t)throw Error("mapToCurve: expected array of bigints");let n=t.fromAffine(e(i)).clearCofactor();return n.assertValidity(),n}}};let n=i(94632),s=i(40219),o=s.bytesToNumberBE;function i2osp(t,e){if(anum(t),anum(e),t<0||t>=1<<8*e)throw Error("invalid I2OSP input: "+t);let i=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)i[n]=255&t,t>>>=8;return new Uint8Array(i)}function anum(t){if(!Number.isSafeInteger(t))throw Error("number expected")}function expand_message_xmd(t,e,i,n){(0,s.abytes)(t),(0,s.abytes)(e),anum(i),e.length>255&&(e=n((0,s.concatBytes)((0,s.utf8ToBytes)("H2C-OVERSIZE-DST-"),e)));let{outputLen:o,blockLen:a}=n,u=Math.ceil(i/o);if(i>65535||u>255)throw Error("expand_message_xmd: invalid lenInBytes");let c=(0,s.concatBytes)(e,i2osp(e.length,1)),p=i2osp(0,a),y=i2osp(i,2),g=Array(u),m=n((0,s.concatBytes)(p,t,y,i2osp(0,1),c));g[0]=n((0,s.concatBytes)(m,i2osp(1,1),c));for(let t=1;t<=u;t++){let e=[function(t,e){let i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t[n]^e[n];return i}(m,g[t-1]),i2osp(t+1,1),c];g[t]=n((0,s.concatBytes)(...e))}let b=(0,s.concatBytes)(...g);return b.slice(0,i)}function expand_message_xof(t,e,i,n,o){if((0,s.abytes)(t),(0,s.abytes)(e),anum(i),e.length>255&&(e=o.create({dkLen:Math.ceil(2*n/8)}).update((0,s.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(e).digest()),i>65535||e.length>255)throw Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:i}).update(t).update(i2osp(i,2)).update(e).update(i2osp(e.length,1)).digest()}function hash_to_field(t,e,i){let a;(0,s.validateObject)(i,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:u,k:c,m:p,hash:y,expand:g,DST:m}=i;(0,s.abytes)(t),anum(e);let b="string"==typeof m?(0,s.utf8ToBytes)(m):m,S=u.toString(2).length,v=Math.ceil((S+c)/8),_=e*p*v;if("xmd"===g)a=expand_message_xmd(t,b,_,y);else if("xof"===g)a=expand_message_xof(t,b,_,c,y);else if("_internal_pass"===g)a=t;else throw Error('expand must be "xmd" or "xof"');let P=Array(e);for(let t=0;t<e;t++){let e=Array(p);for(let i=0;i<p;i++){let s=v*(i+t*p),c=a.subarray(s,s+v);e[i]=(0,n.mod)(o(c),u)}P[t]=e}return P}},94632:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isNegativeLE=void 0,e.mod=mod,e.pow=pow,e.pow2=function(t,e,i){let n=t;for(;e-- >s;)n*=n,n%=i;return n},e.invert=invert,e.tonelliShanks=tonelliShanks,e.FpSqrt=FpSqrt,e.validateField=function(t){let e=g.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,n.validateObject)(t,e)},e.FpPow=FpPow,e.FpInvertBatch=FpInvertBatch,e.FpDiv=function(t,e,i){return t.mul(e,"bigint"==typeof i?invert(i,t.ORDER):t.inv(i))},e.FpLegendre=FpLegendre,e.FpIsSquare=function(t){let e=FpLegendre(t.ORDER);return i=>{let n=e(t,i);return t.eql(n,t.ZERO)||t.eql(n,t.ONE)}},e.nLength=nLength,e.Field=function(t,e,i=!1,a={}){let u;if(t<=s)throw Error("invalid field: expected ORDER > 0, got "+t);let{nBitLength:c,nByteLength:p}=nLength(t,e);if(p>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let y=Object.freeze({ORDER:t,isLE:i,BITS:c,BYTES:p,MASK:(0,n.bitMask)(c),ZERO:s,ONE:o,create:e=>mod(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("invalid field element: expected bigint, got "+typeof e);return s<=e&&e<t},is0:t=>t===s,isOdd:t=>(t&o)===o,neg:e=>mod(-e,t),eql:(t,e)=>t===e,sqr:e=>mod(e*e,t),add:(e,i)=>mod(e+i,t),sub:(e,i)=>mod(e-i,t),mul:(e,i)=>mod(e*i,t),pow:(t,e)=>FpPow(y,t,e),div:(e,i)=>mod(e*invert(i,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>invert(e,t),sqrt:a.sqrt||(e=>(u||(u=FpSqrt(t)),u(y,e))),invertBatch:t=>FpInvertBatch(y,t),cmov:(t,e,i)=>i?e:t,toBytes:t=>i?(0,n.numberToBytesLE)(t,p):(0,n.numberToBytesBE)(t,p),fromBytes:t=>{if(t.length!==p)throw Error("Field.fromBytes: expected "+p+" bytes, got "+t.length);return i?(0,n.bytesToNumberLE)(t):(0,n.bytesToNumberBE)(t)}});return Object.freeze(y)},e.FpSqrtOdd=function(t,e){if(!t.isOdd)throw Error("Field doesn't have isOdd");let i=t.sqrt(e);return t.isOdd(i)?i:t.neg(i)},e.FpSqrtEven=function(t,e){if(!t.isOdd)throw Error("Field doesn't have isOdd");let i=t.sqrt(e);return t.isOdd(i)?t.neg(i):i},e.hashToPrivateScalar=function(t,e,i=!1){t=(0,n.ensureBytes)("privateHash",t);let s=t.length,a=nLength(e).nByteLength+8;if(a<24||s<a||s>1024)throw Error("hashToPrivateScalar: expected "+a+"-1024 bytes of input, got "+s);let u=i?(0,n.bytesToNumberLE)(t):(0,n.bytesToNumberBE)(t);return mod(u,e-o)+o},e.getFieldBytesLength=getFieldBytesLength,e.getMinHashLength=getMinHashLength,e.mapHashToField=function(t,e,i=!1){let s=t.length,a=getFieldBytesLength(e),u=getMinHashLength(e);if(s<16||s<u||s>1024)throw Error("expected "+u+"-1024 bytes of input, got "+s);let c=i?(0,n.bytesToNumberLE)(t):(0,n.bytesToNumberBE)(t),p=mod(c,e-o)+o;return i?(0,n.numberToBytesLE)(p,a):(0,n.numberToBytesBE)(p,a)};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let n=i(40219),s=BigInt(0),o=BigInt(1),a=BigInt(2),u=BigInt(3),c=BigInt(4),p=BigInt(5),y=BigInt(8);function mod(t,e){let i=t%e;return i>=s?i:e+i}function pow(t,e,i){if(e<s)throw Error("invalid exponent, negatives unsupported");if(i<=s)throw Error("invalid modulus");if(i===o)return s;let n=o;for(;e>s;)e&o&&(n=n*t%i),t=t*t%i,e>>=o;return n}function invert(t,e){if(t===s)throw Error("invert: expected non-zero number");if(e<=s)throw Error("invert: expected positive modulus, got "+e);let i=mod(t,e),n=e,a=s,u=o,c=o,p=s;for(;i!==s;){let t=n/i,e=n%i,s=a-c*t,o=u-p*t;n=i,i=e,a=c,u=p,c=s,p=o}let y=n;if(y!==o)throw Error("invert: does not exist");return mod(a,e)}function tonelliShanks(t){let e,i,n;let u=(t-o)/a;for(e=t-o,i=0;e%a===s;e/=a,i++);for(n=a;n<t&&pow(n,u,t)!==t-o;n++)if(n>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===i){let e=(t+o)/c;return function(t,i){let n=t.pow(i,e);if(!t.eql(t.sqr(n),i))throw Error("Cannot find square root");return n}}let p=(e+o)/a;return function(t,s){if(t.pow(s,u)===t.neg(t.ONE))throw Error("Cannot find square root");let a=i,c=t.pow(t.mul(t.ONE,n),e),y=t.pow(s,p),g=t.pow(s,e);for(;!t.eql(g,t.ONE);){if(t.eql(g,t.ZERO))return t.ZERO;let e=1;for(let i=t.sqr(g);e<a&&!t.eql(i,t.ONE);e++)i=t.sqr(i);let i=t.pow(c,o<<BigInt(a-e-1));c=t.sqr(i),y=t.mul(y,i),g=t.mul(g,c),a=e}return y}}function FpSqrt(t){if(t%c===u){let e=(t+o)/c;return function(t,i){let n=t.pow(i,e);if(!t.eql(t.sqr(n),i))throw Error("Cannot find square root");return n}}if(t%y===p){let e=(t-p)/y;return function(t,i){let n=t.mul(i,a),s=t.pow(n,e),o=t.mul(i,s),u=t.mul(t.mul(o,a),s),c=t.mul(o,t.sub(u,t.ONE));if(!t.eql(t.sqr(c),i))throw Error("Cannot find square root");return c}}return tonelliShanks(t)}e.isNegativeLE=(t,e)=>(mod(t,e)&o)===o;let g=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function FpPow(t,e,i){if(i<s)throw Error("invalid exponent, negatives unsupported");if(i===s)return t.ONE;if(i===o)return e;let n=t.ONE,a=e;for(;i>s;)i&o&&(n=t.mul(n,a)),a=t.sqr(a),i>>=o;return n}function FpInvertBatch(t,e){let i=Array(e.length),n=e.reduce((e,n,s)=>t.is0(n)?e:(i[s]=e,t.mul(e,n)),t.ONE),s=t.inv(n);return e.reduceRight((e,n,s)=>t.is0(n)?e:(i[s]=t.mul(e,i[s]),t.mul(e,n)),s),i}function FpLegendre(t){let e=(t-o)/a;return(t,i)=>t.pow(i,e)}function nLength(t,e){let i=void 0!==e?e:t.toString(2).length;return{nBitLength:i,nByteLength:Math.ceil(i/8)}}function getFieldBytesLength(t){if("bigint"!=typeof t)throw Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function getMinHashLength(t){let e=getFieldBytesLength(t);return e+Math.ceil(e/2)}},40219:function(t,e){"use strict";/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.notImplemented=e.bitMask=void 0,e.isBytes=isBytes,e.abytes=abytes,e.abool=function(t,e){if("boolean"!=typeof e)throw Error(t+" boolean expected, got "+e)},e.bytesToHex=bytesToHex,e.numberToHexUnpadded=numberToHexUnpadded,e.hexToNumber=hexToNumber,e.hexToBytes=hexToBytes,e.bytesToNumberBE=function(t){return hexToNumber(bytesToHex(t))},e.bytesToNumberLE=function(t){return abytes(t),hexToNumber(bytesToHex(Uint8Array.from(t).reverse()))},e.numberToBytesBE=numberToBytesBE,e.numberToBytesLE=function(t,e){return numberToBytesBE(t,e).reverse()},e.numberToVarBytesBE=function(t){return hexToBytes(numberToHexUnpadded(t))},e.ensureBytes=function(t,e,i){let n;if("string"==typeof e)try{n=hexToBytes(e)}catch(e){throw Error(t+" must be hex string or Uint8Array, cause: "+e)}else if(isBytes(e))n=Uint8Array.from(e);else throw Error(t+" must be hex string or Uint8Array");let s=n.length;if("number"==typeof i&&s!==i)throw Error(t+" of length "+i+" expected, got "+s);return n},e.concatBytes=concatBytes,e.equalBytes=function(t,e){if(t.length!==e.length)return!1;let i=0;for(let n=0;n<t.length;n++)i|=t[n]^e[n];return 0===i},e.utf8ToBytes=function(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(t))},e.inRange=inRange,e.aInRange=function(t,e,i,n){if(!inRange(e,i,n))throw Error("expected valid "+t+": "+i+" <= n < "+n+", got "+e)},e.bitLen=function(t){let e;for(e=0;t>i;t>>=n,e+=1);return e},e.bitGet=function(t,e){return t>>BigInt(e)&n},e.bitSet=function(t,e,s){return t|(s?n:i)<<BigInt(e)},e.createHmacDrbg=function(t,e,i){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof i)throw Error("hmacFn must be a function");let n=u8n(t),s=u8n(t),o=0,reset=()=>{n.fill(1),s.fill(0),o=0},h=(...t)=>i(s,n,...t),reseed=(t=u8n())=>{s=h(u8fr([0]),t),n=h(),0!==t.length&&(s=h(u8fr([1]),t),n=h())},gen=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let t=0,i=[];for(;t<e;){n=h();let e=n.slice();i.push(e),t+=n.length}return concatBytes(...i)};return(t,e)=>{let i;for(reset(),reseed(t);!(i=e(gen()));)reseed();return reset(),i}},e.validateObject=function(t,e,i={}){let checkField=(e,i,n)=>{let s=u[i];if("function"!=typeof s)throw Error("invalid validator function");let o=t[e];if((!n||void 0!==o)&&!s(o,t))throw Error("param "+String(e)+" is invalid. Expected "+i+", got "+o)};for(let[t,i]of Object.entries(e))checkField(t,i,!1);for(let[t,e]of Object.entries(i))checkField(t,e,!0);return t},e.memoized=function(t){let e=new WeakMap;return(i,...n)=>{let s=e.get(i);if(void 0!==s)return s;let o=t(i,...n);return e.set(i,o),o}};let i=BigInt(0),n=BigInt(1),s=BigInt(2);function isBytes(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function abytes(t){if(!isBytes(t))throw Error("Uint8Array expected")}let o=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function bytesToHex(t){abytes(t);let e="";for(let i=0;i<t.length;i++)e+=o[t[i]];return e}function numberToHexUnpadded(t){let e=t.toString(16);return 1&e.length?"0"+e:e}function hexToNumber(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return""===t?i:BigInt("0x"+t)}let a={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(t){return t>=a._0&&t<=a._9?t-a._0:t>=a.A&&t<=a.F?t-(a.A-10):t>=a.a&&t<=a.f?t-(a.a-10):void 0}function hexToBytes(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,i=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(i);for(let e=0,s=0;e<i;e++,s+=2){let i=asciiToBase16(t.charCodeAt(s)),o=asciiToBase16(t.charCodeAt(s+1));if(void 0===i||void 0===o){let e=t[s]+t[s+1];throw Error('hex string expected, got non-hex character "'+e+'" at index '+s)}n[e]=16*i+o}return n}function numberToBytesBE(t,e){return hexToBytes(t.toString(16).padStart(2*e,"0"))}function concatBytes(...t){let e=0;for(let i=0;i<t.length;i++){let n=t[i];abytes(n),e+=n.length}let i=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let s=t[e];i.set(s,n),n+=s.length}return i}let isPosBig=t=>"bigint"==typeof t&&i<=t;function inRange(t,e,i){return isPosBig(t)&&isPosBig(e)&&isPosBig(i)&&e<=t&&t<i}e.bitMask=t=>(s<<BigInt(t-1))-n;let u8n=t=>new Uint8Array(t),u8fr=t=>Uint8Array.from(t),u={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||isBytes(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};e.notImplemented=()=>{throw Error("not implemented")}},96551:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DER=e.DERErr=void 0,e.weierstrassPoints=weierstrassPoints,e.weierstrass=function(t){let i=function(t){let e=(0,n.validateBasic)(t);return o.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:u,n:c}=i,g=u.BYTES+1,m=2*u.BYTES+1;function modN(t){return(0,s.mod)(t,c)}function invN(t){return(0,s.invert)(t,c)}let{ProjectivePoint:b,normPrivateKeyToScalar:S,weierstrassEquation:v,isWithinCurveOrder:_}=weierstrassPoints({...i,toBytes(t,e,i){let n=e.toAffine(),s=u.toBytes(n.x),c=o.concatBytes;return((0,a.abool)("isCompressed",i),i)?c(Uint8Array.from([e.hasEvenY()?2:3]),s):c(Uint8Array.from([4]),s,u.toBytes(n.y))},fromBytes(t){let e=t.length,i=t[0],n=t.subarray(1);if(e===g&&(2===i||3===i)){let t;let e=o.bytesToNumberBE(n);if(!o.inRange(e,y,u.ORDER))throw Error("Point is not on curve");let s=v(e);try{t=u.sqrt(s)}catch(e){let t=e instanceof Error?": "+e.message:"";throw Error("Point is not on curve"+t)}let a=(t&y)===y;return(1&i)==1!==a&&(t=u.neg(t)),{x:e,y:t}}if(e===m&&4===i){let t=u.fromBytes(n.subarray(0,u.BYTES)),e=u.fromBytes(n.subarray(u.BYTES,2*u.BYTES));return{x:t,y:e}}throw Error("invalid Point, expected length of "+g+", or uncompressed "+m+", got "+e)}}),numToNByteStr=t=>o.bytesToHex(o.numberToBytesBE(t,i.nByteLength));function isBiggerThanHalfOrder(t){let e=c>>y;return t>e}let slcNum=(t,e,i)=>o.bytesToNumberBE(t.slice(e,i));let Signature=class Signature{constructor(t,e,i){this.r=t,this.s=e,this.recovery=i,this.assertValidity()}static fromCompact(t){let e=i.nByteLength;return t=(0,a.ensureBytes)("compactSignature",t,2*e),new Signature(slcNum(t,0,e),slcNum(t,e,2*e))}static fromDER(t){let{r:i,s:n}=e.DER.toSig((0,a.ensureBytes)("DER",t));return new Signature(i,n)}assertValidity(){o.aInRange("r",this.r,y,c),o.aInRange("s",this.s,y,c)}addRecoveryBit(t){return new Signature(this.r,this.s,t)}recoverPublicKey(t){let{r:e,s:n,recovery:s}=this,o=w((0,a.ensureBytes)("msgHash",t));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let c=2===s||3===s?e+i.n:e;if(c>=u.ORDER)throw Error("recovery id 2 or 3 invalid");let p=(1&s)==0?"02":"03",y=b.fromHex(p+numToNByteStr(c)),g=invN(c),m=modN(-o*g),S=modN(n*g),v=b.BASE.multiplyAndAddUnsafe(y,m,S);if(!v)throw Error("point at infinify");return v.assertValidity(),v}hasHighS(){return isBiggerThanHalfOrder(this.s)}normalizeS(){return this.hasHighS()?new Signature(this.r,modN(-this.s),this.recovery):this}toDERRawBytes(){return o.hexToBytes(this.toDERHex())}toDERHex(){return e.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return o.hexToBytes(this.toCompactHex())}toCompactHex(){return numToNByteStr(this.r)+numToNByteStr(this.s)}};function isProbPub(t){let e=o.isBytes(t),i="string"==typeof t,n=(e||i)&&t.length;return e?n===g||n===m:i?n===2*g||n===2*m:t instanceof b}let P=i.bits2int||function(t){if(t.length>8192)throw Error("input is too large");let e=o.bytesToNumberBE(t),n=8*t.length-i.nBitLength;return n>0?e>>BigInt(n):e},w=i.bits2int_modN||function(t){return modN(P(t))},E=o.bitMask(i.nBitLength);function int2octets(t){return o.aInRange("num < 2^"+i.nBitLength,t,p,E),o.numberToBytesBE(t,i.nByteLength)}let I={lowS:i.lowS,prehash:!1},T={lowS:i.lowS,prehash:!1};return b.BASE._setWindowSize(8),{CURVE:i,getPublicKey:function(t,e=!0){return b.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,i=!0){if(isProbPub(t))throw Error("first arg must be private key");if(!isProbPub(e))throw Error("second arg must be public key");let n=b.fromHex(e);return n.multiply(S(t)).toRawBytes(i)},sign:function(t,e,n=I){let{seed:s,k2sig:c}=function(t,e,n=I){if(["recovered","canonical"].some(t=>t in n))throw Error("sign() legacy options not supported");let{hash:s,randomBytes:c}=i,{lowS:g,prehash:m,extraEntropy:v}=n;null==g&&(g=!0),t=(0,a.ensureBytes)("msgHash",t),validateSigVerOpts(n),m&&(t=(0,a.ensureBytes)("prehashed msgHash",s(t)));let E=w(t),T=S(e),k=[int2octets(T),int2octets(E)];if(null!=v&&!1!==v){let t=!0===v?c(u.BYTES):v;k.push((0,a.ensureBytes)("extraEntropy",t))}let A=o.concatBytes(...k);return{seed:A,k2sig:function(t){let e=P(t);if(!_(e))return;let i=invN(e),n=b.BASE.multiply(e).toAffine(),s=modN(n.x);if(s===p)return;let o=modN(i*modN(E+s*T));if(o===p)return;let a=(n.x===s?0:2)|Number(n.y&y),u=o;return g&&isBiggerThanHalfOrder(o)&&(u=isBiggerThanHalfOrder(o)?modN(-o):o,a^=1),new Signature(s,u,a)}}}(t,e,n),g=o.createHmacDrbg(i.hash.outputLen,i.nByteLength,i.hmac);return g(s,c)},verify:function(t,n,s,u=T){let c,p;n=(0,a.ensureBytes)("msgHash",n),s=(0,a.ensureBytes)("publicKey",s);let{lowS:y,prehash:g,format:m}=u;if(validateSigVerOpts(u),"strict"in u)throw Error("options.strict was renamed to lowS");if(void 0!==m&&"compact"!==m&&"der"!==m)throw Error("format must be compact or der");let S="string"==typeof t||o.isBytes(t),v=!S&&!m&&"object"==typeof t&&null!==t&&"bigint"==typeof t.r&&"bigint"==typeof t.s;if(!S&&!v)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(v&&(p=new Signature(t.r,t.s)),S){try{"compact"!==m&&(p=Signature.fromDER(t))}catch(t){if(!(t instanceof e.DER.Err))throw t}p||"der"===m||(p=Signature.fromCompact(t))}c=b.fromHex(s)}catch(t){return!1}if(!p||y&&p.hasHighS())return!1;g&&(n=i.hash(n));let{r:_,s:P}=p,E=w(n),I=invN(P),k=modN(E*I),A=modN(_*I),O=b.BASE.multiplyAndAddUnsafe(c,k,A)?.toAffine();if(!O)return!1;let B=modN(O.x);return B===_},ProjectivePoint:b,Signature,utils:{isValidPrivateKey(t){try{return S(t),!0}catch(t){return!1}},normPrivateKeyToScalar:S,randomPrivateKey:()=>{let t=(0,s.getMinHashLength)(i.n);return(0,s.mapHashToField)(i.randomBytes(t),i.n)},precompute:(t=8,e=b.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}},e.SWUFpSqrtRatio=SWUFpSqrtRatio,e.mapToCurveSimpleSWU=function(t,e){if((0,s.validateField)(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let i=SWUFpSqrtRatio(t,e.Z);if(!t.isOdd)throw Error("Fp.isOdd is not implemented!");return n=>{let s,o,a,u,c,p,y,g;s=t.sqr(n),s=t.mul(s,e.Z),o=t.sqr(s),o=t.add(o,s),a=t.add(o,t.ONE),a=t.mul(a,e.B),u=t.cmov(e.Z,t.neg(o),!t.eql(o,t.ZERO)),u=t.mul(u,e.A),o=t.sqr(a),p=t.sqr(u),c=t.mul(p,e.A),o=t.add(o,c),o=t.mul(o,a),p=t.mul(p,u),c=t.mul(p,e.B),o=t.add(o,c),y=t.mul(s,a);let{isValid:m,value:b}=i(o,p);g=t.mul(s,n),g=t.mul(g,b),y=t.cmov(y,a,m),g=t.cmov(g,b,m);let S=t.isOdd(n)===t.isOdd(g);return g=t.cmov(t.neg(g),g,S),{x:y=t.div(y,u),y:g}}};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let n=i(81525),s=i(94632),o=i(40219),a=i(40219);function validateSigVerOpts(t){void 0!==t.lowS&&(0,a.abool)("lowS",t.lowS),void 0!==t.prehash&&(0,a.abool)("prehash",t.prehash)}let{bytesToNumberBE:u,hexToBytes:c}=o;let DERErr=class DERErr extends Error{constructor(t=""){super(t)}};e.DERErr=DERErr,e.DER={Err:DERErr,_tlv:{encode:(t,i)=>{let{Err:n}=e.DER;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(1&i.length)throw new n("tlv.encode: unpadded data");let s=i.length/2,a=o.numberToHexUnpadded(s);if(a.length/2&128)throw new n("tlv.encode: long form length too big");let u=s>127?o.numberToHexUnpadded(a.length/2|128):"",c=o.numberToHexUnpadded(t);return c+u+a+i},decode(t,i){let{Err:n}=e.DER,s=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(i.length<2||i[s++]!==t)throw new n("tlv.decode: wrong tlv");let o=i[s++],a=!!(128&o),u=0;if(a){let t=127&o;if(!t)throw new n("tlv.decode(long): indefinite length not supported");if(t>4)throw new n("tlv.decode(long): byte length is too big");let e=i.subarray(s,s+t);if(e.length!==t)throw new n("tlv.decode: length bytes not complete");if(0===e[0])throw new n("tlv.decode(long): zero leftmost byte");for(let t of e)u=u<<8|t;if(s+=t,u<128)throw new n("tlv.decode(long): not minimal encoding")}else u=o;let c=i.subarray(s,s+u);if(c.length!==u)throw new n("tlv.decode: wrong value length");return{v:c,l:i.subarray(s+u)}}},_int:{encode(t){let{Err:i}=e.DER;if(t<p)throw new i("integer: negative integers are not allowed");let n=o.numberToHexUnpadded(t);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new i("unexpected DER parsing assertion: unpadded hex");return n},decode(t){let{Err:i}=e.DER;if(128&t[0])throw new i("invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new i("invalid signature integer: unnecessary leading zero");return u(t)}},toSig(t){let{Err:i,_int:n,_tlv:s}=e.DER,a="string"==typeof t?c(t):t;o.abytes(a);let{v:u,l:p}=s.decode(48,a);if(p.length)throw new i("invalid signature: left bytes after parsing");let{v:y,l:g}=s.decode(2,u),{v:m,l:b}=s.decode(2,g);if(b.length)throw new i("invalid signature: left bytes after parsing");return{r:n.decode(y),s:n.decode(m)}},hexFromSig(t){let{_tlv:i,_int:n}=e.DER,s=i.encode(2,n.encode(t.r)),o=i.encode(2,n.encode(t.s));return i.encode(48,s+o)}};let p=BigInt(0),y=BigInt(1),g=BigInt(2),m=BigInt(3),b=BigInt(4);function weierstrassPoints(t){let e=function(t){let e=(0,n.validateBasic)(t);o.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:i,Fp:s,a}=e;if(i){if(!s.eql(a,s.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof i||"bigint"!=typeof i.beta||"function"!=typeof i.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:i}=e,u=(0,s.Field)(e.n,e.nBitLength),c=e.toBytes||((t,e,n)=>{let s=e.toAffine();return o.concatBytes(Uint8Array.from([4]),i.toBytes(s.x),i.toBytes(s.y))}),g=e.fromBytes||(t=>{let e=t.subarray(1),n=i.fromBytes(e.subarray(0,i.BYTES)),s=i.fromBytes(e.subarray(i.BYTES,2*i.BYTES));return{x:n,y:s}});function weierstrassEquation(t){let{a:n,b:s}=e,o=i.sqr(t),a=i.mul(o,t);return i.add(i.add(a,i.mul(t,n)),s)}if(!i.eql(i.sqr(e.Gy),weierstrassEquation(e.Gx)))throw Error("bad generator point: equation left != right");function normPrivateKeyToScalar(t){let i;let{allowedPrivateKeyLengths:n,nByteLength:u,wrapPrivateKey:c,n:p}=e;if(n&&"bigint"!=typeof t){if(o.isBytes(t)&&(t=o.bytesToHex(t)),"string"!=typeof t||!n.includes(t.length))throw Error("invalid private key");t=t.padStart(2*u,"0")}try{i="bigint"==typeof t?t:o.bytesToNumberBE((0,a.ensureBytes)("private key",t,u))}catch(e){throw Error("invalid private key, expected hex or "+u+" bytes, got "+typeof t)}return c&&(i=(0,s.mod)(i,p)),o.aInRange("private key",i,y,p),i}function assertPrjPoint(t){if(!(t instanceof Point))throw Error("ProjectivePoint expected")}let b=(0,a.memoized)((t,e)=>{let{px:n,py:s,pz:o}=t;if(i.eql(o,i.ONE))return{x:n,y:s};let a=t.is0();null==e&&(e=a?i.ONE:i.inv(o));let u=i.mul(n,e),c=i.mul(s,e),p=i.mul(o,e);if(a)return{x:i.ZERO,y:i.ZERO};if(!i.eql(p,i.ONE))throw Error("invZ was invalid");return{x:u,y:c}}),S=(0,a.memoized)(t=>{if(t.is0()){if(e.allowInfinityPoint&&!i.is0(t.py))return;throw Error("bad point: ZERO")}let{x:n,y:s}=t.toAffine();if(!i.isValid(n)||!i.isValid(s))throw Error("bad point: x or y not FE");let o=i.sqr(s),a=weierstrassEquation(n);if(!i.eql(o,a))throw Error("bad point: equation left != right");if(!t.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});let Point=class Point{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!i.isValid(t))throw Error("x required");if(null==e||!i.isValid(e))throw Error("y required");if(null==n||!i.isValid(n))throw Error("z required");Object.freeze(this)}static fromAffine(t){let{x:e,y:n}=t||{};if(!t||!i.isValid(e)||!i.isValid(n))throw Error("invalid affine point");if(t instanceof Point)throw Error("projective point not allowed");let is0=t=>i.eql(t,i.ZERO);return is0(e)&&is0(n)?Point.ZERO:new Point(e,n,i.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=i.invertBatch(t.map(t=>t.pz));return t.map((t,i)=>t.toAffine(e[i])).map(Point.fromAffine)}static fromHex(t){let e=Point.fromAffine(g((0,a.ensureBytes)("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return Point.BASE.multiply(normPrivateKeyToScalar(t))}static msm(t,e){return(0,n.pippenger)(Point,u,t,e)}_setWindowSize(t){_.setWindowSize(this,t)}assertValidity(){S(this)}hasEvenY(){let{y:t}=this.toAffine();if(i.isOdd)return!i.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){assertPrjPoint(t);let{px:e,py:n,pz:s}=this,{px:o,py:a,pz:u}=t,c=i.eql(i.mul(e,u),i.mul(o,s)),p=i.eql(i.mul(n,u),i.mul(a,s));return c&&p}negate(){return new Point(this.px,i.neg(this.py),this.pz)}double(){let{a:t,b:n}=e,s=i.mul(n,m),{px:o,py:a,pz:u}=this,c=i.ZERO,p=i.ZERO,y=i.ZERO,g=i.mul(o,o),b=i.mul(a,a),S=i.mul(u,u),v=i.mul(o,a);return v=i.add(v,v),y=i.mul(o,u),y=i.add(y,y),c=i.mul(t,y),p=i.mul(s,S),p=i.add(c,p),c=i.sub(b,p),p=i.add(b,p),p=i.mul(c,p),c=i.mul(v,c),y=i.mul(s,y),S=i.mul(t,S),v=i.sub(g,S),v=i.mul(t,v),v=i.add(v,y),y=i.add(g,g),g=i.add(y,g),g=i.add(g,S),g=i.mul(g,v),p=i.add(p,g),S=i.mul(a,u),S=i.add(S,S),g=i.mul(S,v),c=i.sub(c,g),y=i.mul(S,b),y=i.add(y,y),y=i.add(y,y),new Point(c,p,y)}add(t){assertPrjPoint(t);let{px:n,py:s,pz:o}=this,{px:a,py:u,pz:c}=t,p=i.ZERO,y=i.ZERO,g=i.ZERO,b=e.a,S=i.mul(e.b,m),v=i.mul(n,a),_=i.mul(s,u),P=i.mul(o,c),w=i.add(n,s),E=i.add(a,u);w=i.mul(w,E),E=i.add(v,_),w=i.sub(w,E),E=i.add(n,o);let I=i.add(a,c);return E=i.mul(E,I),I=i.add(v,P),E=i.sub(E,I),I=i.add(s,o),p=i.add(u,c),I=i.mul(I,p),p=i.add(_,P),I=i.sub(I,p),g=i.mul(b,E),p=i.mul(S,P),g=i.add(p,g),p=i.sub(_,g),g=i.add(_,g),y=i.mul(p,g),_=i.add(v,v),_=i.add(_,v),P=i.mul(b,P),E=i.mul(S,E),_=i.add(_,P),P=i.sub(v,P),P=i.mul(b,P),E=i.add(E,P),v=i.mul(_,E),y=i.add(y,v),v=i.mul(I,E),p=i.mul(w,p),p=i.sub(p,v),v=i.mul(w,_),g=i.mul(I,g),g=i.add(g,v),new Point(p,y,g)}subtract(t){return this.add(t.negate())}is0(){return this.equals(Point.ZERO)}wNAF(t){return _.wNAFCached(this,t,Point.normalizeZ)}multiplyUnsafe(t){let{endo:n,n:s}=e;o.aInRange("scalar",t,p,s);let a=Point.ZERO;if(t===p)return a;if(this.is0()||t===y)return this;if(!n||_.hasPrecomputes(this))return _.wNAFCachedUnsafe(this,t,Point.normalizeZ);let{k1neg:u,k1:c,k2neg:g,k2:m}=n.splitScalar(t),b=a,S=a,v=this;for(;c>p||m>p;)c&y&&(b=b.add(v)),m&y&&(S=S.add(v)),v=v.double(),c>>=y,m>>=y;return u&&(b=b.negate()),g&&(S=S.negate()),S=new Point(i.mul(S.px,n.beta),S.py,S.pz),b.add(S)}multiply(t){let n,s;let{endo:a,n:u}=e;if(o.aInRange("scalar",t,y,u),a){let{k1neg:e,k1:o,k2neg:u,k2:c}=a.splitScalar(t),{p:p,f:y}=this.wNAF(o),{p:g,f:m}=this.wNAF(c);p=_.constTimeNegate(e,p),g=_.constTimeNegate(u,g),g=new Point(i.mul(g.px,a.beta),g.py,g.pz),n=p.add(g),s=y.add(m)}else{let{p:e,f:i}=this.wNAF(t);n=e,s=i}return Point.normalizeZ([n,s])[0]}multiplyAndAddUnsafe(t,e,i){let n=Point.BASE,mul=(t,e)=>e!==p&&e!==y&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),s=mul(this,e).add(mul(t,i));return s.is0()?void 0:s}toAffine(t){return b(this,t)}isTorsionFree(){let{h:t,isTorsionFree:i}=e;if(t===y)return!0;if(i)return i(Point,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:i}=e;return t===y?this:i?i(Point,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return(0,a.abool)("isCompressed",t),this.assertValidity(),c(Point,this,t)}toHex(t=!0){return(0,a.abool)("isCompressed",t),o.bytesToHex(this.toRawBytes(t))}};Point.BASE=new Point(e.Gx,e.Gy,i.ONE),Point.ZERO=new Point(i.ZERO,i.ONE,i.ZERO);let v=e.nBitLength,_=(0,n.wNAF)(Point,e.endo?Math.ceil(v/2):v);return{CURVE:e,ProjectivePoint:Point,normPrivateKeyToScalar,weierstrassEquation,isWithinCurveOrder:function(t){return o.inRange(t,y,e.n)}}}function SWUFpSqrtRatio(t,e){let i=t.ORDER,n=p;for(let t=i-y;t%g===p;t/=g)n+=y;let s=n,o=g<<s-y-y,a=o*g,u=(i-y)/a,c=(u-y)/g,S=a-y,v=t.pow(e,u),_=t.pow(e,(u+y)/g),sqrtRatio=(e,i)=>{let n=v,a=t.pow(i,S),u=t.sqr(a);u=t.mul(u,i);let p=t.mul(e,u);p=t.pow(p,c),p=t.mul(p,a),a=t.mul(p,i),u=t.mul(p,e);let m=t.mul(u,a);p=t.pow(m,o);let b=t.eql(p,t.ONE);a=t.mul(u,_),p=t.mul(m,n),u=t.cmov(a,u,b),m=t.cmov(p,m,b);for(let e=s;e>y;e--){let i=e-g;i=g<<i-y;let s=t.pow(m,i),o=t.eql(s,t.ONE);a=t.mul(u,n),n=t.mul(n,n),s=t.mul(m,n),u=t.cmov(a,u,o),m=t.cmov(s,m,o)}return{isValid:b,value:u}};if(t.ORDER%b===m){let i=(t.ORDER-m)/b,n=t.sqrt(t.neg(e));sqrtRatio=(e,s)=>{let o=t.sqr(s),a=t.mul(e,s);o=t.mul(o,a);let u=t.pow(o,i);u=t.mul(u,a);let c=t.mul(u,n),p=t.mul(t.sqr(u),s),y=t.eql(p,e),g=t.cmov(c,u,y);return{isValid:y,value:g}}}return sqrtRatio}},33497:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.encodeToCurve=e.hashToCurve=e.schnorr=e.secp256k1=void 0;/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let n=i(23061),s=i(98089),o=i(79082),a=i(15134),u=i(94632),c=i(40219),p=i(96551),y=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),g=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),m=BigInt(1),b=BigInt(2),divNearest=(t,e)=>(t+e/b)/e;function sqrtMod(t){let e=BigInt(3),i=BigInt(6),n=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),p=t*t*t%y,g=p*p*t%y,m=(0,u.pow2)(g,e,y)*g%y,v=(0,u.pow2)(m,e,y)*g%y,_=(0,u.pow2)(v,b,y)*p%y,P=(0,u.pow2)(_,n,y)*_%y,w=(0,u.pow2)(P,s,y)*P%y,E=(0,u.pow2)(w,a,y)*w%y,I=(0,u.pow2)(E,c,y)*E%y,T=(0,u.pow2)(I,a,y)*w%y,k=(0,u.pow2)(T,e,y)*g%y,A=(0,u.pow2)(k,o,y)*P%y,O=(0,u.pow2)(A,i,y)*p%y,B=(0,u.pow2)(O,b,y);if(!S.eql(S.sqr(B),t))throw Error("Cannot find square root");return B}let S=(0,u.Field)(y,void 0,void 0,{sqrt:sqrtMod});e.secp256k1=(0,o.createCurve)({a:BigInt(0),b:BigInt(7),Fp:S,n:g,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-m*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=BigInt("0x100000000000000000000000000000000"),o=divNearest(e*t,g),a=divNearest(-i*t,g),c=(0,u.mod)(t-o*e-a*n,g),p=(0,u.mod)(-o*i-a*e,g),y=c>s,b=p>s;if(y&&(c=g-c),b&&(p=g-p),c>s||p>s)throw Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:y,k1:c,k2neg:b,k2:p}}}},n.sha256);let v=BigInt(0),_={};function taggedHash(t,...e){let i=_[t];if(void 0===i){let e=(0,n.sha256)(Uint8Array.from(t,t=>t.charCodeAt(0)));i=(0,c.concatBytes)(e,e),_[t]=i}return(0,n.sha256)((0,c.concatBytes)(i,...e))}let pointToBytes=t=>t.toRawBytes(!0).slice(1),numTo32b=t=>(0,c.numberToBytesBE)(t,32),modP=t=>(0,u.mod)(t,y),modN=t=>(0,u.mod)(t,g),P=e.secp256k1.ProjectivePoint,GmulAdd=(t,e,i)=>P.BASE.multiplyAndAddUnsafe(t,e,i);function schnorrGetExtPubKey(t){let i=e.secp256k1.utils.normPrivateKeyToScalar(t),n=P.fromPrivateKey(i),s=n.hasEvenY()?i:modN(-i);return{scalar:s,bytes:pointToBytes(n)}}function lift_x(t){(0,c.aInRange)("x",t,m,y);let e=modP(t*t),i=modP(e*t+BigInt(7)),n=sqrtMod(i);n%b!==v&&(n=modP(-n));let s=new P(t,n,m);return s.assertValidity(),s}let w=c.bytesToNumberBE;function challenge(...t){return modN(w(taggedHash("BIP0340/challenge",...t)))}function schnorrVerify(t,e,i){let n=(0,c.ensureBytes)("signature",t,64),s=(0,c.ensureBytes)("message",e),o=(0,c.ensureBytes)("publicKey",i,32);try{let t=lift_x(w(o)),e=w(n.subarray(0,32));if(!(0,c.inRange)(e,m,y))return!1;let i=w(n.subarray(32,64));if(!(0,c.inRange)(i,m,g))return!1;let a=challenge(numTo32b(e),pointToBytes(t),s),u=GmulAdd(t,i,modN(-a));if(!u||!u.hasEvenY()||u.toAffine().x!==e)return!1;return!0}catch(t){return!1}}e.schnorr={getPublicKey:function(t){return schnorrGetExtPubKey(t).bytes},sign:function(t,e,i=(0,s.randomBytes)(32)){let n=(0,c.ensureBytes)("message",t),{bytes:o,scalar:a}=schnorrGetExtPubKey(e),u=(0,c.ensureBytes)("auxRand",i,32),p=numTo32b(a^w(taggedHash("BIP0340/aux",u))),y=taggedHash("BIP0340/nonce",p,o,n),g=modN(w(y));if(g===v)throw Error("sign failed: k is zero");let{bytes:m,scalar:b}=schnorrGetExtPubKey(g),S=challenge(m,o,n),_=new Uint8Array(64);if(_.set(m,0),_.set(numTo32b(modN(b+S*a)),32),!schnorrVerify(_,n,o))throw Error("sign: Invalid signature produced");return _},verify:schnorrVerify,utils:{randomPrivateKey:e.secp256k1.utils.randomPrivateKey,lift_x,pointToBytes,numberToBytesBE:c.numberToBytesBE,bytesToNumberBE:c.bytesToNumberBE,taggedHash,mod:u.mod}};let E=(0,a.isogenyMap)(S,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(t=>BigInt(t)))),I=(0,p.mapToCurveSimpleSWU)(S,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:S.create(BigInt("-11"))}),T=(0,a.createHasher)(e.secp256k1.ProjectivePoint,t=>{let{x:e,y:i}=I(S.create(t[0]));return E(e,i)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:S.ORDER,m:1,k:128,expand:"xmd",hash:n.sha256});e.hashToCurve=T.hashToCurve,e.encodeToCurve=T.encodeToCurve},27320:function(t,e){"use strict";function anumber(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}function abytes(t,...e){if(!(t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error("Uint8Array expected of length "+e+", got length="+t.length)}Object.defineProperty(e,"__esModule",{value:!0}),e.anumber=anumber,e.abytes=abytes,e.ahash=function(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");anumber(t.outputLen),anumber(t.blockLen)},e.aexists=function(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")},e.aoutput=function(t,e){abytes(t);let i=e.outputLen;if(t.length<i)throw Error("digestInto() expects output buffer of length at least "+i)}},75457:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HashMD=void 0,e.setBigUint64=setBigUint64,e.Chi=function(t,e,i){return t&e^~t&i},e.Maj=function(t,e,i){return t&e^t&i^e&i};let n=i(27320),s=i(98089);function setBigUint64(t,e,i,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,i,n);let s=BigInt(32),o=BigInt(4294967295),a=Number(i>>s&o),u=Number(i&o),c=n?4:0,p=n?0:4;t.setUint32(e+c,a,n),t.setUint32(e+p,u,n)}let HashMD=class HashMD extends s.Hash{constructor(t,e,i,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,s.createView)(this.buffer)}update(t){(0,n.aexists)(this);let{view:e,buffer:i,blockLen:o}=this;t=(0,s.toBytes)(t);let a=t.length;for(let n=0;n<a;){let u=Math.min(o-this.pos,a-n);if(u===o){let e=(0,s.createView)(t);for(;o<=a-n;n+=o)this.process(e,n);continue}i.set(t.subarray(n,n+u),this.pos),this.pos+=u,n+=u,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,n.aexists)(this),(0,n.aoutput)(t,this),this.finished=!0;let{buffer:e,view:i,blockLen:o,isLE:a}=this,{pos:u}=this;e[u++]=128,this.buffer.subarray(u).fill(0),this.padOffset>o-u&&(this.process(i,0),u=0);for(let t=u;t<o;t++)e[t]=0;setBigUint64(i,o-8,BigInt(8*this.length),a),this.process(i,0);let c=(0,s.createView)(t),p=this.outputLen;if(p%4)throw Error("_sha2: outputLen should be aligned to 32bit");let y=p/4,g=this.get();if(y>g.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<y;t++)c.setUint32(4*t,g[t],a)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let i=t.slice(0,e);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return t.length=n,t.pos=a,t.finished=s,t.destroyed=o,n%e&&t.buffer.set(i),t}};e.HashMD=HashMD},31945:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},79569:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;let n=i(27320),s=i(98089);let HMAC=class HMAC extends s.Hash{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,n.ahash)(t);let i=(0,s.toBytes)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,a=new Uint8Array(o);a.set(i.length>o?t.create().update(i).digest():i);for(let t=0;t<a.length;t++)a[t]^=54;this.iHash.update(a),this.oHash=t.create();for(let t=0;t<a.length;t++)a[t]^=106;this.oHash.update(a),a.fill(0)}update(t){return(0,n.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,n.aexists)(this),(0,n.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:i,finished:n,destroyed:s,blockLen:o,outputLen:a}=this;return t.finished=n,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};e.HMAC=HMAC,e.hmac=(t,e,i)=>new HMAC(t,e).update(i).digest(),e.hmac.create=(t,e)=>new HMAC(t,e)},70830:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ripemd160=e.RIPEMD160=void 0;let n=i(75457),s=i(98089),o=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),a=new Uint8Array(Array(16).fill(0).map((t,e)=>e)),u=a.map(t=>(9*t+5)%16),c=[a],p=[u];for(let t=0;t<4;t++)for(let e of[c,p])e.push(e[t].map(t=>o[t]));let y=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),g=c.map((t,e)=>t.map(t=>y[e][t])),m=p.map((t,e)=>t.map(t=>y[e][t])),b=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),S=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]);function f(t,e,i,n){return 0===t?e^i^n:1===t?e&i|~e&n:2===t?(e|~i)^n:3===t?e&n|i&~n:e^(i|~n)}let v=new Uint32Array(16);let RIPEMD160=class RIPEMD160 extends n.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:e,h2:i,h3:n,h4:s}=this;return[t,e,i,n,s]}set(t,e,i,n,s){this.h0=0|t,this.h1=0|e,this.h2=0|i,this.h3=0|n,this.h4=0|s}process(t,e){for(let i=0;i<16;i++,e+=4)v[i]=t.getUint32(e,!0);let i=0|this.h0,n=i,o=0|this.h1,a=o,u=0|this.h2,y=u,_=0|this.h3,P=_,w=0|this.h4,E=w;for(let t=0;t<5;t++){let e=4-t,I=b[t],T=S[t],k=c[t],A=p[t],O=g[t],B=m[t];for(let e=0;e<16;e++){let n=(0,s.rotl)(i+f(t,o,u,_)+v[k[e]]+I,O[e])+w|0;i=w,w=_,_=0|(0,s.rotl)(u,10),u=o,o=n}for(let t=0;t<16;t++){let i=(0,s.rotl)(n+f(e,a,y,P)+v[A[t]]+T,B[t])+E|0;n=E,E=P,P=0|(0,s.rotl)(y,10),y=a,a=i}}this.set(this.h1+u+P|0,this.h2+_+E|0,this.h3+w+n|0,this.h4+i+a|0,this.h0+o+y|0)}roundClean(){v.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};e.RIPEMD160=RIPEMD160,e.ripemd160=(0,s.wrapConstructor)(()=>new RIPEMD160)},73963:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha1=e.SHA1=void 0;let n=i(75457),s=i(98089),o=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),a=new Uint32Array(80);let SHA1=class SHA1 extends n.HashMD{constructor(){super(64,20,8,!1),this.A=0|o[0],this.B=0|o[1],this.C=0|o[2],this.D=0|o[3],this.E=0|o[4]}get(){let{A:t,B:e,C:i,D:n,E:s}=this;return[t,e,i,n,s]}set(t,e,i,n,s){this.A=0|t,this.B=0|e,this.C=0|i,this.D=0|n,this.E=0|s}process(t,e){for(let i=0;i<16;i++,e+=4)a[i]=t.getUint32(e,!1);for(let t=16;t<80;t++)a[t]=(0,s.rotl)(a[t-3]^a[t-8]^a[t-14]^a[t-16],1);let{A:i,B:o,C:u,D:c,E:p}=this;for(let t=0;t<80;t++){let e,y;t<20?(e=(0,n.Chi)(o,u,c),y=1518500249):t<40?(e=o^u^c,y=1859775393):t<60?(e=(0,n.Maj)(o,u,c),y=2400959708):(e=o^u^c,y=3395469782);let g=(0,s.rotl)(i,5)+e+p+y+a[t]|0;p=c,c=u,u=(0,s.rotl)(o,30),o=i,i=g}i=i+this.A|0,o=o+this.B|0,u=u+this.C|0,c=c+this.D|0,p=p+this.E|0,this.set(i,o,u,c,p)}roundClean(){a.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}};e.SHA1=SHA1,e.sha1=(0,s.wrapConstructor)(()=>new SHA1)},23061:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=e.SHA256=void 0;let n=i(75457),s=i(98089),o=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),u=new Uint32Array(64);let SHA256=class SHA256 extends n.HashMD{constructor(){super(64,32,8,!1),this.A=0|a[0],this.B=0|a[1],this.C=0|a[2],this.D=0|a[3],this.E=0|a[4],this.F=0|a[5],this.G=0|a[6],this.H=0|a[7]}get(){let{A:t,B:e,C:i,D:n,E:s,F:o,G:a,H:u}=this;return[t,e,i,n,s,o,a,u]}set(t,e,i,n,s,o,a,u){this.A=0|t,this.B=0|e,this.C=0|i,this.D=0|n,this.E=0|s,this.F=0|o,this.G=0|a,this.H=0|u}process(t,e){for(let i=0;i<16;i++,e+=4)u[i]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=u[t-15],i=u[t-2],n=(0,s.rotr)(e,7)^(0,s.rotr)(e,18)^e>>>3,o=(0,s.rotr)(i,17)^(0,s.rotr)(i,19)^i>>>10;u[t]=o+u[t-7]+n+u[t-16]|0}let{A:i,B:a,C:c,D:p,E:y,F:g,G:m,H:b}=this;for(let t=0;t<64;t++){let e=(0,s.rotr)(y,6)^(0,s.rotr)(y,11)^(0,s.rotr)(y,25),S=b+e+(0,n.Chi)(y,g,m)+o[t]+u[t]|0,v=(0,s.rotr)(i,2)^(0,s.rotr)(i,13)^(0,s.rotr)(i,22),_=v+(0,n.Maj)(i,a,c)|0;b=m,m=g,g=y,y=p+S|0,p=c,c=a,a=i,i=S+_|0}i=i+this.A|0,a=a+this.B|0,c=c+this.C|0,p=p+this.D|0,y=y+this.E|0,g=g+this.F|0,m=m+this.G|0,b=b+this.H|0,this.set(i,a,c,p,y,g,m,b)}roundClean(){u.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};e.SHA256=SHA256;let SHA224=class SHA224 extends SHA256{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};e.sha256=(0,s.wrapConstructor)(()=>new SHA256),e.sha224=(0,s.wrapConstructor)(()=>new SHA224)},98089:function(t,e,i){"use strict";/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(e,"__esModule",{value:!0}),e.Hash=e.nextTick=e.byteSwapIfBE=e.isLE=void 0,e.isBytes=function(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name},e.u8=function(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},e.u32=function(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))},e.createView=function(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)},e.rotr=function(t,e){return t<<32-e|t>>>e},e.rotl=function(t,e){return t<<e|t>>>32-e>>>0},e.byteSwap=byteSwap,e.byteSwap32=function(t){for(let e=0;e<t.length;e++)t[e]=byteSwap(t[e])},e.bytesToHex=function(t){(0,s.abytes)(t);let e="";for(let i=0;i<t.length;i++)e+=o[t[i]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,i=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(i);for(let e=0,s=0;e<i;e++,s+=2){let i=asciiToBase16(t.charCodeAt(s)),o=asciiToBase16(t.charCodeAt(s+1));if(void 0===i||void 0===o){let e=t[s]+t[s+1];throw Error('hex string expected, got non-hex character "'+e+'" at index '+s)}n[e]=16*i+o}return n},e.asyncLoop=asyncLoop,e.utf8ToBytes=utf8ToBytes,e.toBytes=toBytes,e.concatBytes=function(...t){let e=0;for(let i=0;i<t.length;i++){let n=t[i];(0,s.abytes)(n),e+=n.length}let i=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let s=t[e];i.set(s,n),n+=s.length}return i},e.checkOpts=function(t,e){if(void 0!==e&&"[object Object]"!==({}).toString.call(e))throw Error("Options should be object or undefined");let i=Object.assign(t,e);return i},e.wrapConstructor=function(t){let hashC=e=>t().update(toBytes(e)).digest(),e=t();return hashC.outputLen=e.outputLen,hashC.blockLen=e.blockLen,hashC.create=()=>t(),hashC},e.wrapConstructorWithOpts=function(t){let hashC=(e,i)=>t(i).update(toBytes(e)).digest(),e=t({});return hashC.outputLen=e.outputLen,hashC.blockLen=e.blockLen,hashC.create=e=>t(e),hashC},e.wrapXOFConstructorWithOpts=function(t){let hashC=(e,i)=>t(i).update(toBytes(e)).digest(),e=t({});return hashC.outputLen=e.outputLen,hashC.blockLen=e.blockLen,hashC.create=e=>t(e),hashC},e.randomBytes=function(t=32){if(n.crypto&&"function"==typeof n.crypto.getRandomValues)return n.crypto.getRandomValues(new Uint8Array(t));if(n.crypto&&"function"==typeof n.crypto.randomBytes)return n.crypto.randomBytes(t);throw Error("crypto.getRandomValues must be defined")};let n=i(31945),s=i(27320);function byteSwap(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],e.byteSwapIfBE=e.isLE?t=>t:t=>byteSwap(t);let o=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0")),a={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(t){return t>=a._0&&t<=a._9?t-a._0:t>=a.A&&t<=a.F?t-(a.A-10):t>=a.a&&t<=a.f?t-(a.a-10):void 0}let nextTick=async()=>{};async function asyncLoop(t,i,n){let s=Date.now();for(let o=0;o<t;o++){n(o);let t=Date.now()-s;t>=0&&t<i||(await (0,e.nextTick)(),s+=t)}}function utf8ToBytes(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function toBytes(t){return"string"==typeof t&&(t=utf8ToBytes(t)),(0,s.abytes)(t),t}e.nextTick=nextTick,e.Hash=class{clone(){return this._cloneInto()}}},15640:function(t,e,i){"use strict";i.d(e,{n:function(){return verifyMessage}});var n=i(69402),s=i.n(n),o=i(48764).Buffer;function verifyMessage(t,e,i){var n=new(s()).Message(e),a=s().crypto.Signature.fromCompact(o.from(i,"base64")),u=n.magicHash(),c=new(s()).crypto.ECDSA;c.hashbuf=u,c.sig=a;var p=c.toPublicKey();return new(s()).PublicKey(Object.assign({},p.toObject(),{compressed:!0})).toString()==t&&s().crypto.ECDSA.verify(u,a,p)}},58162:function(t,e,i){"use strict";var n=i(89509).Buffer;t.exports=function(t){if(t.length>=255)throw TypeError("Alphabet too long");for(var e=new Uint8Array(256),i=0;i<e.length;i++)e[i]=255;for(var s=0;s<t.length;s++){var o=t.charAt(s),a=o.charCodeAt(0);if(255!==e[a])throw TypeError(o+" is ambiguous");e[a]=s}var u=t.length,c=t.charAt(0),p=Math.log(u)/Math.log(256),y=Math.log(256)/Math.log(u);function decodeUnsafe(t){if("string"!=typeof t)throw TypeError("Expected String");if(0===t.length)return n.alloc(0);for(var i=0,s=0,o=0;t[i]===c;)s++,i++;for(var a=(t.length-i)*p+1>>>0,y=new Uint8Array(a);i<t.length;){var g=e[t.charCodeAt(i)];if(255===g)return;for(var m=0,b=a-1;(0!==g||m<o)&&-1!==b;b--,m++)g+=u*y[b]>>>0,y[b]=g%256>>>0,g=g/256>>>0;if(0!==g)throw Error("Non-zero carry");o=m,i++}for(var S=a-o;S!==a&&0===y[S];)S++;var v=n.allocUnsafe(s+(a-S));v.fill(0,0,s);for(var _=s;S!==a;)v[_++]=y[S++];return v}return{encode:function(e){if((Array.isArray(e)||e instanceof Uint8Array)&&(e=n.from(e)),!n.isBuffer(e))throw TypeError("Expected Buffer");if(0===e.length)return"";for(var i=0,s=0,o=0,a=e.length;o!==a&&0===e[o];)o++,i++;for(var p=(a-o)*y+1>>>0,g=new Uint8Array(p);o!==a;){for(var m=e[o],b=0,S=p-1;(0!==m||b<s)&&-1!==S;S--,b++)m+=256*g[S]>>>0,g[S]=m%u>>>0,m=m/u>>>0;if(0!==m)throw Error("Non-zero carry");s=b,o++}for(var v=p-s;v!==p&&0===g[v];)v++;for(var _=c.repeat(i);v<p;++v)_+=t.charAt(g[v]);return _},decodeUnsafe:decodeUnsafe,decode:function(t){var e=decodeUnsafe(t);if(e)return e;throw Error("Non-base"+u+" character")}}}},27715:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bech32m=e.bech32=void 0;let i="qpzry9x8gf2tvdw0s3jn54khce6mua7l",n={};for(let t=0;t<i.length;t++){let e=i.charAt(t);n[e]=t}function polymodStep(t){let e=t>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}function prefixChk(t){let e=1;for(let i=0;i<t.length;++i){let n=t.charCodeAt(i);if(n<33||n>126)return"Invalid prefix ("+t+")";e=polymodStep(e)^n>>5}e=polymodStep(e);for(let i=0;i<t.length;++i){let n=t.charCodeAt(i);e=polymodStep(e)^31&n}return e}function convert(t,e,i,n){let s=0,o=0,a=(1<<i)-1,u=[];for(let n=0;n<t.length;++n)for(s=s<<e|t[n],o+=e;o>=i;)u.push(s>>(o-=i)&a);if(n)o>0&&u.push(s<<i-o&a);else{if(o>=e)return"Excess padding";if(s<<i-o&a)return"Non-zero padding"}return u}function toWords(t){return convert(t,8,5,!0)}function fromWordsUnsafe(t){let e=convert(t,5,8,!1);if(Array.isArray(e))return e}function fromWords(t){let e=convert(t,5,8,!1);if(Array.isArray(e))return e;throw Error(e)}function getLibraryFromEncoding(t){let e;function __decode(t,i){if(i=i||90,t.length<8)return t+" too short";if(t.length>i)return"Exceeds length limit";let s=t.toLowerCase(),o=t.toUpperCase();if(t!==s&&t!==o)return"Mixed-case string "+t;t=s;let a=t.lastIndexOf("1");if(-1===a)return"No separator character for "+t;if(0===a)return"Missing prefix for "+t;let u=t.slice(0,a),c=t.slice(a+1);if(c.length<6)return"Data too short";let p=prefixChk(u);if("string"==typeof p)return p;let y=[];for(let t=0;t<c.length;++t){let e=c.charAt(t),i=n[e];if(void 0===i)return"Unknown character "+e;p=polymodStep(p)^i,t+6>=c.length||y.push(i)}return p!==e?"Invalid checksum for "+t:{prefix:u,words:y}}return e="bech32"===t?1:734539939,{decodeUnsafe:function(t,e){let i=__decode(t,e);if("object"==typeof i)return i},decode:function(t,e){let i=__decode(t,e);if("object"==typeof i)return i;throw Error(i)},encode:function(t,n,s){if(s=s||90,t.length+7+n.length>s)throw TypeError("Exceeds length limit");let o=prefixChk(t=t.toLowerCase());if("string"==typeof o)throw Error(o);let a=t+"1";for(let t=0;t<n.length;++t){let e=n[t];if(e>>5!=0)throw Error("Non 5-bit word");o=polymodStep(o)^e,a+=i.charAt(e)}for(let t=0;t<6;++t)o=polymodStep(o);o^=e;for(let t=0;t<6;++t){let e=o>>(5-t)*5&31;a+=i.charAt(e)}return a},toWords,fromWordsUnsafe,fromWords}}e.bech32=getLibraryFromEncoding("bech32"),e.bech32m=getLibraryFromEncoding("bech32m")},82190:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});let n=i(36574);function keyPusher(t,e,i){return n=>{if(t.has(n))return;let s=i.filter(t=>t.key.toString("hex")===n)[0];e.push(s),t.add(n)}}function getTx(t){return t.globalMap.unsignedTx}function getKeySet(t){let e=new Set;return t.forEach(t=>{let i=t.key.toString("hex");if(e.has(i))throw Error("Combine: KeyValue Map keys should be unique");e.add(i)}),e}e.combine=function(t){let e=t[0],i=n.psbtToKeyVals(e),s=t.slice(1);if(0===s.length)throw Error("Combine: Nothing to combine");let o=getTx(e);if(void 0===o)throw Error("Combine: Self missing transaction");let a=getKeySet(i.globalKeyVals),u=i.inputKeyVals.map(getKeySet),c=i.outputKeyVals.map(getKeySet);for(let t of s){let e=getTx(t);if(void 0===e||!e.toBuffer().equals(o.toBuffer()))throw Error("Combine: One of the Psbts does not have the same transaction.");let s=n.psbtToKeyVals(t),p=getKeySet(s.globalKeyVals);p.forEach(keyPusher(a,i.globalKeyVals,s.globalKeyVals));let y=s.inputKeyVals.map(getKeySet);y.forEach((t,e)=>t.forEach(keyPusher(u[e],i.inputKeyVals[e],s.inputKeyVals[e])));let g=s.outputKeyVals.map(getKeySet);g.forEach((t,e)=>t.forEach(keyPusher(c[e],i.outputKeyVals[e],s.outputKeyVals[e])))}return n.psbtFromKeyVals(o,{globalMapKeyVals:i.globalKeyVals,inputKeyVals:i.inputKeyVals,outputKeyVals:i.outputKeyVals})}},44041:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847),range=t=>[...Array(t).keys()];e.decode=function(t){if(t.key[0]!==s.GlobalTypes.GLOBAL_XPUB)throw Error("Decode Error: could not decode globalXpub with key 0x"+t.key.toString("hex"));if(79!==t.key.length||![2,3].includes(t.key[46]))throw Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+t.key.toString("hex"));if(t.value.length/4%1!=0)throw Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");let e=t.key.slice(1),i={masterFingerprint:t.value.slice(0,4),extendedPubkey:e,path:"m"};for(let e of range(t.value.length/4-1)){let n=t.value.readUInt32LE(4*e+4),s=!!(2147483648&n),o=2147483647&n;i.path+="/"+o.toString(10)+(s?"'":"")}return i},e.encode=function(t){let e=n.from([s.GlobalTypes.GLOBAL_XPUB]),i=n.concat([e,t.extendedPubkey]),o=t.path.split("/"),a=n.allocUnsafe(4*o.length);t.masterFingerprint.copy(a,0);let u=4;return o.slice(1).forEach(t=>{let e="'"===t.slice(-1),i=2147483647&parseInt(e?t.slice(0,-1):t,10);e&&(i+=2147483648),a.writeUInt32LE(i,u),u+=4}),{key:i,value:a}},e.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }",e.check=function(t){let e=t.extendedPubkey,i=t.masterFingerprint,s=t.path;return n.isBuffer(e)&&78===e.length&&[2,3].indexOf(e[45])>-1&&n.isBuffer(i)&&4===i.length&&"string"==typeof s&&!!s.match(/^m(\/\d+'?)*$/)},e.canAddToArray=function(t,e,i){let n=e.extendedPubkey.toString("hex");return!i.has(n)&&(i.add(n),0===t.filter(t=>t.extendedPubkey.equals(e.extendedPubkey)).length)}},74480:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.encode=function(t){return{key:n.from([s.GlobalTypes.UNSIGNED_TX]),value:t.toBuffer()}}},71528:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});let n=i(1847),s=i(44041),o=i(74480),a=i(20859),u=i(8248),c=i(70537),p=i(61511),y=i(65896),g=i(91243),m=i(3530),b=i(49265),S=i(23934),v=i(50602),_=i(82954),P=i(6036),w=i(44799),E=i(99595),I=i(9705),T=i(17196),k=i(29375),A=i(66327),O={unsignedTx:o,globalXpub:s,checkPubkey:E.makeChecker([])};e.globals=O;let B={nonWitnessUtxo:c,partialSig:p,sighashType:g,finalScriptSig:a,finalScriptWitness:u,porCommitment:y,witnessUtxo:_,bip32Derivation:w.makeConverter(n.InputTypes.BIP32_DERIVATION),redeemScript:I.makeConverter(n.InputTypes.REDEEM_SCRIPT),witnessScript:A.makeConverter(n.InputTypes.WITNESS_SCRIPT),checkPubkey:E.makeChecker([n.InputTypes.PARTIAL_SIG,n.InputTypes.BIP32_DERIVATION]),tapKeySig:m,tapScriptSig:v,tapLeafScript:b,tapBip32Derivation:T.makeConverter(n.InputTypes.TAP_BIP32_DERIVATION),tapInternalKey:k.makeConverter(n.InputTypes.TAP_INTERNAL_KEY),tapMerkleRoot:S};e.inputs=B;let N={bip32Derivation:w.makeConverter(n.OutputTypes.BIP32_DERIVATION),redeemScript:I.makeConverter(n.OutputTypes.REDEEM_SCRIPT),witnessScript:A.makeConverter(n.OutputTypes.WITNESS_SCRIPT),checkPubkey:E.makeChecker([n.OutputTypes.BIP32_DERIVATION]),tapBip32Derivation:T.makeConverter(n.OutputTypes.TAP_BIP32_DERIVATION),tapTree:P,tapInternalKey:k.makeConverter(n.OutputTypes.TAP_INTERNAL_KEY)};e.outputs=N},20859:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.decode=function(t){if(t.key[0]!==s.InputTypes.FINAL_SCRIPTSIG)throw Error("Decode Error: could not decode finalScriptSig with key 0x"+t.key.toString("hex"));return t.value},e.encode=function(t){let e=n.from([s.InputTypes.FINAL_SCRIPTSIG]);return{key:e,value:t}},e.expected="Buffer",e.check=function(t){return n.isBuffer(t)},e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.finalScriptSig}},8248:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.decode=function(t){if(t.key[0]!==s.InputTypes.FINAL_SCRIPTWITNESS)throw Error("Decode Error: could not decode finalScriptWitness with key 0x"+t.key.toString("hex"));return t.value},e.encode=function(t){let e=n.from([s.InputTypes.FINAL_SCRIPTWITNESS]);return{key:e,value:t}},e.expected="Buffer",e.check=function(t){return n.isBuffer(t)},e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.finalScriptWitness}},70537:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.decode=function(t){if(t.key[0]!==s.InputTypes.NON_WITNESS_UTXO)throw Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+t.key.toString("hex"));return t.value},e.encode=function(t){return{key:n.from([s.InputTypes.NON_WITNESS_UTXO]),value:t}},e.expected="Buffer",e.check=function(t){return n.isBuffer(t)},e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.nonWitnessUtxo}},61511:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.decode=function(t){if(t.key[0]!==s.InputTypes.PARTIAL_SIG)throw Error("Decode Error: could not decode partialSig with key 0x"+t.key.toString("hex"));if(!(34===t.key.length||66===t.key.length)||![2,3,4].includes(t.key[1]))throw Error("Decode Error: partialSig has invalid pubkey in key 0x"+t.key.toString("hex"));let e=t.key.slice(1);return{pubkey:e,signature:t.value}},e.encode=function(t){let e=n.from([s.InputTypes.PARTIAL_SIG]);return{key:n.concat([e,t.pubkey]),value:t.signature}},e.expected="{ pubkey: Buffer; signature: Buffer; }",e.check=function(t){return n.isBuffer(t.pubkey)&&n.isBuffer(t.signature)&&[33,65].includes(t.pubkey.length)&&[2,3,4].includes(t.pubkey[0])&&function(t){if(!n.isBuffer(t)||t.length<9||48!==t[0]||t.length!==t[1]+3||2!==t[2])return!1;let e=t[3];if(e>33||e<1||2!==t[3+e+1])return!1;let i=t[3+e+2];return!(i>33)&&!(i<1)&&t.length===3+e+2+i+2}(t.signature)},e.canAddToArray=function(t,e,i){let n=e.pubkey.toString("hex");return!i.has(n)&&(i.add(n),0===t.filter(t=>t.pubkey.equals(e.pubkey)).length)}},65896:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.decode=function(t){if(t.key[0]!==s.InputTypes.POR_COMMITMENT)throw Error("Decode Error: could not decode porCommitment with key 0x"+t.key.toString("hex"));return t.value.toString("utf8")},e.encode=function(t){let e=n.from([s.InputTypes.POR_COMMITMENT]);return{key:e,value:n.from(t,"utf8")}},e.expected="string",e.check=function(t){return"string"==typeof t},e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.porCommitment}},91243:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.decode=function(t){if(t.key[0]!==s.InputTypes.SIGHASH_TYPE)throw Error("Decode Error: could not decode sighashType with key 0x"+t.key.toString("hex"));return t.value.readUInt32LE(0)},e.encode=function(t){let e=n.from([s.InputTypes.SIGHASH_TYPE]),i=n.allocUnsafe(4);return i.writeUInt32LE(t,0),{key:e,value:i}},e.expected="number",e.check=function(t){return"number"==typeof t},e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.sighashType}},3530:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);function check(t){return n.isBuffer(t)&&(64===t.length||65===t.length)}e.decode=function(t){if(t.key[0]!==s.InputTypes.TAP_KEY_SIG||1!==t.key.length)throw Error("Decode Error: could not decode tapKeySig with key 0x"+t.key.toString("hex"));if(!check(t.value))throw Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return t.value},e.encode=function(t){let e=n.from([s.InputTypes.TAP_KEY_SIG]);return{key:e,value:t}},e.expected="Buffer",e.check=check,e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.tapKeySig}},49265:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.decode=function(t){if(t.key[0]!==s.InputTypes.TAP_LEAF_SCRIPT)throw Error("Decode Error: could not decode tapLeafScript with key 0x"+t.key.toString("hex"));if((t.key.length-2)%32!=0)throw Error("Decode Error: tapLeafScript has invalid control block in key 0x"+t.key.toString("hex"));let e=t.value[t.value.length-1];if((254&t.key[1])!==e)throw Error("Decode Error: tapLeafScript bad leaf version in key 0x"+t.key.toString("hex"));let i=t.value.slice(0,-1),n=t.key.slice(1);return{controlBlock:n,script:i,leafVersion:e}},e.encode=function(t){let e=n.from([s.InputTypes.TAP_LEAF_SCRIPT]),i=n.from([t.leafVersion]);return{key:n.concat([e,t.controlBlock]),value:n.concat([t.script,i])}},e.expected="{ controlBlock: Buffer; leafVersion: number, script: Buffer; }",e.check=function(t){return n.isBuffer(t.controlBlock)&&(t.controlBlock.length-1)%32==0&&(254&t.controlBlock[0])===t.leafVersion&&n.isBuffer(t.script)},e.canAddToArray=function(t,e,i){let n=e.controlBlock.toString("hex");return!i.has(n)&&(i.add(n),0===t.filter(t=>t.controlBlock.equals(e.controlBlock)).length)}},23934:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);function check(t){return n.isBuffer(t)&&32===t.length}e.decode=function(t){if(t.key[0]!==s.InputTypes.TAP_MERKLE_ROOT||1!==t.key.length)throw Error("Decode Error: could not decode tapMerkleRoot with key 0x"+t.key.toString("hex"));if(!check(t.value))throw Error("Decode Error: tapMerkleRoot not a 32-byte hash");return t.value},e.encode=function(t){let e=n.from([s.InputTypes.TAP_MERKLE_ROOT]);return{key:e,value:t}},e.expected="Buffer",e.check=check,e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.tapMerkleRoot}},50602:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847);e.decode=function(t){if(t.key[0]!==s.InputTypes.TAP_SCRIPT_SIG)throw Error("Decode Error: could not decode tapScriptSig with key 0x"+t.key.toString("hex"));if(65!==t.key.length)throw Error("Decode Error: tapScriptSig has invalid key 0x"+t.key.toString("hex"));if(64!==t.value.length&&65!==t.value.length)throw Error("Decode Error: tapScriptSig has invalid signature in key 0x"+t.key.toString("hex"));let e=t.key.slice(1,33),i=t.key.slice(33);return{pubkey:e,leafHash:i,signature:t.value}},e.encode=function(t){let e=n.from([s.InputTypes.TAP_SCRIPT_SIG]);return{key:n.concat([e,t.pubkey,t.leafHash]),value:t.signature}},e.expected="{ pubkey: Buffer; leafHash: Buffer; signature: Buffer; }",e.check=function(t){return n.isBuffer(t.pubkey)&&n.isBuffer(t.leafHash)&&n.isBuffer(t.signature)&&32===t.pubkey.length&&32===t.leafHash.length&&(64===t.signature.length||65===t.signature.length)},e.canAddToArray=function(t,e,i){let n=e.pubkey.toString("hex")+e.leafHash.toString("hex");return!i.has(n)&&(i.add(n),0===t.filter(t=>t.pubkey.equals(e.pubkey)&&t.leafHash.equals(e.leafHash)).length)}},82954:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847),o=i(19254),a=i(3493);e.decode=function(t){if(t.key[0]!==s.InputTypes.WITNESS_UTXO)throw Error("Decode Error: could not decode witnessUtxo with key 0x"+t.key.toString("hex"));let e=o.readUInt64LE(t.value,0),i=8,n=a.decode(t.value,i);i+=a.encodingLength(n);let u=t.value.slice(i);if(u.length!==n)throw Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:u,value:e}},e.encode=function(t){let{script:e,value:i}=t,u=a.encodingLength(e.length),c=n.allocUnsafe(8+u+e.length);return o.writeUInt64LE(c,i,0),a.encode(e.length,c,8),e.copy(c,8+u),{key:n.from([s.InputTypes.WITNESS_UTXO]),value:c}},e.expected="{ script: Buffer; value: number; }",e.check=function(t){return n.isBuffer(t.script)&&"number"==typeof t.value},e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.witnessUtxo}},6036:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(1847),o=i(3493);e.decode=function(t){if(t.key[0]!==s.OutputTypes.TAP_TREE||1!==t.key.length)throw Error("Decode Error: could not decode tapTree with key 0x"+t.key.toString("hex"));let e=0,i=[];for(;e<t.value.length;){let n=t.value[e++],s=t.value[e++],a=o.decode(t.value,e);e+=o.encodingLength(a),i.push({depth:n,leafVersion:s,script:t.value.slice(e,e+a)}),e+=a}return{leaves:i}},e.encode=function(t){let e=n.from([s.OutputTypes.TAP_TREE]),i=[].concat(...t.leaves.map(t=>[n.of(t.depth,t.leafVersion),o.encode(t.script.length),t.script]));return{key:e,value:n.concat(i)}},e.expected="{ leaves: [{ depth: number; leafVersion: number, script: Buffer; }] }",e.check=function(t){return Array.isArray(t.leaves)&&t.leaves.every(t=>t.depth>=0&&t.depth<=128&&(254&t.leafVersion)===t.leafVersion&&n.isBuffer(t.script))},e.canAdd=function(t,e){return!!t&&!!e&&void 0===t.tapTree}},44799:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let range=t=>[...Array(t).keys()],isValidDERKey=t=>33===t.length&&[2,3].includes(t[0])||65===t.length&&4===t[0];e.makeConverter=function(t,e=isValidDERKey){return{decode:function(i){if(i.key[0]!==t)throw Error("Decode Error: could not decode bip32Derivation with key 0x"+i.key.toString("hex"));let n=i.key.slice(1);if(!e(n))throw Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+i.key.toString("hex"));if(i.value.length/4%1!=0)throw Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");let s={masterFingerprint:i.value.slice(0,4),pubkey:n,path:"m"};for(let t of range(i.value.length/4-1)){let e=i.value.readUInt32LE(4*t+4),n=!!(2147483648&e),o=2147483647&e;s.path+="/"+o.toString(10)+(n?"'":"")}return s},encode:function(e){let i=n.from([t]),s=n.concat([i,e.pubkey]),o=e.path.split("/"),a=n.allocUnsafe(4*o.length);e.masterFingerprint.copy(a,0);let u=4;return o.slice(1).forEach(t=>{let e="'"===t.slice(-1),i=2147483647&parseInt(e?t.slice(0,-1):t,10);e&&(i+=2147483648),a.writeUInt32LE(i,u),u+=4}),{key:s,value:a}},check:function(t){return n.isBuffer(t.pubkey)&&n.isBuffer(t.masterFingerprint)&&"string"==typeof t.path&&e(t.pubkey)&&4===t.masterFingerprint.length},expected:"{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }",canAddToArray:function(t,e,i){let n=e.pubkey.toString("hex");return!i.has(n)&&(i.add(n),0===t.filter(t=>t.pubkey.equals(e.pubkey)).length)}}}},99595:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makeChecker=function(t){return function(e){let i;if(t.includes(e.key[0])&&(!(33===(i=e.key.slice(1)).length||65===i.length)||![2,3,4].includes(i[0])))throw Error("Format Error: invalid pubkey in key 0x"+e.key.toString("hex"));return i}}},9705:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.makeConverter=function(t){return{decode:function(e){if(e.key[0]!==t)throw Error("Decode Error: could not decode redeemScript with key 0x"+e.key.toString("hex"));return e.value},encode:function(e){let i=n.from([t]);return{key:i,value:e}},check:function(t){return n.isBuffer(t)},expected:"Buffer",canAdd:function(t,e){return!!t&&!!e&&void 0===t.redeemScript}}}},17196:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(3493),o=i(44799),isValidBIP340Key=t=>32===t.length;e.makeConverter=function(t){let e=o.makeConverter(t,isValidBIP340Key);return{decode:function(t){let i=s.decode(t.value),n=s.encodingLength(i),o=e.decode({key:t.key,value:t.value.slice(n+32*i)}),a=Array(i);for(let e=0,s=n;e<i;e++,s+=32)a[e]=t.value.slice(s,s+32);return Object.assign({},o,{leafHashes:a})},encode:function(t){let i=e.encode(t),o=s.encodingLength(t.leafHashes.length),a=n.allocUnsafe(o);s.encode(t.leafHashes.length,a);let u=n.concat([a,...t.leafHashes,i.value]);return Object.assign({},i,{value:u})},check:function(t){return Array.isArray(t.leafHashes)&&t.leafHashes.every(t=>n.isBuffer(t)&&32===t.length)&&e.check(t)},expected:"{ masterFingerprint: Buffer; pubkey: Buffer; path: string; leafHashes: Buffer[]; }",canAddToArray:e.canAddToArray}}},29375:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.makeConverter=function(t){return{decode:function(e){if(e.key[0]!==t||1!==e.key.length)throw Error("Decode Error: could not decode tapInternalKey with key 0x"+e.key.toString("hex"));if(32!==e.value.length)throw Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return e.value},encode:function(e){let i=n.from([t]);return{key:i,value:e}},check:function(t){return n.isBuffer(t)&&32===t.length},expected:"Buffer",canAdd:function(t,e){return!!t&&!!e&&void 0===t.tapInternalKey}}}},66327:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.makeConverter=function(t){return{decode:function(e){if(e.key[0]!==t)throw Error("Decode Error: could not decode witnessScript with key 0x"+e.key.toString("hex"));return e.value},encode:function(e){let i=n.from([t]);return{key:i,value:e}},check:function(t){return n.isBuffer(t)},expected:"Buffer",canAdd:function(t,e){return!!t&&!!e&&void 0===t.witnessScript}}}},19254:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(3493);function keyValToBuffer(t){let e=t.key.length,i=t.value.length,o=s.encodingLength(e),a=s.encodingLength(i),u=n.allocUnsafe(o+e+a+i);return s.encode(e,u,0),t.key.copy(u,o),s.encode(i,u,o+e),t.value.copy(u,o+e+a),u}function verifuint(t,e){if("number"!=typeof t)throw Error("cannot write a non-number as a number");if(t<0)throw Error("specified a negative value for writing an unsigned value");if(t>e)throw Error("RangeError: value out of range");if(Math.floor(t)!==t)throw Error("value has a fractional component")}e.range=t=>[...Array(t).keys()],e.reverseBuffer=function(t){if(t.length<1)return t;let e=t.length-1,i=0;for(let n=0;n<t.length/2;n++)i=t[n],t[n]=t[e],t[e]=i,e--;return t},e.keyValsToBuffer=function(t){let e=t.map(keyValToBuffer);return e.push(n.from([0])),n.concat(e)},e.keyValToBuffer=keyValToBuffer,e.readUInt64LE=function(t,e){let i=t.readUInt32LE(e),n=t.readUInt32LE(e+4);return verifuint((n*=4294967296)+i,9007199254740991),n+i},e.writeUInt64LE=function(t,e,i){return verifuint(e,9007199254740991),t.writeInt32LE(-1&e,i),t.writeUInt32LE(Math.floor(e/4294967296),i+4),i+8}},3493:function(t,e,i){"use strict";var n=i(48764).Buffer;function checkUInt53(t){if(t<0||t>9007199254740991||t%1!=0)throw RangeError("value out of range")}function encodingLength(t){return checkUInt53(t),t<253?1:t<=65535?3:t<=4294967295?5:9}Object.defineProperty(e,"__esModule",{value:!0}),e.encode=function encode(t,e,i){if(checkUInt53(t),e||(e=n.allocUnsafe(encodingLength(t))),!n.isBuffer(e))throw TypeError("buffer must be a Buffer instance");return i||(i=0),t<253?(e.writeUInt8(t,i),Object.assign(encode,{bytes:1})):t<=65535?(e.writeUInt8(253,i),e.writeUInt16LE(t,i+1),Object.assign(encode,{bytes:3})):t<=4294967295?(e.writeUInt8(254,i),e.writeUInt32LE(t,i+1),Object.assign(encode,{bytes:5})):(e.writeUInt8(255,i),e.writeUInt32LE(t>>>0,i+1),e.writeUInt32LE(t/4294967296|0,i+5),Object.assign(encode,{bytes:9})),e},e.decode=function decode(t,e){if(!n.isBuffer(t))throw TypeError("buffer must be a Buffer instance");e||(e=0);let i=t.readUInt8(e);if(i<253)return Object.assign(decode,{bytes:1}),i;if(253===i)return Object.assign(decode,{bytes:3}),t.readUInt16LE(e+1);if(254===i)return Object.assign(decode,{bytes:5}),t.readUInt32LE(e+1);{Object.assign(decode,{bytes:9});let i=t.readUInt32LE(e+1),n=t.readUInt32LE(e+5),s=4294967296*n+i;return checkUInt53(s),s}},e.encodingLength=encodingLength},12974:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(71528),o=i(19254),a=i(3493),u=i(1847);function checkKeyBuffer(t,e,i){if(!e.equals(n.from([i])))throw Error(`Format Error: Invalid ${t} key: ${e.toString("hex")}`)}function psbtFromKeyVals(t,{globalMapKeyVals:e,inputKeyVals:i,outputKeyVals:n}){let a={unsignedTx:t},c=0;for(let t of e)switch(t.key[0]){case u.GlobalTypes.UNSIGNED_TX:if(checkKeyBuffer("global",t.key,u.GlobalTypes.UNSIGNED_TX),c>0)throw Error("Format Error: GlobalMap has multiple UNSIGNED_TX");c++;break;case u.GlobalTypes.GLOBAL_XPUB:void 0===a.globalXpub&&(a.globalXpub=[]),a.globalXpub.push(s.globals.globalXpub.decode(t));break;default:a.unknownKeyVals||(a.unknownKeyVals=[]),a.unknownKeyVals.push(t)}let p=i.length,y=n.length,g=[],m=[];for(let t of o.range(p)){let e={};for(let n of i[t])switch(s.inputs.checkPubkey(n),n.key[0]){case u.InputTypes.NON_WITNESS_UTXO:if(checkKeyBuffer("input",n.key,u.InputTypes.NON_WITNESS_UTXO),void 0!==e.nonWitnessUtxo)throw Error("Format Error: Input has multiple NON_WITNESS_UTXO");e.nonWitnessUtxo=s.inputs.nonWitnessUtxo.decode(n);break;case u.InputTypes.WITNESS_UTXO:if(checkKeyBuffer("input",n.key,u.InputTypes.WITNESS_UTXO),void 0!==e.witnessUtxo)throw Error("Format Error: Input has multiple WITNESS_UTXO");e.witnessUtxo=s.inputs.witnessUtxo.decode(n);break;case u.InputTypes.PARTIAL_SIG:void 0===e.partialSig&&(e.partialSig=[]),e.partialSig.push(s.inputs.partialSig.decode(n));break;case u.InputTypes.SIGHASH_TYPE:if(checkKeyBuffer("input",n.key,u.InputTypes.SIGHASH_TYPE),void 0!==e.sighashType)throw Error("Format Error: Input has multiple SIGHASH_TYPE");e.sighashType=s.inputs.sighashType.decode(n);break;case u.InputTypes.REDEEM_SCRIPT:if(checkKeyBuffer("input",n.key,u.InputTypes.REDEEM_SCRIPT),void 0!==e.redeemScript)throw Error("Format Error: Input has multiple REDEEM_SCRIPT");e.redeemScript=s.inputs.redeemScript.decode(n);break;case u.InputTypes.WITNESS_SCRIPT:if(checkKeyBuffer("input",n.key,u.InputTypes.WITNESS_SCRIPT),void 0!==e.witnessScript)throw Error("Format Error: Input has multiple WITNESS_SCRIPT");e.witnessScript=s.inputs.witnessScript.decode(n);break;case u.InputTypes.BIP32_DERIVATION:void 0===e.bip32Derivation&&(e.bip32Derivation=[]),e.bip32Derivation.push(s.inputs.bip32Derivation.decode(n));break;case u.InputTypes.FINAL_SCRIPTSIG:checkKeyBuffer("input",n.key,u.InputTypes.FINAL_SCRIPTSIG),e.finalScriptSig=s.inputs.finalScriptSig.decode(n);break;case u.InputTypes.FINAL_SCRIPTWITNESS:checkKeyBuffer("input",n.key,u.InputTypes.FINAL_SCRIPTWITNESS),e.finalScriptWitness=s.inputs.finalScriptWitness.decode(n);break;case u.InputTypes.POR_COMMITMENT:checkKeyBuffer("input",n.key,u.InputTypes.POR_COMMITMENT),e.porCommitment=s.inputs.porCommitment.decode(n);break;case u.InputTypes.TAP_KEY_SIG:checkKeyBuffer("input",n.key,u.InputTypes.TAP_KEY_SIG),e.tapKeySig=s.inputs.tapKeySig.decode(n);break;case u.InputTypes.TAP_SCRIPT_SIG:void 0===e.tapScriptSig&&(e.tapScriptSig=[]),e.tapScriptSig.push(s.inputs.tapScriptSig.decode(n));break;case u.InputTypes.TAP_LEAF_SCRIPT:void 0===e.tapLeafScript&&(e.tapLeafScript=[]),e.tapLeafScript.push(s.inputs.tapLeafScript.decode(n));break;case u.InputTypes.TAP_BIP32_DERIVATION:void 0===e.tapBip32Derivation&&(e.tapBip32Derivation=[]),e.tapBip32Derivation.push(s.inputs.tapBip32Derivation.decode(n));break;case u.InputTypes.TAP_INTERNAL_KEY:checkKeyBuffer("input",n.key,u.InputTypes.TAP_INTERNAL_KEY),e.tapInternalKey=s.inputs.tapInternalKey.decode(n);break;case u.InputTypes.TAP_MERKLE_ROOT:checkKeyBuffer("input",n.key,u.InputTypes.TAP_MERKLE_ROOT),e.tapMerkleRoot=s.inputs.tapMerkleRoot.decode(n);break;default:e.unknownKeyVals||(e.unknownKeyVals=[]),e.unknownKeyVals.push(n)}g.push(e)}for(let t of o.range(y)){let e={};for(let i of n[t])switch(s.outputs.checkPubkey(i),i.key[0]){case u.OutputTypes.REDEEM_SCRIPT:if(checkKeyBuffer("output",i.key,u.OutputTypes.REDEEM_SCRIPT),void 0!==e.redeemScript)throw Error("Format Error: Output has multiple REDEEM_SCRIPT");e.redeemScript=s.outputs.redeemScript.decode(i);break;case u.OutputTypes.WITNESS_SCRIPT:if(checkKeyBuffer("output",i.key,u.OutputTypes.WITNESS_SCRIPT),void 0!==e.witnessScript)throw Error("Format Error: Output has multiple WITNESS_SCRIPT");e.witnessScript=s.outputs.witnessScript.decode(i);break;case u.OutputTypes.BIP32_DERIVATION:void 0===e.bip32Derivation&&(e.bip32Derivation=[]),e.bip32Derivation.push(s.outputs.bip32Derivation.decode(i));break;case u.OutputTypes.TAP_INTERNAL_KEY:checkKeyBuffer("output",i.key,u.OutputTypes.TAP_INTERNAL_KEY),e.tapInternalKey=s.outputs.tapInternalKey.decode(i);break;case u.OutputTypes.TAP_TREE:checkKeyBuffer("output",i.key,u.OutputTypes.TAP_TREE),e.tapTree=s.outputs.tapTree.decode(i);break;case u.OutputTypes.TAP_BIP32_DERIVATION:void 0===e.tapBip32Derivation&&(e.tapBip32Derivation=[]),e.tapBip32Derivation.push(s.outputs.tapBip32Derivation.decode(i));break;default:e.unknownKeyVals||(e.unknownKeyVals=[]),e.unknownKeyVals.push(i)}m.push(e)}return{globalMap:a,inputs:g,outputs:m}}e.psbtFromBuffer=function(t,e){let i=0;function varSlice(){let e=a.decode(t,i);i+=a.encodingLength(e);let n=t.slice(i,i+e);return i+=e,n}function getKeyValue(){let t=varSlice(),e=varSlice();return{key:t,value:e}}function checkEndOfKeyValPairs(){if(i>=t.length)throw Error("Format Error: Unexpected End of PSBT");let e=0===t.readUInt8(i);return e&&i++,e}if(1886610036!==function(){let e=t.readUInt32BE(i);return i+=4,e}())throw Error("Format Error: Invalid Magic Number");if(255!==function(){let e=t.readUInt8(i);return i+=1,e}())throw Error("Format Error: Magic Number must be followed by 0xff separator");let n=[],s={};for(;!checkEndOfKeyValPairs();){let t=getKeyValue(),e=t.key.toString("hex");if(s[e])throw Error("Format Error: Keys must be unique for global keymap: key "+e);s[e]=1,n.push(t)}let c=n.filter(t=>t.key[0]===u.GlobalTypes.UNSIGNED_TX);if(1!==c.length)throw Error("Format Error: Only one UNSIGNED_TX allowed");let p=e(c[0].value),{inputCount:y,outputCount:g}=p.getInputOutputCounts(),m=[],b=[];for(let t of o.range(y)){let e={},i=[];for(;!checkEndOfKeyValPairs();){let n=getKeyValue(),s=n.key.toString("hex");if(e[s])throw Error("Format Error: Keys must be unique for each input: input index "+t+" key "+s);e[s]=1,i.push(n)}m.push(i)}for(let t of o.range(g)){let e={},i=[];for(;!checkEndOfKeyValPairs();){let n=getKeyValue(),s=n.key.toString("hex");if(e[s])throw Error("Format Error: Keys must be unique for each output: output index "+t+" key "+s);e[s]=1,i.push(n)}b.push(i)}return psbtFromKeyVals(p,{globalMapKeyVals:n,inputKeyVals:m,outputKeyVals:b})},e.checkKeyBuffer=checkKeyBuffer,e.psbtFromKeyVals=psbtFromKeyVals},36574:function(t,e,i){"use strict";function __export(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),__export(i(12974)),__export(i(15312))},15312:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(71528),o=i(19254);e.psbtToBuffer=function({globalMap:t,inputs:e,outputs:i}){let{globalKeyVals:s,inputKeyVals:a,outputKeyVals:u}=psbtToKeyVals({globalMap:t,inputs:e,outputs:i}),c=o.keyValsToBuffer(s),keyValsOrEmptyToBuffer=t=>0===t.length?[n.from([0])]:t.map(o.keyValsToBuffer),p=keyValsOrEmptyToBuffer(a),y=keyValsOrEmptyToBuffer(u),g=n.allocUnsafe(5);return g.writeUIntBE(482972169471,0,5),n.concat([g,c].concat(p,y))};let sortKeyVals=(t,e)=>t.key.compare(e.key);function keyValsFromMap(t,e){let i=new Set,n=Object.entries(t).reduce((t,[n,s])=>{if("unknownKeyVals"===n)return t;let o=e[n];if(void 0===o)return t;let a=(Array.isArray(s)?s:[s]).map(o.encode),u=a.map(t=>t.key.toString("hex"));return u.forEach(t=>{if(i.has(t))throw Error("Serialize Error: Duplicate key: "+t);i.add(t)}),t.concat(a)},[]),s=t.unknownKeyVals?t.unknownKeyVals.filter(t=>!i.has(t.key.toString("hex"))):[];return n.concat(s).sort(sortKeyVals)}function psbtToKeyVals({globalMap:t,inputs:e,outputs:i}){return{globalKeyVals:keyValsFromMap(t,s.globals),inputKeyVals:e.map(t=>keyValsFromMap(t,s.inputs)),outputKeyVals:i.map(t=>keyValsFromMap(t,s.outputs))}}e.psbtToKeyVals=psbtToKeyVals},95011:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(82190),o=i(36574),a=i(1847),u=i(96403);e.Psbt=class{constructor(t){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:t}}static fromBase64(t,e){let i=n.from(t,"base64");return this.fromBuffer(i,e)}static fromHex(t,e){let i=n.from(t,"hex");return this.fromBuffer(i,e)}static fromBuffer(t,e){let i=o.psbtFromBuffer(t,e),n=new this(i.globalMap.unsignedTx);return Object.assign(n,i),n}toBase64(){let t=this.toBuffer();return t.toString("base64")}toHex(){let t=this.toBuffer();return t.toString("hex")}toBuffer(){return o.psbtToBuffer(this)}updateGlobal(t){return u.updateGlobal(t,this.globalMap),this}updateInput(t,e){let i=u.checkForInput(this.inputs,t);return u.updateInput(e,i),this}updateOutput(t,e){let i=u.checkForOutput(this.outputs,t);return u.updateOutput(e,i),this}addUnknownKeyValToGlobal(t){return u.checkHasKey(t,this.globalMap.unknownKeyVals,u.getEnumLength(a.GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(t),this}addUnknownKeyValToInput(t,e){let i=u.checkForInput(this.inputs,t);return u.checkHasKey(e,i.unknownKeyVals,u.getEnumLength(a.InputTypes)),i.unknownKeyVals||(i.unknownKeyVals=[]),i.unknownKeyVals.push(e),this}addUnknownKeyValToOutput(t,e){let i=u.checkForOutput(this.outputs,t);return u.checkHasKey(e,i.unknownKeyVals,u.getEnumLength(a.OutputTypes)),i.unknownKeyVals||(i.unknownKeyVals=[]),i.unknownKeyVals.push(e),this}addInput(t){this.globalMap.unsignedTx.addInput(t),this.inputs.push({unknownKeyVals:[]});let e=t.unknownKeyVals||[],i=this.inputs.length-1;if(!Array.isArray(e))throw Error("unknownKeyVals must be an Array");return e.forEach(t=>this.addUnknownKeyValToInput(i,t)),u.addInputAttributes(this.inputs,t),this}addOutput(t){this.globalMap.unsignedTx.addOutput(t),this.outputs.push({unknownKeyVals:[]});let e=t.unknownKeyVals||[],i=this.outputs.length-1;if(!Array.isArray(e))throw Error("unknownKeyVals must be an Array");return e.forEach(t=>this.addUnknownKeyValToOutput(i,t)),u.addOutputAttributes(this.outputs,t),this}clearFinalizedInput(t){let e=u.checkForInput(this.inputs,t);for(let i of(u.inputCheckUncleanFinalized(t,e),Object.keys(e)))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(i)||delete e[i];return this}combine(...t){let e=s.combine([this].concat(t));return Object.assign(this,e),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}}},1847:function(t,e){"use strict";var i,n,s;Object.defineProperty(e,"__esModule",{value:!0}),(i=e.GlobalTypes||(e.GlobalTypes={}))[i.UNSIGNED_TX=0]="UNSIGNED_TX",i[i.GLOBAL_XPUB=1]="GLOBAL_XPUB",e.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"],(n=e.InputTypes||(e.InputTypes={}))[n.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",n[n.WITNESS_UTXO=1]="WITNESS_UTXO",n[n.PARTIAL_SIG=2]="PARTIAL_SIG",n[n.SIGHASH_TYPE=3]="SIGHASH_TYPE",n[n.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",n[n.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",n[n.BIP32_DERIVATION=6]="BIP32_DERIVATION",n[n.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",n[n.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",n[n.POR_COMMITMENT=9]="POR_COMMITMENT",n[n.TAP_KEY_SIG=19]="TAP_KEY_SIG",n[n.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",n[n.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",n[n.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",n[n.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",n[n.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT",e.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment","tapKeySig","tapScriptSig","tapLeafScript","tapBip32Derivation","tapInternalKey","tapMerkleRoot"],(s=e.OutputTypes||(e.OutputTypes={}))[s.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",s[s.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",s[s.BIP32_DERIVATION=2]="BIP32_DERIVATION",s[s.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",s[s.TAP_TREE=6]="TAP_TREE",s[s.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION",e.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation","tapInternalKey","tapTree","tapBip32Derivation"]},96403:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(71528);function checkForInput(t,e){let i=t[e];if(void 0===i)throw Error(`No input #${e}`);return i}function checkForOutput(t,e){let i=t[e];if(void 0===i)throw Error(`No output #${e}`);return i}function throwForUpdateMaker(t,e,i,n){throw Error(`Data for ${t} key ${e} is incorrect: Expected ${i} and got ${JSON.stringify(n)}`)}function updateMaker(t){return(e,i)=>{for(let n of Object.keys(e)){let o=e[n],{canAdd:a,canAddToArray:u,check:c,expected:p}=s[t+"s"][n]||{},y=!!u;if(c){if(y){if(!Array.isArray(o)||i[n]&&!Array.isArray(i[n]))throw Error(`Key type ${n} must be an array`);o.every(c)||throwForUpdateMaker(t,n,p,o);let e=i[n]||[],s=new Set;if(!o.every(t=>u(e,t,s)))throw Error("Can not add duplicate data to array");i[n]=e.concat(o)}else{if(c(o)||throwForUpdateMaker(t,n,p,o),!a(i,o))throw Error(`Can not add duplicate data to ${t}`);i[n]=o}}}}}e.checkForInput=checkForInput,e.checkForOutput=checkForOutput,e.checkHasKey=function(t,e,i){if(t.key[0]<i)throw Error("Use the method for your specific key instead of addUnknownKeyVal*");if(e&&0!==e.filter(e=>e.key.equals(t.key)).length)throw Error(`Duplicate Key: ${t.key.toString("hex")}`)},e.getEnumLength=function(t){let e=0;return Object.keys(t).forEach(t=>{Number(isNaN(Number(t)))&&e++}),e},e.inputCheckUncleanFinalized=function(t,e){let i=!1;if(e.nonWitnessUtxo||e.witnessUtxo){let t=!!e.redeemScript,n=!!e.witnessScript,s=!t||!!e.finalScriptSig,o=!n||!!e.finalScriptWitness,a=!!e.finalScriptSig||!!e.finalScriptWitness;i=s&&o&&a}if(!1===i)throw Error(`Input #${t} has too much or too little data to clean`)},e.updateGlobal=updateMaker("global"),e.updateInput=updateMaker("input"),e.updateOutput=updateMaker("output"),e.addInputAttributes=function(t,i){let n=t.length-1,s=checkForInput(t,n);e.updateInput(i,s)},e.addOutputAttributes=function(t,i){let n=t.length-1,s=checkForOutput(t,n);e.updateOutput(i,s)},e.defaultVersionSetter=function(t,e){if(!n.isBuffer(e)||e.length<4)throw Error("Set Version: Invalid Transaction");return e.writeUInt32LE(t,0),e},e.defaultLocktimeSetter=function(t,e){if(!n.isBuffer(e)||e.length<4)throw Error("Set Locktime: Invalid Transaction");return e.writeUInt32LE(t,e.length-4),e}},79164:function(t,e,i){"use strict";var n=i(48764).Buffer,s=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});let u=i(89133),c=a(i(17656));let BIP322=class BIP322{static hashMessage(t){let e=new u.Hash;e.update(this.TAG);let i=e.digest(),s=new u.Hash;s.update(i),s.update(i),s.update(n.from(t));let o=s.digest();return o}static buildToSpendTx(t,e){let i=new c.Psbt;i.setVersion(0),i.setLocktime(0);let s=this.hashMessage(t),o=new Uint8Array([0,32]),a=new Uint8Array(o.length+s.length);return a.set(o),a.set(s,o.length),i.addInput({hash:"0".repeat(64),index:4294967295,sequence:0,finalScriptSig:n.from(a),witnessScript:n.from([])}),i.addOutput({value:0,script:e}),i.extractTransaction()}static buildToSignTx(t,e,i=!1,s){let o=new c.Psbt;return o.setVersion(0),o.setLocktime(0),o.addInput({hash:t,index:0,sequence:0,witnessUtxo:{script:e,value:0}}),i&&o.updateInput(0,{redeemScript:e}),s&&o.updateInput(0,{tapInternalKey:s}),o.addOutput({value:0,script:n.from([106])}),o}static encodeWitness(t){let e=t.data.inputs[0].finalScriptWitness;if(e)return e.toString("base64");throw Error("Cannot encode empty witness stack.")}};BIP322.TAG=n.from("BIP0322-signed-message"),e.default=BIP322},83657:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});let u=a(i(79164)),c=a(i(45217)),p=i(35810),y=o(i(17656)),g=a(i(77235)),m=o(i(87790));e.default=class{static sign(t,e,i){let n;let s=(0,c.default)(g.default),o=s.fromWIF(t,[y.networks.bitcoin,y.networks.testnet,y.networks.regtest]);if(!this.checkPubKeyCorrespondToAddress(o.publicKey,e))throw Error(`Invalid private key provided for signing message for ${e}.`);if(p.Address.isP2PKH(e))return m.sign(i,o.privateKey,o.compressed);let a=p.Address.convertAdressToScriptPubkey(e),b=u.default.buildToSpendTx(i,a);if(p.Address.isP2SH(e)){let t=y.payments.p2wpkh({hash:y.crypto.hash160(o.publicKey),network:p.Address.getNetworkFromAddess(e)}).output;n=u.default.buildToSignTx(b.getId(),t,!0)}else if(p.Address.isP2WPKH(e))n=u.default.buildToSignTx(b.getId(),a);else{let t=p.Key.toXOnly(o.publicKey);o=o.tweak(y.crypto.taggedHash("TapTweak",t)),(n=u.default.buildToSignTx(b.getId(),a,!1,t)).updateInput(0,{sighashType:y.Transaction.SIGHASH_ALL})}let S=n.signAllInputs(o,[y.Transaction.SIGHASH_ALL]).finalizeAllInputs();return u.default.encodeWitness(S)}static checkPubKeyCorrespondToAddress(t,e){let i;if(p.Address.isP2PKH(e))i=p.Address.convertPubKeyIntoAddress(t,"p2pkh");else if(p.Address.isP2SH(e))i=p.Address.convertPubKeyIntoAddress(t,"p2sh-p2wpkh");else if(p.Address.isP2WPKH(e))i=p.Address.convertPubKeyIntoAddress(t,"p2wpkh");else if(p.Address.isP2TR(e))i=p.Address.convertPubKeyIntoAddress(t,"p2tr");else throw Error("Unable to sign BIP-322 message for unsupported address type.");return i.mainnet===e||i.testnet===e||i.regtest===e}}},60350:function(t,e,i){"use strict";var n=i(48764).Buffer,s=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return o(e,t),e},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});let c=u(i(79164)),p=a(i(17656)),y=u(i(77235)),g=i(35810),m=a(i(87790)),b=i(84963);e.default=class{static verifySignature(t,e,i,s=!1){if(!g.Address.isValidBitcoinAddress(t))throw Error("Invalid Bitcoin address is provided.");if(g.Address.isP2PKH(t)||g.BIP137.isBIP137Signature(i))return this.verifyBIP137Signature(t,e,i,s);let o=g.Address.convertAdressToScriptPubkey(t),a=c.default.buildToSpendTx(e,o),u=c.default.buildToSignTx(a.getId(),o);u.updateInput(0,{finalScriptWitness:n.from(i,"base64")});let m=u.extractTransaction().ins[0].witness,S=m[0];if(g.Address.isP2WPKHWitness(m)){let e;let i=m[1],{signature:s}=(0,b.decodeScriptSignature)(S),a=p.crypto.hash160(i);if(g.Address.isP2SH(t)){e=this.getHashForSigP2SHInP2WPKH(u,a);let t=n.concat([n.from([0,20]),a]),i=p.crypto.hash160(t),s=o.subarray(2,-1);if(0!==n.compare(i,s))return!1}else{e=this.getHashForSigP2WPKH(u);let t=o.subarray(2);if(0!==n.compare(a,t))return!1}return y.default.verify(e,i,s)}if(g.Address.isP2TR(t)){let t,e;if(!g.Address.isSingleKeyP2TRWitness(m))throw Error("BIP-322 verification from script-spend P2TR is unsupported.");let i=o.subarray(2);if(64===S.byteLength)t=this.getHashForSigP2TR(u,0),e=S;else if(65===S.byteLength)t=this.getHashForSigP2TR(u,S[64]),e=S.subarray(0,-1);else throw Error("Invalid Schnorr signature provided.");return y.default.verifySchnorr(t,i,e)}throw Error("Only P2WPKH, P2SH-P2WPKH, and single-key-spend P2TR BIP-322 verification is supported. Unsupported address is provided.")}static verifyBIP137Signature(t,e,i,n){let s,o;if(n)return this.bitcoinMessageVerifyWrap(e,t,i);let a=g.BIP137.derivePubKey(e,i);65===a.byteLength?(s=a,o=g.Key.compressPublicKey(a)):(s=g.Key.uncompressPublicKey(a),o=a);let u=g.Address.convertPubKeyIntoAddress(s,"p2pkh").mainnet,c=g.Address.convertPubKeyIntoAddress(o,"p2pkh").mainnet,p=g.Address.convertPubKeyIntoAddress(o,"p2sh-p2wpkh").mainnet,y=g.Address.convertPubKeyIntoAddress(o,"p2wpkh").mainnet;if(g.Address.isP2PKH(t)){let e=g.Address.convertPubKeyIntoAddress(s,"p2pkh"),i=g.Address.convertPubKeyIntoAddress(o,"p2pkh");if(e.mainnet!==t&&e.testnet!==t&&e.regtest!==t&&i.mainnet!==t&&i.testnet!==t&&i.regtest!==t)return!1}else if(g.Address.isP2SH(t)){let e=g.Address.convertPubKeyIntoAddress(o,"p2sh-p2wpkh");if(e.mainnet!==t&&e.testnet!==t&&e.regtest!==t)return!1}else if(g.Address.isP2WPKH(t)){let e=g.Address.convertPubKeyIntoAddress(o,"p2wpkh");if(e.mainnet!==t&&e.testnet!==t&&e.regtest!==t)return!1}else{let e=g.Address.convertPubKeyIntoAddress(o,"p2tr");if(e.mainnet!==t&&e.testnet!==t&&e.regtest!==t)return!1}let m=this.bitcoinMessageVerifyWrap(e,u,i)||this.bitcoinMessageVerifyWrap(e,c,i)||this.bitcoinMessageVerifyWrap(e,p,i)||this.bitcoinMessageVerifyWrap(e,y,i);return m}static bitcoinMessageVerifyWrap(t,e,i){try{return m.verify(t,e,i)}catch(t){return!1}}static getHashForSigP2WPKH(t){let e=p.payments.p2pkh({hash:t.data.inputs[0].witnessUtxo.script.subarray(2)}).output;return t.extractTransaction().hashForWitnessV0(0,e,0,p.Transaction.SIGHASH_ALL)}static getHashForSigP2SHInP2WPKH(t,e){let i=p.payments.p2pkh({hash:e}).output;return t.extractTransaction().hashForWitnessV0(0,i,0,p.Transaction.SIGHASH_ALL)}static getHashForSigP2TR(t,e){if(e!==p.Transaction.SIGHASH_DEFAULT&&e!==p.Transaction.SIGHASH_ALL)throw Error("Invalid SIGHASH used in signature. Must be either SIGHASH_ALL or SIGHASH_DEFAULT.");return t.extractTransaction().hashForWitnessV1(0,[t.data.inputs[0].witnessUtxo.script],[0],e)}}},50622:function(t,e,i){"use strict";var n=i(48764).Buffer;function fromDER(t){0===t[0]&&(t=t.slice(1));let e=n.alloc(32,0),i=Math.max(0,32-t.length);return t.copy(e,i),e}Object.defineProperty(e,"__esModule",{value:!0}),e.decodeScriptSignature=void 0,e.decodeScriptSignature=function(t){let e=t.readUInt8(t.length-1),i=-129&e;if(i<=0||i>=4)throw Error("Invalid hashType "+e);let s=function(t){if(t.length<8)throw Error("DER sequence length is too short");if(t.length>72)throw Error("DER sequence length is too long");if(48!==t[0])throw Error("Expected DER sequence");if(t[1]!==t.length-2)throw Error("DER sequence length is invalid");if(2!==t[2])throw Error("Expected DER integer");let e=t[3];if(0===e)throw Error("R length is zero");if(5+e>=t.length)throw Error("R length is too long");if(2!==t[4+e])throw Error("Expected DER integer (2)");let i=t[5+e];if(0===i)throw Error("S length is zero");if(6+e+i!==t.length)throw Error("S length is invalid");if(128&t[4])throw Error("R value is negative");if(e>1&&0===t[4]&&!(128&t[5]))throw Error("R value excessively padded");if(128&t[e+6])throw Error("S value is negative");if(i>1&&0===t[e+6]&&!(128&t[e+7]))throw Error("S value excessively padded");return{r:t.slice(4,4+e),s:t.slice(6+e)}}(t.slice(0,-1)),o=fromDER(s.r),a=fromDER(s.s),u=n.concat([o,a],64);return{signature:u,hashType:e}}},84963:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decodeScriptSignature=void 0;let n=i(50622);Object.defineProperty(e,"decodeScriptSignature",{enumerable:!0,get:function(){return n.decodeScriptSignature}})},28627:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});let u=a(i(17902)),c=o(i(17656));e.default=class{static isP2PKH(t){return"1"===t[0]||"m"===t[0]||"n"===t[0]}static isP2SH(t){return"3"===t[0]||"2"===t[0]}static isP2WPKH(t){if(!/^(bc1q|tb1q|bcrt1q)/.test(t))return!1;{let e=this.convertAdressToScriptPubkey(t);return 22===e.byteLength}}static isP2TR(t){return!!/^(bc1p|tb1p|bcrt1p)/.test(t)}static isP2WPKHWitness(t){return 2===t.length&&33===t[1].byteLength&&(2===t[1][0]||3===t[1][0])}static isSingleKeyP2TRWitness(t){return 1===t.length}static getNetworkFromAddess(t){if(/^(bc1q|bc1p|1|3)/.test(t))return c.networks.bitcoin;if(/^(tb1q|tb1p|2|m|n)/.test(t))return c.networks.testnet;if(/^(bcrt1q|bcrt1p)/.test(t))return c.networks.regtest;throw Error("Unknown address type")}static convertAdressToScriptPubkey(t){if("1"===t[0]||"m"===t[0]||"n"===t[0])return c.payments.p2pkh({address:t,network:this.getNetworkFromAddess(t)}).output;if("3"===t[0]||"2"===t[0])return c.payments.p2sh({address:t,network:this.getNetworkFromAddess(t)}).output;if(/^(bc1q|tb1q|bcrt1q)/.test(t)){if(42===t.length||t.includes("bcrt1q")&&44===t.length)return c.payments.p2wpkh({address:t,network:this.getNetworkFromAddess(t)}).output;if(62===t.length||t.includes("bcrt1q")&&64===t.length)return c.payments.p2wsh({address:t,network:this.getNetworkFromAddess(t)}).output}else if(/^(bc1p|tb1p|bcrt1p)/.test(t)&&(62===t.length||t.includes("bcrt1p")&&64===t.length))return c.payments.p2tr({address:t,network:this.getNetworkFromAddess(t)}).output;throw Error("Unknown address type")}static convertPubKeyIntoAddress(t,e){switch(e){case"p2pkh":return{mainnet:c.payments.p2pkh({pubkey:t,network:c.networks.bitcoin}).address,testnet:c.payments.p2pkh({pubkey:t,network:c.networks.testnet}).address,regtest:c.payments.p2pkh({pubkey:t,network:c.networks.regtest}).address};case"p2sh-p2wpkh":return{mainnet:c.payments.p2sh({redeem:c.payments.p2wpkh({pubkey:t,network:c.networks.bitcoin}),network:c.networks.bitcoin}).address,testnet:c.payments.p2sh({redeem:c.payments.p2wpkh({pubkey:t,network:c.networks.testnet}),network:c.networks.testnet}).address,regtest:c.payments.p2sh({redeem:c.payments.p2wpkh({pubkey:t,network:c.networks.regtest}),network:c.networks.regtest}).address};case"p2wpkh":return{mainnet:c.payments.p2wpkh({pubkey:t,network:c.networks.bitcoin}).address,testnet:c.payments.p2wpkh({pubkey:t,network:c.networks.testnet}).address,regtest:c.payments.p2wpkh({pubkey:t,network:c.networks.regtest}).address};case"p2tr":let i=u.default.toXOnly(t);return{mainnet:c.payments.p2tr({internalPubkey:i,network:c.networks.bitcoin}).address,testnet:c.payments.p2tr({internalPubkey:i,network:c.networks.testnet}).address,regtest:c.payments.p2tr({internalPubkey:i,network:c.networks.regtest}).address};default:throw Error("Cannot convert public key into unsupported address type.")}}static isValidBitcoinAddress(t){try{return c.address.toOutputScript(t,c.networks.bitcoin),!0}catch(t){}try{return c.address.toOutputScript(t,c.networks.testnet),!0}catch(t){}try{return c.address.toOutputScript(t,c.networks.regtest),!0}catch(t){}return!1}}},37692:function(t,e,i){"use strict";var n=i(48764).Buffer,s=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return o(e,t),e},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});let c=u(i(91545)),p=a(i(87790));e.default=class{static isBIP137Signature(t){let e=n.from(t,"base64");return 65===e.byteLength}static derivePubKey(t,e){let i=p.magicHash(t),s=this.decodeSignature(n.from(e,"base64"));return n.from(c.default.ecdsaRecover(s.signature,s.recovery,i,s.compressed))}static decodeSignature(t){if(65!==t.length)throw Error("Invalid signature length");let e=t.readUInt8(0)-27;if(e>19||e<0)throw Error("Invalid signature parameter");return{compressed:!!(12&e),recovery:3&e,signature:t.subarray(1)}}}},17902:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0});let s=i(86266);e.default=class{static toXOnly(t){if(32!==t.length&&33!==t.length)throw Error("Invalid public key length");return n.from(32===t.length?t:t.subarray(1,33))}static compressPublicKey(t){let e=new s.ec("secp256k1");try{let i=e.keyFromPublic(n.from(t)),s=n.from(i.getPublic(!0,"array"));return s}catch(t){throw Error("Fails to compress the provided public key. Please check if the provided key is a valid uncompressed public key.")}}static uncompressPublicKey(t){let e=new s.ec("secp256k1");try{let i=e.keyFromPublic(n.from(t)),s=n.from(i.getPublic(!1,"array"));return s}catch(t){throw Error("Fails to uncompress the provided public key. Please check if the provided key is a valid compressed public key.")}}}},92344:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static encode(t){if(t<253){let e=n.alloc(1);return e.writeUInt8(t),e}if(t<65536){let e=n.alloc(3);return e.writeUInt8(253),e.writeUInt16LE(t,1),e}if(t<4294967296){let e=n.alloc(5);return e.writeUInt8(254),e.writeUInt32LE(t,1),e}if(t<281474976710656){let e=n.alloc(9);return e.writeUInt8(255),e.writeUIntLE(t,1,6),e.writeUInt8(0,7),e.writeUInt8(0,8),e}throw Error(`Integer too large: ${t}`)}static decode(t){if(0===t.byteLength)throw Error("Empty buffer provided");let e=t.readUInt8();return 253===e?t.readUInt16LE(1):254===e?t.readUInt32LE(1):255===e?t.readUIntLE(1,6):e}}},37783:function(t,e,i){"use strict";var n=i(48764).Buffer,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});let o=s(i(92344));e.default=class{static encode(t){let e=o.default.encode(t.length);return n.concat([e,t])}static decode(t){let e=o.default.decode(t),i=o.default.encode(e).byteLength;return t.subarray(i,e+i)}}},47492:function(t,e,i){"use strict";var n=i(48764).Buffer,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});let o=s(i(92344)),a=s(i(37783));e.default=class{static serialize(t){let e=o.default.encode(t.length);return t.forEach(t=>{e=n.concat([e,a.default.encode(n.from(t))])}),e.toString("base64")}static deserialize(t){let e,i=[];e="string"==typeof t?n.from(t,"base64"):t;let s=o.default.decode(e),u=o.default.encode(s).byteLength;e=e.subarray(u);for(let t=0;t<s;t++){let t=a.default.decode(e);i.push(t);let n=a.default.encode(t).byteLength;e=e.subarray(n)}return i}}},35810:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Witness=e.VarStr=e.VarInt=e.Key=e.BIP137=e.Address=void 0;let s=n(i(28627));e.Address=s.default;let o=n(i(37692));e.BIP137=o.default;let a=n(i(17902));e.Key=a.default;let u=n(i(92344));e.VarInt=u.default;let c=n(i(37783));e.VarStr=c.default;let p=n(i(47492));e.Witness=p.default},57208:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Witness=e.Key=e.BIP137=e.Address=e.Verifier=e.Signer=e.BIP322=void 0;let u=a(i(79164));e.BIP322=u.default;let c=a(i(83657));e.Signer=c.default;let p=a(i(60350));e.Verifier=p.default;let y=i(35810);Object.defineProperty(e,"Address",{enumerable:!0,get:function(){return y.Address}}),Object.defineProperty(e,"BIP137",{enumerable:!0,get:function(){return y.BIP137}}),Object.defineProperty(e,"Key",{enumerable:!0,get:function(){return y.Key}}),Object.defineProperty(e,"Witness",{enumerable:!0,get:function(){return y.Witness}});let g=a(i(77235)),m=o(i(17656));m.initEccLib(g.default)},91545:function(t,e,i){t.exports=i(84811)(i(23546))},23546:function(t,e,i){let n=i(86266).ec,s=new n("secp256k1"),o=s.curve,a=o.n.constructor;function loadPublicKey(t){let e=t[0];switch(e){case 2:case 3:if(33!==t.length)return null;return function(t,e){let i=new a(e);if(i.cmp(o.p)>=0)return null;let n=(i=i.toRed(o.red)).redSqr().redIMul(i).redIAdd(o.b).redSqrt();3===t!==n.isOdd()&&(n=n.redNeg());let u=i.redSqr().redIMul(i);return n.redSqr().redISub(u.redIAdd(o.b)).isZero()?s.keyPair({pub:{x:i,y:n}}):null}(e,t.subarray(1,33));case 4:case 6:case 7:if(65!==t.length)return null;return function(t,e,i){let n=new a(e),u=new a(i);if(n.cmp(o.p)>=0||u.cmp(o.p)>=0||(n=n.toRed(o.red),u=u.toRed(o.red),(6===t||7===t)&&u.isOdd()!==(7===t)))return null;let c=n.redSqr().redIMul(n);return u.redSqr().redISub(c.redIAdd(o.b)).isZero()?s.keyPair({pub:{x:n,y:u}}):null}(e,t.subarray(1,33),t.subarray(33,65));default:return null}}function savePublicKey(t,e){let i=e.encode(null,33===t.length);for(let e=0;e<t.length;++e)t[e]=i[e]}t.exports={contextRandomize:()=>0,privateKeyVerify(t){let e=new a(t);return 0>e.cmp(o.n)&&!e.isZero()?0:1},privateKeyNegate(t){let e=new a(t),i=o.n.sub(e).umod(o.n).toArrayLike(Uint8Array,"be",32);return t.set(i),0},privateKeyTweakAdd(t,e){let i=new a(e);if(i.cmp(o.n)>=0||(i.iadd(new a(t)),i.cmp(o.n)>=0&&i.isub(o.n),i.isZero()))return 1;let n=i.toArrayLike(Uint8Array,"be",32);return t.set(n),0},privateKeyTweakMul(t,e){let i=new a(e);if(i.cmp(o.n)>=0||i.isZero())return 1;i.imul(new a(t)),i.cmp(o.n)>=0&&(i=i.umod(o.n));let n=i.toArrayLike(Uint8Array,"be",32);return t.set(n),0},publicKeyVerify(t){let e=loadPublicKey(t);return null===e?1:0},publicKeyCreate(t,e){let i=new a(e);if(i.cmp(o.n)>=0||i.isZero())return 1;let n=s.keyFromPrivate(e).getPublic();return savePublicKey(t,n),0},publicKeyConvert(t,e){let i=loadPublicKey(e);if(null===i)return 1;let n=i.getPublic();return savePublicKey(t,n),0},publicKeyNegate(t,e){let i=loadPublicKey(e);if(null===i)return 1;let n=i.getPublic();return n.y=n.y.redNeg(),savePublicKey(t,n),0},publicKeyCombine(t,e){let i=Array(e.length);for(let t=0;t<e.length;++t)if(i[t]=loadPublicKey(e[t]),null===i[t])return 1;let n=i[0].getPublic();for(let t=1;t<i.length;++t)n=n.add(i[t].pub);return n.isInfinity()?2:(savePublicKey(t,n),0)},publicKeyTweakAdd(t,e,i){let n=loadPublicKey(e);if(null===n)return 1;if((i=new a(i)).cmp(o.n)>=0)return 2;let s=n.getPublic().add(o.g.mul(i));return s.isInfinity()?2:(savePublicKey(t,s),0)},publicKeyTweakMul(t,e,i){let n=loadPublicKey(e);if(null===n)return 1;if((i=new a(i)).cmp(o.n)>=0||i.isZero())return 2;let s=n.getPublic().mul(i);return savePublicKey(t,s),0},signatureNormalize(t){let e=new a(t.subarray(0,32)),i=new a(t.subarray(32,64));return e.cmp(o.n)>=0||i.cmp(o.n)>=0?1:(1===i.cmp(s.nh)&&t.set(o.n.sub(i).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(t,e){let i=e.subarray(0,32),n=e.subarray(32,64);if(new a(i).cmp(o.n)>=0||new a(n).cmp(o.n)>=0)return 1;let{output:s}=t,u=s.subarray(4,37);u[0]=0,u.set(i,1);let c=33,p=0;for(;c>1&&0===u[p]&&!(128&u[p+1]);--c,++p);if(128&(u=u.subarray(p))[0]||c>1&&0===u[0]&&!(128&u[1]))return 1;let y=s.subarray(39,72);y[0]=0,y.set(n,1);let g=33,m=0;for(;g>1&&0===y[m]&&!(128&y[m+1]);--g,++m);return 128&(y=y.subarray(m))[0]||g>1&&0===y[0]&&!(128&y[1])?1:(t.outputlen=6+c+g,s[0]=48,s[1]=t.outputlen-2,s[2]=2,s[3]=u.length,s.set(u,4),s[4+c]=2,s[5+c]=y.length,s.set(y,6+c),0)},signatureImport(t,e){if(e.length<8||e.length>72||48!==e[0]||e[1]!==e.length-2||2!==e[2])return 1;let i=e[3];if(0===i||5+i>=e.length||2!==e[4+i])return 1;let n=e[5+i];if(0===n||6+i+n!==e.length||128&e[4]||i>1&&0===e[4]&&!(128&e[5])||128&e[i+6]||n>1&&0===e[i+6]&&!(128&e[i+7]))return 1;let s=e.subarray(4,4+i);if(33===s.length&&0===s[0]&&(s=s.subarray(1)),s.length>32)return 1;let u=e.subarray(6+i);if(33===u.length&&0===u[0]&&(u=u.slice(1)),u.length>32)throw Error("S length is too long");let c=new a(s);c.cmp(o.n)>=0&&(c=new a(0));let p=new a(e.subarray(6+i));return p.cmp(o.n)>=0&&(p=new a(0)),t.set(c.toArrayLike(Uint8Array,"be",32),0),t.set(p.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(t,e,i,n,u){let c;if(u){let t=u;u=s=>{let o=t(e,i,null,n,s),u=o instanceof Uint8Array&&32===o.length;if(!u)throw Error("This is the way");return new a(o)}}let p=new a(i);if(p.cmp(o.n)>=0||p.isZero())return 1;try{c=s.sign(e,i,{canonical:!0,k:u,pers:n})}catch(t){return 1}return t.signature.set(c.r.toArrayLike(Uint8Array,"be",32),0),t.signature.set(c.s.toArrayLike(Uint8Array,"be",32),32),t.recid=c.recoveryParam,0},ecdsaVerify(t,e,i){let n={r:t.subarray(0,32),s:t.subarray(32,64)},u=new a(n.r),c=new a(n.s);if(u.cmp(o.n)>=0||c.cmp(o.n)>=0)return 1;if(1===c.cmp(s.nh)||u.isZero()||c.isZero())return 3;let p=loadPublicKey(i);if(null===p)return 2;let y=p.getPublic(),g=s.verify(e,n,y);return g?0:3},ecdsaRecover(t,e,i,n){let u;let c={r:e.slice(0,32),s:e.slice(32,64)},p=new a(c.r),y=new a(c.s);if(p.cmp(o.n)>=0||y.cmp(o.n)>=0)return 1;if(p.isZero()||y.isZero())return 2;try{u=s.recoverPubKey(n,c,i)}catch(t){return 2}return savePublicKey(t,u),0},ecdh(t,e,i,n,u,c,p){let y=loadPublicKey(e);if(null===y)return 1;let g=new a(i);if(g.cmp(o.n)>=0||g.isZero())return 2;let m=y.getPublic().mul(g);if(void 0===u){let e=m.encode(null,!0),i=s.hash().update(e).digest();for(let e=0;e<32;++e)t[e]=i[e]}else{c||(c=new Uint8Array(32));let e=m.getX().toArray("be",32);for(let t=0;t<32;++t)c[t]=e[t];p||(p=new Uint8Array(32));let i=m.getY().toArray("be",32);for(let t=0;t<32;++t)p[t]=i[t];let s=u(c,p,n),o=s instanceof Uint8Array&&s.length===t.length;if(!o)return 2;t.set(s)}return 0}}},84811:function(t){let e={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function assert(t,e){if(!t)throw Error(e)}function isUint8Array(t,e,i){if(assert(e instanceof Uint8Array,`Expected ${t} to be an Uint8Array`),void 0!==i){if(Array.isArray(i)){let n=i.join(", "),s=`Expected ${t} to be an Uint8Array with length [${n}]`;assert(i.includes(e.length),s)}else{let n=`Expected ${t} to be an Uint8Array with length ${i}`;assert(e.length===i,n)}}}function isCompressed(t){assert("Boolean"===toTypeString(t),"Expected compressed to be a Boolean")}function getAssertedOutput(t=t=>new Uint8Array(t),e){return"function"==typeof t&&(t=t(e)),isUint8Array("output",t,e),t}function toTypeString(t){return Object.prototype.toString.call(t).slice(8,-1)}t.exports=t=>({contextRandomize(i){if(assert(null===i||i instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),null!==i&&isUint8Array("seed",i,32),1===t.contextRandomize(i))throw Error(e.CONTEXT_RANDOMIZE_UNKNOW)},privateKeyVerify:e=>(isUint8Array("private key",e,32),0===t.privateKeyVerify(e)),privateKeyNegate(i){switch(isUint8Array("private key",i,32),t.privateKeyNegate(i)){case 0:return i;case 1:throw Error(e.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(i,n){switch(isUint8Array("private key",i,32),isUint8Array("tweak",n,32),t.privateKeyTweakAdd(i,n)){case 0:return i;case 1:throw Error(e.TWEAK_ADD)}},privateKeyTweakMul(i,n){switch(isUint8Array("private key",i,32),isUint8Array("tweak",n,32),t.privateKeyTweakMul(i,n)){case 0:return i;case 1:throw Error(e.TWEAK_MUL)}},publicKeyVerify:e=>(isUint8Array("public key",e,[33,65]),0===t.publicKeyVerify(e)),publicKeyCreate(i,n=!0,s){switch(isUint8Array("private key",i,32),isCompressed(n),s=getAssertedOutput(s,n?33:65),t.publicKeyCreate(s,i)){case 0:return s;case 1:throw Error(e.SECKEY_INVALID);case 2:throw Error(e.PUBKEY_SERIALIZE)}},publicKeyConvert(i,n=!0,s){switch(isUint8Array("public key",i,[33,65]),isCompressed(n),s=getAssertedOutput(s,n?33:65),t.publicKeyConvert(s,i)){case 0:return s;case 1:throw Error(e.PUBKEY_PARSE);case 2:throw Error(e.PUBKEY_SERIALIZE)}},publicKeyNegate(i,n=!0,s){switch(isUint8Array("public key",i,[33,65]),isCompressed(n),s=getAssertedOutput(s,n?33:65),t.publicKeyNegate(s,i)){case 0:return s;case 1:throw Error(e.PUBKEY_PARSE);case 2:throw Error(e.IMPOSSIBLE_CASE);case 3:throw Error(e.PUBKEY_SERIALIZE)}},publicKeyCombine(i,n=!0,s){for(let t of(assert(Array.isArray(i),"Expected public keys to be an Array"),assert(i.length>0,"Expected public keys array will have more than zero items"),i))isUint8Array("public key",t,[33,65]);switch(isCompressed(n),s=getAssertedOutput(s,n?33:65),t.publicKeyCombine(s,i)){case 0:return s;case 1:throw Error(e.PUBKEY_PARSE);case 2:throw Error(e.PUBKEY_COMBINE);case 3:throw Error(e.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(i,n,s=!0,o){switch(isUint8Array("public key",i,[33,65]),isUint8Array("tweak",n,32),isCompressed(s),o=getAssertedOutput(o,s?33:65),t.publicKeyTweakAdd(o,i,n)){case 0:return o;case 1:throw Error(e.PUBKEY_PARSE);case 2:throw Error(e.TWEAK_ADD)}},publicKeyTweakMul(i,n,s=!0,o){switch(isUint8Array("public key",i,[33,65]),isUint8Array("tweak",n,32),isCompressed(s),o=getAssertedOutput(o,s?33:65),t.publicKeyTweakMul(o,i,n)){case 0:return o;case 1:throw Error(e.PUBKEY_PARSE);case 2:throw Error(e.TWEAK_MUL)}},signatureNormalize(i){switch(isUint8Array("signature",i,64),t.signatureNormalize(i)){case 0:return i;case 1:throw Error(e.SIG_PARSE)}},signatureExport(i,n){isUint8Array("signature",i,64),n=getAssertedOutput(n,72);let s={output:n,outputlen:72};switch(t.signatureExport(s,i)){case 0:return n.slice(0,s.outputlen);case 1:throw Error(e.SIG_PARSE);case 2:throw Error(e.IMPOSSIBLE_CASE)}},signatureImport(i,n){switch(isUint8Array("signature",i),n=getAssertedOutput(n,64),t.signatureImport(n,i)){case 0:return n;case 1:throw Error(e.SIG_PARSE);case 2:throw Error(e.IMPOSSIBLE_CASE)}},ecdsaSign(i,n,s={},o){isUint8Array("message",i,32),isUint8Array("private key",n,32),assert("Object"===toTypeString(s),"Expected options to be an Object"),void 0!==s.data&&isUint8Array("options.data",s.data),void 0!==s.noncefn&&assert("Function"===toTypeString(s.noncefn),"Expected options.noncefn to be a Function"),o=getAssertedOutput(o,64);let a={signature:o,recid:null};switch(t.ecdsaSign(a,i,n,s.data,s.noncefn)){case 0:return a;case 1:throw Error(e.SIGN);case 2:throw Error(e.IMPOSSIBLE_CASE)}},ecdsaVerify(i,n,s){switch(isUint8Array("signature",i,64),isUint8Array("message",n,32),isUint8Array("public key",s,[33,65]),t.ecdsaVerify(i,n,s)){case 0:return!0;case 3:return!1;case 1:throw Error(e.SIG_PARSE);case 2:throw Error(e.PUBKEY_PARSE)}},ecdsaRecover(i,n,s,o=!0,a){switch(isUint8Array("signature",i,64),assert("Number"===toTypeString(n)&&n>=0&&n<=3,"Expected recovery id to be a Number within interval [0, 3]"),isUint8Array("message",s,32),isCompressed(o),a=getAssertedOutput(a,o?33:65),t.ecdsaRecover(a,i,n,s)){case 0:return a;case 1:throw Error(e.SIG_PARSE);case 2:throw Error(e.RECOVER);case 3:throw Error(e.IMPOSSIBLE_CASE)}},ecdh(i,n,s={},o){switch(isUint8Array("public key",i,[33,65]),isUint8Array("private key",n,32),assert("Object"===toTypeString(s),"Expected options to be an Object"),void 0!==s.data&&isUint8Array("options.data",s.data),void 0!==s.hashfn?(assert("Function"===toTypeString(s.hashfn),"Expected options.hashfn to be a Function"),void 0!==s.xbuf&&isUint8Array("options.xbuf",s.xbuf,32),void 0!==s.ybuf&&isUint8Array("options.ybuf",s.ybuf,32),isUint8Array("output",o)):o=getAssertedOutput(o,32),t.ecdh(o,i,n,s.data,s.hashfn,s.xbuf,s.ybuf)){case 0:return o;case 1:throw Error(e.PUBKEY_PARSE);case 2:throw Error(e.ECDH)}}})},72882:function(t,e,i){"use strict";var n=i(77191);t.exports=function(t){function decodeRaw(e){var i=e.slice(0,-4),n=e.slice(-4),s=t(i);if(!(n[0]^s[0]|n[1]^s[1]|n[2]^s[2]|n[3]^s[3]))return i}return{encode:function(e){var i=Uint8Array.from(e),s=t(i),o=i.length+4,a=new Uint8Array(o);return a.set(i,0),a.set(s.subarray(0,4),i.length),n.encode(a,o)},decode:function(e){var i=decodeRaw(n.decode(e),t);if(!i)throw Error("Invalid checksum");return i},decodeUnsafe:function(t){var e=n.decodeUnsafe(t);if(e)return decodeRaw(e)}}}},89239:function(t,e,i){"use strict";var{sha256:n}=i(23061),s=i(72882);t.exports=s(function(t){return n(n(t))})},95488:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.toOutputScript=e.fromOutputScript=e.toBech32=e.toBase58Check=e.fromBech32=e.fromBase58Check=void 0;let s=i(74378),o=i(84972),a=i(73357),u=i(41838),c=i(27715),p=i(89239),y="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.";function fromBase58Check(t){let e=n.from(p.decode(t));if(e.length<21)throw TypeError(t+" is too short");if(e.length>21)throw TypeError(t+" is too long");let i=e.readUInt8(0),s=e.slice(1);return{version:i,hash:s}}function fromBech32(t){let e,i;try{e=c.bech32.decode(t)}catch(t){}if(e){if(0!==(i=e.words[0]))throw TypeError(t+" uses wrong encoding")}else if(0===(i=(e=c.bech32m.decode(t)).words[0]))throw TypeError(t+" uses wrong encoding");let s=c.bech32.fromWords(e.words.slice(1));return{version:i,prefix:e.prefix,data:n.from(s)}}function toBech32(t,e,i){let n=c.bech32.toWords(t);return n.unshift(e),0===e?c.bech32.encode(i,n):c.bech32m.encode(i,n)}e.fromBase58Check=fromBase58Check,e.fromBech32=fromBech32,e.toBase58Check=function(t,e){(0,u.typeforce)((0,u.tuple)(u.Hash160bit,u.UInt8),arguments);let i=n.allocUnsafe(21);return i.writeUInt8(e,0),t.copy(i,1),p.encode(i)},e.toBech32=toBech32,e.fromOutputScript=function(t,e){e=e||s.bitcoin;try{return o.p2pkh({output:t,network:e}).address}catch(t){}try{return o.p2sh({output:t,network:e}).address}catch(t){}try{return o.p2wpkh({output:t,network:e}).address}catch(t){}try{return o.p2wsh({output:t,network:e}).address}catch(t){}try{return o.p2tr({output:t,network:e}).address}catch(t){}try{return function(t,e){let i=t.slice(2);if(i.length<2||i.length>40)throw TypeError("Invalid program length for segwit address");let n=t[0]-80;if(n<2||n>16)throw TypeError("Invalid version for segwit address");if(t[1]!==i.length)throw TypeError("Invalid script for segwit address");return console.warn(y),toBech32(i,n,e.bech32)}(t,e)}catch(t){}throw Error(a.toASM(t)+" has no matching Address")},e.toOutputScript=function(t,e){let i,n;e=e||s.bitcoin;try{i=fromBase58Check(t)}catch(t){}if(i){if(i.version===e.pubKeyHash)return o.p2pkh({hash:i.hash}).output;if(i.version===e.scriptHash)return o.p2sh({hash:i.hash}).output}else{try{n=fromBech32(t)}catch(t){}if(n){if(n.prefix!==e.bech32)throw Error(t+" has an invalid prefix");if(0===n.version){if(20===n.data.length)return o.p2wpkh({hash:n.data}).output;if(32===n.data.length)return o.p2wsh({hash:n.data}).output}else if(1===n.version){if(32===n.data.length)return o.p2tr({pubkey:n.data}).output}else if(n.version>=2&&n.version<=16&&n.data.length>=2&&n.data.length<=40)return console.warn(y),a.compile([n.version+80,n.data])}}throw Error(t+" has no matching Script")}},77617:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.encode=e.decode=e.check=void 0,e.check=function(t){if(t.length<8||t.length>72||48!==t[0]||t[1]!==t.length-2||2!==t[2])return!1;let e=t[3];if(0===e||5+e>=t.length||2!==t[4+e])return!1;let i=t[5+e];return 0!==i&&6+e+i===t.length&&!(128&t[4])&&(!(e>1)||0!==t[4]||!!(128&t[5]))&&!(128&t[e+6])&&(!(i>1)||0!==t[e+6]||!!(128&t[e+7]))},e.decode=function(t){if(t.length<8)throw Error("DER sequence length is too short");if(t.length>72)throw Error("DER sequence length is too long");if(48!==t[0])throw Error("Expected DER sequence");if(t[1]!==t.length-2)throw Error("DER sequence length is invalid");if(2!==t[2])throw Error("Expected DER integer");let e=t[3];if(0===e)throw Error("R length is zero");if(5+e>=t.length)throw Error("R length is too long");if(2!==t[4+e])throw Error("Expected DER integer (2)");let i=t[5+e];if(0===i)throw Error("S length is zero");if(6+e+i!==t.length)throw Error("S length is invalid");if(128&t[4])throw Error("R value is negative");if(e>1&&0===t[4]&&!(128&t[5]))throw Error("R value excessively padded");if(128&t[e+6])throw Error("S value is negative");if(i>1&&0===t[e+6]&&!(128&t[e+7]))throw Error("S value excessively padded");return{r:t.slice(4,4+e),s:t.slice(6+e)}},e.encode=function(t,e){let i=t.length,s=e.length;if(0===i)throw Error("R length is zero");if(0===s)throw Error("S length is zero");if(i>33)throw Error("R length is too long");if(s>33)throw Error("S length is too long");if(128&t[0])throw Error("R value is negative");if(128&e[0])throw Error("S value is negative");if(i>1&&0===t[0]&&!(128&t[1]))throw Error("R value excessively padded");if(s>1&&0===e[0]&&!(128&e[1]))throw Error("S value excessively padded");let o=n.allocUnsafe(6+i+s);return o[0]=48,o[1]=o.length-2,o[2]=2,o[3]=t.length,t.copy(o,4),o[4+i]=2,o[5+i]=e.length,e.copy(o,6+i),o}},87949:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.Block=void 0;let s=i(9357),o=i(5525),a=i(298),u=i(82737),c=i(41838),{typeforce:p}=c,y=TypeError("Cannot compute merkle root for zero transactions"),g=TypeError("Cannot compute witness commit for non-segwit block");let Block=class Block{constructor(){this.version=1,this.prevHash=void 0,this.merkleRoot=void 0,this.timestamp=0,this.witnessCommit=void 0,this.bits=0,this.nonce=0,this.transactions=void 0}static fromBuffer(t){if(t.length<80)throw Error("Buffer too small (< 80 bytes)");let e=new s.BufferReader(t),i=new Block;if(i.version=e.readInt32(),i.prevHash=e.readSlice(32),i.merkleRoot=e.readSlice(32),i.timestamp=e.readUInt32(),i.bits=e.readUInt32(),i.nonce=e.readUInt32(),80===t.length)return i;let readTransaction=()=>{let t=u.Transaction.fromBuffer(e.buffer.slice(e.offset),!0);return e.offset+=t.byteLength(),t},n=e.readVarInt();i.transactions=[];for(let t=0;t<n;++t){let t=readTransaction();i.transactions.push(t)}let o=i.getWitnessCommit();return o&&(i.witnessCommit=o),i}static fromHex(t){return Block.fromBuffer(n.from(t,"hex"))}static calculateTarget(t){let e=n.alloc(32,0);return e.writeUIntBE(8388607&t,29-(((4278190080&t)>>24)-3),3),e}static calculateMerkleRoot(t,e){if(p([{getHash:c.Function}],t),0===t.length)throw y;if(e&&!txesHaveWitnessCommit(t))throw g;let i=t.map(t=>t.getHash(e)),s=(0,a.fastMerkleRoot)(i,o.hash256);return e?o.hash256(n.concat([s,t[0].ins[0].witness[0]])):s}getWitnessCommit(){if(!txesHaveWitnessCommit(this.transactions))return null;let t=this.transactions[0].outs.filter(t=>t.script.slice(0,6).equals(n.from("6a24aa21a9ed","hex"))).map(t=>t.script.slice(6,38));if(0===t.length)return null;let e=t[t.length-1];return e instanceof n&&32===e.length?e:null}hasWitnessCommit(){return this.witnessCommit instanceof n&&32===this.witnessCommit.length||null!==this.getWitnessCommit()}hasWitness(){var t;return(t=this.transactions)instanceof Array&&t.some(t=>"object"==typeof t&&t.ins instanceof Array&&t.ins.some(t=>"object"==typeof t&&t.witness instanceof Array&&t.witness.length>0))}weight(){let t=this.byteLength(!1,!1),e=this.byteLength(!1,!0);return 3*t+e}byteLength(t,e=!0){return t||!this.transactions?80:80+s.varuint.encodingLength(this.transactions.length)+this.transactions.reduce((t,i)=>t+i.byteLength(e),0)}getHash(){return o.hash256(this.toBuffer(!0))}getId(){return(0,s.reverseBuffer)(this.getHash()).toString("hex")}getUTCDate(){let t=new Date(0);return t.setUTCSeconds(this.timestamp),t}toBuffer(t){let e=n.allocUnsafe(this.byteLength(t)),i=new s.BufferWriter(e);return i.writeInt32(this.version),i.writeSlice(this.prevHash),i.writeSlice(this.merkleRoot),i.writeUInt32(this.timestamp),i.writeUInt32(this.bits),i.writeUInt32(this.nonce),t||!this.transactions||(s.varuint.encode(this.transactions.length,e,i.offset),i.offset+=s.varuint.encode.bytes,this.transactions.forEach(t=>{let n=t.byteLength();t.toBuffer(e,i.offset),i.offset+=n})),e}toHex(t){return this.toBuffer(t).toString("hex")}checkTxRoots(){let t=this.hasWitnessCommit();return!(!t&&this.hasWitness())&&this.__checkMerkleRoot()&&(!t||this.__checkWitnessCommit())}checkProofOfWork(){let t=(0,s.reverseBuffer)(this.getHash()),e=Block.calculateTarget(this.bits);return 0>=t.compare(e)}__checkMerkleRoot(){if(!this.transactions)throw y;let t=Block.calculateMerkleRoot(this.transactions);return 0===this.merkleRoot.compare(t)}__checkWitnessCommit(){if(!this.transactions)throw y;if(!this.hasWitnessCommit())throw g;let t=Block.calculateMerkleRoot(this.transactions,!0);return 0===this.witnessCommit.compare(t)}};function txesHaveWitnessCommit(t){return t instanceof Array&&t[0]&&t[0].ins&&t[0].ins instanceof Array&&t[0].ins[0]&&t[0].ins[0].witness&&t[0].ins[0].witness instanceof Array&&t[0].ins[0].witness.length>0}e.Block=Block},9357:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.BufferReader=e.BufferWriter=e.cloneBuffer=e.reverseBuffer=e.writeUInt64LE=e.readUInt64LE=e.varuint=void 0;let s=i(41838),{typeforce:o}=s,a=i(57795);function verifuint(t,e){if("number"!=typeof t)throw Error("cannot write a non-number as a number");if(t<0)throw Error("specified a negative value for writing an unsigned value");if(t>e)throw Error("RangeError: value out of range");if(Math.floor(t)!==t)throw Error("value has a fractional component")}function readUInt64LE(t,e){let i=t.readUInt32LE(e),n=t.readUInt32LE(e+4);return verifuint((n*=4294967296)+i,9007199254740991),n+i}function writeUInt64LE(t,e,i){return verifuint(e,9007199254740991),t.writeInt32LE(-1&e,i),t.writeUInt32LE(Math.floor(e/4294967296),i+4),i+8}e.varuint=a,e.readUInt64LE=readUInt64LE,e.writeUInt64LE=writeUInt64LE,e.reverseBuffer=function(t){if(t.length<1)return t;let e=t.length-1,i=0;for(let n=0;n<t.length/2;n++)i=t[n],t[n]=t[e],t[e]=i,e--;return t},e.cloneBuffer=function(t){let e=n.allocUnsafe(t.length);return t.copy(e),e};let BufferWriter=class BufferWriter{static withCapacity(t){return new BufferWriter(n.alloc(t))}constructor(t,e=0){this.buffer=t,this.offset=e,o(s.tuple(s.Buffer,s.UInt32),[t,e])}writeUInt8(t){this.offset=this.buffer.writeUInt8(t,this.offset)}writeInt32(t){this.offset=this.buffer.writeInt32LE(t,this.offset)}writeUInt32(t){this.offset=this.buffer.writeUInt32LE(t,this.offset)}writeUInt64(t){this.offset=writeUInt64LE(this.buffer,t,this.offset)}writeVarInt(t){a.encode(t,this.buffer,this.offset),this.offset+=a.encode.bytes}writeSlice(t){if(this.buffer.length<this.offset+t.length)throw Error("Cannot write slice out of bounds");this.offset+=t.copy(this.buffer,this.offset)}writeVarSlice(t){this.writeVarInt(t.length),this.writeSlice(t)}writeVector(t){this.writeVarInt(t.length),t.forEach(t=>this.writeVarSlice(t))}end(){if(this.buffer.length===this.offset)return this.buffer;throw Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}};e.BufferWriter=BufferWriter,e.BufferReader=class{constructor(t,e=0){this.buffer=t,this.offset=e,o(s.tuple(s.Buffer,s.UInt32),[t,e])}readUInt8(){let t=this.buffer.readUInt8(this.offset);return this.offset++,t}readInt32(){let t=this.buffer.readInt32LE(this.offset);return this.offset+=4,t}readUInt32(){let t=this.buffer.readUInt32LE(this.offset);return this.offset+=4,t}readUInt64(){let t=readUInt64LE(this.buffer,this.offset);return this.offset+=8,t}readVarInt(){let t=a.decode(this.buffer,this.offset);return this.offset+=a.decode.bytes,t}readSlice(t){if(this.buffer.length<this.offset+t)throw Error("Cannot read slice out of bounds");let e=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){let t=this.readVarInt(),e=[];for(let i=0;i<t;i++)e.push(this.readVarSlice());return e}}},5525:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.taggedHash=e.TAGGED_HASH_PREFIXES=e.TAGS=e.hash256=e.hash160=e.sha256=e.sha1=e.ripemd160=void 0;let s=i(70830),o=i(73963),a=i(23061);function sha256(t){return n.from((0,a.sha256)(Uint8Array.from(t)))}e.ripemd160=function(t){return n.from((0,s.ripemd160)(Uint8Array.from(t)))},e.sha1=function(t){return n.from((0,o.sha1)(Uint8Array.from(t)))},e.sha256=sha256,e.hash160=function(t){return n.from((0,s.ripemd160)((0,a.sha256)(Uint8Array.from(t))))},e.hash256=function(t){return n.from((0,a.sha256)((0,a.sha256)(Uint8Array.from(t))))},e.TAGS=["BIP0340/challenge","BIP0340/aux","BIP0340/nonce","TapLeaf","TapBranch","TapSighash","TapTweak","KeyAgg list","KeyAgg coefficient"],e.TAGGED_HASH_PREFIXES={"BIP0340/challenge":n.from([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":n.from([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":n.from([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:n.from([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:n.from([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:n.from([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:n.from([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":n.from([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":n.from([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])},e.taggedHash=function(t,i){return sha256(n.concat([e.TAGGED_HASH_PREFIXES[t],i]))}},66379:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.getEccLib=e.initEccLib=void 0;let s={};e.initEccLib=function(t,e){t?t!==s.eccLib&&(e?.DANGER_DO_NOT_VERIFY_ECCLIB||(assert("function"==typeof t.isXOnlyPoint),assert(t.isXOnlyPoint(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(t.isXOnlyPoint(h("fffffffffffffffffffffffffffffffffffffffffffffffffffffffeeffffc2e"))),assert(t.isXOnlyPoint(h("f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9"))),assert(t.isXOnlyPoint(h("0000000000000000000000000000000000000000000000000000000000000001"))),assert(!t.isXOnlyPoint(h("0000000000000000000000000000000000000000000000000000000000000000"))),assert(!t.isXOnlyPoint(h("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"))),assert("function"==typeof t.xOnlyPointAddTweak),o.forEach(e=>{let i=t.xOnlyPointAddTweak(h(e.pubkey),h(e.tweak));null===e.result?assert(null===i):(assert(null!==i),assert(i.parity===e.parity),assert(n.from(i.xOnlyPubkey).equals(h(e.result))))})),s.eccLib=t):s.eccLib=t},e.getEccLib=function(){if(!s.eccLib)throw Error("No ECC Library provided. You must call initEccLib() with a valid TinySecp256k1Interface instance");return s.eccLib};let h=t=>n.from(t,"hex");function assert(t){if(!t)throw Error("ecc library invalid")}let o=[{pubkey:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",tweak:"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140",parity:-1,result:null},{pubkey:"1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b",tweak:"a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac",parity:1,result:"e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"},{pubkey:"2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",tweak:"823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47",parity:0,result:"9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"}]},17656:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initEccLib=e.Transaction=e.opcodes=e.Psbt=e.Block=e.script=e.payments=e.networks=e.crypto=e.address=void 0;let n=i(95488);e.address=n;let s=i(5525);e.crypto=s;let o=i(74378);e.networks=o;let a=i(84972);e.payments=a;let u=i(73357);e.script=u;var c=i(87949);Object.defineProperty(e,"Block",{enumerable:!0,get:function(){return c.Block}});var p=i(99930);Object.defineProperty(e,"Psbt",{enumerable:!0,get:function(){return p.Psbt}});var y=i(47334);Object.defineProperty(e,"opcodes",{enumerable:!0,get:function(){return y.OPS}});var g=i(82737);Object.defineProperty(e,"Transaction",{enumerable:!0,get:function(){return g.Transaction}});var m=i(66379);Object.defineProperty(e,"initEccLib",{enumerable:!0,get:function(){return m.initEccLib}})},298:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.fastMerkleRoot=void 0,e.fastMerkleRoot=function(t,e){if(!Array.isArray(t))throw TypeError("Expected values Array");if("function"!=typeof e)throw TypeError("Expected digest Function");let i=t.length,s=t.concat();for(;i>1;){let t=0;for(let o=0;o<i;o+=2,++t){let a=s[o],u=o+1===i?a:s[o+1],c=n.concat([a,u]);s[t]=e(c)}i=t}return s[0]}},74378:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.testnet=e.regtest=e.bitcoin=void 0,e.bitcoin={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},e.regtest={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},e.testnet={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},47334:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.REVERSE_OPS=e.OPS=void 0;let i={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255};e.OPS=i;let n={};for(let t of(e.REVERSE_OPS=n,Object.keys(i))){let e=i[t];n[e]=t}},12227:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.tweakKey=e.tapTweakHash=e.tapleafHash=e.findScriptPath=e.toHashTree=e.rootHashFromPath=e.MAX_TAPTREE_DEPTH=e.LEAF_VERSION_TAPSCRIPT=void 0;let n=i(48764),s=i(66379),o=i(5525),a=i(9357),u=i(41838);e.LEAF_VERSION_TAPSCRIPT=192,e.MAX_TAPTREE_DEPTH=128;let isHashBranch=t=>"left"in t&&"right"in t;function tapleafHash(t){let i=t.version||e.LEAF_VERSION_TAPSCRIPT;return o.taggedHash("TapLeaf",n.Buffer.concat([n.Buffer.from([i]),function(t){let e=a.varuint.encodingLength(t.length),i=n.Buffer.allocUnsafe(e);return a.varuint.encode(t.length,i),n.Buffer.concat([i,t])}(t.output)]))}function tapTweakHash(t,e){return o.taggedHash("TapTweak",n.Buffer.concat(e?[t,e]:[t]))}function tapBranchHash(t,e){return o.taggedHash("TapBranch",n.Buffer.concat([t,e]))}e.rootHashFromPath=function(t,e){if(t.length<33)throw TypeError(`The control-block length is too small. Got ${t.length}, expected min 33.`);let i=(t.length-33)/32,n=e;for(let e=0;e<i;e++){let i=t.slice(33+32*e,65+32*e);n=0>n.compare(i)?tapBranchHash(n,i):tapBranchHash(i,n)}return n},e.toHashTree=function toHashTree(t){if((0,u.isTapleaf)(t))return{hash:tapleafHash(t)};let e=[toHashTree(t[0]),toHashTree(t[1])];e.sort((t,e)=>t.hash.compare(e.hash));let[i,n]=e;return{hash:tapBranchHash(i.hash,n.hash),left:i,right:n}},e.findScriptPath=function findScriptPath(t,e){if(isHashBranch(t)){let i=findScriptPath(t.left,e);if(void 0!==i)return[...i,t.right.hash];let n=findScriptPath(t.right,e);if(void 0!==n)return[...n,t.left.hash]}else if(t.hash.equals(e))return[]},e.tapleafHash=tapleafHash,e.tapTweakHash=tapTweakHash,e.tweakKey=function(t,e){if(!n.Buffer.isBuffer(t)||32!==t.length||e&&32!==e.length)return null;let i=tapTweakHash(t,e),o=(0,s.getEccLib)().xOnlyPointAddTweak(t,i);return o&&null!==o.xOnlyPubkey?{parity:o.parity,x:n.Buffer.from(o.xOnlyPubkey)}:null}},36648:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.p2data=void 0;let n=i(74378),s=i(73357),o=i(41838),a=i(52691),u=s.OPS;e.p2data=function(t,e){if(!t.data&&!t.output)throw TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),(0,o.typeforce)({network:o.typeforce.maybe(o.typeforce.Object),output:o.typeforce.maybe(o.typeforce.Buffer),data:o.typeforce.maybe(o.typeforce.arrayOf(o.typeforce.Buffer))},t);let i=t.network||n.bitcoin,c={name:"embed",network:i};if(a.prop(c,"output",()=>{if(t.data)return s.compile([u.OP_RETURN].concat(t.data))}),a.prop(c,"data",()=>{if(t.output)return s.decompile(t.output).slice(1)}),e.validate&&t.output){let e=s.decompile(t.output);if(e[0]!==u.OP_RETURN||!e.slice(1).every(o.typeforce.Buffer))throw TypeError("Output is invalid");if(t.data&&!(0,o.stacksEqual)(t.data,c.data))throw TypeError("Data mismatch")}return Object.assign(c,t)}},84972:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.p2tr=e.p2wsh=e.p2wpkh=e.p2sh=e.p2pkh=e.p2pk=e.p2ms=e.embed=void 0;let n=i(36648);Object.defineProperty(e,"embed",{enumerable:!0,get:function(){return n.p2data}});let s=i(98793);Object.defineProperty(e,"p2ms",{enumerable:!0,get:function(){return s.p2ms}});let o=i(97759);Object.defineProperty(e,"p2pk",{enumerable:!0,get:function(){return o.p2pk}});let a=i(44483);Object.defineProperty(e,"p2pkh",{enumerable:!0,get:function(){return a.p2pkh}});let u=i(21160);Object.defineProperty(e,"p2sh",{enumerable:!0,get:function(){return u.p2sh}});let c=i(18810);Object.defineProperty(e,"p2wpkh",{enumerable:!0,get:function(){return c.p2wpkh}});let p=i(82401);Object.defineProperty(e,"p2wsh",{enumerable:!0,get:function(){return p.p2wsh}});let y=i(10079);Object.defineProperty(e,"p2tr",{enumerable:!0,get:function(){return y.p2tr}})},52691:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.value=e.prop=void 0,e.prop=function(t,e,i){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get(){let t=i.call(this);return this[e]=t,t},set(t){Object.defineProperty(this,e,{configurable:!0,enumerable:!0,value:t,writable:!0})}})},e.value=function(t){let e;return()=>void 0!==e?e:e=t()}},98793:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.p2ms=void 0;let n=i(74378),s=i(73357),o=i(41838),a=i(52691),u=s.OPS,c=u.OP_RESERVED;e.p2ms=function(t,e){if(!t.input&&!t.output&&!(t.pubkeys&&void 0!==t.m)&&!t.signatures)throw TypeError("Not enough data");function isAcceptableSignature(t){return s.isCanonicalScriptSignature(t)||(e.allowIncomplete&&t===u.OP_0)!==void 0}e=Object.assign({validate:!0},e||{}),(0,o.typeforce)({network:o.typeforce.maybe(o.typeforce.Object),m:o.typeforce.maybe(o.typeforce.Number),n:o.typeforce.maybe(o.typeforce.Number),output:o.typeforce.maybe(o.typeforce.Buffer),pubkeys:o.typeforce.maybe(o.typeforce.arrayOf(o.isPoint)),signatures:o.typeforce.maybe(o.typeforce.arrayOf(isAcceptableSignature)),input:o.typeforce.maybe(o.typeforce.Buffer)},t);let i=t.network||n.bitcoin,p={network:i},y=[],g=!1;function decode(t){g||(g=!0,y=s.decompile(t),p.m=y[0]-c,p.n=y[y.length-2]-c,p.pubkeys=y.slice(1,-2))}if(a.prop(p,"output",()=>{if(t.m&&p.n&&t.pubkeys)return s.compile([].concat(c+t.m,t.pubkeys,c+p.n,u.OP_CHECKMULTISIG))}),a.prop(p,"m",()=>{if(p.output)return decode(p.output),p.m}),a.prop(p,"n",()=>{if(p.pubkeys)return p.pubkeys.length}),a.prop(p,"pubkeys",()=>{if(t.output)return decode(t.output),p.pubkeys}),a.prop(p,"signatures",()=>{if(t.input)return s.decompile(t.input).slice(1)}),a.prop(p,"input",()=>{if(t.signatures)return s.compile([u.OP_0].concat(t.signatures))}),a.prop(p,"witness",()=>{if(p.input)return[]}),a.prop(p,"name",()=>{if(p.m&&p.n)return`p2ms(${p.m} of ${p.n})`}),e.validate){if(t.output){if(decode(t.output),!o.typeforce.Number(y[0])||!o.typeforce.Number(y[y.length-2])||y[y.length-1]!==u.OP_CHECKMULTISIG||p.m<=0||p.n>16||p.m>p.n||p.n!==y.length-3||!p.pubkeys.every(t=>(0,o.isPoint)(t)))throw TypeError("Output is invalid");if(void 0!==t.m&&t.m!==p.m)throw TypeError("m mismatch");if(void 0!==t.n&&t.n!==p.n)throw TypeError("n mismatch");if(t.pubkeys&&!(0,o.stacksEqual)(t.pubkeys,p.pubkeys))throw TypeError("Pubkeys mismatch")}if(t.pubkeys){if(void 0!==t.n&&t.n!==t.pubkeys.length)throw TypeError("Pubkey count mismatch");if(p.n=t.pubkeys.length,p.n<p.m)throw TypeError("Pubkey count cannot be less than m")}if(t.signatures){if(t.signatures.length<p.m)throw TypeError("Not enough signatures provided");if(t.signatures.length>p.m)throw TypeError("Too many signatures provided")}if(t.input){if(t.input[0]!==u.OP_0)throw TypeError("Input is invalid");if(0===p.signatures.length||!p.signatures.every(isAcceptableSignature))throw TypeError("Input has invalid signature(s)");if(t.signatures&&!(0,o.stacksEqual)(t.signatures,p.signatures))throw TypeError("Signature mismatch");if(void 0!==t.m&&t.m!==t.signatures.length)throw TypeError("Signature count mismatch")}}return Object.assign(p,t)}},97759:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.p2pk=void 0;let n=i(74378),s=i(73357),o=i(41838),a=i(52691),u=s.OPS;e.p2pk=function(t,e){if(!t.input&&!t.output&&!t.pubkey&&!t.input&&!t.signature)throw TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),(0,o.typeforce)({network:o.typeforce.maybe(o.typeforce.Object),output:o.typeforce.maybe(o.typeforce.Buffer),pubkey:o.typeforce.maybe(o.isPoint),signature:o.typeforce.maybe(s.isCanonicalScriptSignature),input:o.typeforce.maybe(o.typeforce.Buffer)},t);let i=a.value(()=>s.decompile(t.input)),c=t.network||n.bitcoin,p={name:"p2pk",network:c};if(a.prop(p,"output",()=>{if(t.pubkey)return s.compile([t.pubkey,u.OP_CHECKSIG])}),a.prop(p,"pubkey",()=>{if(t.output)return t.output.slice(1,-1)}),a.prop(p,"signature",()=>{if(t.input)return i()[0]}),a.prop(p,"input",()=>{if(t.signature)return s.compile([t.signature])}),a.prop(p,"witness",()=>{if(p.input)return[]}),e.validate){if(t.output){if(t.output[t.output.length-1]!==u.OP_CHECKSIG)throw TypeError("Output is invalid");if(!(0,o.isPoint)(p.pubkey))throw TypeError("Output pubkey is invalid");if(t.pubkey&&!t.pubkey.equals(p.pubkey))throw TypeError("Pubkey mismatch")}if(t.signature&&t.input&&!t.input.equals(p.input))throw TypeError("Signature mismatch");if(t.input){if(1!==i().length)throw TypeError("Input is invalid");if(!s.isCanonicalScriptSignature(p.signature))throw TypeError("Input has invalid signature")}}return Object.assign(p,t)}},44483:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.p2pkh=void 0;let s=i(5525),o=i(74378),a=i(73357),u=i(41838),c=i(52691),p=i(89239),y=a.OPS;e.p2pkh=function(t,e){if(!t.address&&!t.hash&&!t.output&&!t.pubkey&&!t.input)throw TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),(0,u.typeforce)({network:u.typeforce.maybe(u.typeforce.Object),address:u.typeforce.maybe(u.typeforce.String),hash:u.typeforce.maybe(u.typeforce.BufferN(20)),output:u.typeforce.maybe(u.typeforce.BufferN(25)),pubkey:u.typeforce.maybe(u.isPoint),signature:u.typeforce.maybe(a.isCanonicalScriptSignature),input:u.typeforce.maybe(u.typeforce.Buffer)},t);let i=c.value(()=>{let e=n.from(p.decode(t.address)),i=e.readUInt8(0),s=e.slice(1);return{version:i,hash:s}}),g=c.value(()=>a.decompile(t.input)),m=t.network||o.bitcoin,b={name:"p2pkh",network:m};if(c.prop(b,"address",()=>{if(!b.hash)return;let t=n.allocUnsafe(21);return t.writeUInt8(m.pubKeyHash,0),b.hash.copy(t,1),p.encode(t)}),c.prop(b,"hash",()=>t.output?t.output.slice(3,23):t.address?i().hash:t.pubkey||b.pubkey?s.hash160(t.pubkey||b.pubkey):void 0),c.prop(b,"output",()=>{if(b.hash)return a.compile([y.OP_DUP,y.OP_HASH160,b.hash,y.OP_EQUALVERIFY,y.OP_CHECKSIG])}),c.prop(b,"pubkey",()=>{if(t.input)return g()[1]}),c.prop(b,"signature",()=>{if(t.input)return g()[0]}),c.prop(b,"input",()=>{if(t.pubkey&&t.signature)return a.compile([t.signature,t.pubkey])}),c.prop(b,"witness",()=>{if(b.input)return[]}),e.validate){let e=n.from([]);if(t.address){if(i().version!==m.pubKeyHash)throw TypeError("Invalid version or Network mismatch");if(20!==i().hash.length)throw TypeError("Invalid address");e=i().hash}if(t.hash){if(e.length>0&&!e.equals(t.hash))throw TypeError("Hash mismatch");e=t.hash}if(t.output){if(25!==t.output.length||t.output[0]!==y.OP_DUP||t.output[1]!==y.OP_HASH160||20!==t.output[2]||t.output[23]!==y.OP_EQUALVERIFY||t.output[24]!==y.OP_CHECKSIG)throw TypeError("Output is invalid");let i=t.output.slice(3,23);if(e.length>0&&!e.equals(i))throw TypeError("Hash mismatch");e=i}if(t.pubkey){let i=s.hash160(t.pubkey);if(e.length>0&&!e.equals(i))throw TypeError("Hash mismatch");e=i}if(t.input){let i=g();if(2!==i.length)throw TypeError("Input is invalid");if(!a.isCanonicalScriptSignature(i[0]))throw TypeError("Input has invalid signature");if(!(0,u.isPoint)(i[1]))throw TypeError("Input has invalid pubkey");if(t.signature&&!t.signature.equals(i[0]))throw TypeError("Signature mismatch");if(t.pubkey&&!t.pubkey.equals(i[1]))throw TypeError("Pubkey mismatch");let n=s.hash160(i[1]);if(e.length>0&&!e.equals(n))throw TypeError("Hash mismatch")}}return Object.assign(b,t)}},21160:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.p2sh=void 0;let s=i(5525),o=i(74378),a=i(73357),u=i(41838),c=i(52691),p=i(89239),y=a.OPS;e.p2sh=function(t,e){if(!t.address&&!t.hash&&!t.output&&!t.redeem&&!t.input)throw TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),(0,u.typeforce)({network:u.typeforce.maybe(u.typeforce.Object),address:u.typeforce.maybe(u.typeforce.String),hash:u.typeforce.maybe(u.typeforce.BufferN(20)),output:u.typeforce.maybe(u.typeforce.BufferN(23)),redeem:u.typeforce.maybe({network:u.typeforce.maybe(u.typeforce.Object),output:u.typeforce.maybe(u.typeforce.Buffer),input:u.typeforce.maybe(u.typeforce.Buffer),witness:u.typeforce.maybe(u.typeforce.arrayOf(u.typeforce.Buffer))}),input:u.typeforce.maybe(u.typeforce.Buffer),witness:u.typeforce.maybe(u.typeforce.arrayOf(u.typeforce.Buffer))},t);let i=t.network;i||(i=t.redeem&&t.redeem.network||o.bitcoin);let g={network:i},m=c.value(()=>{let e=n.from(p.decode(t.address)),i=e.readUInt8(0),s=e.slice(1);return{version:i,hash:s}}),b=c.value(()=>a.decompile(t.input)),S=c.value(()=>{let e=b(),s=e[e.length-1];return{network:i,output:s===y.OP_FALSE?n.from([]):s,input:a.compile(e.slice(0,-1)),witness:t.witness||[]}});if(c.prop(g,"address",()=>{if(!g.hash)return;let t=n.allocUnsafe(21);return t.writeUInt8(g.network.scriptHash,0),g.hash.copy(t,1),p.encode(t)}),c.prop(g,"hash",()=>t.output?t.output.slice(2,22):t.address?m().hash:g.redeem&&g.redeem.output?s.hash160(g.redeem.output):void 0),c.prop(g,"output",()=>{if(g.hash)return a.compile([y.OP_HASH160,g.hash,y.OP_EQUAL])}),c.prop(g,"redeem",()=>{if(t.input)return S()}),c.prop(g,"input",()=>{if(t.redeem&&t.redeem.input&&t.redeem.output)return a.compile([].concat(a.decompile(t.redeem.input),t.redeem.output))}),c.prop(g,"witness",()=>g.redeem&&g.redeem.witness?g.redeem.witness:g.input?[]:void 0),c.prop(g,"name",()=>{let t=["p2sh"];return void 0!==g.redeem&&void 0!==g.redeem.name&&t.push(g.redeem.name),t.join("-")}),e.validate){let e=n.from([]);if(t.address){if(m().version!==i.scriptHash)throw TypeError("Invalid version or Network mismatch");if(20!==m().hash.length)throw TypeError("Invalid address");e=m().hash}if(t.hash){if(e.length>0&&!e.equals(t.hash))throw TypeError("Hash mismatch");e=t.hash}if(t.output){if(23!==t.output.length||t.output[0]!==y.OP_HASH160||20!==t.output[1]||t.output[22]!==y.OP_EQUAL)throw TypeError("Output is invalid");let i=t.output.slice(2,22);if(e.length>0&&!e.equals(i))throw TypeError("Hash mismatch");e=i}let checkRedeem=t=>{if(t.output){let i=a.decompile(t.output);if(!i||i.length<1)throw TypeError("Redeem.output too short");if(t.output.byteLength>520)throw TypeError("Redeem.output unspendable if larger than 520 bytes");if(a.countNonPushOnlyOPs(i)>201)throw TypeError("Redeem.output unspendable with more than 201 non-push ops");let n=s.hash160(t.output);if(e.length>0&&!e.equals(n))throw TypeError("Hash mismatch");e=n}if(t.input){let e=t.input.length>0,i=t.witness&&t.witness.length>0;if(!e&&!i)throw TypeError("Empty input");if(e&&i)throw TypeError("Input and witness provided");if(e){let e=a.decompile(t.input);if(!a.isPushOnly(e))throw TypeError("Non push-only scriptSig")}}};if(t.input){let t=b();if(!t||t.length<1)throw TypeError("Input too short");if(!n.isBuffer(S().output))throw TypeError("Input is invalid");checkRedeem(S())}if(t.redeem){if(t.redeem.network&&t.redeem.network!==i)throw TypeError("Network mismatch");if(t.input){let e=S();if(t.redeem.output&&!t.redeem.output.equals(e.output))throw TypeError("Redeem.output mismatch");if(t.redeem.input&&!t.redeem.input.equals(e.input))throw TypeError("Redeem.input mismatch")}checkRedeem(t.redeem)}if(t.witness&&t.redeem&&t.redeem.witness&&!(0,u.stacksEqual)(t.redeem.witness,t.witness))throw TypeError("Witness and redeem.witness mismatch")}return Object.assign(g,t)}},10079:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.p2tr=void 0;let n=i(48764),s=i(74378),o=i(73357),a=i(41838),u=i(66379),c=i(12227),p=i(52691),y=i(27715),g=i(95488),m=o.OPS;e.p2tr=function(t,e){if(!t.address&&!t.output&&!t.pubkey&&!t.internalPubkey&&!(t.witness&&t.witness.length>1))throw TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),(0,a.typeforce)({address:a.typeforce.maybe(a.typeforce.String),input:a.typeforce.maybe(a.typeforce.BufferN(0)),network:a.typeforce.maybe(a.typeforce.Object),output:a.typeforce.maybe(a.typeforce.BufferN(34)),internalPubkey:a.typeforce.maybe(a.typeforce.BufferN(32)),hash:a.typeforce.maybe(a.typeforce.BufferN(32)),pubkey:a.typeforce.maybe(a.typeforce.BufferN(32)),signature:a.typeforce.maybe(a.typeforce.anyOf(a.typeforce.BufferN(64),a.typeforce.BufferN(65))),witness:a.typeforce.maybe(a.typeforce.arrayOf(a.typeforce.Buffer)),scriptTree:a.typeforce.maybe(a.isTaptree),redeem:a.typeforce.maybe({output:a.typeforce.maybe(a.typeforce.Buffer),redeemVersion:a.typeforce.maybe(a.typeforce.Number),witness:a.typeforce.maybe(a.typeforce.arrayOf(a.typeforce.Buffer))}),redeemVersion:a.typeforce.maybe(a.typeforce.Number)},t);let i=p.value(()=>(0,g.fromBech32)(t.address)),b=p.value(()=>{if(t.witness&&t.witness.length)return t.witness.length>=2&&80===t.witness[t.witness.length-1][0]?t.witness.slice(0,-1):t.witness.slice()}),S=p.value(()=>t.scriptTree?(0,c.toHashTree)(t.scriptTree):t.hash?{hash:t.hash}:void 0),v=t.network||s.bitcoin,_={name:"p2tr",network:v};if(p.prop(_,"address",()=>{if(!_.pubkey)return;let t=y.bech32m.toWords(_.pubkey);return t.unshift(1),y.bech32m.encode(v.bech32,t)}),p.prop(_,"hash",()=>{let t=S();if(t)return t.hash;let e=b();if(e&&e.length>1){let t=e[e.length-1],i=t[0]&a.TAPLEAF_VERSION_MASK,n=e[e.length-2],s=(0,c.tapleafHash)({output:n,version:i});return(0,c.rootHashFromPath)(t,s)}return null}),p.prop(_,"output",()=>{if(_.pubkey)return o.compile([m.OP_1,_.pubkey])}),p.prop(_,"redeemVersion",()=>t.redeemVersion?t.redeemVersion:t.redeem&&void 0!==t.redeem.redeemVersion&&null!==t.redeem.redeemVersion?t.redeem.redeemVersion:c.LEAF_VERSION_TAPSCRIPT),p.prop(_,"redeem",()=>{let t=b();if(t&&!(t.length<2))return{output:t[t.length-2],witness:t.slice(0,-2),redeemVersion:t[t.length-1][0]&a.TAPLEAF_VERSION_MASK}}),p.prop(_,"pubkey",()=>{if(t.pubkey)return t.pubkey;if(t.output)return t.output.slice(2);if(t.address)return i().data;if(_.internalPubkey){let t=(0,c.tweakKey)(_.internalPubkey,_.hash);if(t)return t.x}}),p.prop(_,"internalPubkey",()=>{if(t.internalPubkey)return t.internalPubkey;let e=b();if(e&&e.length>1)return e[e.length-1].slice(1,33)}),p.prop(_,"signature",()=>{if(t.signature)return t.signature;let e=b();if(e&&1===e.length)return e[0]}),p.prop(_,"witness",()=>{if(t.witness)return t.witness;let e=S();if(e&&t.redeem&&t.redeem.output&&t.internalPubkey){let i=(0,c.tapleafHash)({output:t.redeem.output,version:_.redeemVersion}),s=(0,c.findScriptPath)(e,i);if(!s)return;let o=(0,c.tweakKey)(t.internalPubkey,e.hash);if(!o)return;let a=n.Buffer.concat([n.Buffer.from([_.redeemVersion|o.parity]),t.internalPubkey].concat(s));return[t.redeem.output,a]}if(t.signature)return[t.signature]}),e.validate){let e=n.Buffer.from([]);if(t.address){if(v&&v.bech32!==i().prefix)throw TypeError("Invalid prefix or Network mismatch");if(1!==i().version)throw TypeError("Invalid address version");if(32!==i().data.length)throw TypeError("Invalid address data");e=i().data}if(t.pubkey){if(e.length>0&&!e.equals(t.pubkey))throw TypeError("Pubkey mismatch");e=t.pubkey}if(t.output){if(34!==t.output.length||t.output[0]!==m.OP_1||32!==t.output[1])throw TypeError("Output is invalid");if(e.length>0&&!e.equals(t.output.slice(2)))throw TypeError("Pubkey mismatch");e=t.output.slice(2)}if(t.internalPubkey){let i=(0,c.tweakKey)(t.internalPubkey,_.hash);if(e.length>0&&!e.equals(i.x))throw TypeError("Pubkey mismatch");e=i.x}if(e&&e.length&&!(0,u.getEccLib)().isXOnlyPoint(e))throw TypeError("Invalid pubkey for p2tr");let s=S();if(t.hash&&s&&!t.hash.equals(s.hash))throw TypeError("Hash mismatch");if(t.redeem&&t.redeem.output&&s){let e=(0,c.tapleafHash)({output:t.redeem.output,version:_.redeemVersion});if(!(0,c.findScriptPath)(s,e))throw TypeError("Redeem script not in tree")}let p=b();if(t.redeem&&_.redeem){if(t.redeem.redeemVersion&&t.redeem.redeemVersion!==_.redeem.redeemVersion)throw TypeError("Redeem.redeemVersion and witness mismatch");if(t.redeem.output){if(0===o.decompile(t.redeem.output).length)throw TypeError("Redeem.output is invalid");if(_.redeem.output&&!t.redeem.output.equals(_.redeem.output))throw TypeError("Redeem.output and witness mismatch")}if(t.redeem.witness&&_.redeem.witness&&!(0,a.stacksEqual)(t.redeem.witness,_.redeem.witness))throw TypeError("Redeem.witness and witness mismatch")}if(p&&p.length){if(1===p.length){if(t.signature&&!t.signature.equals(p[0]))throw TypeError("Signature mismatch")}else{let i=p[p.length-1];if(i.length<33)throw TypeError(`The control-block length is too small. Got ${i.length}, expected min 33.`);if((i.length-33)%32!=0)throw TypeError(`The control-block length of ${i.length} is incorrect!`);let n=(i.length-33)/32;if(n>128)throw TypeError(`The script path is too long. Got ${n}, expected max 128.`);let s=i.slice(1,33);if(t.internalPubkey&&!t.internalPubkey.equals(s))throw TypeError("Internal pubkey mismatch");if(!(0,u.getEccLib)().isXOnlyPoint(s))throw TypeError("Invalid internalPubkey for p2tr witness");let o=i[0]&a.TAPLEAF_VERSION_MASK,y=p[p.length-2],g=(0,c.tapleafHash)({output:y,version:o}),m=(0,c.rootHashFromPath)(i,g),b=(0,c.tweakKey)(s,m);if(!b)throw TypeError("Invalid outputKey for p2tr witness");if(e.length&&!e.equals(b.x))throw TypeError("Pubkey mismatch for p2tr witness");if(b.parity!==(1&i[0]))throw Error("Incorrect parity")}}}return Object.assign(_,t)}},18810:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.p2wpkh=void 0;let s=i(5525),o=i(74378),a=i(73357),u=i(41838),c=i(52691),p=i(27715),y=a.OPS,g=n.alloc(0);e.p2wpkh=function(t,e){if(!t.address&&!t.hash&&!t.output&&!t.pubkey&&!t.witness)throw TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),(0,u.typeforce)({address:u.typeforce.maybe(u.typeforce.String),hash:u.typeforce.maybe(u.typeforce.BufferN(20)),input:u.typeforce.maybe(u.typeforce.BufferN(0)),network:u.typeforce.maybe(u.typeforce.Object),output:u.typeforce.maybe(u.typeforce.BufferN(22)),pubkey:u.typeforce.maybe(u.isPoint),signature:u.typeforce.maybe(a.isCanonicalScriptSignature),witness:u.typeforce.maybe(u.typeforce.arrayOf(u.typeforce.Buffer))},t);let i=c.value(()=>{let e=p.bech32.decode(t.address),i=e.words.shift(),s=p.bech32.fromWords(e.words);return{version:i,prefix:e.prefix,data:n.from(s)}}),m=t.network||o.bitcoin,b={name:"p2wpkh",network:m};if(c.prop(b,"address",()=>{if(!b.hash)return;let t=p.bech32.toWords(b.hash);return t.unshift(0),p.bech32.encode(m.bech32,t)}),c.prop(b,"hash",()=>t.output?t.output.slice(2,22):t.address?i().data:t.pubkey||b.pubkey?s.hash160(t.pubkey||b.pubkey):void 0),c.prop(b,"output",()=>{if(b.hash)return a.compile([y.OP_0,b.hash])}),c.prop(b,"pubkey",()=>t.pubkey?t.pubkey:t.witness?t.witness[1]:void 0),c.prop(b,"signature",()=>{if(t.witness)return t.witness[0]}),c.prop(b,"input",()=>{if(b.witness)return g}),c.prop(b,"witness",()=>{if(t.pubkey&&t.signature)return[t.signature,t.pubkey]}),e.validate){let e=n.from([]);if(t.address){if(m&&m.bech32!==i().prefix)throw TypeError("Invalid prefix or Network mismatch");if(0!==i().version)throw TypeError("Invalid address version");if(20!==i().data.length)throw TypeError("Invalid address data");e=i().data}if(t.hash){if(e.length>0&&!e.equals(t.hash))throw TypeError("Hash mismatch");e=t.hash}if(t.output){if(22!==t.output.length||t.output[0]!==y.OP_0||20!==t.output[1])throw TypeError("Output is invalid");if(e.length>0&&!e.equals(t.output.slice(2)))throw TypeError("Hash mismatch");e=t.output.slice(2)}if(t.pubkey){let i=s.hash160(t.pubkey);if(e.length>0&&!e.equals(i))throw TypeError("Hash mismatch");if(e=i,!(0,u.isPoint)(t.pubkey)||33!==t.pubkey.length)throw TypeError("Invalid pubkey for p2wpkh")}if(t.witness){if(2!==t.witness.length)throw TypeError("Witness is invalid");if(!a.isCanonicalScriptSignature(t.witness[0]))throw TypeError("Witness has invalid signature");if(!(0,u.isPoint)(t.witness[1])||33!==t.witness[1].length)throw TypeError("Witness has invalid pubkey");if(t.signature&&!t.signature.equals(t.witness[0]))throw TypeError("Signature mismatch");if(t.pubkey&&!t.pubkey.equals(t.witness[1]))throw TypeError("Pubkey mismatch");let i=s.hash160(t.witness[1]);if(e.length>0&&!e.equals(i))throw TypeError("Hash mismatch")}}return Object.assign(b,t)}},82401:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.p2wsh=void 0;let s=i(5525),o=i(74378),a=i(73357),u=i(41838),c=i(52691),p=i(27715),y=a.OPS,g=n.alloc(0);function chunkHasUncompressedPubkey(t){return!!(n.isBuffer(t)&&65===t.length&&4===t[0]&&(0,u.isPoint)(t))}e.p2wsh=function(t,e){if(!t.address&&!t.hash&&!t.output&&!t.redeem&&!t.witness)throw TypeError("Not enough data");e=Object.assign({validate:!0},e||{}),(0,u.typeforce)({network:u.typeforce.maybe(u.typeforce.Object),address:u.typeforce.maybe(u.typeforce.String),hash:u.typeforce.maybe(u.typeforce.BufferN(32)),output:u.typeforce.maybe(u.typeforce.BufferN(34)),redeem:u.typeforce.maybe({input:u.typeforce.maybe(u.typeforce.Buffer),network:u.typeforce.maybe(u.typeforce.Object),output:u.typeforce.maybe(u.typeforce.Buffer),witness:u.typeforce.maybe(u.typeforce.arrayOf(u.typeforce.Buffer))}),input:u.typeforce.maybe(u.typeforce.BufferN(0)),witness:u.typeforce.maybe(u.typeforce.arrayOf(u.typeforce.Buffer))},t);let i=c.value(()=>{let e=p.bech32.decode(t.address),i=e.words.shift(),s=p.bech32.fromWords(e.words);return{version:i,prefix:e.prefix,data:n.from(s)}}),m=c.value(()=>a.decompile(t.redeem.input)),b=t.network;b||(b=t.redeem&&t.redeem.network||o.bitcoin);let S={network:b};if(c.prop(S,"address",()=>{if(!S.hash)return;let t=p.bech32.toWords(S.hash);return t.unshift(0),p.bech32.encode(b.bech32,t)}),c.prop(S,"hash",()=>t.output?t.output.slice(2):t.address?i().data:S.redeem&&S.redeem.output?s.sha256(S.redeem.output):void 0),c.prop(S,"output",()=>{if(S.hash)return a.compile([y.OP_0,S.hash])}),c.prop(S,"redeem",()=>{if(t.witness)return{output:t.witness[t.witness.length-1],input:g,witness:t.witness.slice(0,-1)}}),c.prop(S,"input",()=>{if(S.witness)return g}),c.prop(S,"witness",()=>{if(t.redeem&&t.redeem.input&&t.redeem.input.length>0&&t.redeem.output&&t.redeem.output.length>0){let e=a.toStack(m());return S.redeem=Object.assign({witness:e},t.redeem),S.redeem.input=g,[].concat(e,t.redeem.output)}if(t.redeem&&t.redeem.output&&t.redeem.witness)return[].concat(t.redeem.witness,t.redeem.output)}),c.prop(S,"name",()=>{let t=["p2wsh"];return void 0!==S.redeem&&void 0!==S.redeem.name&&t.push(S.redeem.name),t.join("-")}),e.validate){let e=n.from([]);if(t.address){if(i().prefix!==b.bech32)throw TypeError("Invalid prefix or Network mismatch");if(0!==i().version)throw TypeError("Invalid address version");if(32!==i().data.length)throw TypeError("Invalid address data");e=i().data}if(t.hash){if(e.length>0&&!e.equals(t.hash))throw TypeError("Hash mismatch");e=t.hash}if(t.output){if(34!==t.output.length||t.output[0]!==y.OP_0||32!==t.output[1])throw TypeError("Output is invalid");let i=t.output.slice(2);if(e.length>0&&!e.equals(i))throw TypeError("Hash mismatch");e=i}if(t.redeem){if(t.redeem.network&&t.redeem.network!==b)throw TypeError("Network mismatch");if(t.redeem.input&&t.redeem.input.length>0&&t.redeem.witness&&t.redeem.witness.length>0)throw TypeError("Ambiguous witness source");if(t.redeem.output){let i=a.decompile(t.redeem.output);if(!i||i.length<1)throw TypeError("Redeem.output is invalid");if(t.redeem.output.byteLength>3600)throw TypeError("Redeem.output unspendable if larger than 3600 bytes");if(a.countNonPushOnlyOPs(i)>201)throw TypeError("Redeem.output unspendable with more than 201 non-push ops");let n=s.sha256(t.redeem.output);if(e.length>0&&!e.equals(n))throw TypeError("Hash mismatch");e=n}if(t.redeem.input&&!a.isPushOnly(m()))throw TypeError("Non push-only scriptSig");if(t.witness&&t.redeem.witness&&!(0,u.stacksEqual)(t.witness,t.redeem.witness))throw TypeError("Witness and redeem.witness mismatch");if(t.redeem.input&&m().some(chunkHasUncompressedPubkey)||t.redeem.output&&(a.decompile(t.redeem.output)||[]).some(chunkHasUncompressedPubkey))throw TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(t.witness&&t.witness.length>0){let e=t.witness[t.witness.length-1];if(t.redeem&&t.redeem.output&&!t.redeem.output.equals(e))throw TypeError("Witness and redeem.output mismatch");if(t.witness.some(chunkHasUncompressedPubkey)||(a.decompile(e)||[]).some(chunkHasUncompressedPubkey))throw TypeError("Witness contains uncompressed pubkey")}}return Object.assign(S,t)}},99930:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.Psbt=void 0;let s=i(95011),o=i(3493),a=i(96403),u=i(95488),c=i(9357),p=i(74378),y=i(84972),g=i(12227),m=i(73357),b=i(82737),S=i(23064),v=i(87929),_={network:p.bitcoin,maximumFeeRate:5e3};let Psbt=class Psbt{static fromBase64(t,e={}){let i=n.from(t,"base64");return this.fromBuffer(i,e)}static fromHex(t,e={}){let i=n.from(t,"hex");return this.fromBuffer(i,e)}static fromBuffer(t,e={}){let i=s.Psbt.fromBuffer(t,transactionFromBuffer),n=new Psbt(e,i);return function(t,e){t.ins.forEach(t=>{checkTxInputCache(e,t)})}(n.__CACHE.__TX,n.__CACHE),n}constructor(t={},e=new s.Psbt(new PsbtTransaction)){this.data=e,this.opts=Object.assign({},_,t),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},0===this.data.inputs.length&&this.setVersion(2);let dpew=(t,e,i,n)=>Object.defineProperty(t,e,{enumerable:i,writable:n});dpew(this,"__CACHE",!1,!0),dpew(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(t){this.setVersion(t)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(t){this.setLocktime(t)}get txInputs(){return this.__CACHE.__TX.ins.map(t=>({hash:(0,c.cloneBuffer)(t.hash),index:t.index,sequence:t.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(t=>{let e;try{e=(0,u.fromOutputScript)(t.script,this.opts.network)}catch(t){}return{script:(0,c.cloneBuffer)(t.script),value:t.value,address:e}})}combine(...t){return this.data.combine(...t.map(t=>t.data)),this}clone(){let t=Psbt.fromBuffer(this.data.toBuffer());return t.opts=JSON.parse(JSON.stringify(this.opts)),t}setMaximumFeeRate(t){check32Bit(t),this.opts.maximumFeeRate=t}setVersion(t){check32Bit(t),checkInputsForPartialSig(this.data.inputs,"setVersion");let e=this.__CACHE;return e.__TX.version=t,e.__EXTRACTED_TX=void 0,this}setLocktime(t){check32Bit(t),checkInputsForPartialSig(this.data.inputs,"setLocktime");let e=this.__CACHE;return e.__TX.locktime=t,e.__EXTRACTED_TX=void 0,this}setInputSequence(t,e){check32Bit(e),checkInputsForPartialSig(this.data.inputs,"setInputSequence");let i=this.__CACHE;if(i.__TX.ins.length<=t)throw Error("Input index too high");return i.__TX.ins[t].sequence=e,i.__EXTRACTED_TX=void 0,this}addInputs(t){return t.forEach(t=>this.addInput(t)),this}addInput(t){if(arguments.length>1||!t||void 0===t.hash||void 0===t.index)throw Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");(0,S.checkTaprootInputFields)(t,t,"addInput"),checkInputsForPartialSig(this.data.inputs,"addInput"),t.witnessScript&&checkInvalidP2WSH(t.witnessScript);let e=this.__CACHE;this.data.addInput(t);let i=e.__TX.ins[e.__TX.ins.length-1];checkTxInputCache(e,i);let n=this.data.inputs.length-1,s=this.data.inputs[n];return s.nonWitnessUtxo&&addNonWitnessTxCache(this.__CACHE,s,n),e.__FEE=void 0,e.__FEE_RATE=void 0,e.__EXTRACTED_TX=void 0,this}addOutputs(t){return t.forEach(t=>this.addOutput(t)),this}addOutput(t){if(arguments.length>1||!t||void 0===t.value||void 0===t.address&&void 0===t.script)throw Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");checkInputsForPartialSig(this.data.inputs,"addOutput");let{address:e}=t;if("string"==typeof e){let{network:i}=this.opts,n=(0,u.toOutputScript)(e,i);t=Object.assign({},t,{script:n})}(0,S.checkTaprootOutputFields)(t,t,"addOutput");let i=this.__CACHE;return this.data.addOutput(t),i.__FEE=void 0,i.__FEE_RATE=void 0,i.__EXTRACTED_TX=void 0,this}extractTransaction(t){if(!this.data.inputs.every(isFinalized))throw Error("Not finalized");let e=this.__CACHE;if(t||function(t,e,i){let n=e.__FEE_RATE||t.getFeeRate(),s=e.__EXTRACTED_TX.virtualSize();if(n>=i.maximumFeeRate)throw Error(`Warning: You are paying around ${(n*s/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${s} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}(this,e,this.opts),e.__EXTRACTED_TX)return e.__EXTRACTED_TX;let i=e.__TX.clone();return inputFinalizeGetAmts(this.data.inputs,i,e,!0),i}getFeeRate(){return getTxCacheValue("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return getTxCacheValue("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return(0,a.checkForInput)(this.data.inputs,0),range(this.data.inputs.length).forEach(t=>this.finalizeInput(t)),this}finalizeInput(t,e){let i=(0,a.checkForInput)(this.data.inputs,t);return(0,S.isTaprootInput)(i)?this._finalizeTaprootInput(t,i,void 0,e):this._finalizeInput(t,i,e)}finalizeTaprootInput(t,e,i=S.tapScriptFinalizer){let n=(0,a.checkForInput)(this.data.inputs,t);if((0,S.isTaprootInput)(n))return this._finalizeTaprootInput(t,n,e,i);throw Error(`Cannot finalize input #${t}. Not Taproot.`)}_finalizeInput(t,e,i=getFinalScripts){let{script:n,isP2SH:s,isP2WSH:o,isSegwit:a}=function(t,e,i){let n=i.__TX,s={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(s.isP2SH=!!e.redeemScript,s.isP2WSH=!!e.witnessScript,e.witnessScript)s.script=e.witnessScript;else if(e.redeemScript)s.script=e.redeemScript;else if(e.nonWitnessUtxo){let o=nonWitnessUtxoTxFromCache(i,e,t),a=n.ins[t].index;s.script=o.outs[a].script}else e.witnessUtxo&&(s.script=e.witnessUtxo.script);return(e.witnessScript||(0,v.isP2WPKH)(s.script))&&(s.isSegwit=!0),s}(t,e,this.__CACHE);if(!n)throw Error(`No script found for input #${t}`);!function(t){if(!t.sighashType||!t.partialSig)return;let{partialSig:e,sighashType:i}=t;e.forEach(t=>{let{hashType:e}=m.signature.decode(t.signature);if(i!==e)throw Error("Signature sighash does not match input sighash type")})}(e);let{finalScriptSig:u,finalScriptWitness:c}=i(t,e,n,a,s,o);if(u&&this.data.updateInput(t,{finalScriptSig:u}),c&&this.data.updateInput(t,{finalScriptWitness:c}),!u&&!c)throw Error(`Unknown error finalizing input #${t}`);return this.data.clearFinalizedInput(t),this}_finalizeTaprootInput(t,e,i,n=S.tapScriptFinalizer){if(!e.witnessUtxo)throw Error(`Cannot finalize input #${t}. Missing withness utxo.`);if(e.tapKeySig){let i=y.p2tr({output:e.witnessUtxo.script,signature:e.tapKeySig}),n=(0,v.witnessStackToScriptWitness)(i.witness);this.data.updateInput(t,{finalScriptWitness:n})}else{let{finalScriptWitness:s}=n(t,e,i);this.data.updateInput(t,{finalScriptWitness:s})}return this.data.clearFinalizedInput(t),this}getInputType(t){let e=(0,a.checkForInput)(this.data.inputs,t),i=getScriptFromUtxo(t,e,this.__CACHE),s=getMeaningfulScript(i,t,"input",e.redeemScript||function(t){if(!t)return;let e=m.decompile(t);if(!e)return;let i=e[e.length-1];if(!n.isBuffer(i)||isPubkeyLike(i)||m.isCanonicalScriptSignature(i))return;let s=m.decompile(i);if(s)return i}(e.finalScriptSig),e.witnessScript||function(t){if(!t)return;let e=scriptWitnessToWitnessStack(t),i=e[e.length-1];if(isPubkeyLike(i))return;let n=m.decompile(i);if(n)return i}(e.finalScriptWitness)),o="raw"===s.type?"":s.type+"-",u=classifyScript(s.meaningfulScript);return o+u}inputHasPubkey(t,e){let i=(0,a.checkForInput)(this.data.inputs,t);return function(t,e,i,n){let s=getScriptFromUtxo(i,e,n),{meaningfulScript:o}=getMeaningfulScript(s,i,"input",e.redeemScript,e.witnessScript);return(0,v.pubkeyInScript)(t,o)}(e,i,t,this.__CACHE)}inputHasHDKey(t,e){let i=(0,a.checkForInput)(this.data.inputs,t),n=bip32DerivationIsMine(e);return!!i.bip32Derivation&&i.bip32Derivation.some(n)}outputHasPubkey(t,e){let i=(0,a.checkForOutput)(this.data.outputs,t);return function(t,e,i,n){let s=n.__TX.outs[i].script,{meaningfulScript:o}=getMeaningfulScript(s,i,"output",e.redeemScript,e.witnessScript);return(0,v.pubkeyInScript)(t,o)}(e,i,t,this.__CACHE)}outputHasHDKey(t,e){let i=(0,a.checkForOutput)(this.data.outputs,t),n=bip32DerivationIsMine(e);return!!i.bip32Derivation&&i.bip32Derivation.some(n)}validateSignaturesOfAllInputs(t){(0,a.checkForInput)(this.data.inputs,0);let e=range(this.data.inputs.length).map(e=>this.validateSignaturesOfInput(e,t));return e.reduce((t,e)=>!0===e&&t,!0)}validateSignaturesOfInput(t,e,i){let n=this.data.inputs[t];return(0,S.isTaprootInput)(n)?this.validateSignaturesOfTaprootInput(t,e,i):this._validateSignaturesOfInput(t,e,i)}_validateSignaturesOfInput(t,e,i){let n,s,o;let a=this.data.inputs[t],u=(a||{}).partialSig;if(!a||!u||u.length<1)throw Error("No signatures to validate");if("function"!=typeof e)throw Error("Need validator function to validate signatures");let c=i?u.filter(t=>t.pubkey.equals(i)):u;if(c.length<1)throw Error("No signatures for this pubkey");let p=[];for(let i of c){let u=m.signature.decode(i.signature),{hash:c,script:y}=o!==u.hashType?getHashForSig(t,Object.assign({},a,{sighashType:u.hashType}),this.__CACHE,!0):{hash:n,script:s};o=u.hashType,n=c,s=y,checkScriptForPubkey(i.pubkey,y,"verify"),p.push(e(i.pubkey,c,u.signature))}return p.every(t=>!0===t)}validateSignaturesOfTaprootInput(t,e,i){let n=this.data.inputs[t],s=(n||{}).tapKeySig,o=(n||{}).tapScriptSig;if(!n&&!s&&!(o&&!o.length))throw Error("No signatures to validate");if("function"!=typeof e)throw Error("Need validator function to validate signatures");i=i&&(0,S.toXOnly)(i);let a=i?getTaprootHashesForSig(t,n,this.data.inputs,i,this.__CACHE):function(t,e,i,n){let s=[];if(e.tapInternalKey){let i=getPrevoutTaprootKey(t,e,n);i&&s.push(i)}if(e.tapScriptSig){let t=e.tapScriptSig.map(t=>t.pubkey);s.push(...t)}let o=s.map(s=>getTaprootHashesForSig(t,e,i,s,n));return o.flat()}(t,n,this.data.inputs,this.__CACHE);if(!a.length)throw Error("No signatures for this pubkey");let u=a.find(t=>!t.leafHash),c=0;if(s&&u){let t=e(u.pubkey,u.hash,trimTaprootSig(s));if(!t)return!1;c++}if(o)for(let t of o){let i=a.find(e=>t.pubkey.equals(e.pubkey));if(i){let n=e(t.pubkey,i.hash,trimTaprootSig(t.signature));if(!n)return!1;c++}}return c>0}signAllInputsHD(t,e=[b.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw Error("Need HDSigner to sign input");let i=[];for(let n of range(this.data.inputs.length))try{this.signInputHD(n,t,e),i.push(!0)}catch(t){i.push(!1)}if(i.every(t=>!1===t))throw Error("No inputs were signed");return this}signAllInputsHDAsync(t,e=[b.Transaction.SIGHASH_ALL]){return new Promise((i,n)=>{if(!t||!t.publicKey||!t.fingerprint)return n(Error("Need HDSigner to sign input"));let s=[],o=[];for(let i of range(this.data.inputs.length))o.push(this.signInputHDAsync(i,t,e).then(()=>{s.push(!0)},()=>{s.push(!1)}));return Promise.all(o).then(()=>{if(s.every(t=>!1===t))return n(Error("No inputs were signed"));i()})})}signInputHD(t,e,i=[b.Transaction.SIGHASH_ALL]){if(!e||!e.publicKey||!e.fingerprint)throw Error("Need HDSigner to sign input");let n=getSignersFromHD(t,this.data.inputs,e);return n.forEach(e=>this.signInput(t,e,i)),this}signInputHDAsync(t,e,i=[b.Transaction.SIGHASH_ALL]){return new Promise((n,s)=>{if(!e||!e.publicKey||!e.fingerprint)return s(Error("Need HDSigner to sign input"));let o=getSignersFromHD(t,this.data.inputs,e),a=o.map(e=>this.signInputAsync(t,e,i));return Promise.all(a).then(()=>{n()}).catch(s)})}signAllInputs(t,e){if(!t||!t.publicKey)throw Error("Need Signer to sign input");let i=[];for(let n of range(this.data.inputs.length))try{this.signInput(n,t,e),i.push(!0)}catch(t){i.push(!1)}if(i.every(t=>!1===t))throw Error("No inputs were signed");return this}signAllInputsAsync(t,e){return new Promise((i,n)=>{if(!t||!t.publicKey)return n(Error("Need Signer to sign input"));let s=[],o=[];for(let[i]of this.data.inputs.entries())o.push(this.signInputAsync(i,t,e).then(()=>{s.push(!0)},()=>{s.push(!1)}));return Promise.all(o).then(()=>{if(s.every(t=>!1===t))return n(Error("No inputs were signed"));i()})})}signInput(t,e,i){if(!e||!e.publicKey)throw Error("Need Signer to sign input");let n=(0,a.checkForInput)(this.data.inputs,t);return(0,S.isTaprootInput)(n)?this._signTaprootInput(t,n,e,void 0,i):this._signInput(t,e,i)}signTaprootInput(t,e,i,n){if(!e||!e.publicKey)throw Error("Need Signer to sign input");let s=(0,a.checkForInput)(this.data.inputs,t);if((0,S.isTaprootInput)(s))return this._signTaprootInput(t,s,e,i,n);throw Error(`Input #${t} is not of type Taproot.`)}_signInput(t,e,i=[b.Transaction.SIGHASH_ALL]){let{hash:n,sighashType:s}=getHashAndSighashType(this.data.inputs,t,e.publicKey,this.__CACHE,i),o=[{pubkey:e.publicKey,signature:m.signature.encode(e.sign(n),s)}];return this.data.updateInput(t,{partialSig:o}),this}_signTaprootInput(t,e,i,n,s=[b.Transaction.SIGHASH_DEFAULT]){let o=this.checkTaprootHashesForSig(t,e,i,n,s),a=o.filter(t=>!t.leafHash).map(t=>(0,S.serializeTaprootSignature)(i.signSchnorr(t.hash),e.sighashType))[0],u=o.filter(t=>!!t.leafHash).map(t=>({pubkey:(0,S.toXOnly)(i.publicKey),signature:(0,S.serializeTaprootSignature)(i.signSchnorr(t.hash),e.sighashType),leafHash:t.leafHash}));return a&&this.data.updateInput(t,{tapKeySig:a}),u.length&&this.data.updateInput(t,{tapScriptSig:u}),this}signInputAsync(t,e,i){return Promise.resolve().then(()=>{if(!e||!e.publicKey)throw Error("Need Signer to sign input");let n=(0,a.checkForInput)(this.data.inputs,t);return(0,S.isTaprootInput)(n)?this._signTaprootInputAsync(t,n,e,void 0,i):this._signInputAsync(t,e,i)})}signTaprootInputAsync(t,e,i,n){return Promise.resolve().then(()=>{if(!e||!e.publicKey)throw Error("Need Signer to sign input");let s=(0,a.checkForInput)(this.data.inputs,t);if((0,S.isTaprootInput)(s))return this._signTaprootInputAsync(t,s,e,i,n);throw Error(`Input #${t} is not of type Taproot.`)})}_signInputAsync(t,e,i=[b.Transaction.SIGHASH_ALL]){let{hash:n,sighashType:s}=getHashAndSighashType(this.data.inputs,t,e.publicKey,this.__CACHE,i);return Promise.resolve(e.sign(n)).then(i=>{let n=[{pubkey:e.publicKey,signature:m.signature.encode(i,s)}];this.data.updateInput(t,{partialSig:n})})}async _signTaprootInputAsync(t,e,i,n,s=[b.Transaction.SIGHASH_DEFAULT]){let o=this.checkTaprootHashesForSig(t,e,i,n,s),a=[],u=o.filter(t=>!t.leafHash)[0];if(u){let t=Promise.resolve(i.signSchnorr(u.hash)).then(t=>({tapKeySig:(0,S.serializeTaprootSignature)(t,e.sighashType)}));a.push(t)}let c=o.filter(t=>!!t.leafHash);if(c.length){let t=c.map(t=>Promise.resolve(i.signSchnorr(t.hash)).then(n=>{let s=[{pubkey:(0,S.toXOnly)(i.publicKey),signature:(0,S.serializeTaprootSignature)(n,e.sighashType),leafHash:t.leafHash}];return{tapScriptSig:s}}));a.push(...t)}return Promise.all(a).then(e=>{e.forEach(e=>this.data.updateInput(t,e))})}checkTaprootHashesForSig(t,e,i,n,s){if("function"!=typeof i.signSchnorr)throw Error(`Need Schnorr Signer to sign taproot input #${t}.`);let o=getTaprootHashesForSig(t,e,this.data.inputs,i.publicKey,this.__CACHE,n,s);if(!o||!o.length)throw Error(`Can not sign for input #${t} with the key ${i.publicKey.toString("hex")}`);return o}toBuffer(){return checkCache(this.__CACHE),this.data.toBuffer()}toHex(){return checkCache(this.__CACHE),this.data.toHex()}toBase64(){return checkCache(this.__CACHE),this.data.toBase64()}updateGlobal(t){return this.data.updateGlobal(t),this}updateInput(t,e){return e.witnessScript&&checkInvalidP2WSH(e.witnessScript),(0,S.checkTaprootInputFields)(this.data.inputs[t],e,"updateInput"),this.data.updateInput(t,e),e.nonWitnessUtxo&&addNonWitnessTxCache(this.__CACHE,this.data.inputs[t],t),this}updateOutput(t,e){let i=this.data.outputs[t];return(0,S.checkTaprootOutputFields)(i,e,"updateOutput"),this.data.updateOutput(t,e),this}addUnknownKeyValToGlobal(t){return this.data.addUnknownKeyValToGlobal(t),this}addUnknownKeyValToInput(t,e){return this.data.addUnknownKeyValToInput(t,e),this}addUnknownKeyValToOutput(t,e){return this.data.addUnknownKeyValToOutput(t,e),this}clearFinalizedInput(t){return this.data.clearFinalizedInput(t),this}};e.Psbt=Psbt;let transactionFromBuffer=t=>new PsbtTransaction(t);let PsbtTransaction=class PsbtTransaction{constructor(t=n.from([2,0,0,0,0,0,0,0,0,0])){this.tx=b.Transaction.fromBuffer(t),function(t){let e=t.ins.every(t=>t.script&&0===t.script.length&&t.witness&&0===t.witness.length);if(!e)throw Error("Format Error: Transaction ScriptSigs are not empty")}(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(void 0===t.hash||void 0===t.index||!n.isBuffer(t.hash)&&"string"!=typeof t.hash||"number"!=typeof t.index)throw Error("Error adding input.");let e="string"==typeof t.hash?(0,c.reverseBuffer)(n.from(t.hash,"hex")):t.hash;this.tx.addInput(e,t.index,t.sequence)}addOutput(t){if(void 0===t.script||void 0===t.value||!n.isBuffer(t.script)||"number"!=typeof t.value)throw Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}};function checkCache(t){if(!1!==t.__UNSAFE_SIGN_NONSEGWIT)throw Error("Not BIP174 compliant, can not export")}function hasSigs(t,e,i){let n;if(!e)return!1;if((n=i?i.map(t=>{let i=function(t){if(65===t.length){let e=1&t[64],i=t.slice(0,33);return i[0]=2|e,i}return t.slice()}(t);return e.find(t=>t.pubkey.equals(i))}).filter(t=>!!t):e).length>t)throw Error("Too many signatures");return n.length===t}function isFinalized(t){return!!t.finalScriptSig||!!t.finalScriptWitness}function bip32DerivationIsMine(t){return e=>!!(e.masterFingerprint.equals(t.fingerprint)&&t.derivePath(e.path).publicKey.equals(e.pubkey))}function check32Bit(t){if("number"!=typeof t||t!==Math.floor(t)||t>4294967295||t<0)throw Error("Invalid 32 bit integer")}function checkInputsForPartialSig(t,e){t.forEach(t=>{let i=(0,S.isTaprootInput)(t)?(0,S.checkTaprootInputForSigs)(t,e):(0,v.checkInputForSig)(t,e);if(i)throw Error("Can not modify transaction, signatures exist.")})}function checkScriptForPubkey(t,e,i){if(!(0,v.pubkeyInScript)(t,e))throw Error(`Can not ${i} for this input with the key ${t.toString("hex")}`)}function checkTxInputCache(t,e){let i=(0,c.reverseBuffer)(n.from(e.hash)).toString("hex")+":"+e.index;if(t.__TX_IN_CACHE[i])throw Error("Duplicate input detected.");t.__TX_IN_CACHE[i]=1}function scriptCheckerFactory(t,e){return(i,n,s,o)=>{let a=t({redeem:{output:s}}).output;if(!n.equals(a))throw Error(`${e} for ${o} #${i} doesn't match the scriptPubKey in the prevout`)}}let P=scriptCheckerFactory(y.p2sh,"Redeem script"),w=scriptCheckerFactory(y.p2wsh,"Witness script");function getTxCacheValue(t,e,i,n){let s;if(!i.every(isFinalized))throw Error(`PSBT must be finalized to calculate ${e}`);if("__FEE_RATE"===t&&n.__FEE_RATE)return n.__FEE_RATE;if("__FEE"===t&&n.__FEE)return n.__FEE;let o=!0;return(n.__EXTRACTED_TX?(s=n.__EXTRACTED_TX,o=!1):s=n.__TX.clone(),inputFinalizeGetAmts(i,s,n,o),"__FEE_RATE"===t)?n.__FEE_RATE:"__FEE"===t?n.__FEE:void 0}function getFinalScripts(t,e,i,n,s,o){let a=classifyScript(i);if(!function(t,e,i){switch(i){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return hasSigs(1,t.partialSig);case"multisig":let n=y.p2ms({output:e});return hasSigs(n.m,t.partialSig,n.pubkeys);default:return!1}}(e,i,a))throw Error(`Can not finalize input #${t}`);return function(t,e,i,n,s,o){let a,u;let c=function(t,e,i){let n;switch(e){case"multisig":let s=function(t,e){let i=y.p2ms({output:t});return i.pubkeys.map(t=>(e.filter(e=>e.pubkey.equals(t))[0]||{}).signature).filter(t=>!!t)}(t,i);n=y.p2ms({output:t,signatures:s});break;case"pubkey":n=y.p2pk({output:t,signature:i[0].signature});break;case"pubkeyhash":n=y.p2pkh({output:t,pubkey:i[0].pubkey,signature:i[0].signature});break;case"witnesspubkeyhash":n=y.p2wpkh({output:t,pubkey:i[0].pubkey,signature:i[0].signature})}return n}(t,e,i),p=o?y.p2wsh({redeem:c}):null,g=s?y.p2sh({redeem:p||c}):null;return n?(u=p?(0,v.witnessStackToScriptWitness)(p.witness):(0,v.witnessStackToScriptWitness)(c.witness),g&&(a=g.input)):a=g?g.input:c.input,{finalScriptSig:a,finalScriptWitness:u}}(i,a,e.partialSig,n,s,o)}function getHashAndSighashType(t,e,i,n,s){let o=(0,a.checkForInput)(t,e),{hash:u,sighashType:c,script:p}=getHashForSig(e,o,n,!1,s);return checkScriptForPubkey(i,p,"sign"),{hash:u,sighashType:c}}function getHashForSig(t,e,i,n,s){let o,a;let u=i.__TX,c=e.sighashType||b.Transaction.SIGHASH_ALL;if(checkSighashTypeAllowed(c,s),e.nonWitnessUtxo){let n=nonWitnessUtxoTxFromCache(i,e,t),s=u.ins[t].hash,o=n.getHash();if(!s.equals(o))throw Error(`Non-witness UTXO hash for input #${t} doesn't match the hash specified in the prevout`);let c=u.ins[t].index;a=n.outs[c]}else if(e.witnessUtxo)a=e.witnessUtxo;else throw Error("Need a Utxo input item for signing");let{meaningfulScript:p,type:g}=getMeaningfulScript(a.script,t,"input",e.redeemScript,e.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(g)>=0)o=u.hashForWitnessV0(t,p,a.value,c);else if((0,v.isP2WPKH)(p)){let e=y.p2pkh({hash:p.slice(2)}).output;o=u.hashForWitnessV0(t,e,a.value,c)}else{if(void 0===e.nonWitnessUtxo&&!1===i.__UNSAFE_SIGN_NONSEGWIT)throw Error(`Input #${t} has witnessUtxo but non-segwit script: ${p.toString("hex")}`);n||!1===i.__UNSAFE_SIGN_NONSEGWIT||console.warn("Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecessor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.\n*********************\nPROCEED WITH CAUTION!\n*********************"),o=u.hashForSignature(t,p,c)}return{script:p,sighashType:c,hash:o}}function getPrevoutTaprootKey(t,e,i){let{script:n}=getScriptAndAmountFromUtxo(t,e,i);return(0,v.isP2TR)(n)?n.subarray(2,34):null}function trimTaprootSig(t){return 64===t.length?t:t.subarray(0,64)}function getTaprootHashesForSig(t,e,i,s,o,a,u){let c=o.__TX,p=e.sighashType||b.Transaction.SIGHASH_DEFAULT;checkSighashTypeAllowed(p,u);let y=i.map((t,e)=>getScriptAndAmountFromUtxo(e,t,o)),m=y.map(t=>t.script),_=y.map(t=>t.value),P=[];if(e.tapInternalKey&&!a){let i=getPrevoutTaprootKey(t,e,o)||n.from([]);if((0,S.toXOnly)(s).equals(i)){let e=c.hashForWitnessV1(t,m,_,p);P.push({pubkey:s,hash:e})}}let w=(e.tapLeafScript||[]).filter(t=>(0,v.pubkeyInScript)(s,t.script)).map(t=>{let e=(0,g.tapleafHash)({output:t.script,version:t.leafVersion});return Object.assign({hash:e},t)}).filter(t=>!a||a.equals(t.hash)).map(e=>{let i=c.hashForWitnessV1(t,m,_,p,e.hash);return{pubkey:s,hash:i,leafHash:e.hash}});return P.concat(w)}function checkSighashTypeAllowed(t,e){if(e&&0>e.indexOf(t)){let e=function(t){let e=t&b.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(31&t){case b.Transaction.SIGHASH_ALL:e+="SIGHASH_ALL";break;case b.Transaction.SIGHASH_SINGLE:e+="SIGHASH_SINGLE";break;case b.Transaction.SIGHASH_NONE:e+="SIGHASH_NONE"}return e}(t);throw Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${e}`)}}function getSignersFromHD(t,e,i){let n=(0,a.checkForInput)(e,t);if(!n.bip32Derivation||0===n.bip32Derivation.length)throw Error("Need bip32Derivation to sign with HD");let s=n.bip32Derivation.map(t=>t.masterFingerprint.equals(i.fingerprint)?t:void 0).filter(t=>!!t);if(0===s.length)throw Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");let o=s.map(t=>{let e=i.derivePath(t.path);if(!t.pubkey.equals(e.publicKey))throw Error("pubkey did not match bip32Derivation");return e});return o}function scriptWitnessToWitnessStack(t){let e=0;function readVarInt(){let i=o.decode(t,e);return e+=o.decode.bytes,i}return function(){let i=readVarInt(),n=[];for(let s=0;s<i;s++)n.push(function(){var i;return i=readVarInt(),e+=i,t.slice(e-i,e)}());return n}()}function addNonWitnessTxCache(t,e,i){t.__NON_WITNESS_UTXO_BUF_CACHE[i]=e.nonWitnessUtxo;let n=b.Transaction.fromBuffer(e.nonWitnessUtxo);t.__NON_WITNESS_UTXO_TX_CACHE[i]=n,delete e.nonWitnessUtxo,Object.defineProperty(e,"nonWitnessUtxo",{enumerable:!0,get(){let e=t.__NON_WITNESS_UTXO_BUF_CACHE[i],n=t.__NON_WITNESS_UTXO_TX_CACHE[i];if(void 0!==e)return e;{let e=n.toBuffer();return t.__NON_WITNESS_UTXO_BUF_CACHE[i]=e,e}},set(e){t.__NON_WITNESS_UTXO_BUF_CACHE[i]=e}})}function inputFinalizeGetAmts(t,e,i,n){let s=0;t.forEach((t,o)=>{if(n&&t.finalScriptSig&&(e.ins[o].script=t.finalScriptSig),n&&t.finalScriptWitness&&(e.ins[o].witness=scriptWitnessToWitnessStack(t.finalScriptWitness)),t.witnessUtxo)s+=t.witnessUtxo.value;else if(t.nonWitnessUtxo){let n=nonWitnessUtxoTxFromCache(i,t,o),a=e.ins[o].index,u=n.outs[a];s+=u.value}});let o=e.outs.reduce((t,e)=>t+e.value,0),a=s-o;if(a<0)throw Error("Outputs are spending more than Inputs");let u=e.virtualSize();i.__FEE=a,i.__EXTRACTED_TX=e,i.__FEE_RATE=Math.floor(a/u)}function nonWitnessUtxoTxFromCache(t,e,i){let n=t.__NON_WITNESS_UTXO_TX_CACHE;return n[i]||addNonWitnessTxCache(t,e,i),n[i]}function getScriptFromUtxo(t,e,i){let{script:n}=getScriptAndAmountFromUtxo(t,e,i);return n}function getScriptAndAmountFromUtxo(t,e,i){if(void 0!==e.witnessUtxo)return{script:e.witnessUtxo.script,value:e.witnessUtxo.value};if(void 0!==e.nonWitnessUtxo){let n=nonWitnessUtxoTxFromCache(i,e,t),s=n.outs[i.__TX.ins[t].index];return{script:s.script,value:s.value}}throw Error("Can't find pubkey in input without Utxo data")}function isPubkeyLike(t){return 33===t.length&&m.isCanonicalPubKey(t)}function getMeaningfulScript(t,e,i,n,s){let o;let a=(0,v.isP2SHScript)(t),u=a&&n&&(0,v.isP2WSHScript)(n),c=(0,v.isP2WSHScript)(t);if(a&&void 0===n)throw Error("scriptPubkey is P2SH but redeemScript missing");if((c||u)&&void 0===s)throw Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");return u?(o=s,P(e,t,n,i),w(e,n,s,i),checkInvalidP2WSH(o)):c?(o=s,w(e,t,s,i),checkInvalidP2WSH(o)):a?(o=n,P(e,t,n,i)):o=t,{meaningfulScript:o,type:u?"p2sh-p2wsh":a?"p2sh":c?"p2wsh":"raw"}}function checkInvalidP2WSH(t){if((0,v.isP2WPKH)(t)||(0,v.isP2SHScript)(t))throw Error("P2WPKH or P2SH can not be contained within P2WSH")}function classifyScript(t){return(0,v.isP2WPKH)(t)?"witnesspubkeyhash":(0,v.isP2PKH)(t)?"pubkeyhash":(0,v.isP2MS)(t)?"multisig":(0,v.isP2PK)(t)?"pubkey":"nonstandard"}function range(t){return[...Array(t).keys()]}},23064:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.checkTaprootInputForSigs=e.tapTreeFromList=e.tapTreeToList=e.tweakInternalPubKey=e.checkTaprootOutputFields=e.checkTaprootInputFields=e.isTaprootOutput=e.isTaprootInput=e.serializeTaprootSignature=e.tapScriptFinalizer=e.toXOnly=void 0;let s=i(41838),o=i(82737),a=i(87929),u=i(12227),c=i(84972),p=i(87929);function isTaprootInput(t){return t&&!!(t.tapInternalKey||t.tapMerkleRoot||t.tapLeafScript&&t.tapLeafScript.length||t.tapBip32Derivation&&t.tapBip32Derivation.length||t.witnessUtxo&&(0,a.isP2TR)(t.witnessUtxo.script))}function isTaprootOutput(t,e){return t&&!!(t.tapInternalKey||t.tapTree||t.tapBip32Derivation&&t.tapBip32Derivation.length||e&&(0,a.isP2TR)(e))}function tapTreeFromList(t=[]){return 1===t.length&&0===t[0].depth?{output:t[0].script,version:t[0].leafVersion}:function(t){let e;for(let i of t)if(!(e=function instertLeafInTree(t,e,i=0){if(i>u.MAX_TAPTREE_DEPTH)throw Error("Max taptree depth exceeded.");if(t.depth===i)return e?void 0:{output:t.script,version:t.leafVersion};if((0,s.isTapleaf)(e))return;let n=instertLeafInTree(t,e&&e[0],i+1);if(n)return[n,e&&e[1]];let o=instertLeafInTree(t,e&&e[1],i+1);if(o)return[e&&e[0],o]}(i,e)))throw Error("No room left to insert tapleaf in tree");return e}(t)}function decodeSchnorrSignature(t){return{signature:t.slice(0,64),hashType:t.slice(64)[0]||o.Transaction.SIGHASH_DEFAULT}}function isTapLeafInTree(t,e){if(!e)return!0;let i=(0,u.tapleafHash)({output:t.script,version:t.leafVersion}),n=(0,u.rootHashFromPath)(t.controlBlock,i);return n.equals(e)}function hasNonTaprootFields(t){return t&&!!(t.redeemScript||t.witnessScript||t.bip32Derivation&&t.bip32Derivation.length)}e.toXOnly=t=>32===t.length?t:t.slice(1,33),e.tapScriptFinalizer=function(t,e,i){let n=function(t,e,i){if(!t.tapScriptSig||!t.tapScriptSig.length)throw Error(`Can not finalize taproot input #${e}. No tapleaf script signature provided.`);let n=(t.tapLeafScript||[]).sort((t,e)=>t.controlBlock.length-e.controlBlock.length).find(e=>(function(t,e,i){let n=(0,u.tapleafHash)({output:t.script,version:t.leafVersion}),s=!i||i.equals(n);return s&&void 0!==e.find(t=>t.leafHash.equals(n))})(e,t.tapScriptSig,i));if(!n)throw Error(`Can not finalize taproot input #${e}. Signature for tapleaf script not found.`);return n}(e,t,i);try{let t=function(t,e){let i=(0,u.tapleafHash)({output:e.script,version:e.leafVersion});return(t.tapScriptSig||[]).filter(t=>t.leafHash.equals(i)).map(t=>{var i;return i=e.script,Object.assign({positionInScript:(0,a.pubkeyPositionInScript)(t.pubkey,i)},t)}).sort((t,e)=>e.positionInScript-t.positionInScript).map(t=>t.signature)}(e,n),i=t.concat(n.script).concat(n.controlBlock);return{finalScriptWitness:(0,a.witnessStackToScriptWitness)(i)}}catch(e){throw Error(`Can not finalize taproot input #${t}: ${e}`)}},e.serializeTaprootSignature=function(t,e){let i=e?n.from([e]):n.from([]);return n.concat([t,i])},e.isTaprootInput=isTaprootInput,e.isTaprootOutput=isTaprootOutput,e.checkTaprootInputFields=function(t,e,i){(function(t,e,i){let n=isTaprootInput(t)&&hasNonTaprootFields(e),s=hasNonTaprootFields(t)&&isTaprootInput(e),o=t===e&&isTaprootInput(e)&&hasNonTaprootFields(e);if(n||s||o)throw Error(`Invalid arguments for Psbt.${i}. Cannot use both taproot and non-taproot fields.`)})(t,e,i),function(t,e,i){if(e.tapMerkleRoot){let n=(e.tapLeafScript||[]).every(t=>isTapLeafInTree(t,e.tapMerkleRoot)),s=(t.tapLeafScript||[]).every(t=>isTapLeafInTree(t,e.tapMerkleRoot));if(!n||!s)throw Error(`Invalid arguments for Psbt.${i}. Tapleaf not part of taptree.`)}else if(t.tapMerkleRoot){let n=(e.tapLeafScript||[]).every(e=>isTapLeafInTree(e,t.tapMerkleRoot));if(!n)throw Error(`Invalid arguments for Psbt.${i}. Tapleaf not part of taptree.`)}}(t,e,i)},e.checkTaprootOutputFields=function(t,e,i){(function(t,e,i){let n=isTaprootOutput(t)&&hasNonTaprootFields(e),s=hasNonTaprootFields(t)&&isTaprootOutput(e),o=t===e&&isTaprootOutput(e)&&hasNonTaprootFields(e);if(n||s||o)throw Error(`Invalid arguments for Psbt.${i}. Cannot use both taproot and non-taproot fields.`)})(t,e,i),function(t,e){if(!e.tapTree&&!e.tapInternalKey)return;let i=e.tapInternalKey||t.tapInternalKey,n=e.tapTree||t.tapTree;if(i){let{script:e}=t,s=function(t,e){let i=e&&tapTreeFromList(e.leaves),{output:n}=(0,c.p2tr)({internalPubkey:t,scriptTree:i});return n}(i,n);if(e&&!e.equals(s))throw Error("Error adding output. Script or address missmatch.")}}(t,e)},e.tweakInternalPubKey=function(t,e){let i=e.tapInternalKey,n=i&&(0,u.tweakKey)(i,e.tapMerkleRoot);if(!n)throw Error(`Cannot tweak tap internal key for input #${t}. Public key: ${i&&i.toString("hex")}`);return n.x},e.tapTreeToList=function(t){if(!(0,s.isTaptree)(t))throw Error("Cannot convert taptree to tapleaf list. Expecting a tapree structure.");return function _tapTreeToList(t,e=[],i=0){if(i>u.MAX_TAPTREE_DEPTH)throw Error("Max taptree depth exceeded.");return t?((0,s.isTapleaf)(t)?e.push({depth:i,leafVersion:t.version||u.LEAF_VERSION_TAPSCRIPT,script:t.output}):(t[0]&&_tapTreeToList(t[0],e,i+1),t[1]&&_tapTreeToList(t[1],e,i+1)),e):[]}(t)},e.tapTreeFromList=tapTreeFromList,e.checkTaprootInputForSigs=function(t,e){let i=function(t){let e=[];if(t.tapKeySig&&e.push(t.tapKeySig),t.tapScriptSig&&e.push(...t.tapScriptSig.map(t=>t.signature)),!e.length){let i=function(t){if(!t)return;let e=t.slice(2);if(64===e.length||65===e.length)return e}(t.finalScriptWitness);i&&e.push(i)}return e}(t);return i.some(t=>(0,p.signatureBlocksAction)(t,decodeSchnorrSignature,e))}},87929:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.signatureBlocksAction=e.checkInputForSig=e.pubkeyInScript=e.pubkeyPositionInScript=e.witnessStackToScriptWitness=e.isP2TR=e.isP2SHScript=e.isP2WSHScript=e.isP2WPKH=e.isP2PKH=e.isP2PK=e.isP2MS=void 0;let s=i(3493),o=i(73357),a=i(82737),u=i(5525),c=i(84972);function isPaymentFactory(t){return e=>{try{return t({output:e}),!0}catch(t){return!1}}}function pubkeyPositionInScript(t,e){let i=(0,u.hash160)(t),n=t.slice(1,33),s=o.decompile(e);if(null===s)throw Error("Unknown script error");return s.findIndex(e=>"number"!=typeof e&&(e.equals(t)||e.equals(i)||e.equals(n)))}function signatureBlocksAction(t,e,i){let{hashType:n}=e(t),s=[],o=n&a.Transaction.SIGHASH_ANYONECANPAY;switch(o&&s.push("addInput"),31&n){case a.Transaction.SIGHASH_ALL:break;case a.Transaction.SIGHASH_SINGLE:case a.Transaction.SIGHASH_NONE:s.push("addOutput"),s.push("setInputSequence")}return -1===s.indexOf(i)}e.isP2MS=isPaymentFactory(c.p2ms),e.isP2PK=isPaymentFactory(c.p2pk),e.isP2PKH=isPaymentFactory(c.p2pkh),e.isP2WPKH=isPaymentFactory(c.p2wpkh),e.isP2WSHScript=isPaymentFactory(c.p2wsh),e.isP2SHScript=isPaymentFactory(c.p2sh),e.isP2TR=isPaymentFactory(c.p2tr),e.witnessStackToScriptWitness=function(t){let e=n.allocUnsafe(0);function writeVarInt(t){let i=e.length,o=s.encodingLength(t);e=n.concat([e,n.allocUnsafe(o)]),s.encode(t,e,i)}return writeVarInt(t.length),t.forEach(function(t){writeVarInt(t.length),e=n.concat([e,n.from(t)])}),e},e.pubkeyPositionInScript=pubkeyPositionInScript,e.pubkeyInScript=function(t,e){return -1!==pubkeyPositionInScript(t,e)},e.checkInputForSig=function(t,e){let i=function(t){let e=[];if(0===(t.partialSig||[]).length){if(!t.finalScriptSig&&!t.finalScriptWitness)return[];e=function(t){let e=t.finalScriptSig&&o.decompile(t.finalScriptSig)||[],i=t.finalScriptWitness&&o.decompile(t.finalScriptWitness)||[];return e.concat(i).filter(t=>n.isBuffer(t)&&o.isCanonicalScriptSignature(t)).map(t=>({signature:t}))}(t)}else e=t.partialSig;return e.map(t=>t.signature)}(t);return i.some(t=>signatureBlocksAction(t,o.signature.decode,e))},e.signatureBlocksAction=signatureBlocksAction},79937:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=e.encodingLength=void 0;let n=i(47334);function encodingLength(t){return t<n.OPS.OP_PUSHDATA1?1:t<=255?2:t<=65535?3:5}e.encodingLength=encodingLength,e.encode=function(t,e,i){let s=encodingLength(e);return 1===s?t.writeUInt8(e,i):2===s?(t.writeUInt8(n.OPS.OP_PUSHDATA1,i),t.writeUInt8(e,i+1)):3===s?(t.writeUInt8(n.OPS.OP_PUSHDATA2,i),t.writeUInt16LE(e,i+1)):(t.writeUInt8(n.OPS.OP_PUSHDATA4,i),t.writeUInt32LE(e,i+1)),s},e.decode=function(t,e){let i,s;let o=t.readUInt8(e);if(o<n.OPS.OP_PUSHDATA1)i=o,s=1;else if(o===n.OPS.OP_PUSHDATA1){if(e+2>t.length)return null;i=t.readUInt8(e+1),s=2}else if(o===n.OPS.OP_PUSHDATA2){if(e+3>t.length)return null;i=t.readUInt16LE(e+1),s=3}else{if(e+5>t.length)return null;if(o!==n.OPS.OP_PUSHDATA4)throw Error("Unexpected opcode");i=t.readUInt32LE(e+1),s=5}return{opcode:o,number:i,size:s}}},73357:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.signature=e.number=e.isCanonicalScriptSignature=e.isDefinedHashType=e.isCanonicalPubKey=e.toStack=e.fromASM=e.toASM=e.decompile=e.compile=e.countNonPushOnlyOPs=e.isPushOnly=e.OPS=void 0;let s=i(77617),o=i(47334);Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return o.OPS}});let a=i(79937),u=i(45815),c=i(24362),p=i(41838),{typeforce:y}=p,g=o.OPS.OP_RESERVED;function isPushOnlyChunk(t){return p.Buffer(t)||p.Number(t)&&(t===o.OPS.OP_0||t>=o.OPS.OP_1&&t<=o.OPS.OP_16||t===o.OPS.OP_1NEGATE)}function isPushOnly(t){return p.Array(t)&&t.every(isPushOnlyChunk)}function asMinimalOP(t){if(0===t.length)return o.OPS.OP_0;if(1===t.length){if(t[0]>=1&&t[0]<=16)return g+t[0];if(129===t[0])return o.OPS.OP_1NEGATE}}function chunksIsBuffer(t){return n.isBuffer(t)}function singleChunkIsBuffer(t){return n.isBuffer(t)}function compile(t){if(chunksIsBuffer(t))return t;y(p.Array,t);let e=t.reduce((t,e)=>singleChunkIsBuffer(e)?1===e.length&&void 0!==asMinimalOP(e)?t+1:t+a.encodingLength(e.length)+e.length:t+1,0),i=n.allocUnsafe(e),s=0;if(t.forEach(t=>{if(singleChunkIsBuffer(t)){let e=asMinimalOP(t);if(void 0!==e){i.writeUInt8(e,s),s+=1;return}s+=a.encode(i,t.length,s),t.copy(i,s),s+=t.length}else i.writeUInt8(t,s),s+=1}),s!==i.length)throw Error("Could not decode chunks");return i}function decompile(t){if(p.Array(t))return t;y(p.Buffer,t);let e=[],i=0;for(;i<t.length;){let n=t[i];if(n>o.OPS.OP_0&&n<=o.OPS.OP_PUSHDATA4){let n=a.decode(t,i);if(null===n||(i+=n.size)+n.number>t.length)return null;let s=t.slice(i,i+n.number);i+=n.number;let o=asMinimalOP(s);void 0!==o?e.push(o):e.push(s)}else e.push(n),i+=1}return e}function isDefinedHashType(t){let e=-129&t;return e>0&&e<4}e.isPushOnly=isPushOnly,e.countNonPushOnlyOPs=function(t){return t.length-t.filter(isPushOnlyChunk).length},e.compile=compile,e.decompile=decompile,e.toASM=function(t){if(chunksIsBuffer(t)&&(t=decompile(t)),!t)throw Error("Could not convert invalid chunks to ASM");return t.map(t=>{if(singleChunkIsBuffer(t)){let e=asMinimalOP(t);if(void 0===e)return t.toString("hex");t=e}return o.REVERSE_OPS[t]}).join(" ")},e.fromASM=function(t){return y(p.String,t),compile(t.split(" ").map(t=>void 0!==o.OPS[t]?o.OPS[t]:(y(p.Hex,t),n.from(t,"hex"))))},e.toStack=function(t){return y(isPushOnly,t=decompile(t)),t.map(t=>singleChunkIsBuffer(t)?t:t===o.OPS.OP_0?n.allocUnsafe(0):u.encode(t-g))},e.isCanonicalPubKey=function(t){return p.isPoint(t)},e.isDefinedHashType=isDefinedHashType,e.isCanonicalScriptSignature=function(t){return!!(n.isBuffer(t)&&isDefinedHashType(t[t.length-1]))&&s.check(t.slice(0,-1))},e.number=u,e.signature=c},45815:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.encode=e.decode=void 0,e.decode=function(t,e,i){e=e||4,i=void 0===i||i;let n=t.length;if(0===n)return 0;if(n>e)throw TypeError("Script number overflow");if(i&&(127&t[n-1])==0&&(n<=1||(128&t[n-2])==0))throw Error("Non-minimally encoded script number");if(5===n){let e=t.readUInt32LE(0),i=t.readUInt8(4);return 128&i?-((-129&i)*4294967296+e):4294967296*i+e}let s=0;for(let e=0;e<n;++e)s|=t[e]<<8*e;return 128&t[n-1]?-(s&~(128<<8*(n-1))):s},e.encode=function(t){var e;let i=Math.abs(t),s=(e=i)>2147483647?5:e>8388607?4:e>32767?3:e>127?2:e>0?1:0,o=n.allocUnsafe(s),a=t<0;for(let t=0;t<s;++t)o.writeUInt8(255&i,t),i>>=8;return 128&o[s-1]?o.writeUInt8(a?128:0,s-1):a&&(o[s-1]|=128),o}},24362:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.encode=e.decode=void 0;let s=i(77617),o=i(73357),a=i(41838),{typeforce:u}=a,c=n.alloc(1,0);function toDER(t){let e=0;for(;0===t[e];)++e;return e===t.length?c:128&(t=t.slice(e))[0]?n.concat([c,t],1+t.length):t}function fromDER(t){0===t[0]&&(t=t.slice(1));let e=n.alloc(32,0),i=Math.max(0,32-t.length);return t.copy(e,i),e}e.decode=function(t){let e=t.readUInt8(t.length-1);if(!(0,o.isDefinedHashType)(e))throw Error("Invalid hashType "+e);let i=s.decode(t.slice(0,-1)),a=fromDER(i.r),u=fromDER(i.s),c=n.concat([a,u],64);return{signature:c,hashType:e}},e.encode=function(t,e){if(u({signature:a.BufferN(64),hashType:a.UInt8},{signature:t,hashType:e}),!(0,o.isDefinedHashType)(e))throw Error("Invalid hashType "+e);let i=n.allocUnsafe(1);i.writeUInt8(e,0);let c=toDER(t.slice(0,32)),p=toDER(t.slice(32,64));return n.concat([s.encode(c,p),i])}},82737:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.Transaction=void 0;let s=i(9357),o=i(5525),a=i(73357),u=i(73357),c=i(41838),{typeforce:p}=c;function varSliceSize(t){let e=t.length;return s.varuint.encodingLength(e)+e}let y=n.allocUnsafe(0),g=[],m=n.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),b=n.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),S=n.from("ffffffffffffffff","hex"),v={script:y,valueBuffer:S};let Transaction=class Transaction{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(t,e){let i=new s.BufferReader(t),n=new Transaction;n.version=i.readInt32();let o=i.readUInt8(),a=i.readUInt8(),u=!1;o===Transaction.ADVANCED_TRANSACTION_MARKER&&a===Transaction.ADVANCED_TRANSACTION_FLAG?u=!0:i.offset-=2;let c=i.readVarInt();for(let t=0;t<c;++t)n.ins.push({hash:i.readSlice(32),index:i.readUInt32(),script:i.readVarSlice(),sequence:i.readUInt32(),witness:g});let p=i.readVarInt();for(let t=0;t<p;++t)n.outs.push({value:i.readUInt64(),script:i.readVarSlice()});if(u){for(let t=0;t<c;++t)n.ins[t].witness=i.readVector();if(!n.hasWitnesses())throw Error("Transaction has superfluous witness data")}if(n.locktime=i.readUInt32(),e)return n;if(i.offset!==t.length)throw Error("Transaction has unexpected data");return n}static fromHex(t){return Transaction.fromBuffer(n.from(t,"hex"),!1)}static isCoinbaseHash(t){p(c.Hash256bit,t);for(let e=0;e<32;++e)if(0!==t[e])return!1;return!0}isCoinbase(){return 1===this.ins.length&&Transaction.isCoinbaseHash(this.ins[0].hash)}addInput(t,e,i,n){return p(c.tuple(c.Hash256bit,c.UInt32,c.maybe(c.UInt32),c.maybe(c.Buffer)),arguments),c.Null(i)&&(i=Transaction.DEFAULT_SEQUENCE),this.ins.push({hash:t,index:e,script:n||y,sequence:i,witness:g})-1}addOutput(t,e){return p(c.tuple(c.Buffer,c.Satoshi),arguments),this.outs.push({script:t,value:e})-1}hasWitnesses(){return this.ins.some(t=>0!==t.witness.length)}stripWitnesses(){this.ins.forEach(t=>{t.witness=g})}weight(){let t=this.byteLength(!1),e=this.byteLength(!0);return 3*t+e}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(t=!0){let e=t&&this.hasWitnesses();return(e?10:8)+s.varuint.encodingLength(this.ins.length)+s.varuint.encodingLength(this.outs.length)+this.ins.reduce((t,e)=>t+40+varSliceSize(e.script),0)+this.outs.reduce((t,e)=>t+8+varSliceSize(e.script),0)+(e?this.ins.reduce((t,e)=>t+function(t){let e=t.length;return s.varuint.encodingLength(e)+t.reduce((t,e)=>t+varSliceSize(e),0)}(e.witness),0):0)}clone(){let t=new Transaction;return t.version=this.version,t.locktime=this.locktime,t.ins=this.ins.map(t=>({hash:t.hash,index:t.index,script:t.script,sequence:t.sequence,witness:t.witness})),t.outs=this.outs.map(t=>({script:t.script,value:t.value})),t}hashForSignature(t,e,i){if(p(c.tuple(c.UInt32,c.Buffer,c.Number),arguments),t>=this.ins.length)return b;let s=a.compile(a.decompile(e).filter(t=>t!==u.OPS.OP_CODESEPARATOR)),g=this.clone();if((31&i)===Transaction.SIGHASH_NONE)g.outs=[],g.ins.forEach((e,i)=>{i!==t&&(e.sequence=0)});else if((31&i)===Transaction.SIGHASH_SINGLE){if(t>=this.outs.length)return b;g.outs.length=t+1;for(let e=0;e<t;e++)g.outs[e]=v;g.ins.forEach((e,i)=>{i!==t&&(e.sequence=0)})}i&Transaction.SIGHASH_ANYONECANPAY?(g.ins=[g.ins[t]],g.ins[0].script=s):(g.ins.forEach(t=>{t.script=y}),g.ins[t].script=s);let m=n.allocUnsafe(g.byteLength(!1)+4);return m.writeInt32LE(i,m.length-4),g.__toBuffer(m,0,!1),o.hash256(m)}hashForWitnessV1(t,e,i,a,u,g){if(p(c.tuple(c.UInt32,p.arrayOf(c.Buffer),p.arrayOf(c.Satoshi),c.UInt32),arguments),i.length!==this.ins.length||e.length!==this.ins.length)throw Error("Must supply prevout script and value for all inputs");let m=a===Transaction.SIGHASH_DEFAULT?Transaction.SIGHASH_ALL:a&Transaction.SIGHASH_OUTPUT_MASK,b=a&Transaction.SIGHASH_INPUT_MASK,S=b===Transaction.SIGHASH_ANYONECANPAY,v=m===Transaction.SIGHASH_NONE,_=m===Transaction.SIGHASH_SINGLE,P=y,w=y,E=y,I=y,T=y;if(!S){let t=s.BufferWriter.withCapacity(36*this.ins.length);this.ins.forEach(e=>{t.writeSlice(e.hash),t.writeUInt32(e.index)}),P=o.sha256(t.end()),t=s.BufferWriter.withCapacity(8*this.ins.length),i.forEach(e=>t.writeUInt64(e)),w=o.sha256(t.end()),t=s.BufferWriter.withCapacity(e.map(varSliceSize).reduce((t,e)=>t+e)),e.forEach(e=>t.writeVarSlice(e)),E=o.sha256(t.end()),t=s.BufferWriter.withCapacity(4*this.ins.length),this.ins.forEach(e=>t.writeUInt32(e.sequence)),I=o.sha256(t.end())}if(v||_){if(_&&t<this.outs.length){let e=this.outs[t],i=s.BufferWriter.withCapacity(8+varSliceSize(e.script));i.writeUInt64(e.value),i.writeVarSlice(e.script),T=o.sha256(i.end())}}else{let t=this.outs.map(t=>8+varSliceSize(t.script)).reduce((t,e)=>t+e),e=s.BufferWriter.withCapacity(t);this.outs.forEach(t=>{e.writeUInt64(t.value),e.writeVarSlice(t.script)}),T=o.sha256(e.end())}let k=(u?2:0)+(g?1:0),A=174-(S?49:0)-(v?32:0)+(g?32:0)+(u?37:0),O=s.BufferWriter.withCapacity(A);if(O.writeUInt8(a),O.writeInt32(this.version),O.writeUInt32(this.locktime),O.writeSlice(P),O.writeSlice(w),O.writeSlice(E),O.writeSlice(I),v||_||O.writeSlice(T),O.writeUInt8(k),S){let n=this.ins[t];O.writeSlice(n.hash),O.writeUInt32(n.index),O.writeUInt64(i[t]),O.writeVarSlice(e[t]),O.writeUInt32(n.sequence)}else O.writeUInt32(t);if(g){let t=s.BufferWriter.withCapacity(varSliceSize(g));t.writeVarSlice(g),O.writeSlice(o.sha256(t.end()))}return _&&O.writeSlice(T),u&&(O.writeSlice(u),O.writeUInt8(0),O.writeUInt32(4294967295)),o.taggedHash("TapSighash",n.concat([n.from([0]),O.end()]))}hashForWitnessV0(t,e,i,a){let u;p(c.tuple(c.UInt32,c.Buffer,c.Satoshi,c.UInt32),arguments);let y=n.from([]),g=m,b=m,S=m;if(a&Transaction.SIGHASH_ANYONECANPAY||(y=n.allocUnsafe(36*this.ins.length),u=new s.BufferWriter(y,0),this.ins.forEach(t=>{u.writeSlice(t.hash),u.writeUInt32(t.index)}),b=o.hash256(y)),a&Transaction.SIGHASH_ANYONECANPAY||(31&a)===Transaction.SIGHASH_SINGLE||(31&a)===Transaction.SIGHASH_NONE||(y=n.allocUnsafe(4*this.ins.length),u=new s.BufferWriter(y,0),this.ins.forEach(t=>{u.writeUInt32(t.sequence)}),S=o.hash256(y)),(31&a)!==Transaction.SIGHASH_SINGLE&&(31&a)!==Transaction.SIGHASH_NONE){let t=this.outs.reduce((t,e)=>t+8+varSliceSize(e.script),0);y=n.allocUnsafe(t),u=new s.BufferWriter(y,0),this.outs.forEach(t=>{u.writeUInt64(t.value),u.writeVarSlice(t.script)}),g=o.hash256(y)}else if((31&a)===Transaction.SIGHASH_SINGLE&&t<this.outs.length){let e=this.outs[t];y=n.allocUnsafe(8+varSliceSize(e.script)),(u=new s.BufferWriter(y,0)).writeUInt64(e.value),u.writeVarSlice(e.script),g=o.hash256(y)}y=n.allocUnsafe(156+varSliceSize(e)),u=new s.BufferWriter(y,0);let v=this.ins[t];return u.writeInt32(this.version),u.writeSlice(b),u.writeSlice(S),u.writeSlice(v.hash),u.writeUInt32(v.index),u.writeVarSlice(e),u.writeUInt64(i),u.writeUInt32(v.sequence),u.writeSlice(g),u.writeUInt32(this.locktime),u.writeUInt32(a),o.hash256(y)}getHash(t){return t&&this.isCoinbase()?n.alloc(32,0):o.hash256(this.__toBuffer(void 0,void 0,t))}getId(){return(0,s.reverseBuffer)(this.getHash(!1)).toString("hex")}toBuffer(t,e){return this.__toBuffer(t,e,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(t,e){p(c.tuple(c.Number,c.Buffer),arguments),this.ins[t].script=e}setWitness(t,e){p(c.tuple(c.Number,[c.Buffer]),arguments),this.ins[t].witness=e}__toBuffer(t,e,i=!1){t||(t=n.allocUnsafe(this.byteLength(i)));let o=new s.BufferWriter(t,e||0);o.writeInt32(this.version);let a=i&&this.hasWitnesses();return(a&&(o.writeUInt8(Transaction.ADVANCED_TRANSACTION_MARKER),o.writeUInt8(Transaction.ADVANCED_TRANSACTION_FLAG)),o.writeVarInt(this.ins.length),this.ins.forEach(t=>{o.writeSlice(t.hash),o.writeUInt32(t.index),o.writeVarSlice(t.script),o.writeUInt32(t.sequence)}),o.writeVarInt(this.outs.length),this.outs.forEach(t=>{void 0!==t.value?o.writeUInt64(t.value):o.writeSlice(t.valueBuffer),o.writeVarSlice(t.script)}),a&&this.ins.forEach(t=>{o.writeVector(t.witness)}),o.writeUInt32(this.locktime),void 0!==e)?t.slice(e,o.offset):t}};e.Transaction=Transaction,Transaction.DEFAULT_SEQUENCE=4294967295,Transaction.SIGHASH_DEFAULT=0,Transaction.SIGHASH_ALL=1,Transaction.SIGHASH_NONE=2,Transaction.SIGHASH_SINGLE=3,Transaction.SIGHASH_ANYONECANPAY=128,Transaction.SIGHASH_OUTPUT_MASK=3,Transaction.SIGHASH_INPUT_MASK=128,Transaction.ADVANCED_TRANSACTION_MARKER=0,Transaction.ADVANCED_TRANSACTION_FLAG=1},41838:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.oneOf=e.Null=e.BufferN=e.Function=e.UInt32=e.UInt8=e.tuple=e.maybe=e.Hex=e.Buffer=e.String=e.Boolean=e.Array=e.Number=e.Hash256bit=e.Hash160bit=e.Buffer256bit=e.isTaptree=e.isTapleaf=e.TAPLEAF_VERSION_MASK=e.Satoshi=e.isPoint=e.stacksEqual=e.typeforce=void 0;let n=i(48764);e.typeforce=i(2401);let s=n.Buffer.alloc(32,0),o=n.Buffer.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex");e.stacksEqual=function(t,e){return t.length===e.length&&t.every((t,i)=>t.equals(e[i]))},e.isPoint=function(t){if(!n.Buffer.isBuffer(t)||t.length<33)return!1;let e=t[0],i=t.slice(1,33);if(0===i.compare(s)||i.compare(o)>=0)return!1;if((2===e||3===e)&&33===t.length)return!0;let a=t.slice(33);return!(0===a.compare(s)||a.compare(o)>=0)&&4===e&&65===t.length};let a=21*1e14;function isTapleaf(t){return!!(t&&"output"in t&&n.Buffer.isBuffer(t.output))&&(void 0===t.version||(t.version&e.TAPLEAF_VERSION_MASK)===t.version)}e.Satoshi=function(t){return e.typeforce.UInt53(t)&&t<=a},e.TAPLEAF_VERSION_MASK=254,e.isTapleaf=isTapleaf,e.isTaptree=function isTaptree(t){return(0,e.Array)(t)?2===t.length&&t.every(t=>isTaptree(t)):isTapleaf(t)},e.Buffer256bit=e.typeforce.BufferN(32),e.Hash160bit=e.typeforce.BufferN(20),e.Hash256bit=e.typeforce.BufferN(32),e.Number=e.typeforce.Number,e.Array=e.typeforce.Array,e.Boolean=e.typeforce.Boolean,e.String=e.typeforce.String,e.Buffer=e.typeforce.Buffer,e.Hex=e.typeforce.Hex,e.maybe=e.typeforce.maybe,e.tuple=e.typeforce.tuple,e.UInt8=e.typeforce.UInt8,e.UInt32=e.typeforce.UInt32,e.Function=e.typeforce.Function,e.BufferN=e.typeforce.BufferN,e.Null=e.typeforce.Null,e.oneOf=e.typeforce.oneOf},87790:function(t,e,i){var n=i(48764).Buffer;let s=i(58334),o=i(9941),a=i(8055),u=i(23482),c=i(17221),p=i(57795),y={P2WPKH:"p2wpkh",P2SH_P2WPKH:"p2sh(p2wpkh)"};function sha256(t){return u("sha256").update(t).digest()}function hash160(t){return u("ripemd160").update(sha256(t)).digest()}function encodeSignature(t,e,i,s){return void 0!==s?(e+=8,s===y.P2WPKH&&(e+=4)):i&&(e+=4),n.concat([n.alloc(1,e+27),t])}function magicHash(t,e){e=e||"\x18Bitcoin Signed Message:\n",n.isBuffer(e)||(e=n.from(e,"utf8")),n.isBuffer(t)||(t=n.from(t,"utf8"));let i=p.encodingLength(t.length),s=n.allocUnsafe(e.length+i+t.length);return e.copy(s,0),p.encode(t.length,s,e.length),t.copy(s,e.length+i),sha256(sha256(s))}function prepareSign(t,e){"object"==typeof t&&void 0===e&&(e=t,t=void 0);let{segwitType:i,extraEntropy:n}=e||{};if(i&&("string"==typeof i||i instanceof String)&&(i=i.toLowerCase()),i&&i!==y.P2SH_P2WPKH&&i!==y.P2WPKH)throw Error('Unrecognized segwitType: use "'+y.P2SH_P2WPKH+'" or "'+y.P2WPKH+'"');return{messagePrefixArg:t,segwitType:i,extraEntropy:n}}function isSigner(t){return t&&"function"==typeof t.sign}function segwitRedeemHash(t){let e=n.concat([n.from("0014","hex"),t]);return hash160(e)}function decodeBech32(t){let e=o.decode(t),i=o.fromWords(e.words.slice(1));return n.from(i)}t.exports={magicHash:magicHash,sign:function(t,e,i,n,s){let{messagePrefixArg:o,segwitType:a,extraEntropy:u}=prepareSign(n,s),p=magicHash(t,o),y=isSigner(e)?e.sign(p,u):c.sign(p,e,{data:u});return encodeSignature(y.signature,y.recovery,i,a)},signAsync:function(t,e,i,n,s){let o,a,u;return Promise.resolve().then(()=>{({messagePrefixArg:o,segwitType:a,extraEntropy:u}=prepareSign(n,s));let i=magicHash(t,o);return isSigner(e)?e.sign(i,u):c.sign(i,e,{data:u})}).then(t=>encodeSignature(t.signature,t.recovery,i,a))},verify:function(t,e,i,o,u){let p,g;n.isBuffer(i)||(i=n.from(i,"base64"));let m=function(t){if(65!==t.length)throw Error("Invalid signature length");let e=t.readUInt8(0)-27;if(e>15||e<0)throw Error("Invalid signature parameter");return{compressed:!!(12&e),segwitType:8&e?4&e?y.P2WPKH:y.P2SH_P2WPKH:null,recovery:3&e,signature:t.slice(1)}}(i);if(u&&!m.compressed)throw Error("checkSegwitAlways can only be used with a compressed pubkey signature flagbyte");let b=magicHash(t,o),S=c.recover(b,m.signature,m.recovery,m.compressed),v=hash160(S);if(m.segwitType)m.segwitType===y.P2SH_P2WPKH?(p=segwitRedeemHash(v),g=s.decode(e).slice(1)):(p=v,g=decodeBech32(e));else if(u)try{return g=decodeBech32(e),a(v,g)}catch(i){let t=segwitRedeemHash(v);return a(v,g=s.decode(e).slice(1))||a(t,g)}else p=v,g=s.decode(e).slice(1);return a(p,g)}}},9941:function(t){"use strict";for(var e="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={},n=0;n<e.length;n++){var s=e.charAt(n);if(void 0!==i[s])throw TypeError(s+" is ambiguous");i[s]=n}function polymodStep(t){var e=t>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}function prefixChk(t){for(var e=1,i=0;i<t.length;++i){var n=t.charCodeAt(i);if(n<33||n>126)return"Invalid prefix ("+t+")";e=polymodStep(e)^n>>5}for(i=0,e=polymodStep(e);i<t.length;++i){var s=t.charCodeAt(i);e=polymodStep(e)^31&s}return e}function __decode(t,e){if(e=e||90,t.length<8)return t+" too short";if(t.length>e)return"Exceeds length limit";var n=t.toLowerCase(),s=t.toUpperCase();if(t!==n&&t!==s)return"Mixed-case string "+t;var o=(t=n).lastIndexOf("1");if(-1===o)return"No separator character for "+t;if(0===o)return"Missing prefix for "+t;var a=t.slice(0,o),u=t.slice(o+1);if(u.length<6)return"Data too short";var c=prefixChk(a);if("string"==typeof c)return c;for(var p=[],y=0;y<u.length;++y){var g=u.charAt(y),m=i[g];if(void 0===m)return"Unknown character "+g;c=polymodStep(c)^m,y+6>=u.length||p.push(m)}return 1!==c?"Invalid checksum for "+t:{prefix:a,words:p}}function convert(t,e,i,n){for(var s=0,o=0,a=(1<<i)-1,u=[],c=0;c<t.length;++c)for(s=s<<e|t[c],o+=e;o>=i;)u.push(s>>(o-=i)&a);if(n)o>0&&u.push(s<<i-o&a);else{if(o>=e)return"Excess padding";if(s<<i-o&a)return"Non-zero padding"}return u}t.exports={decodeUnsafe:function(){var t=__decode.apply(null,arguments);if("object"==typeof t)return t},decode:function(t){var e=__decode.apply(null,arguments);if("object"==typeof e)return e;throw Error(e)},encode:function(t,i,n){if(n=n||90,t.length+7+i.length>n)throw TypeError("Exceeds length limit");var s=prefixChk(t=t.toLowerCase());if("string"==typeof s)throw Error(s);for(var o=t+"1",a=0;a<i.length;++a){var u=i[a];if(u>>5!=0)throw Error("Non 5-bit word");s=polymodStep(s)^u,o+=e.charAt(u)}for(a=0;a<6;++a)s=polymodStep(s);for(s^=1,a=0;a<6;++a){var c=s>>(5-a)*5&31;o+=e.charAt(c)}return o},toWordsUnsafe:function(t){var e=convert(t,8,5,!0);if(Array.isArray(e))return e},toWords:function(t){var e=convert(t,8,5,!0);if(Array.isArray(e))return e;throw Error(e)},fromWordsUnsafe:function(t){var e=convert(t,5,8,!1);if(Array.isArray(e))return e},fromWords:function(t){var e=convert(t,5,8,!1);if(Array.isArray(e))return e;throw Error(e)}}},69402:function(t,e,i){"use strict";var n=i(48764).Buffer,s=t.exports;s.version="v"+i(46625).i8,s.versionGuard=function(t){if(void 0!==t)throw Error("More than one instance of bitcore-lib found. Please make sure to require bitcore-lib and check that submodules do not also include their own bitcore-lib dependency.")},s.versionGuard(i.g._bitcore),i.g._bitcore=s.version,s.crypto={},s.crypto.BN=i(35418),s.crypto.ECDSA=i(30044),s.crypto.Schnorr=i(84118),s.crypto.Hash=i(66812),s.crypto.Random=i(42773),s.crypto.Point=i(29143),s.crypto.Signature=i(72571),s.crypto.TaggedHash=i(83868),s.encoding={},s.encoding.Base58=i(52131),s.encoding.Base58Check=i(36517),s.encoding.BufferReader=i(10992),s.encoding.BufferWriter=i(64926),s.encoding.Varint=i(28948),s.util={},s.util.buffer=i(19153),s.util.js=i(29854),s.util.preconditions=i(79460),s.errors=i(10862),s.Address=i(53),s.Block=i(69491),s.MerkleBlock=i(49595),s.BlockHeader=i(82828),s.HDPrivateKey=i(82650),s.HDPublicKey=i(26644),s.Message=i(26722),s.Networks=i(6742),s.Opcode=i(76244),s.PrivateKey=i(57867),s.PublicKey=i(39521),s.Script=i(64502),s.Transaction=i(98507),s.URI=i(7839),s.Unit=i(88222),s.deps={},s.deps.bnjs=i(77026),s.deps.bs58=i(9384),s.deps.Buffer=n,s.deps.elliptic=i(86266),s.deps._=i(96486),s.Transaction.sighash=i(254)},53:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(79460),a=i(10862),u=i(36517),c=i(64567),p=i(6742),y=i(66812),g=i(29854),m=i(39521);function Address(t,e,i,n){if(!(this instanceof Address))return new Address(t,e,i);if(s.isArray(t)&&s.isNumber(e))return Address.createMultisig(t,e,i,!1,n);if(t instanceof Address)return t;if(o.checkArgument(t,"First argument is required, please include address data.","guide/address.html"),e&&!p.get(e))throw TypeError('Second argument must be "livenet" or "testnet".');if(i&&i!==Address.PayToPublicKeyHash&&i!==Address.PayToScriptHash&&i!==Address.PayToWitnessPublicKeyHash&&i!==Address.PayToWitnessScriptHash&&i!==Address.PayToTaproot)throw TypeError('Third argument must be "pubkeyhash", "scripthash", "witnesspubkeyhash", "witnessscripthash", or "taproot".');var a=this._classifyArguments(t,e,i);return a.network=a.network||p.get(e)||p.defaultNetwork,a.type=a.type||i||Address.PayToPublicKeyHash,g.defineImmutable(this,{hashBuffer:a.hashBuffer,network:a.network,type:a.type}),this}Address.prototype._classifyArguments=function(t,e,i){if((t instanceof n||t instanceof Uint8Array)&&(20===t.length||32===t.length))return Address._transformHash(t,e,i);if((t instanceof n||t instanceof Uint8Array)&&t.length>=21)return Address._transformBuffer(t,e,i);if(t instanceof m)return Address._transformPublicKey(t,e,i);if(t instanceof b)return Address._transformScript(t,e);if("string"==typeof t)return Address._transformString(t,e,i);if(s.isObject(t))return Address._transformObject(t);throw TypeError("First argument is an unrecognized data format.")},Address.PayToPublicKeyHash="pubkeyhash",Address.PayToScriptHash="scripthash",Address.PayToWitnessPublicKeyHash="witnesspubkeyhash",Address.PayToWitnessScriptHash="witnessscripthash",Address.PayToTaproot="taproot",Address._transformHash=function(t,e,i){var s={};if(!(t instanceof n)&&!(t instanceof Uint8Array))throw TypeError("Address supplied is not a buffer.");if(20!==t.length&&32!==t.length)throw TypeError("Address hashbuffers must be either 20 or 32 bytes.");return s.hashBuffer=t,s.network=p.get(e)||p.defaultNetwork,s.type=i,s},Address._transformObject=function(t){return o.checkArgument(t.hash||t.hashBuffer,"Must provide a `hash` or `hashBuffer` property"),o.checkArgument(t.type,"Must provide a `type` property"),{hashBuffer:t.hash?n.from(t.hash,"hex"):t.hashBuffer,network:p.get(t.network)||p.defaultNetwork,type:t.type}},Address._classifyFromVersion=function(t){var e={};if(t.length>21){var i=c.decode(t.toString("utf8"));if(0!==i.version&&1!==i.version)throw TypeError("Only witness v0 and v1 addresses are supported.");if(0===i.version){if(20===i.data.length)e.type=Address.PayToWitnessPublicKeyHash;else if(32===i.data.length)e.type=Address.PayToWitnessScriptHash;else throw TypeError("Witness data must be either 20 or 32 bytes.")}else if(1===i.version){if(32===i.data.length)e.type=Address.PayToTaproot;else throw TypeError("Witness data must be 32 bytes for v1")}e.network=p.get(i.prefix,"bech32prefix")}else{var n=p.get(t[0],"pubkeyhash"),s=p.get(t[0],"scripthash");n?(e.network=n,e.type=Address.PayToPublicKeyHash):s&&(e.network=s,e.type=Address.PayToScriptHash)}return e},Address._transformBuffer=function(t,e,i){var s={};if(!(t instanceof n)&&!(t instanceof Uint8Array))throw TypeError("Address supplied is not a buffer.");if(t.length<21)throw TypeError("Address buffer is incorrect length.");var o=p.get(e),a=Address._classifyFromVersion(t);if(e&&!o)throw TypeError("Unknown network");if(!a.network||o&&o.xpubkey!==a.network.xpubkey)throw TypeError("Address has mismatched network type.");if(!a.type||i&&i!==a.type)throw TypeError("Address has mismatched type.");return t.length>21?s.hashBuffer=c.decode(t.toString("utf8")).data:s.hashBuffer=t.slice(1),s.network=o||a.network,s.type=a.type,s},Address._transformPublicKey=function(t,e,i){var n={};if(!(t instanceof m))throw TypeError("Address must be an instance of PublicKey.");if(i&&i!==Address.PayToScriptHash&&i!==Address.PayToWitnessPublicKeyHash&&i!==Address.PayToPublicKeyHash&&i!==Address.PayToTaproot)throw TypeError("Type must be either pubkeyhash, witnesspubkeyhash, scripthash, or taproot to transform public key.");if(!t.compressed&&(i===Address.PayToScriptHash||i===Address.PayToWitnessPublicKeyHash))throw TypeError("Witness addresses must use compressed public keys.");return i===Address.PayToScriptHash?n.hashBuffer=y.sha256ripemd160(b.buildWitnessV0Out(t).toBuffer()):i===Address.PayToTaproot?n.hashBuffer=t.createTapTweak().tweakedPubKey:n.hashBuffer=y.sha256ripemd160(t.toBuffer()),n.type=i||Address.PayToPublicKeyHash,n},Address._transformScript=function(t,e){o.checkArgument(t instanceof b,"script must be a Script instance");var i=t.getAddressInfo(e);if(!i)throw new a.Script.CantDeriveAddress(t);return i},Address.createMultisig=function(t,e,i,n,o){if(i=i||t[0].network||p.defaultNetwork,o&&o!==Address.PayToScriptHash&&o!==Address.PayToWitnessScriptHash)throw TypeError("Type must be either scripthash or witnessscripthash to create multisig.");if(n||o===Address.PayToWitnessScriptHash){t=s.map(t,m);for(var a=0;a<t.length;a++)if(!t[a].compressed)throw TypeError("Witness addresses must use compressed public keys.")}var u=b.buildMultisigOut(t,e);return n?Address.payingTo(b.buildWitnessMultisigOutFromScript(u),i):Address.payingTo(u,i,o)},Address._transformString=function(t,e,i){if("string"!=typeof t)throw TypeError("data parameter supplied is not a string.");if(t.length>100)throw TypeError("address string is too long");if(e&&!p.get(e))throw TypeError("Unknown network");t=t.trim();try{var s=Address._transformBuffer(n.from(t,"utf8"),e,i);return s}catch(t){if(i===Address.PayToWitnessPublicKeyHash||i===Address.PayToWitnessScriptHash||i===Address.PayToTaproot)throw t}var o=u.decode(t),s=Address._transformBuffer(o,e,i);return s},Address.fromPublicKey=function(t,e,i){var n=Address._transformPublicKey(t,e,i);return e=e||p.defaultNetwork,new Address(n.hashBuffer,e,n.type)},Address.fromPublicKeyHash=function(t,e){var i=Address._transformHash(t);return new Address(i.hashBuffer,e,Address.PayToPublicKeyHash)},Address.fromScriptHash=function(t,e,i){o.checkArgument(t,"hash parameter is required");var n=Address._transformHash(t);if(i===Address.PayToWitnessScriptHash&&32!==t.length)throw TypeError("Address hashbuffer must be exactly 32 bytes for v0 witness script hash.");var i=i||Address.PayToScriptHash;return new Address(n.hashBuffer,e,i)},Address.payingTo=function(t,e,i){o.checkArgument(t,"script is required"),o.checkArgument(t instanceof b,"script must be instance of Script"),n=i===Address.PayToWitnessScriptHash?y.sha256(t.toBuffer()):y.sha256ripemd160(t.toBuffer());var n,i=i||Address.PayToScriptHash;return Address.fromScriptHash(n,e,i)},Address.fromScript=function(t,e){o.checkArgument(t instanceof b,"script must be a Script instance");var i=Address._transformScript(t,e);return new Address(i.hashBuffer,e,i.type)},Address.fromBuffer=function(t,e,i){var n=Address._transformBuffer(t,e,i);return new Address(n.hashBuffer,n.network,n.type)},Address.fromString=function(t,e,i){var n=Address._transformString(t,e,i);return new Address(n.hashBuffer,n.network,n.type)},Address.fromObject=function(t){o.checkState(g.isHexa(t.hash),'Unexpected hash property, "'+t.hash+'", expected to be hex.');var e=n.from(t.hash,"hex");return new Address(e,t.network,t.type)},Address.getValidationError=function(t,e,i){var n;try{new Address(t,e,i)}catch(t){n=t}return n},Address.isValid=function(t,e,i){return!Address.getValidationError(t,e,i)},Address.prototype.isPayToPublicKeyHash=function(){return this.type===Address.PayToPublicKeyHash},Address.prototype.isPayToScriptHash=function(){return this.type===Address.PayToScriptHash},Address.prototype.isPayToWitnessPublicKeyHash=function(){return this.type===Address.PayToWitnessPublicKeyHash},Address.prototype.isPayToWitnessScriptHash=function(){return this.type===Address.PayToWitnessScriptHash},Address.prototype.isPayToTaproot=function(){return this.type===Address.PayToTaproot},Address.prototype.toBuffer=function(){if(this.isPayToWitnessPublicKeyHash()||this.isPayToWitnessScriptHash())return n.from(this.toString(),"utf8");var t=n.from([this.network[this.type]]);return n.concat([t,this.hashBuffer])},Address.prototype.toObject=Address.prototype.toJSON=function(){return{hash:this.hashBuffer.toString("hex"),type:this.type,network:this.network.toString()}},Address.prototype.toString=function(){if(this.isPayToWitnessPublicKeyHash()||this.isPayToWitnessScriptHash()||this.isPayToTaproot()){let t=this.network.bech32prefix,e=0,i=c.encodings.BECH32;return this.isPayToTaproot()&&(e=1,i=c.encodings.BECH32M),c.encode(t,e,this.hashBuffer,i)}return u.encode(this.toBuffer())},Address.prototype.inspect=function(){return"<Address: "+this.toString()+", type: "+this.type+", network: "+this.network+">"},t.exports=Address;var b=i(64502)},99428:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(82828),a=i(35418),u=i(19153),c=i(10992),p=i(64926),y=i(66812),g=i(98507),m=i(79460);function Block(t){return this instanceof Block?(s.extend(this,Block._from(t)),this):new Block(t)}Block.MAX_BLOCK_SIZE=1e6,Block._from=function(t){var e={};if(u.isBuffer(t))e=Block._fromBufferReader(c(t));else if(s.isObject(t))e=Block._fromObject(t);else throw TypeError("Unrecognized argument for Block");return e},Block._fromObject=function(t){var e=[];return t.transactions.forEach(function(t){t instanceof g?e.push(t):e.push(g().fromObject(t))}),{header:o.fromObject(t.header),transactions:e}},Block.fromObject=function(t){var e=Block._fromObject(t);return new Block(e)},Block._fromBufferReader=function(t){var e={};m.checkState(!t.finished(),"No block data received"),e.header=o.fromBufferReader(t);var i=t.readVarintNum();e.transactions=[];for(var n=0;n<i;n++)e.transactions.push(g().fromBufferReader(t));return e},Block.fromBufferReader=function(t){m.checkArgument(t,"br is required");var e=Block._fromBufferReader(t);return new Block(e)},Block.fromBuffer=function(t){return Block.fromBufferReader(new c(t))},Block.fromString=function(t){var e=n.from(t,"hex");return Block.fromBuffer(e)},Block.fromRawBlock=function(t){u.isBuffer(t)||(t=n.from(t,"binary"));var e=c(t);e.pos=Block.Values.START_OF_BLOCK;var i=Block._fromBufferReader(e);return new Block(i)},Block.prototype.toObject=Block.prototype.toJSON=function(){var t=[];return this.transactions.forEach(function(e){t.push(e.toObject())}),{header:this.header.toObject(),transactions:t}},Block.prototype.toBuffer=function(){return this.toBufferWriter().concat()},Block.prototype.toString=function(){return this.toBuffer().toString("hex")},Block.prototype.toBufferWriter=function(t){t||(t=new p),t.write(this.header.toBuffer()),t.writeVarintNum(this.transactions.length);for(var e=0;e<this.transactions.length;e++)this.transactions[e].toBufferWriter(t);return t},Block.prototype.getTransactionHashes=function(){var t=[];if(0===this.transactions.length)return[Block.Values.NULL_HASH];for(var e=0;e<this.transactions.length;e++)t.push(this.transactions[e]._getHash());return t},Block.prototype.getMerkleTree=function(){for(var t=this.getTransactionHashes(),e=0,i=this.transactions.length;i>1;i=Math.floor((i+1)/2)){for(var s=0;s<i;s+=2){var o=Math.min(s+1,i-1),a=n.concat([t[e+s],t[e+o]]);t.push(y.sha256sha256(a))}e+=i}return t},Block.prototype.getMerkleRoot=function(){var t=this.getMerkleTree();return t[t.length-1]},Block.prototype.validMerkleRoot=function(){var t=new a(this.header.merkleRoot.toString("hex"),"hex"),e=new a(this.getMerkleRoot().toString("hex"),"hex");return 0===t.cmp(e)},Block.prototype._getHash=function(){return this.header._getHash()};var b={configurable:!1,enumerable:!0,get:function(){return this._id||(this._id=this.header.id),this._id},set:s.noop};Object.defineProperty(Block.prototype,"id",b),Object.defineProperty(Block.prototype,"hash",b),Block.prototype.inspect=function(){return"<Block "+this.id+">"},Block.Values={START_OF_BLOCK:8,NULL_HASH:n.from("0000000000000000000000000000000000000000000000000000000000000000","hex")},t.exports=Block},82828:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(35418),a=i(19153),u=i(10992),c=i(64926),p=i(66812);i(29854);var y=i(79460),BlockHeader=function BlockHeader(t){if(!(this instanceof BlockHeader))return new BlockHeader(t);var e=BlockHeader._from(t);return this.version=e.version,this.prevHash=e.prevHash,this.merkleRoot=e.merkleRoot,this.time=e.time,this.timestamp=e.time,this.bits=e.bits,this.nonce=e.nonce,e.hash&&y.checkState(this.hash===e.hash,"Argument object hash property does not match block hash."),this};BlockHeader._from=function(t){var e={};if(a.isBuffer(t))e=BlockHeader._fromBufferReader(u(t));else if(s.isObject(t))e=BlockHeader._fromObject(t);else throw TypeError("Unrecognized argument for BlockHeader");return e},BlockHeader._fromObject=function(t){y.checkArgument(t,"data is required");var e=t.prevHash,i=t.merkleRoot;return s.isString(t.prevHash)&&(e=a.reverse(n.from(t.prevHash,"hex"))),s.isString(t.merkleRoot)&&(i=a.reverse(n.from(t.merkleRoot,"hex"))),{hash:t.hash,version:t.version,prevHash:e,merkleRoot:i,time:t.time,timestamp:t.time,bits:t.bits,nonce:t.nonce}},BlockHeader.fromObject=function(t){var e=BlockHeader._fromObject(t);return new BlockHeader(e)},BlockHeader.fromRawBlock=function(t){a.isBuffer(t)||(t=n.from(t,"binary"));var e=u(t);e.pos=BlockHeader.Constants.START_OF_HEADER;var i=BlockHeader._fromBufferReader(e);return new BlockHeader(i)},BlockHeader.fromBuffer=function(t){var e=BlockHeader._fromBufferReader(u(t));return new BlockHeader(e)},BlockHeader.fromString=function(t){var e=n.from(t,"hex");return BlockHeader.fromBuffer(e)},BlockHeader._fromBufferReader=function(t){var e={};return e.version=t.readInt32LE(),e.prevHash=t.read(32),e.merkleRoot=t.read(32),e.time=t.readUInt32LE(),e.bits=t.readUInt32LE(),e.nonce=t.readUInt32LE(),e},BlockHeader.fromBufferReader=function(t){var e=BlockHeader._fromBufferReader(t);return new BlockHeader(e)},BlockHeader.prototype.toObject=BlockHeader.prototype.toJSON=function(){return{hash:this.hash,version:this.version,prevHash:a.reverse(this.prevHash).toString("hex"),merkleRoot:a.reverse(this.merkleRoot).toString("hex"),time:this.time,bits:this.bits,nonce:this.nonce}},BlockHeader.prototype.toBuffer=function(){return this.toBufferWriter().concat()},BlockHeader.prototype.toString=function(){return this.toBuffer().toString("hex")},BlockHeader.prototype.toBufferWriter=function(t){return t||(t=new c),t.writeInt32LE(this.version),t.write(this.prevHash),t.write(this.merkleRoot),t.writeUInt32LE(this.time),t.writeUInt32LE(this.bits),t.writeUInt32LE(this.nonce),t},BlockHeader.prototype.getTargetDifficulty=function(t){t=t||this.bits;for(var e=new o(16777215&t),i=8*((t>>>24)-3);i-- >0;)e=e.mul(new o(2));return e},BlockHeader.prototype.getDifficulty=function(){var t=this.getTargetDifficulty(486604799).mul(new o(1e8)),e=this.getTargetDifficulty(),i=t.div(e).toString(10),n=i.length-8;return parseFloat(i=i.slice(0,n)+"."+i.slice(n))},BlockHeader.prototype._getHash=function(){var t=this.toBuffer();return p.sha256sha256(t)};var g={configurable:!1,enumerable:!0,get:function(){return this._id||(this._id=u(this._getHash()).readReverse().toString("hex")),this._id},set:s.noop};Object.defineProperty(BlockHeader.prototype,"id",g),Object.defineProperty(BlockHeader.prototype,"hash",g),BlockHeader.prototype.validTimestamp=function(){var t=Math.round(new Date().getTime()/1e3);return!(this.time>t+BlockHeader.Constants.MAX_TIME_OFFSET)},BlockHeader.prototype.validProofOfWork=function(){var t=new o(this.id,"hex"),e=this.getTargetDifficulty();return!(t.cmp(e)>0)},BlockHeader.prototype.inspect=function(){return"<BlockHeader "+this.id+">"},BlockHeader.Constants={START_OF_HEADER:8,MAX_TIME_OFFSET:7200,LARGEST_HASH:new o("10000000000000000000000000000000000000000000000000000000000000000","hex")},t.exports=BlockHeader},69491:function(t,e,i){t.exports=i(99428),t.exports.BlockHeader=i(82828),t.exports.MerkleBlock=i(49595)},49595:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(82828),a=i(19153),u=i(10992),c=i(64926),p=i(66812);i(29854);var y=i(98507),g=i(10862),m=i(79460);function MerkleBlock(t){if(!(this instanceof MerkleBlock))return new MerkleBlock(t);var e={};if(a.isBuffer(t))e=MerkleBlock._fromBufferReader(u(t));else if(s.isObject(t))e={header:t.header instanceof o?t.header:o.fromObject(t.header),numTransactions:t.numTransactions,hashes:t.hashes,flags:t.flags};else throw TypeError("Unrecognized argument for MerkleBlock");return s.extend(this,e),this._flagBitsUsed=0,this._hashesUsed=0,this}MerkleBlock.fromBuffer=function(t){return MerkleBlock.fromBufferReader(u(t))},MerkleBlock.fromBufferReader=function(t){return new MerkleBlock(MerkleBlock._fromBufferReader(t))},MerkleBlock.prototype.toBuffer=function(){return this.toBufferWriter().concat()},MerkleBlock.prototype.toBufferWriter=function(t){t||(t=new c),t.write(this.header.toBuffer()),t.writeUInt32LE(this.numTransactions),t.writeVarintNum(this.hashes.length);for(var e=0;e<this.hashes.length;e++)t.write(n.from(this.hashes[e],"hex"));for(t.writeVarintNum(this.flags.length),e=0;e<this.flags.length;e++)t.writeUInt8(this.flags[e]);return t},MerkleBlock.prototype.toObject=MerkleBlock.prototype.toJSON=function(){return{header:this.header.toObject(),numTransactions:this.numTransactions,hashes:this.hashes,flags:this.flags}},MerkleBlock.prototype.validMerkleTree=function(){if(m.checkState(s.isArray(this.flags),"MerkleBlock flags is not an array"),m.checkState(s.isArray(this.hashes),"MerkleBlock hashes is not an array"),this.hashes.length>this.numTransactions||8*this.flags.length<this.hashes.length)return!1;var t=this._calcTreeHeight(),e={hashesUsed:0,flagBitsUsed:0},i=this._traverseMerkleTree(t,0,e);return e.hashesUsed===this.hashes.length&&a.equals(i,this.header.merkleRoot)},MerkleBlock.prototype.filterdTxsHash=function(){if(m.checkState(s.isArray(this.flags),"MerkleBlock flags is not an array"),m.checkState(s.isArray(this.hashes),"MerkleBlock hashes is not an array"),this.hashes.length>this.numTransactions||8*this.flags.length<this.hashes.length)throw new g.MerkleBlock.InvalidMerkleTree;if(1===this.hashes.length)return[];var t=this._calcTreeHeight(),e={hashesUsed:0,flagBitsUsed:0},i=this._traverseMerkleTree(t,0,e,!0);if(e.hashesUsed!==this.hashes.length)throw new g.MerkleBlock.InvalidMerkleTree;return i},MerkleBlock.prototype._traverseMerkleTree=function(t,e,i,s){(i=i||{}).txs=i.txs||[],i.flagBitsUsed=i.flagBitsUsed||0,i.hashesUsed=i.hashesUsed||0;var s=s||!1;if(i.flagBitsUsed>8*this.flags.length)return null;var o=this.flags[i.flagBitsUsed>>3]>>>(7&i.flagBitsUsed++)&1;if(0!==t&&o){var a=this._traverseMerkleTree(t-1,2*e,i),u=a;return(2*e+1<this._calcTreeWidth(t-1)&&(u=this._traverseMerkleTree(t-1,2*e+1,i)),s)?i.txs:p.sha256sha256(new n.concat([a,u]))}if(i.hashesUsed>=this.hashes.length)return null;var c=this.hashes[i.hashesUsed++];return 0===t&&o&&i.txs.push(c),n.from(c,"hex")},MerkleBlock.prototype._calcTreeWidth=function(t){return this.numTransactions+(1<<t)-1>>t},MerkleBlock.prototype._calcTreeHeight=function(){for(var t=0;this._calcTreeWidth(t)>1;)t++;return t},MerkleBlock.prototype.hasTransaction=function(t){m.checkArgument(!s.isUndefined(t),"tx cannot be undefined"),m.checkArgument(t instanceof y||"string"==typeof t,'Invalid tx given, tx must be a "string" or "Transaction"');var e=t;t instanceof y&&(e=a.reverse(n.from(t.id,"hex")).toString("hex"));var i=[],o=this._calcTreeHeight();return this._traverseMerkleTree(o,0,{txs:i}),-1!==i.indexOf(e)},MerkleBlock._fromBufferReader=function(t){m.checkState(!t.finished(),"No merkleblock data received");var e={};e.header=o.fromBufferReader(t),e.numTransactions=t.readUInt32LE();var i=t.readVarintNum();e.hashes=[];for(var n=0;n<i;n++)e.hashes.push(t.read(32).toString("hex"));var s=t.readVarintNum();for(n=0,e.flags=[];n<s;n++)e.flags.push(t.readUInt8());return e},MerkleBlock.fromObject=function(t){return new MerkleBlock(t)},t.exports=MerkleBlock},35418:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(77026),o=i(79460),a=i(96486);let u=i(19153);var reversebuf=function(t){for(var e=n.alloc(t.length),i=0;i<t.length;i++)e[i]=t[t.length-1-i];return e};s.Zero=new s(0),s.One=new s(1),s.Minus1=new s(-1),s.fromNumber=function(t){return o.checkArgument(a.isNumber(t)),new s(t)},s.fromString=function(t,e){return o.checkArgument(a.isString(t)),new s(t,e)},s.fromBuffer=function(t,e){o.checkArgument(u.isBuffer(t),"first argument should be a buffer"),t=n.from(t),void 0!==e&&"little"===e.endian&&(t=reversebuf(t));var i=t.toString("hex");return new s(i,16)},s.fromSM=function(t,e){if(0===t.length)return s.fromBuffer(n.from([0]));var i,o="big";return e&&(o=e.endian),"little"===o&&(t=reversebuf(t)),128&t[0]?(t[0]=127&t[0],(i=s.fromBuffer(t)).neg().copy(i)):i=s.fromBuffer(t),i},s.prototype.toNumber=function(){return parseInt(this.toString(10),10)},s.prototype.toBuffer=function(t){var e,i;if(t&&t.size){var o=(i=this.toString(16,2)).length/2;e=n.from(i,"hex"),o===t.size||(o>t.size?e=s.trim(e,o):o<t.size&&(e=s.pad(e,o,t.size)))}else i=this.toString(16,2),e=n.from(i,"hex");return void 0!==t&&"little"===t.endian&&(e=reversebuf(e)),e},s.prototype.toSMBigEndian=function(){var t;return -1===this.cmp(s.Zero)?128&(t=this.neg().toBuffer())[0]?t=n.concat([n.from([128]),t]):t[0]=128|t[0]:128&(t=this.toBuffer())[0]&&(t=n.concat([n.from([0]),t])),1===t.length&0===t[0]&&(t=n.from([])),t},s.prototype.toSM=function(t){var e=t?t.endian:"big",i=this.toSMBigEndian();return"little"===e&&(i=reversebuf(i)),i},s.fromScriptNumBuffer=function(t,e,i){var n=i||4;if(o.checkArgument(t.length<=n,Error("script number overflow")),e&&t.length>0&&(127&t[t.length-1])==0&&(t.length<=1||(128&t[t.length-2])==0))throw Error("non-minimally encoded script number");return s.fromSM(t,{endian:"little"})},s.prototype.toScriptNumBuffer=function(){return this.toSM({endian:"little"})},s.trim=function(t,e){return t.slice(e-t.length,t.length)},s.pad=function(t,e,i){for(var s=n.alloc(i),o=0;o<t.length;o++)s[s.length-1-o]=t[t.length-1-o];for(o=0;o<i-e;o++)s[o]=0;return s},t.exports=s},30044:function(t,e,i){"use strict";var n=i(48764).Buffer;let s=i(35418),o=i(29143),a=i(72571),u=i(39521),c=i(42773),p=i(66812),y=i(19153),g=i(79460),getPublicKey=function(t,e,i){g.checkArgument(0===i||1===i||2===i||3===i,Error("i must be equal to 0, 1, 2, or 3"));var n=s.fromBuffer(t),a=e.r,c=e.s,p=1&i,y=i>>1,m=o.getN(),b=o.getG(),S=y?a.add(m):a,v=o.fromX(p,S);if(!v.mul(m).isInfinity())throw Error("nR is not a valid curve point");var _=n.neg().umod(m),P=a.invm(m),w=v.mul(c).add(b.mul(_)).mul(P);return u.fromPoint(w,e.compressed)},getRandomK=function(){var t,e=o.getN();do t=s.fromBuffer(c.getRandomBuffer(32));while(!(t.lt(e)&&t.gt(s.Zero)));return t},getDeterministicK=function(t,e,i){i||(i=0);var a=n.alloc(32);a.fill(1);var u=n.alloc(32);u.fill(0);var c=e.bn.toBuffer({size:32});u=p.sha256hmac(n.concat([a,n.from([0]),c,t]),u),a=p.sha256hmac(a,u),u=p.sha256hmac(n.concat([a,n.from([1]),c,t]),u),a=p.sha256hmac(a,u),a=p.sha256hmac(a,u);for(var y=s.fromBuffer(a),g=o.getN(),m=0;m<i||!(y.lt(g)&&y.gt(s.Zero));m++)u=p.sha256hmac(n.concat([a,n.from([0])]),u),a=p.sha256hmac(a,u),a=p.sha256hmac(a,u),y=s.fromBuffer(a);return y},toLowS=function(t){return t.gt(new s("7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0","hex"))&&(t=o.getN().sub(t)),t},verificationError=function(t,e,i,n){let{endian:a="big"}=n||{};if(!y.isBuffer(t)||32!==t.length)return"hashbuf must be a 32 byte buffer";var u=e.r,c=e.s;if(!(u.gt(s.Zero)&&u.lt(o.getN()))||!(c.gt(s.Zero)&&c.lt(o.getN())))return"r and s not in range";var p=s.fromBuffer(t,{endian:a}),g=o.getN(),m=c.invm(g),b=m.mul(p).umod(g),S=m.mul(u).umod(g),v=o.getG().mulAdd(b,i.point,S);return v.isInfinity()?"p is infinity":0!==v.getX().umod(g).cmp(u)?"Invalid signature":void 0};t.exports={sign:function(t,e,i){let{endian:u="big",randomK:c=!1}=i||{};g.checkState(y.isBuffer(t)&&32===t.length,"hashbuf must be a 32 byte buffer"),g.checkState(e&&e.bn,"privkey must be a PrivateKey");var p,m,b,S=e.bn;t=n.from(t),"little"===u&&t.reverse();var v=s.fromBuffer(t),_=o.getN(),P=o.getG(),w=0;do p=c?getRandomK():getDeterministicK(t,e,w),w++,m=P.mul(p).x.umod(_),b=p.invm(_).mul(v.add(S.mul(m))).umod(_);while(0>=m.cmp(s.Zero)||0>=b.cmp(s.Zero));return b=toLowS(b),new a({s:b,r:m,compressed:e.publicKey.compressed})},verify:function(t,e,i,n){if(!i)throw Error("pubkey required for signature verification");if(i=new u(i),!e)throw Error("signature required for verification");return!verificationError(t,e=new a(e),i,n)},verificationError,calci:function(t,e,i){for(var n,s=0;s<4;s++){try{n=getPublicKey(t,e,s)}catch(t){console.error(t);continue}if(n.point.eq(i.point))return e.i=s,e.compressed=i.compressed,e}throw Error("Unable to find valid recovery factor")},recoverPublicKey:function(t,e){return getPublicKey(t,e,e.i)}},t.exports.__testing__={getDeterministicK,getPublicKey,getRandomK,toLowS}},66812:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(42474),o=i(19153),a=i(79460),u=t.exports;u.sha1=function(t){return a.checkArgument(o.isBuffer(t)),s.createHash("sha1").update(t).digest()},u.sha1.blocksize=512,u.sha256=function(t){return a.checkArgument(o.isBuffer(t)),s.createHash("sha256").update(t).digest()},u.sha256.blocksize=512,u.sha256sha256=function(t){return a.checkArgument(o.isBuffer(t)),u.sha256(u.sha256(t))},u.ripemd160=function(t){return a.checkArgument(o.isBuffer(t)),s.createHash("ripemd160").update(t).digest()},u.sha256ripemd160=function(t){return a.checkArgument(o.isBuffer(t)),u.ripemd160(u.sha256(t))},u.sha512=function(t){return a.checkArgument(o.isBuffer(t)),s.createHash("sha512").update(t).digest()},u.sha512.blocksize=1024,u.hmac=function(t,e,i){a.checkArgument(o.isBuffer(e)),a.checkArgument(o.isBuffer(i)),a.checkArgument(t.blocksize);var s=t.blocksize/8;if(i.length>s)i=t(i);else if(i<s){var u=n.alloc(s);u.fill(0),i.copy(u),i=u}var c=n.alloc(s);c.fill(92);var p=n.alloc(s);p.fill(54);for(var y=n.alloc(s),g=n.alloc(s),m=0;m<s;m++)y[m]=c[m]^i[m],g[m]=p[m]^i[m];return t(n.concat([y,t(n.concat([g,e]))]))},u.sha256hmac=function(t,e){return u.hmac(u.sha256,t,e)},u.sha512hmac=function(t,e){return u.hmac(u.sha512,t,e)}},29143:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(35418),o=i(19153),a=new(i(86266)).ec("secp256k1"),u=a.curve.point.bind(a.curve),c=a.curve.pointFromX.bind(a.curve),Point=function(t,e,i){try{var n=u(t,e,i)}catch(t){throw Error("Invalid Point")}return n.validate(),n};Point.prototype=Object.getPrototypeOf(a.curve.point()),Point.fromX=function(t,e){try{var i=c(e,t)}catch(t){throw Error("Invalid X")}return i.validate(),i},Point.getG=function(){return a.curve.g},Point.getN=function(){return new s(a.curve.n.toArray())},Point.getP=function(){return a.curve.p.clone()},Point.prototype._getX=Point.prototype.getX,Point.prototype.getX=function(){return new s(this._getX().toArray())},Point.prototype._getY=Point.prototype.getY,Point.prototype.getY=function(){return new s(this._getY().toArray())},Point.prototype.validate=function(){var t;if(this.isInfinity())throw Error("Point cannot be equal to Infinity");try{t=c(this.getX(),this.getY().isOdd())}catch(t){throw Error("Point does not lie on the curve")}if(0!==t.y.cmp(this.y))throw Error("Invalid y value for curve.");if(!this.mul(Point.getN()).isInfinity())throw Error("Point times N must be infinity");return this},Point.pointToCompressed=function(t){var e,i=t.getX().toBuffer({size:32}),s=t.getY().toBuffer({size:32});return e=s[s.length-1]%2?n.from([3]):n.from([2]),o.concat([e,i])},Point.prototype.liftX=function(){let t=Point.getP(),e=new s(0),i=new s(1),n=new s(2),o=new s(3),a=new s(4),u=new s(7),c=s.red("k256"),p=this.x.pow(o).add(u).mod(t),y=p.toRed(c).redPow(t.add(i).div(a)).mod(t);if(!p.eq(y.pow(n).mod(t)))throw Error("liftX failed");let g=this.x.red?this.x.fromRed():this.x,m=y.mod(n).eq(e)?y.fromRed():t.sub(y);return new Point(g,m,!0)},t.exports=Point},42773:function(t,e,i){"use strict";var n=i(48764).Buffer;function Random(){}Random.getRandomBuffer=function(t){return Random.getRandomBufferBrowser(t)},Random.getRandomBufferNode=function(t){return i(42474).randomBytes(t)},Random.getRandomBufferBrowser=function(t){if(!window.crypto&&!window.msCrypto)throw Error("window.crypto not available");if(window.crypto&&window.crypto.getRandomValues)var e=window.crypto;else if(window.msCrypto&&window.msCrypto.getRandomValues)var e=window.msCrypto;else throw Error("window.crypto.getRandomValues not available");var i=new Uint8Array(t);return e.getRandomValues(i),n.from(i)},Random.getPseudoRandomBuffer=function(t){for(var e,i=n.alloc(t),s=0;s<=t;s++){var o=Math.floor(s/4);0==s-4*o?(e=4294967296*Math.random(),i[s]=255&e):i[s]=255&(e>>>=8)}return i},t.exports=Random},84118:function(t,e,i){var n=i(48764).Buffer;let s=i(42474),o=i(79460),a=i(29854),u=i(35418),c=i(29143),p=i(83868),Schnorr=function Schnorr(){return this instanceof Schnorr?this:new Schnorr};Schnorr.prototype.set=function(){},Schnorr.sign=function(t,e,i){if(32!==(t=n.isBuffer(t)?t:t.toBuffer()).length)throw Error("Private key should be 32 bytes for schnorr signatures");"string"==typeof e&&(o.checkArgument(a.isHexaString(e),"Schnorr message string is not hex"),e=n.from(e,"hex")),o.checkArgument(o.isType(e,"Buffer"),"Schnorr message must be a hex string or buffer"),i||(i=s.randomBytes(32)),"string"==typeof i&&(o.checkArgument(a.isHexaString(i),"Schnorr aux string is not hex"),i=n.from(i,"hex")),o.checkArgument(o.isType(i,"Buffer"),"Schnorr aux must be a hex string or buffer");let y=c.getG(),g=c.getN(),m=new u(t);if(m.eqn(0)||m.gte(g))throw Error("Invalid private key for schnorr signing");let b=y.mul(m),S=n.from(b.encodeCompressed().slice(1)),v=b.y.isEven()?m:g.sub(m),_=v.xor(new u(new p("BIP0340/aux",i).finalize())),P=new p("BIP0340/nonce",n.concat([_.toBuffer(),S,e])).finalize(),w=new u(P).mod(g);if(w.eqn(0))throw Error("Error creating schnorr signature");let E=y.mul(w),I=n.from(E.encodeCompressed().slice(1)),T=E.y.isEven()?w:g.sub(w),k=new u(new p("BIP0340/challenge",n.concat([I,S,e])).finalize()).mod(g),A=n.concat([I,T.add(k.mul(v)).mod(g).toBuffer({size:32})]);if(!Schnorr.verify(S,e,A))throw Error("Error creating schnorr signature. Verification failed");return A},Schnorr.verify=function(t,e,i){if(o.isType(t,"PublicKey")&&(t=t.point.x.toBuffer()),32!==t.length)throw Error("Public key should be 32 bytes for schnorr signatures");if("string"==typeof e&&(o.checkArgument(a.isHexaString(e),"Schnorr message string is not hex"),e=n.from(e,"hex")),32!==e.length)throw Error("Message should be a 32 byte buffer");if("string"==typeof i&&(o.checkArgument(a.isHexaString(i),"Schnorr signature string is not hex"),i=n.from(i,"hex")),"function"==typeof i.toBuffer&&65===(i=i.toBuffer()).length&&(i=i.slice(0,64)),64!==i.length)throw Error("Signature should be a 64 byte buffer. Got "+i.length+" bytes");try{let n=c.getP(),s=c.getN(),o=c.fromX(!1,t).liftX(),a=new u(i.slice(0,32)),p=new u(i.slice(32,64));if(a.gte(n)||p.gte(s))return!1;let y=getE(a,o,e),g=c.getG(),m=g.mul(p).add(o.mul(y).neg());if(m.inf||!m.y.isEven()||!m.x.eq(a))return!1;return!0}catch(t){return!1}};let getE=function(t,e,i){let s=c.getN(),o=new p("BIP0340/challenge",n.concat([t.toBuffer({size:32}),e.x.toBuffer({size:32}),i])).finalize();return new u(o).mod(s)};t.exports=Schnorr},72571:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(35418),o=i(96486),a=i(79460),u=i(19153),c=i(29854),Signature=function Signature(t,e,i){if(!(this instanceof Signature))return new Signature(t,e,i);t instanceof s?this.set({r:t,s:e,isSchnorr:i}):t&&this.set(t)};Signature.prototype.set=function(t){return this.r=t.r||this.r||void 0,this.s=t.s||this.s||void 0,this.i=void 0===t.i?this.i:t.i,this.compressed=void 0===t.compressed?this.compressed:t.compressed,this.isSchnorr=void 0===t.isSchnorr?this.isSchnorr:t.isSchnorr,this.nhashtype=t.nhashtype||this.nhashtype||void 0,this},Signature.fromCompact=function(t){a.checkArgument(u.isBuffer(t),"Argument is expected to be a Buffer");var e=new Signature,i=!0,n=t.slice(0,1)[0]-27-4;n<0&&(i=!1,n+=4);var o=t.slice(1,33),c=t.slice(33,65);return a.checkArgument(0===n||1===n||2===n||3===n,Error("i must be 0, 1, 2, or 3")),a.checkArgument(32===o.length,Error("r must be 32 bytes")),a.checkArgument(32===c.length,Error("s must be 32 bytes")),e.compressed=i,e.i=n,e.r=s.fromBuffer(o),e.s=s.fromBuffer(c),e},Signature.fromDER=Signature.fromBuffer=function(t,e){var i=new Signature;if((64===t.length||65===t.length)&&48!=t[0])return Signature.fromSchnorr(t);a.checkArgument(!(64===t.length&&48===t[0]),Error("64 DER (ecdsa) signatures not allowed"));var n=Signature.parseDER(t,e);return i.r=n.r,i.s=n.s,i},Signature.fromTxFormat=function(t){var e=t.readUInt8(t.length-1),i=t.slice(0,t.length-1),n=new Signature.fromDER(i,!1);return n.nhashtype=e,n},Signature.fromString=function(t){var e=n.from(t,"hex");return Signature.fromDER(e)},Signature.parseDER=function(t,e){a.checkArgument(u.isBuffer(t),Error("DER formatted signature should be a buffer")),o.isUndefined(e)&&(e=!0);var i=t[0];a.checkArgument(48===i,Error("Header byte should be 0x30"));var n=t[1],c=t.slice(2).length;a.checkArgument(!e||n===c,Error("Length byte should length of what follows")),n=n<c?n:c;var p=t[2];a.checkArgument(2===p,Error("Integer byte for r should be 0x02"));var y=t[3],g=t.slice(4,4+y),m=s.fromBuffer(g),b=0===t[4];a.checkArgument(y===g.length,Error("Length of r incorrect"));var S=t[4+y+0];a.checkArgument(2===S,Error("Integer byte for s should be 0x02"));var v=t[4+y+1],_=t.slice(4+y+2,4+y+2+v),P=s.fromBuffer(_),w=0===t[4+y+2+2];a.checkArgument(v===_.length,Error("Length of s incorrect"));var E=4+y+2+v;return a.checkArgument(n===E-2,Error("Length of signature incorrect")),{header:i,length:n,rheader:p,rlength:y,rneg:b,rbuf:g,r:m,sheader:S,slength:v,sneg:w,sbuf:_,s:P}},Signature.prototype.toCompact=function(t,e){if(t="number"==typeof t?t:this.i,e="boolean"==typeof e?e:this.compressed,!(0===t||1===t||2===t||3===t))throw Error("i must be equal to 0, 1, 2, or 3");var i=t+27+4;!1===e&&(i-=4);var s=n.from([i]),o=this.r.toBuffer({size:32}),a=this.s.toBuffer({size:32});return n.concat([s,o,a])},Signature.prototype.toBuffer=Signature.prototype.toDER=function(){if(this.isSchnorr){let t=this.nhashtype&&this.nhashtype!==Signature.SIGHASH_DEFAULT?n.from([this.nhashtype]):n.alloc(0);return n.concat([this.r.toBuffer({size:32}),this.s.toBuffer({size:32}),t])}var t=this.r.toBuffer(),e=this.s.toBuffer(),i=!!(128&t[0]),s=!!(128&e[0]),o=i?n.concat([n.from([0]),t]):t,a=s?n.concat([n.from([0]),e]):e,u=o.length,c=a.length,p=2+u+2+c;return n.concat([n.from([48,p,2,u]),o,n.from([2,c]),a])},Signature.prototype.toString=function(){return this.toDER().toString("hex")},Signature.isTxDER=function(t){if(t.length<9||t.length>73||48!==t[0]||t[1]!==t.length-3)return!1;var e=t[3];if(5+e>=t.length)return!1;var i=t[5+e];if(e+i+7!==t.length)return!1;var n=t.slice(4);if(2!==t[2]||0===e||128&n[0]||e>1&&0===n[0]&&!(128&n[1]))return!1;var s=t.slice(6+e);return 2===t[6+e-2]&&0!==i&&!(128&s[0])&&(!(i>1)||0!==s[0]||!!(128&s[1]))},Signature.prototype.hasLowS=function(){return!(this.s.lt(new s(1))||this.s.gt(new s("7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0","hex")))},Signature.prototype.hasDefinedHashtype=function(){if(!c.isNaturalNumber(this.nhashtype))return!1;var t=this.nhashtype&~Signature.SIGHASH_ANYONECANPAY;return!(t<Signature.SIGHASH_ALL)&&!(t>Signature.SIGHASH_SINGLE)},Signature.prototype.toTxFormat=function(){var t=this.toDER(),e=n.alloc(1);return e.writeUInt8(this.nhashtype,0),n.concat([t,e])},Signature.fromSchnorr=function(t){a.checkArgument(n.isBuffer(t),"Schnorr signature argument must be a buffer"),a.checkArgument(64===t.length||65===t.length,"Schnorr signatures must be 64 or 65 bytes");let e=new Signature,i=t.slice(0,32),o=t.slice(32,64);return 65===t.length?(e.nhashtype=t[t.length-1],a.checkState(e.nhashtype!==Signature.SIGHASH_DEFAULT,Error("invalid hashtype"))):e.nhashtype=Signature.SIGHASH_DEFAULT,e.r=s.fromBuffer(i),e.s=s.fromBuffer(o),e.isSchnorr=!0,e},Signature.SIGHASH_DEFAULT=0,Signature.SIGHASH_ALL=1,Signature.SIGHASH_NONE=2,Signature.SIGHASH_SINGLE=3,Signature.SIGHASH_ANYONECANPAY=128,Signature.SIGHASH_OUTPUT_MASK=3,Signature.SIGHASH_INPUT_MASK=128,Signature.Version={},Signature.Version.BASE=0,Signature.Version.WITNESS_V0=1,Signature.Version.TAPROOT=2,Signature.Version.TAPSCRIPT=3,t.exports=Signature},83868:function(t,e,i){var n=i(48764).Buffer;let s=i(66812),o=i(64926),a=i(9213);function TaggedHash(t,e,i="hex"){if(!(this instanceof TaggedHash))return new TaggedHash(t,e,i);o.apply(this),t=n.from(t);let a=s.sha256(t);return this.write(a),this.write(a),e&&(e=n.isBuffer(e)?e:n.from(e,i),this.write(e)),this}a(TaggedHash,o),TaggedHash.prototype.finalize=function(){return n.from(s.sha256(this.toBuffer()))},Object.defineProperties(TaggedHash,{TAPSIGHASH:{get:()=>new TaggedHash("TapSighash")},TAPLEAF:{get:()=>new TaggedHash("TapLeaf")},TAPBRANCH:{get:()=>new TaggedHash("TapBranch")}}),t.exports=TaggedHash},52131:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(9384),a=i(48764),u="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz".split(""),Base58=function Base58(t){if(!(this instanceof Base58))return new Base58(t);n.isBuffer(t)?this.fromBuffer(t):"string"==typeof t?this.fromString(t):t&&this.set(t)};Base58.validCharacters=function(t){return a.Buffer.isBuffer(t)&&(t=t.toString()),s.every(s.map(t,function(t){return s.includes(u,t)}))},Base58.prototype.set=function(t){return this.buf=t.buf||this.buf||void 0,this},Base58.encode=function(t){if(!a.Buffer.isBuffer(t))throw Error("Input should be a buffer");return o.encode(t)},Base58.decode=function(t){if("string"!=typeof t)throw Error("Input should be a string");return n.from(o.decode(t))},Base58.prototype.fromBuffer=function(t){return this.buf=t,this},Base58.prototype.fromString=function(t){var e=Base58.decode(t);return this.buf=e,this},Base58.prototype.toBuffer=function(){return this.buf},Base58.prototype.toString=function(){return Base58.encode(this.buf)},t.exports=Base58},36517:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(52131);i(48764);var a=i(66812).sha256sha256,Base58Check=function Base58Check(t){if(!(this instanceof Base58Check))return new Base58Check(t);n.isBuffer(t)?this.fromBuffer(t):"string"==typeof t?this.fromString(t):t&&this.set(t)};Base58Check.prototype.set=function(t){return this.buf=t.buf||this.buf||void 0,this},Base58Check.validChecksum=function(t,e){return s.isString(t)&&(t=n.from(o.decode(t))),s.isString(e)&&(e=n.from(o.decode(e))),e||(e=t.slice(-4),t=t.slice(0,-4)),Base58Check.checksum(t).toString("hex")===e.toString("hex")},Base58Check.decode=function(t){if("string"!=typeof t)throw Error("Input must be a string");var e=n.from(o.decode(t));if(e.length<4)throw Error("Input string too short");var i=e.slice(0,-4),s=e.slice(-4),u=a(i).slice(0,4);if(s.toString("hex")!==u.toString("hex"))throw Error("Checksum mismatch");return i},Base58Check.checksum=function(t){return a(t).slice(0,4)},Base58Check.encode=function(t){if(!n.isBuffer(t))throw Error("Input must be a buffer");var e=n.alloc(t.length+4),i=Base58Check.checksum(t);return t.copy(e),i.copy(e,t.length),o.encode(e)},Base58Check.prototype.fromBuffer=function(t){return this.buf=t,this},Base58Check.prototype.fromString=function(t){var e=Base58Check.decode(t);return this.buf=e,this},Base58Check.prototype.toBuffer=function(){return this.buf},Base58Check.prototype.toString=function(){return Base58Check.encode(this.buf)},t.exports=Base58Check},64567:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(27715);let o={BECH32:1,BECH32M:2};t.exports={decode:function(t){var e;if("string"!=typeof t)throw Error("Input should be a string");let i=s.bech32.fromWords,a=o.BECH32;try{e=s.bech32.decode(t)}catch(n){if(n.message.indexOf("Invalid checksum")>-1)e=s.bech32m.decode(t),a=o.BECH32M,i=s.bech32m.fromWords;else throw n}let u=e.words[0];if(u>=1&&a!==o.BECH32M)throw Error("Version 1+ witness address must use Bech32m checksum");return{prefix:e.prefix,data:n.from(i(e.words.slice(1))),version:u}},encode:function(t,e,i,n){if("string"!=typeof t)throw Error("Prefix should be a string");if("number"!=typeof e)throw Error("version should be a number");if(n&&"string"==typeof n&&(n=o[n.toUpperCase()]||-1),n&&!(n==o.BECH32||n==o.BECH32M))throw Error("Invalid encoding specified");let a=n==o.BECH32M?s.bech32m:s.bech32,u=a.toWords(i);return u.unshift(e),a.encode(t,u)},encodings:o}},10992:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(79460),a=i(19153),u=i(35418),BufferReader=function BufferReader(t){if(!(this instanceof BufferReader))return new BufferReader(t);if(!s.isUndefined(t)){if(n.isBuffer(t))this.set({buf:t});else if(s.isString(t))this.set({buf:n.from(t,"hex")});else if(s.isObject(t))this.set(t);else throw TypeError("Unrecognized argument for BufferReader")}};BufferReader.prototype.set=function(t){return this.buf=t.buf||this.buf||void 0,this.pos=t.pos||this.pos||0,this},BufferReader.prototype.eof=function(){return!this.buf||this.pos>=this.buf.length},BufferReader.prototype.finished=BufferReader.prototype.eof,BufferReader.prototype.read=function(t){o.checkArgument(!s.isUndefined(t),"Must specify a length");var e=this.buf.slice(this.pos,this.pos+t);return this.pos=this.pos+t,e},BufferReader.prototype.readAll=function(){var t=this.buf.slice(this.pos,this.buf.length);return this.pos=this.buf.length,t},BufferReader.prototype.readUInt8=function(){var t=this.buf.readUInt8(this.pos);return this.pos=this.pos+1,t},BufferReader.prototype.readUInt16BE=function(){var t=this.buf.readUInt16BE(this.pos);return this.pos=this.pos+2,t},BufferReader.prototype.readUInt16LE=function(){var t=this.buf.readUInt16LE(this.pos);return this.pos=this.pos+2,t},BufferReader.prototype.readUInt32BE=function(){var t=this.buf.readUInt32BE(this.pos);return this.pos=this.pos+4,t},BufferReader.prototype.readUInt32LE=function(){var t=this.buf.readUInt32LE(this.pos);return this.pos=this.pos+4,t},BufferReader.prototype.readInt32LE=function(){var t=this.buf.readInt32LE(this.pos);return this.pos=this.pos+4,t},BufferReader.prototype.readUInt64BEBN=function(){var t=this.buf.slice(this.pos,this.pos+8),e=u.fromBuffer(t);return this.pos=this.pos+8,e},BufferReader.prototype.readUInt64LEBN=function(){var t,e=this.buf.readUInt32LE(this.pos),i=4294967296*this.buf.readUInt32LE(this.pos+4)+e;if(i<=9007199254740991)t=new u(i);else{var n=Array.prototype.slice.call(this.buf,this.pos,this.pos+8);t=new u(n,10,"le")}return this.pos=this.pos+8,t},BufferReader.prototype.readVarintNum=function(){var t=this.readUInt8();switch(t){case 253:return this.readUInt16LE();case 254:return this.readUInt32LE();case 255:var e=this.readUInt64LEBN().toNumber();if(e<=9007199254740992)return e;throw Error("number too large to retain precision - use readVarintBN");default:return t}},BufferReader.prototype.readVarLengthBuffer=function(){var t=this.readVarintNum(),e=this.read(t);return o.checkState(e.length===t,"Invalid length while reading varlength buffer. Expected to read: "+t+" and read "+e.length),e},BufferReader.prototype.readVarintBuf=function(){switch(this.buf.readUInt8(this.pos)){case 253:return this.read(3);case 254:return this.read(5);case 255:return this.read(9);default:return this.read(1)}},BufferReader.prototype.readVarintBN=function(){var t=this.readUInt8();switch(t){case 253:return new u(this.readUInt16LE());case 254:return new u(this.readUInt32LE());case 255:return this.readUInt64LEBN();default:return new u(t)}},BufferReader.prototype.reverse=function(){for(var t=n.alloc(this.buf.length),e=0;e<t.length;e++)t[e]=this.buf[this.buf.length-1-e];return this.buf=t,this},BufferReader.prototype.readReverse=function(t){s.isUndefined(t)&&(t=this.buf.length);var e=this.buf.slice(this.pos,this.pos+t);return this.pos=this.pos+t,a.reverse(e)},t.exports=BufferReader},64926:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(19153),o=i(69282),BufferWriter=function BufferWriter(t){if(!(this instanceof BufferWriter))return new BufferWriter(t);this.bufLen=0,t?this.set(t):this.bufs=[]};BufferWriter.prototype.set=function(t){return this.bufs=t.bufs||this.bufs||[],this.bufLen=this.bufs.reduce(function(t,e){return t+e.length},0),this},BufferWriter.prototype.toBuffer=function(){return this.concat()},BufferWriter.prototype.concat=function(){return n.concat(this.bufs,this.bufLen)},BufferWriter.prototype.write=function(t){return o(s.isBuffer(t)),this.bufs.push(t),this.bufLen+=t.length,this},BufferWriter.prototype.writeReverse=function(t){return o(s.isBuffer(t)),this.bufs.push(s.reverse(t)),this.bufLen+=t.length,this},BufferWriter.prototype.writeUInt8=function(t){t<0&&(t>>>=0);var e=n.alloc(1);return e.writeUInt8(t,0),this.write(e),this},BufferWriter.prototype.writeUInt16BE=function(t){t<0&&(t>>>=0);var e=n.alloc(2);return e.writeUInt16BE(t,0),this.write(e),this},BufferWriter.prototype.writeUInt16LE=function(t){t<0&&(t>>>=0);var e=n.alloc(2);return e.writeUInt16LE(t,0),this.write(e),this},BufferWriter.prototype.writeUInt32BE=function(t){t<0&&(t>>>=0);var e=n.alloc(4);return e.writeUInt32BE(t,0),this.write(e),this},BufferWriter.prototype.writeInt32LE=function(t){var e=n.alloc(4);return e.writeInt32LE(t,0),this.write(e),this},BufferWriter.prototype.writeUInt32LE=function(t){t<0&&(t>>>=0);var e=n.alloc(4);return e.writeUInt32LE(t,0),this.write(e),this},BufferWriter.prototype.writeUInt64BEBN=function(t){var e=t.toBuffer({size:8});return this.write(e),this},BufferWriter.prototype.writeUInt64LEBN=function(t){var e=t.toBuffer({size:8});return this.writeReverse(e),this},BufferWriter.prototype.writeVarintNum=function(t){var e=BufferWriter.varintBufNum(t);return this.write(e),this},BufferWriter.prototype.writeVarintBN=function(t){var e=BufferWriter.varintBufBN(t);return this.write(e),this},BufferWriter.varintBufNum=function(t){var e=void 0;return t<253?(e=n.alloc(1)).writeUInt8(t,0):t<65536?((e=n.alloc(3)).writeUInt8(253,0),e.writeUInt16LE(t,1)):t<4294967296?((e=n.alloc(5)).writeUInt8(254,0),e.writeUInt32LE(t,1)):((e=n.alloc(9)).writeUInt8(255,0),e.writeInt32LE(-1&t,1),e.writeUInt32LE(Math.floor(t/4294967296),5)),e},BufferWriter.varintBufBN=function(t){var e=void 0,i=t.toNumber();if(i<253)(e=n.alloc(1)).writeUInt8(i,0);else if(i<65536)(e=n.alloc(3)).writeUInt8(253,0),e.writeUInt16LE(i,1);else if(i<4294967296)(e=n.alloc(5)).writeUInt8(254,0),e.writeUInt32LE(i,1);else{var s=new BufferWriter;s.writeUInt8(255),s.writeUInt64LEBN(t);var e=s.concat()}return e},t.exports=BufferWriter},28948:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(64926),o=i(10992),a=i(35418),Varint=function Varint(t){if(!(this instanceof Varint))return new Varint(t);n.isBuffer(t)?this.buf=t:"number"==typeof t?this.fromNumber(t):t instanceof a?this.fromBN(t):t&&this.set(t)};Varint.prototype.set=function(t){return this.buf=t.buf||this.buf,this},Varint.prototype.fromString=function(t){return this.set({buf:n.from(t,"hex")}),this},Varint.prototype.toString=function(){return this.buf.toString("hex")},Varint.prototype.fromBuffer=function(t){return this.buf=t,this},Varint.prototype.fromBufferReader=function(t){return this.buf=t.readVarintBuf(),this},Varint.prototype.fromBN=function(t){return this.buf=s().writeVarintBN(t).concat(),this},Varint.prototype.fromNumber=function(t){return this.buf=s().writeVarintNum(t).concat(),this},Varint.prototype.toBuffer=function(){return this.buf},Varint.prototype.toBN=function(){return o(this.buf).readVarintBN()},Varint.prototype.toNumber=function(){return o(this.buf).readVarintNum()},t.exports=Varint},10862:function(t,e,i){"use strict";var n=i(96486),traverseNode=function(t,e){var NodeError=function(){if(n.isString(e.message)){var t,i;this.message=(t=e.message,i=arguments,t.replace("{0}",i[0]).replace("{1}",i[1]).replace("{2}",i[2]))}else if(n.isFunction(e.message))this.message=e.message.apply(null,arguments);else throw Error("Invalid error definition for "+e.name);this.stack=this.message+"\n"+Error().stack};return NodeError.prototype=Object.create(t.prototype),NodeError.prototype.name=t.prototype.name+e.name,t[e.name]=NodeError,e.errors&&childDefinitions(NodeError,e.errors),NodeError},childDefinitions=function(t,e){n.each(e,function(e){traverseNode(t,e)})},s={};s.Error=function(){this.message="Internal error",this.stack=this.message+"\n"+Error().stack},s.Error.prototype=Object.create(Error.prototype),s.Error.prototype.name="bitcore.Error";var o=i(92082);childDefinitions(s.Error,o),t.exports=s.Error,t.exports.extend=function(t){return traverseNode(s.Error,t)}},92082:function(t){"use strict";t.exports=[{name:"InvalidB58Char",message:"Invalid Base58 character: {0} in {1}"},{name:"InvalidB58Checksum",message:"Invalid Base58 checksum for {0}"},{name:"InvalidNetwork",message:"Invalid version for network: got {0}"},{name:"InvalidState",message:"Invalid state: {0}"},{name:"NotImplemented",message:"Function {0} was not implemented yet"},{name:"InvalidNetworkArgument",message:'Invalid network: must be "livenet" or "testnet", got {0}'},{name:"InvalidArgument",message:function(){return"Invalid Argument"+(arguments[0]?": "+arguments[0]:"")+(arguments[1]?" Documentation: http://bitcore.io/"+arguments[1]:"")}},{name:"AbstractMethodInvoked",message:"Abstract Method Invocation: {0}"},{name:"InvalidArgumentType",message:function(){return"Invalid Argument for "+arguments[2]+", expected "+arguments[1]+" but got "+typeof arguments[0]}},{name:"Unit",message:"Internal Error on Unit {0}",errors:[{name:"UnknownCode",message:"Unrecognized unit code: {0}"},{name:"InvalidRate",message:"Invalid exchange rate: {0}"}]},{name:"MerkleBlock",message:"Internal Error on MerkleBlock {0}",errors:[{name:"InvalidMerkleTree",message:"This MerkleBlock contain an invalid Merkle Tree"}]},{name:"Transaction",message:"Internal Error on Transaction {0}",errors:[{name:"Input",message:"Internal Error on Input {0}",errors:[{name:"MissingScript",message:"Need a script to create an input"},{name:"UnsupportedScript",message:"Unsupported input script type: {0}"},{name:"MissingPreviousOutput",message:"No previous output information."},{name:"BlockHeightOutOfRange",message:"Block Height can only be between 0 and 65535"},{name:"LockTimeRange",message:"Seconds needs to be more that 0 and less that 33553920"}]},{name:"NeedMoreInfo",message:"{0}"},{name:"InvalidSorting",message:"The sorting function provided did not return the change output as one of the array elements"},{name:"InvalidOutputAmountSum",message:"{0}"},{name:"MissingSignatures",message:"Some inputs have not been fully signed"},{name:"InvalidIndex",message:"Invalid index: {0} is not between 0, {1}"},{name:"UnableToVerifySignature",message:"Unable to verify signature: {0}"},{name:"DustOutputs",message:"Dust amount detected in one output"},{name:"InvalidSatoshis",message:"Output satoshis are invalid"},{name:"FeeError",message:"Internal Error on Fee {0}",errors:[{name:"TooSmall",message:"Fee is too small: {0}"},{name:"TooLarge",message:"Fee is too large: {0}"},{name:"Different",message:"Unspent value is different from specified fee: {0}"}]},{name:"ChangeAddressMissing",message:"Change address is missing"},{name:"BlockHeightTooHigh",message:"Block Height can be at most 2^32 -1"},{name:"NLockTimeOutOfRange",message:"Block Height can only be between 0 and 499 999 999"},{name:"LockTimeTooEarly",message:"Lock Time can't be earlier than UNIX date 500 000 000"}]},{name:"Script",message:"Internal Error on Script {0}",errors:[{name:"UnrecognizedAddress",message:"Expected argument {0} to be an address"},{name:"CantDeriveAddress",message:"Can't derive address associated with script {0}, needs to be p2pkh in, p2pkh out, p2sh in, or p2sh out."},{name:"InvalidBuffer",message:"Invalid script buffer: can't parse valid script from given buffer {0}"}]},{name:"HDPrivateKey",message:"Internal Error on HDPrivateKey {0}",errors:[{name:"InvalidDerivationArgument",message:"Invalid derivation argument {0}, expected string, or number and boolean"},{name:"InvalidEntropyArgument",message:"Invalid entropy: must be an hexa string or binary buffer, got {0}",errors:[{name:"TooMuchEntropy",message:'Invalid entropy: more than 512 bits is non standard, got "{0}"'},{name:"NotEnoughEntropy",message:'Invalid entropy: at least 128 bits needed, got "{0}"'}]},{name:"InvalidLength",message:"Invalid length for xprivkey string in {0}"},{name:"InvalidPath",message:"Invalid derivation path: {0}"},{name:"UnrecognizedArgument",message:'Invalid argument: creating a HDPrivateKey requires a string, buffer, json or object, got "{0}"'}]},{name:"HDPublicKey",message:"Internal Error on HDPublicKey {0}",errors:[{name:"ArgumentIsPrivateExtended",message:"Argument is an extended private key: {0}"},{name:"InvalidDerivationArgument",message:"Invalid derivation argument: got {0}"},{name:"InvalidLength",message:'Invalid length for xpubkey: got "{0}"'},{name:"InvalidPath",message:'Invalid derivation path, it should look like: "m/1/100", got "{0}"'},{name:"InvalidIndexCantDeriveHardened",message:"Invalid argument: creating a hardened path requires an HDPrivateKey"},{name:"MustSupplyArgument",message:"Must supply an argument to create a HDPublicKey"},{name:"UnrecognizedArgument",message:"Invalid argument for creation, must be string, json, buffer, or object"}]}]},82650:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(69282),o=i(48764),a=i(96486),u=i(79460),c=i(35418),p=i(52131),y=i(36517),g=i(66812),m=i(6742),b=i(29143),S=i(57867),v=i(42773),_=i(10862),P=_.HDPrivateKey,w=i(19153),E=i(29854),I=1/8;function HDPrivateKey(t){if(t instanceof HDPrivateKey)return t;if(!(this instanceof HDPrivateKey))return new HDPrivateKey(t);if(!t)return this._generateRandomly();if(m.get(t))return this._generateRandomly(t);if(a.isString(t)||w.isBuffer(t)){if(HDPrivateKey.isValidSerialized(t))this._buildFromSerialized(t);else if(E.isValidJSON(t))this._buildFromJSON(t);else if(w.isBuffer(t)&&HDPrivateKey.isValidSerialized(t.toString()))this._buildFromSerialized(t.toString());else throw HDPrivateKey.getSerializedError(t)}else if(a.isObject(t))this._buildFromObject(t);else throw new P.UnrecognizedArgument(t)}HDPrivateKey.isValidPath=function(t,e){if(a.isString(t)){var i=HDPrivateKey._getDerivationIndexes(t);return null!==i&&a.every(i,HDPrivateKey.isValidPath)}return!!a.isNumber(t)&&(t<HDPrivateKey.Hardened&&!0===e&&(t+=HDPrivateKey.Hardened),t>=0&&t<HDPrivateKey.MaxIndex)},HDPrivateKey._getDerivationIndexes=function(t){var e=t.split("/");if(a.includes(HDPrivateKey.RootElementAlias,t))return[];if(!a.includes(HDPrivateKey.RootElementAlias,e[0]))return null;var i=e.slice(1).map(function(t){var e="'"===t.slice(-1);if(e&&(t=t.slice(0,-1)),!t||"-"===t[0])return NaN;var i=+t;return e&&(i+=HDPrivateKey.Hardened),i});return a.some(i,isNaN)?null:i},HDPrivateKey.prototype.derive=function(t,e){return this.deriveNonCompliantChild(t,e)},HDPrivateKey.prototype.deriveChild=function(t,e){if(a.isNumber(t))return this._deriveWithNumber(t,e);if(a.isString(t))return this._deriveFromString(t);throw new P.InvalidDerivationArgument(t)},HDPrivateKey.prototype.deriveNonCompliantChild=function(t,e){if(a.isNumber(t))return this._deriveWithNumber(t,e,!0);if(a.isString(t))return this._deriveFromString(t,!0);throw new P.InvalidDerivationArgument(t)},HDPrivateKey.prototype._deriveWithNumber=function(t,e,i){if(!HDPrivateKey.isValidPath(t,e))throw new P.InvalidPath(t);e=t>=HDPrivateKey.Hardened||e,t<HDPrivateKey.Hardened&&!0===e&&(t+=HDPrivateKey.Hardened);var o,a=w.integerAsBuffer(t);if(e&&i){var u=this.privateKey.bn.toBuffer();o=w.concat([n.from([0]),u,a])}else if(e){var p=this.privateKey.bn.toBuffer({size:32});s(32===p.length,"length of private key buffer is expected to be 32 bytes"),o=w.concat([n.from([0]),p,a])}else o=w.concat([this.publicKey.toBuffer(),a]);var y=g.sha512hmac(o,this._buffers.chainCode),m=c.fromBuffer(y.slice(0,32),{size:32}),v=y.slice(32,64),_=m.add(this.privateKey.toBigNumber()).umod(b.getN()).toBuffer({size:32});return S.isValid(_)?new HDPrivateKey({network:this.network,depth:this.depth+1,parentFingerPrint:this.fingerPrint,childIndex:t,chainCode:v,privateKey:_}):this._deriveWithNumber(t+1,null,i)},HDPrivateKey.prototype._deriveFromString=function(t,e){if(!HDPrivateKey.isValidPath(t))throw new P.InvalidPath(t);return HDPrivateKey._getDerivationIndexes(t).reduce(function(t,i){return t._deriveWithNumber(i,null,e)},this)},HDPrivateKey.isValidSerialized=function(t,e){return!HDPrivateKey.getSerializedError(t,e)},HDPrivateKey.getSerializedError=function(t,e){if(!(a.isString(t)||w.isBuffer(t)))return new P.UnrecognizedArgument("Expected string or buffer");if(!p.validCharacters(t))return new _.InvalidB58Char("(unknown)",t);try{t=y.decode(t)}catch(e){return new _.InvalidB58Checksum(t)}if(t.length!==HDPrivateKey.DataLength)return new P.InvalidLength(t);if(!a.isUndefined(e)){var i=HDPrivateKey._validateNetwork(t,e);if(i)return i}return null},HDPrivateKey._validateNetwork=function(t,e){var i=m.get(e);if(!i)return new _.InvalidNetworkArgument(e);var n=t.slice(0,4);return w.integerFromBuffer(n)!==i.xprivkey?new _.InvalidNetwork(n):null},HDPrivateKey.fromString=function(t){return u.checkArgument(a.isString(t),"No valid string was provided"),new HDPrivateKey(t)},HDPrivateKey.fromObject=function(t){return u.checkArgument(a.isObject(t),"No valid argument was provided"),new HDPrivateKey(t)},HDPrivateKey.prototype._buildFromJSON=function(t){return this._buildFromObject(JSON.parse(t))},HDPrivateKey.prototype._buildFromObject=function(t){var e={version:t.network?w.integerAsBuffer(m.get(t.network).xprivkey):t.version,depth:a.isNumber(t.depth)?w.integerAsSingleByteBuffer(t.depth):t.depth,parentFingerPrint:a.isNumber(t.parentFingerPrint)?w.integerAsBuffer(t.parentFingerPrint):t.parentFingerPrint,childIndex:a.isNumber(t.childIndex)?w.integerAsBuffer(t.childIndex):t.childIndex,chainCode:a.isString(t.chainCode)?n.from(t.chainCode,"hex"):t.chainCode,privateKey:a.isString(t.privateKey)&&E.isHexa(t.privateKey)?n.from(t.privateKey,"hex"):t.privateKey,checksum:t.checksum?t.checksum.length?t.checksum:w.integerAsBuffer(t.checksum):void 0};return this._buildFromBuffers(e)},HDPrivateKey.prototype._buildFromSerialized=function(t){var e=y.decode(t),i={version:e.slice(HDPrivateKey.VersionStart,HDPrivateKey.VersionEnd),depth:e.slice(HDPrivateKey.DepthStart,HDPrivateKey.DepthEnd),parentFingerPrint:e.slice(HDPrivateKey.ParentFingerPrintStart,HDPrivateKey.ParentFingerPrintEnd),childIndex:e.slice(HDPrivateKey.ChildIndexStart,HDPrivateKey.ChildIndexEnd),chainCode:e.slice(HDPrivateKey.ChainCodeStart,HDPrivateKey.ChainCodeEnd),privateKey:e.slice(HDPrivateKey.PrivateKeyStart,HDPrivateKey.PrivateKeyEnd),checksum:e.slice(HDPrivateKey.ChecksumStart,HDPrivateKey.ChecksumEnd),xprivkey:t};return this._buildFromBuffers(i)},HDPrivateKey.prototype._generateRandomly=function(t){return HDPrivateKey.fromSeed(v.getRandomBuffer(64),t)},HDPrivateKey.fromSeed=function(t,e){if(E.isHexaString(t)&&(t=n.from(t,"hex")),!n.isBuffer(t))throw new P.InvalidEntropyArgument(t);if(t.length<128*I)throw new P.InvalidEntropyArgument.NotEnoughEntropy(t);if(t.length>512*I)throw new P.InvalidEntropyArgument.TooMuchEntropy(t);var i=g.sha512hmac(t,n.from("Bitcoin seed"));return new HDPrivateKey({network:m.get(e)||m.defaultNetwork,depth:0,parentFingerPrint:0,childIndex:0,privateKey:i.slice(0,32),chainCode:i.slice(32,64)})},HDPrivateKey.prototype._calcHDPublicKey=function(){if(!this._hdPublicKey){var t=i(26644);this._hdPublicKey=new t(this)}},HDPrivateKey.prototype._buildFromBuffers=function(t){HDPrivateKey._validateBufferArguments(t),E.defineImmutable(this,{_buffers:t});var e,i=[t.version,t.depth,t.parentFingerPrint,t.childIndex,t.chainCode,w.emptyBuffer(1),t.privateKey],s=o.Buffer.concat(i);if(t.checksum&&t.checksum.length){if(t.checksum.toString()!==y.checksum(s).toString())throw new _.InvalidB58Checksum(s)}else t.checksum=y.checksum(s);var a=m.get(w.integerFromBuffer(t.version));e=y.encode(o.Buffer.concat(i)),t.xprivkey=n.from(e);var u=new S(c.fromBuffer(t.privateKey),a),p=u.toPublicKey(),b=HDPrivateKey.ParentFingerPrintSize,v=g.sha256ripemd160(p.toBuffer()).slice(0,b);return E.defineImmutable(this,{xprivkey:e,network:a,depth:w.integerFromSingleByteBuffer(t.depth),privateKey:u,publicKey:p,fingerPrint:v}),this._hdPublicKey=null,Object.defineProperty(this,"hdPublicKey",{configurable:!1,enumerable:!0,get:function(){return this._calcHDPublicKey(),this._hdPublicKey}}),Object.defineProperty(this,"xpubkey",{configurable:!1,enumerable:!0,get:function(){return this._calcHDPublicKey(),this._hdPublicKey.xpubkey}}),this},HDPrivateKey._validateBufferArguments=function(t){var checkBuffer=function(e,i){var n=t[e];s(w.isBuffer(n),e+" argument is not a buffer"),s(n.length===i,e+" has not the expected size: found "+n.length+", expected "+i)};checkBuffer("version",HDPrivateKey.VersionSize),checkBuffer("depth",HDPrivateKey.DepthSize),checkBuffer("parentFingerPrint",HDPrivateKey.ParentFingerPrintSize),checkBuffer("childIndex",HDPrivateKey.ChildIndexSize),checkBuffer("chainCode",HDPrivateKey.ChainCodeSize),checkBuffer("privateKey",HDPrivateKey.PrivateKeySize),t.checksum&&t.checksum.length&&checkBuffer("checksum",HDPrivateKey.CheckSumSize)},HDPrivateKey.prototype.toString=function(){return this.xprivkey},HDPrivateKey.prototype.inspect=function(){return"<HDPrivateKey: "+this.xprivkey+">"},HDPrivateKey.prototype.toObject=HDPrivateKey.prototype.toJSON=function(){return{network:m.get(w.integerFromBuffer(this._buffers.version),"xprivkey").name,depth:w.integerFromSingleByteBuffer(this._buffers.depth),fingerPrint:w.integerFromBuffer(this.fingerPrint),parentFingerPrint:w.integerFromBuffer(this._buffers.parentFingerPrint),childIndex:w.integerFromBuffer(this._buffers.childIndex),chainCode:w.bufferToHex(this._buffers.chainCode),privateKey:this.privateKey.toBuffer().toString("hex"),checksum:w.integerFromBuffer(this._buffers.checksum),xprivkey:this.xprivkey}},HDPrivateKey.fromBuffer=function(t){return new HDPrivateKey(t.toString())},HDPrivateKey.prototype.toBuffer=function(){return w.copy(this._buffers.xprivkey)},HDPrivateKey.DefaultDepth=0,HDPrivateKey.DefaultFingerprint=0,HDPrivateKey.DefaultChildIndex=0,HDPrivateKey.Hardened=2147483648,HDPrivateKey.MaxIndex=2*HDPrivateKey.Hardened,HDPrivateKey.RootElementAlias=["m","M","m'","M'"],HDPrivateKey.VersionSize=4,HDPrivateKey.DepthSize=1,HDPrivateKey.ParentFingerPrintSize=4,HDPrivateKey.ChildIndexSize=4,HDPrivateKey.ChainCodeSize=32,HDPrivateKey.PrivateKeySize=32,HDPrivateKey.CheckSumSize=4,HDPrivateKey.DataLength=78,HDPrivateKey.SerializedByteSize=82,HDPrivateKey.VersionStart=0,HDPrivateKey.VersionEnd=HDPrivateKey.VersionStart+HDPrivateKey.VersionSize,HDPrivateKey.DepthStart=HDPrivateKey.VersionEnd,HDPrivateKey.DepthEnd=HDPrivateKey.DepthStart+HDPrivateKey.DepthSize,HDPrivateKey.ParentFingerPrintStart=HDPrivateKey.DepthEnd,HDPrivateKey.ParentFingerPrintEnd=HDPrivateKey.ParentFingerPrintStart+HDPrivateKey.ParentFingerPrintSize,HDPrivateKey.ChildIndexStart=HDPrivateKey.ParentFingerPrintEnd,HDPrivateKey.ChildIndexEnd=HDPrivateKey.ChildIndexStart+HDPrivateKey.ChildIndexSize,HDPrivateKey.ChainCodeStart=HDPrivateKey.ChildIndexEnd,HDPrivateKey.ChainCodeEnd=HDPrivateKey.ChainCodeStart+HDPrivateKey.ChainCodeSize,HDPrivateKey.PrivateKeyStart=HDPrivateKey.ChainCodeEnd+1,HDPrivateKey.PrivateKeyEnd=HDPrivateKey.PrivateKeyStart+HDPrivateKey.PrivateKeySize,HDPrivateKey.ChecksumStart=HDPrivateKey.PrivateKeyEnd,HDPrivateKey.ChecksumEnd=HDPrivateKey.ChecksumStart+HDPrivateKey.CheckSumSize,s(HDPrivateKey.ChecksumEnd===HDPrivateKey.SerializedByteSize),t.exports=HDPrivateKey},26644:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(79460),a=i(35418),u=i(52131),c=i(36517),p=i(66812),y=i(82650),g=i(6742),m=i(29143),b=i(39521),S=i(10862),v=S.HDPublicKey,_=i(69282),P=i(29854),w=i(19153);function HDPublicKey(t){if(t instanceof HDPublicKey)return t;if(!(this instanceof HDPublicKey))return new HDPublicKey(t);if(t){if(s.isString(t)||w.isBuffer(t)){var e=HDPublicKey.getSerializedError(t);if(!e)return this._buildFromSerialized(t);if(w.isBuffer(t)&&!HDPublicKey.getSerializedError(t.toString()))return this._buildFromSerialized(t.toString());if(e instanceof v.ArgumentIsPrivateExtended)return new y(t).hdPublicKey;throw e}if(s.isObject(t))return t instanceof y?this._buildFromPrivate(t):this._buildFromObject(t);throw new v.UnrecognizedArgument(t)}throw new v.MustSupplyArgument}HDPublicKey.isValidPath=function(t){if(s.isString(t)){var e=y._getDerivationIndexes(t);return null!==e&&s.every(e,HDPublicKey.isValidPath)}return!!s.isNumber(t)&&t>=0&&t<HDPublicKey.Hardened},HDPublicKey.prototype.derive=function(t,e){return this.deriveChild(t,e)},HDPublicKey.prototype.deriveChild=function(t,e){if(s.isNumber(t))return this._deriveWithNumber(t,e);if(s.isString(t))return this._deriveFromString(t);throw new v.InvalidDerivationArgument(t)},HDPublicKey.prototype._deriveWithNumber=function(t,e){if(t>=HDPublicKey.Hardened||e)throw new v.InvalidIndexCantDeriveHardened;if(t<0)throw new v.InvalidPath(t);var i,n=w.integerAsBuffer(t),s=w.concat([this.publicKey.toBuffer(),n]),o=p.sha512hmac(s,this._buffers.chainCode),u=a.fromBuffer(o.slice(0,32),{size:32}),c=o.slice(32,64);try{i=b.fromPoint(m.getG().mul(u).add(this.publicKey.point))}catch(e){return this._deriveWithNumber(t+1)}return new HDPublicKey({network:this.network,depth:this.depth+1,parentFingerPrint:this.fingerPrint,childIndex:t,chainCode:c,publicKey:i})},HDPublicKey.prototype._deriveFromString=function(t){if(s.includes(t,"'"))throw new v.InvalidIndexCantDeriveHardened;if(!HDPublicKey.isValidPath(t))throw new v.InvalidPath(t);return y._getDerivationIndexes(t).reduce(function(t,e){return t._deriveWithNumber(e)},this)},HDPublicKey.isValidSerialized=function(t,e){return s.isNull(HDPublicKey.getSerializedError(t,e))},HDPublicKey.getSerializedError=function(t,e){if(!(s.isString(t)||w.isBuffer(t)))return new v.UnrecognizedArgument("expected buffer or string");if(!u.validCharacters(t))return new S.InvalidB58Char("(unknown)",t);try{t=c.decode(t)}catch(e){return new S.InvalidB58Checksum(t)}if(t.length!==HDPublicKey.DataSize)return new v.InvalidLength(t);if(!s.isUndefined(e)){var i=HDPublicKey._validateNetwork(t,e);if(i)return i}var n=w.integerFromBuffer(t.slice(0,4));return n===g.livenet.xprivkey||n===g.testnet.xprivkey?new v.ArgumentIsPrivateExtended:null},HDPublicKey._validateNetwork=function(t,e){var i=g.get(e);if(!i)return new S.InvalidNetworkArgument(e);var n=t.slice(HDPublicKey.VersionStart,HDPublicKey.VersionEnd);return w.integerFromBuffer(n)!==i.xpubkey?new S.InvalidNetwork(n):null},HDPublicKey.prototype._buildFromPrivate=function(t){var e=s.clone(t._buffers),i=m.getG().mul(a.fromBuffer(e.privateKey));return e.publicKey=m.pointToCompressed(i),e.version=w.integerAsBuffer(g.get(w.integerFromBuffer(e.version)).xpubkey),e.privateKey=void 0,e.checksum=void 0,e.xprivkey=void 0,this._buildFromBuffers(e)},HDPublicKey.prototype._buildFromObject=function(t){var e={version:t.network?w.integerAsBuffer(g.get(t.network).xpubkey):t.version,depth:s.isNumber(t.depth)?w.integerAsSingleByteBuffer(t.depth):t.depth,parentFingerPrint:s.isNumber(t.parentFingerPrint)?w.integerAsBuffer(t.parentFingerPrint):t.parentFingerPrint,childIndex:s.isNumber(t.childIndex)?w.integerAsBuffer(t.childIndex):t.childIndex,chainCode:s.isString(t.chainCode)?n.from(t.chainCode,"hex"):t.chainCode,publicKey:s.isString(t.publicKey)?n.from(t.publicKey,"hex"):w.isBuffer(t.publicKey)?t.publicKey:t.publicKey.toBuffer(),checksum:s.isNumber(t.checksum)?w.integerAsBuffer(t.checksum):t.checksum};return this._buildFromBuffers(e)},HDPublicKey.prototype._buildFromSerialized=function(t){var e=c.decode(t),i={version:e.slice(HDPublicKey.VersionStart,HDPublicKey.VersionEnd),depth:e.slice(HDPublicKey.DepthStart,HDPublicKey.DepthEnd),parentFingerPrint:e.slice(HDPublicKey.ParentFingerPrintStart,HDPublicKey.ParentFingerPrintEnd),childIndex:e.slice(HDPublicKey.ChildIndexStart,HDPublicKey.ChildIndexEnd),chainCode:e.slice(HDPublicKey.ChainCodeStart,HDPublicKey.ChainCodeEnd),publicKey:e.slice(HDPublicKey.PublicKeyStart,HDPublicKey.PublicKeyEnd),checksum:e.slice(HDPublicKey.ChecksumStart,HDPublicKey.ChecksumEnd),xpubkey:t};return this._buildFromBuffers(i)},HDPublicKey.prototype._buildFromBuffers=function(t){HDPublicKey._validateBufferArguments(t),P.defineImmutable(this,{_buffers:t});var e,i=[t.version,t.depth,t.parentFingerPrint,t.childIndex,t.chainCode,t.publicKey],s=w.concat(i),o=c.checksum(s);if(t.checksum&&t.checksum.length){if(t.checksum.toString("hex")!==o.toString("hex"))throw new S.InvalidB58Checksum(s,o)}else t.checksum=o;var a=g.get(w.integerFromBuffer(t.version));e=c.encode(w.concat(i)),t.xpubkey=n.from(e);var u=new b(t.publicKey,{network:a}),y=HDPublicKey.ParentFingerPrintSize,m=p.sha256ripemd160(u.toBuffer()).slice(0,y);return P.defineImmutable(this,{xpubkey:e,network:a,depth:w.integerFromSingleByteBuffer(t.depth),publicKey:u,fingerPrint:m}),this},HDPublicKey._validateBufferArguments=function(t){var checkBuffer=function(e,i){var n=t[e];_(w.isBuffer(n),e+" argument is not a buffer, it's "+typeof n),_(n.length===i,e+" has not the expected size: found "+n.length+", expected "+i)};checkBuffer("version",HDPublicKey.VersionSize),checkBuffer("depth",HDPublicKey.DepthSize),checkBuffer("parentFingerPrint",HDPublicKey.ParentFingerPrintSize),checkBuffer("childIndex",HDPublicKey.ChildIndexSize),checkBuffer("chainCode",HDPublicKey.ChainCodeSize),checkBuffer("publicKey",HDPublicKey.PublicKeySize),t.checksum&&t.checksum.length&&checkBuffer("checksum",HDPublicKey.CheckSumSize)},HDPublicKey.fromString=function(t){return o.checkArgument(s.isString(t),"No valid string was provided"),new HDPublicKey(t)},HDPublicKey.fromObject=function(t){return o.checkArgument(s.isObject(t),"No valid argument was provided"),new HDPublicKey(t)},HDPublicKey.prototype.toString=function(){return this.xpubkey},HDPublicKey.prototype.inspect=function(){return"<HDPublicKey: "+this.xpubkey+">"},HDPublicKey.prototype.toObject=HDPublicKey.prototype.toJSON=function(){return{network:g.get(w.integerFromBuffer(this._buffers.version)).name,depth:w.integerFromSingleByteBuffer(this._buffers.depth),fingerPrint:w.integerFromBuffer(this.fingerPrint),parentFingerPrint:w.integerFromBuffer(this._buffers.parentFingerPrint),childIndex:w.integerFromBuffer(this._buffers.childIndex),chainCode:w.bufferToHex(this._buffers.chainCode),publicKey:this.publicKey.toString(),checksum:w.integerFromBuffer(this._buffers.checksum),xpubkey:this.xpubkey}},HDPublicKey.fromBuffer=function(t){return new HDPublicKey(t)},HDPublicKey.prototype.toBuffer=function(){return w.copy(this._buffers.xpubkey)},HDPublicKey.Hardened=2147483648,HDPublicKey.RootElementAlias=["m","M"],HDPublicKey.VersionSize=4,HDPublicKey.DepthSize=1,HDPublicKey.ParentFingerPrintSize=4,HDPublicKey.ChildIndexSize=4,HDPublicKey.ChainCodeSize=32,HDPublicKey.PublicKeySize=33,HDPublicKey.CheckSumSize=4,HDPublicKey.DataSize=78,HDPublicKey.SerializedByteSize=82,HDPublicKey.VersionStart=0,HDPublicKey.VersionEnd=HDPublicKey.VersionStart+HDPublicKey.VersionSize,HDPublicKey.DepthStart=HDPublicKey.VersionEnd,HDPublicKey.DepthEnd=HDPublicKey.DepthStart+HDPublicKey.DepthSize,HDPublicKey.ParentFingerPrintStart=HDPublicKey.DepthEnd,HDPublicKey.ParentFingerPrintEnd=HDPublicKey.ParentFingerPrintStart+HDPublicKey.ParentFingerPrintSize,HDPublicKey.ChildIndexStart=HDPublicKey.ParentFingerPrintEnd,HDPublicKey.ChildIndexEnd=HDPublicKey.ChildIndexStart+HDPublicKey.ChildIndexSize,HDPublicKey.ChainCodeStart=HDPublicKey.ChildIndexEnd,HDPublicKey.ChainCodeEnd=HDPublicKey.ChainCodeStart+HDPublicKey.ChainCodeSize,HDPublicKey.PublicKeyStart=HDPublicKey.ChainCodeEnd,HDPublicKey.PublicKeyEnd=HDPublicKey.PublicKeyStart+HDPublicKey.PublicKeySize,HDPublicKey.ChecksumStart=HDPublicKey.PublicKeyEnd,HDPublicKey.ChecksumEnd=HDPublicKey.ChecksumStart+HDPublicKey.CheckSumSize,_(HDPublicKey.PublicKeyEnd===HDPublicKey.DataSize),_(HDPublicKey.ChecksumEnd===HDPublicKey.SerializedByteSize),t.exports=HDPublicKey},26722:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(57867),a=i(39521),u=i(53),c=i(64926),p=i(30044),y=i(72571),g=i(66812).sha256sha256,m=i(29854),b=i(79460);function Message(t){return this instanceof Message?(b.checkArgument(s.isString(t),"First argument should be a string"),this.message=t,this):new Message(t)}Message.MAGIC_BYTES=n.from("Bitcoin Signed Message:\n"),Message.prototype.magicHash=function(){var t=c.varintBufNum(Message.MAGIC_BYTES.length),e=n.from(this.message),i=c.varintBufNum(e.length);return g(n.concat([t,Message.MAGIC_BYTES,i,e]))},Message.prototype._sign=function(t){b.checkArgument(t instanceof o,"First argument should be an instance of PrivateKey");let e=this.magicHash(),i=p.sign(e,t,{randomK:!0});return p.calci(e,i,t.toPublicKey()),i},Message.prototype.sign=function(t){return this._sign(t).toCompact().toString("base64")},Message.prototype._verify=function(t,e){b.checkArgument(t instanceof a,"First argument should be an instance of PublicKey"),b.checkArgument(e instanceof y,"Second argument should be an instance of Signature");var i=this.magicHash(),n=p.verify(i,e,t);return n||(this.error="The signature was invalid"),n},Message.prototype.verify=function(t,e){b.checkArgument(t),b.checkArgument(e&&s.isString(e)),s.isString(t)&&(t=u.fromString(t));var i=y.fromCompact(n.from(e,"base64"));let o=this.magicHash();var a=p.recoverPublicKey(o,i),c=u.fromPublicKey(a,t.network);return t.toString()!==c.toString()?(this.error="The signature did not match the message digest",!1):this._verify(a,i)},Message.prototype.recoverPublicKey=function(t,e){b.checkArgument(t),b.checkArgument(e&&s.isString(e)),s.isString(t)&&(t=u.fromString(t));var i=y.fromCompact(n.from(e,"base64"));let o=this.magicHash();var a=p.recoverPublicKey(o,i),c=u.fromPublicKey(a,t.network);return t.toString()!==c.toString()&&(this.error="The signature did not match the message digest"),a.toString()},Message.fromString=function(t){return new Message(t)},Message.fromJSON=function(t){return m.isValidJSON(t)&&(t=JSON.parse(t)),new Message(t.message)},Message.prototype.toObject=function(){return{message:this.message}},Message.prototype.toJSON=function(){return JSON.stringify(this.toObject())},Message.prototype.toString=function(){return this.message},Message.prototype.inspect=function(){return"<Message: "+this.toString()+">"},t.exports=Message,i(64502)},6742:function(t,e,i){"use strict";var n=i(19153),s=i(29854),o=[],a={};function Network(){}function get(t,e){if(~o.indexOf(t))return t;if(e){for(let i in Array.isArray(e)||(e=[e]),o)if(e.some(e=>o[i][e]===t))return o[i];return}return a[t]&&a[t].length>=1?a[t][0]:a[t]}function is(t){return this.name==t||this.alias==t}function addNetwork(t){var e=new Network;for(let i of(s.defineImmutable(e,{name:t.name,alias:t.alias,is:t.is,pubkeyhash:t.pubkeyhash,privatekey:t.privatekey,scripthash:t.scripthash,bech32prefix:t.bech32prefix,xpubkey:t.xpubkey,xprivkey:t.xprivkey}),t.networkMagic&&s.defineImmutable(e,{networkMagic:n.integerAsBuffer(t.networkMagic)}),t.port&&s.defineImmutable(e,{port:t.port}),t.dnsSeeds&&s.defineImmutable(e,{dnsSeeds:t.dnsSeeds}),Object.values(e)))null!=i&&"object"!=typeof i&&(a[i]||(a[i]=[]),a[i].push(e));for(let i of(o.push(e),t.variants||[]))addNetwork({...t,variants:void 0,...i});return e}Network.prototype.toString=function(){return this.name},addNetwork({name:"livenet",alias:"mainnet",is,pubkeyhash:0,privatekey:128,scripthash:5,bech32prefix:"bc",xpubkey:76067358,xprivkey:76066276,networkMagic:4190024921,port:8333,dnsSeeds:["seed.bitcoin.sipa.be","dnsseed.bluematt.me","dnsseed.bitcoin.dashjr.org","seed.bitcoinstats.com","seed.bitnodes.io","bitseed.xf2.org"]});var u=get("livenet");addNetwork({name:"testnet",alias:"testnet",is,pubkeyhash:111,privatekey:239,scripthash:196,bech32prefix:"tb",xpubkey:70617039,xprivkey:70615956,variants:[{name:"testnet3",networkMagic:185665799,port:18333,dnsSeeds:["testnet-seed.bitcoin.petertodd.org","testnet-seed.bluematt.me","testnet-seed.alexykot.me","testnet-seed.bitcoin.schildbach.de"]},{name:"signet",networkMagic:168021824,port:38333,dnsSeeds:["178.128.221.177","103.16.128.63","153.126.143.201","192.241.163.142"]},{name:"testnet4",networkMagic:471220008,port:48333,dnsSeeds:["18.189.156.102","18.201.207.55","51.158.248.8","57.128.176.163","82.67.102.15","88.99.248.50","95.217.73.162","103.99.171.212","103.165.192.210"]}]});var c=get("testnet"),p=get("testnet3"),y=get("signet");addNetwork({name:"regtest",alias:"dev",is,pubkeyhash:111,privatekey:239,scripthash:196,bech32prefix:"bcrt",xpubkey:70617039,xprivkey:70615956,networkMagic:4206867930,port:18444,dnsSeeds:[]});var g=get("regtest");t.exports={add:addNetwork,remove:function(t){"object"!=typeof t&&(t=get(t));for(var e=0;e<o.length;e++)o[e]===t&&o.splice(e,1);for(var i in a)if(a[i].length){let e=a[i].indexOf(t);e>=0&&a[i].splice(e,1),0===a[i].length&&delete a[i]}else a[i]===t&&delete a[i]},defaultNetwork:u,livenet:u,mainnet:u,testnet:c,testnet3:p,signet:y,regtest:g,get:get,enableRegtest:function(){c.regtestEnabled=!0},disableRegtest:function(){c.regtestEnabled=!1}}},76244:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(79460),a=i(19153),u=i(29854);function Opcode(t){var e;if(!(this instanceof Opcode))return new Opcode(t);if(s.isNumber(t))e=t;else if(s.isString(t))e=Opcode.map[t];else throw TypeError('Unrecognized num type: "'+typeof t+'" for Opcode');return u.defineImmutable(this,{num:e}),this}for(var c in Opcode.fromBuffer=function(t){return o.checkArgument(a.isBuffer(t)),new Opcode(Number("0x"+t.toString("hex")))},Opcode.fromNumber=function(t){return o.checkArgument(s.isNumber(t)),new Opcode(t)},Opcode.fromString=function(t){o.checkArgument(s.isString(t));var e=Opcode.map[t];if(void 0===e)throw TypeError("Invalid opcodestr");return new Opcode(e)},Opcode.prototype.toHex=function(){return this.num.toString(16)},Opcode.prototype.toBuffer=function(){return n.from(this.toHex(),"hex")},Opcode.prototype.toNumber=function(){return this.num},Opcode.prototype.toString=function(){var t=Opcode.reverseMap[this.num];if(void 0===t)throw Error("Opcode does not have a string representation");return t},Opcode.smallInt=function(t){return(o.checkArgument(s.isNumber(t),"Invalid Argument: n should be number"),o.checkArgument(t>=0&&t<=16,"Invalid Argument: n must be between 0 and 16"),0===t)?Opcode("OP_0"):new Opcode(Opcode.map.OP_1+t-1)},Opcode.decodeOpN=function(t){return t===Opcode.OP_0?0:(o.checkArgument(t>=Opcode.OP_1&&t<=Opcode.OP_16,Error("Invalid opcode: "+JSON.stringify(t))),t-(Opcode.OP_1-1))},Opcode.isOpSuccess=function(t){return"string"!=typeof t||parseInt(t)||(t=Opcode[t]),80==t||98==t||t>=126&&t<=129||t>=131&&t<=134||t>=137&&t<=138||t>=141&&t<=142||t>=149&&t<=153||t>=187&&t<=254},Opcode.map={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_CHECKLOCKTIMEVERIFY:177,OP_CHECKSEQUENCEVERIFY:178,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255},Opcode.reverseMap=[],Opcode.map)Opcode.reverseMap[Opcode.map[c]]=c;s.extend(Opcode,Opcode.map),Opcode.isSmallIntOp=function(t){return t instanceof Opcode&&(t=t.toNumber()),t===Opcode.map.OP_0||t>=Opcode.map.OP_1&&t<=Opcode.map.OP_16},Opcode.prototype.inspect=function(){return"<Opcode: "+this.toString()+", hex: "+this.toHex()+", decimal: "+this.num+">"},t.exports=Opcode},57867:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(53),a=i(36517),u=i(35418),c=i(29854),p=i(6742),y=i(29143),g=i(39521),m=i(42773),b=i(79460);let S=i(83868);function PrivateKey(t,e){if(!(this instanceof PrivateKey))return new PrivateKey(t,e);if(t instanceof PrivateKey)return t;var i=this._classifyArguments(t,e);if(!i.bn||0===i.bn.cmp(new u(0)))throw TypeError("Number can not be equal to zero, undefined, null or false");if(!i.bn.lt(y.getN()))throw TypeError("Number must be less than N");if(void 0===i.network)throw TypeError('Must specify the network ("livenet" or "testnet")');return c.defineImmutable(this,{bn:i.bn,compressed:i.compressed,network:i.network}),Object.defineProperty(this,"publicKey",{configurable:!1,enumerable:!0,get:this.toPublicKey.bind(this)}),this}PrivateKey.prototype._classifyArguments=function(t,e){var i={compressed:!0,network:e?p.get(e):p.defaultNetwork};if(s.isUndefined(t)||s.isNull(t))i.bn=PrivateKey._getRandomBN();else if(t instanceof u)i.bn=t;else if(t instanceof n||t instanceof Uint8Array)i=PrivateKey._transformBuffer(t,e);else if(t.bn&&t.network)i=PrivateKey._transformObject(t);else if(!e&&p.get(t))i.bn=PrivateKey._getRandomBN(),i.network=p.get(t);else if("string"==typeof t)c.isHexa(t)?i.bn=new u(n.from(t,"hex")):i=PrivateKey._transformWIF(t,e);else throw TypeError("First argument is an unrecognized data type.");return i},PrivateKey._getRandomBN=function(){do{var t,e,i=m.getRandomBuffer(32);t=(e=u.fromBuffer(i)).lt(y.getN())}while(!t);return e},PrivateKey._transformBuffer=function(t,e){var i={};if(32===t.length)return PrivateKey._transformBNBuffer(t,e);if(i.network=p.get(t[0],"privatekey"),!i.network)throw Error("Invalid network");if(e&&i.network!==p.get(e))throw TypeError("Private key network mismatch");if(34===t.length&&1===t[33])i.compressed=!0;else if(33===t.length)i.compressed=!1;else throw Error("Length of buffer must be 33 (uncompressed) or 34 (compressed)");return i.bn=u.fromBuffer(t.slice(1,33)),i},PrivateKey._transformBNBuffer=function(t,e){var i={};return i.network=p.get(e)||p.defaultNetwork,i.bn=u.fromBuffer(t),i.compressed=!1,i},PrivateKey._transformWIF=function(t,e){return PrivateKey._transformBuffer(a.decode(t),e)},PrivateKey.fromBuffer=function(t,e){return new PrivateKey(t,e)},PrivateKey._transformObject=function(t){return{bn:new u(t.bn,"hex"),network:p.get(t.network),compressed:t.compressed}},PrivateKey.fromString=PrivateKey.fromWIF=function(t){return b.checkArgument(s.isString(t),"First argument is expected to be a string."),new PrivateKey(t)},PrivateKey.fromObject=function(t){return b.checkArgument(s.isObject(t),"First argument is expected to be an object."),new PrivateKey(t)},PrivateKey.fromRandom=function(t){var e=PrivateKey._getRandomBN();return new PrivateKey(e,t)},PrivateKey.getValidationError=function(t,e){var i;try{new PrivateKey(t,e)}catch(t){i=t}return i},PrivateKey.isValid=function(t,e){return!!t&&!PrivateKey.getValidationError(t,e)},PrivateKey.prototype.toString=function(){return this.toBuffer().toString("hex")},PrivateKey.prototype.toWIF=function(){var t,e=this.network;return t=this.compressed?n.concat([n.from([e.privatekey]),this.bn.toBuffer({size:32}),n.from([1])]):n.concat([n.from([e.privatekey]),this.bn.toBuffer({size:32})]),a.encode(t)},PrivateKey.prototype.toBigNumber=function(){return this.bn},PrivateKey.prototype.toBuffer=function(){return this.bn.toBuffer({size:32})},PrivateKey.prototype.toBufferNoPadding=function(){return this.bn.toBuffer()},PrivateKey.prototype.toPublicKey=function(){return this._pubkey||(this._pubkey=g.fromPrivateKey(this)),this._pubkey},PrivateKey.prototype.toAddress=function(t,e){var i=this.toPublicKey();return o.fromPublicKey(i,t||this.network,e)},PrivateKey.prototype.toObject=PrivateKey.prototype.toJSON=function(){return{bn:this.bn.toString("hex"),compressed:this.compressed,network:this.network.toString()}},PrivateKey.prototype.createTapTweak=function(t){let e=y.getN(),i=y.getG().mul(this.bn),s=i.y.isEven()?this.bn:e.sub(this.bn),o=new S("TapTweak");o.write(i.x.toBuffer({size:32})),t&&(b.checkArgument(n.isBuffer(t)&&32===t.length,"merkleRoot must be 32 byte buffer"),o.write(t));let a=o.finalize();return b.checkState(u.fromBuffer(a).lt(e),"TapTweak hash failed secp256k1 order check"),{tweakedPrivKey:s.add(new u(a)).mod(e).toBuffer({size:32})}},PrivateKey.prototype.inspect=function(){var t=this.compressed?"":", uncompressed";return"<PrivateKey: "+this.toString()+", network: "+this.network+t+">"},t.exports=PrivateKey},39521:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(35418),o=i(29143),a=i(66812),u=i(29854),c=i(6742),p=i(96486),y=i(79460);let g=i(83868);function PublicKey(t,e){if(!(this instanceof PublicKey))return new PublicKey(t,e);if(y.checkArgument(t,"First argument is required, please include public key data."),t instanceof PublicKey)return t;e=e||{};var i=this._classifyArgs(t,e);return i.point.validate(),u.defineImmutable(this,{point:i.point,compressed:i.compressed,network:i.network||c.defaultNetwork}),this}PublicKey.prototype._classifyArgs=function(t,e){var i={compressed:p.isUndefined(e.compressed)||e.compressed};if(t instanceof o)i.point=t;else if(t.x&&t.y)i=PublicKey._transformObject(t);else if("string"==typeof t)i=PublicKey._transformDER(n.from(t,"hex"));else if(PublicKey._isBuffer(t))i=PublicKey._transformDER(t);else if(PublicKey._isPrivateKey(t))i=PublicKey._transformPrivateKey(t);else throw TypeError("First argument is an unrecognized data format.");return i.network||(i.network=p.isUndefined(e.network)?void 0:c.get(e.network)),i},PublicKey._isPrivateKey=function(t){return t instanceof i(57867)},PublicKey._isBuffer=function(t){return t instanceof n||t instanceof Uint8Array},PublicKey._transformPrivateKey=function(t){y.checkArgument(PublicKey._isPrivateKey(t),"Must be an instance of PrivateKey");var e={};return e.point=o.getG().mul(t.bn),e.compressed=t.compressed,e.network=t.network,e},PublicKey._transformDER=function(t,e){y.checkArgument(PublicKey._isBuffer(t),"Must be a hex buffer of DER encoded public key");var i,n,a,u,c={};if(e=!!p.isUndefined(e)||e,4!==t[0]&&(e||6!==t[0]&&7!==t[0])){if(3===t[0])a=t.slice(1),i=new s(a),(c=PublicKey._transformX(!0,i)).compressed=!0;else if(2===t[0])a=t.slice(1),i=new s(a),(c=PublicKey._transformX(!1,i)).compressed=!0;else throw TypeError("Invalid DER format public key")}else{if(a=t.slice(1,33),u=t.slice(33,65),32!==a.length||32!==u.length||65!==t.length)throw TypeError("Length of x and y must be 32 bytes");i=new s(a),n=new s(u),c.point=new o(i,n),c.compressed=!1}return c},PublicKey._transformX=function(t,e){y.checkArgument("boolean"==typeof t,"Must specify whether y is odd or not (true or false)");var i={};return i.point=o.fromX(t,e),i},PublicKey._transformObject=function(t){var e=new s(t.x,"hex"),i=new s(t.y,"hex"),n=new o(e,i);return new PublicKey(n,{compressed:t.compressed})},PublicKey.fromPrivateKey=function(t){y.checkArgument(PublicKey._isPrivateKey(t),"Must be an instance of PrivateKey");var e=PublicKey._transformPrivateKey(t);return new PublicKey(e.point,{compressed:e.compressed,network:e.network})},PublicKey.fromBuffer=function(t,e){return(y.checkArgument(PublicKey._isBuffer(t),"Must be a hex buffer of DER encoded public key or 32 byte X coordinate (taproot)"),32===t.length)?PublicKey.fromX(!1,t):PublicKey.fromDER(t,e)},PublicKey.fromDER=function(t,e){y.checkArgument(PublicKey._isBuffer(t),"Must be a hex buffer of DER encoded public key");var i=PublicKey._transformDER(t,e);return new PublicKey(i.point,{compressed:i.compressed})},PublicKey.fromPoint=function(t,e){return y.checkArgument(t instanceof o,"First argument must be an instance of Point."),new PublicKey(t,{compressed:e})},PublicKey.fromString=function(t,e){var i=n.from(t,e||"hex"),s=PublicKey._transformDER(i);return new PublicKey(s.point,{compressed:s.compressed})},PublicKey.fromX=function(t,e){var i=PublicKey._transformX(t,e);return new PublicKey(i.point,{compressed:i.compressed})},PublicKey.fromTaproot=function(t){return"string"==typeof t&&u.isHexaString(t)&&(t=n.from(t,"hex")),y.checkArgument(n.isBuffer(t),"hexBuf must be a hex string or buffer"),y.checkArgument(32===t.length,"Taproot public keys must be 32 bytes"),new PublicKey.fromX(!1,t)},PublicKey.isValidTaproot=function(t){try{return!!PublicKey.fromTaproot(t)}catch(t){return!1}},PublicKey.prototype.computeTapTweakHash=function(t){let e=new g("TapTweak");e.write(this.point.x.toBuffer({size:32})),t&&(y.checkArgument(n.isBuffer(t)&&32===t.length,"merkleRoot must be 32 byte buffer"),e.write(t));let i=e.finalize(),a=o.getN();return y.checkState(s.fromBuffer(i).lt(a),"TapTweak hash failed secp256k1 order check"),i},PublicKey.prototype.checkTapTweak=function(t,e,i){n.isBuffer(t)&&(t=PublicKey.fromTaproot(t));let o=t.computeTapTweakHash(e),a=t.point.liftX(),u=a.add(this.point.curve.g.mul(s.fromBuffer(o)));return this.point.x.eq(u.x)&&u.y.mod(new s(2)).eq(new s(1&i[0]))},PublicKey.prototype.createTapTweak=function(t){y.checkArgument(null==t||n.isBuffer(t)&&32===t.length,"merkleRoot must be a 32 byte buffer");let e=this.computeTapTweakHash(t);e=new s(e);let i=this.point.liftX().add(o.getG().mul(e)),a=i.y.isEven()?0:1;return{parity:a,tweakedPubKey:i.x.toBuffer()}},PublicKey.getValidationError=function(t){var e;try{new PublicKey(t)}catch(t){e=t}return e},PublicKey.isValid=function(t){return!PublicKey.getValidationError(t)},PublicKey.prototype.toObject=PublicKey.prototype.toJSON=function(){return{x:this.point.getX().toString("hex",2),y:this.point.getY().toString("hex",2),compressed:this.compressed}},PublicKey.prototype.toBuffer=PublicKey.prototype.toDER=function(){var t,e=this.point.getX(),i=this.point.getY(),s=e.toBuffer({size:32}),o=i.toBuffer({size:32});return this.compressed?(t=o[o.length-1]%2?n.from([3]):n.from([2]),n.concat([t,s])):(t=n.from([4]),n.concat([t,s,o]))},PublicKey.prototype._getID=function(){return a.sha256ripemd160(this.toBuffer())},PublicKey.prototype.toAddress=function(t,e){return i(53).fromPublicKey(this,t||this.network,e)},PublicKey.prototype.toString=function(){return this.toDER().toString("hex")},PublicKey.prototype.inspect=function(){return"<PublicKey: "+this.toString()+(this.compressed?"":", uncompressed")+">"},t.exports=PublicKey},64502:function(t,e,i){t.exports=i(88508),t.exports.Interpreter=i(80156)},80156:function(t,e,i){"use strict";var n=i(48764).Buffer;let s=i(96486),o=i(88508),a=i(76244),u=i(35418),c=i(66812),p=i(72571),y=i(39521),g=i(79460),m=i(96857),b=i(9977),S=i(64926),v=i(83868);var Interpreter=function Interpreter(t){if(!(this instanceof Interpreter))return new Interpreter(t);t?(this.initialize(),this.set(t)):this.initialize()};Interpreter.prototype.verifyWitnessProgram=function(t,e,i,n,s,u){var y=new o,g=[];if(0===t){if(e.length===Interpreter.WITNESS_V0_SCRIPTHASH_SIZE){if(0===i.length)return this.errstr="SCRIPT_ERR_WITNESS_PROGRAM_WITNESS_EMPTY",!1;var m=i[i.length-1];return(y=new o(m),c.sha256(m).toString("hex")!==e.toString("hex"))?(this.errstr="SCRIPT_ERR_WITNESS_PROGRAM_MISMATCH",!1):(g=i.slice(0,-1),this.executeWitnessScript(y,g,p.Version.WITNESS_V0,n,s))}return e.length!==Interpreter.WITNESS_V0_KEYHASH_SIZE?(this.errstr="SCRIPT_ERR_WITNESS_PROGRAM_WRONG_LENGTH",!1):2!==i.length?(this.errstr="SCRIPT_ERR_WITNESS_PROGRAM_MISMATCH",!1):(y.add(a.OP_DUP),y.add(a.OP_HASH160),y.add(e),y.add(a.OP_EQUALVERIFY),y.add(a.OP_CHECKSIG),g=i,this.executeWitnessScript(y,g,p.Version.WITNESS_V0,n,s))}if(1!==t||e.length!=Interpreter.WITNESS_V1_TAPROOT_SIZE||u){if(s&Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM)return this.errstr="SCRIPT_ERR_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM",!1}else{let t={annexPresent:!1};if(!(s&Interpreter.SCRIPT_VERIFY_TAPROOT))return!0;if(0==(g=Array.from(i)).length)return this.errstr="SCRIPT_ERR_WITNESS_PROGRAM_WITNESS_EMPTY",!1;if(g.length>=2&&g[g.length-1].length&&g[g.length-1][0]===o.ANNEX_TAG){let e=g.pop(),i=new S;i.writeVarintNum(e.length),i.write(e),t.annexHash=c.sha256(i.toBuffer()),t.annexPresent=!0}if(t.annexInit=!0,1===g.length)return this.checkSchnorrSignature(g[0],e,p.Version.TAPROOT,t);{let a=g.pop(),u=g.pop();if(a.length<Interpreter.TAPROOT_CONTROL_BASE_SIZE||a.length>Interpreter.TAPROOT_CONTROL_MAX_SIZE||(a.length-Interpreter.TAPROOT_CONTROL_BASE_SIZE)%Interpreter.TAPROOT_CONTROL_NODE_SIZE!=0)return this.errstr="SCRIPT_ERR_TAPROOT_WRONG_CONTROL_SIZE",!1;if(t.tapleafHash=Interpreter.computeTapleafHash(a[0]&Interpreter.TAPROOT_LEAF_MASK,u),!Interpreter.verifyTaprootCommitment(a,e,t.tapleafHash))return this.errstr="SCRIPT_ERR_WITNESS_PROGRAM_MISMATCH",!1;if(t.tapleafHashInit=!0,(a[0]&Interpreter.TAPROOT_LEAF_MASK)===Interpreter.TAPROOT_LEAF_TAPSCRIPT){let e;{let t=new S;for(let e of(t.writeVarintNum(i.length),i))t.writeVarintNum(e.length),t.write(e);e=t.toBuffer().length}try{y=new o(u)}catch(t){return this.errstr="SCRIPT_ERR_BAD_OPCODE",!1}return t.validationWeightLeft=e+o.VALIDATION_WEIGHT_OFFSET,t.validationWeightLeftInit=!0,this.executeWitnessScript(y,g,p.Version.TAPSCRIPT,n,s,t)}if(s&Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION)return this.errstr="SCRIPT_ERR_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION",!1}}return!0},Interpreter.prototype.executeWitnessScript=function(t,e,i,n,s,o){if(i===p.Version.TAPSCRIPT){for(let e of t.chunks)if(a.isOpSuccess(e.opcodenum)){if(s&Interpreter.SCRIPT_VERIFY_DISCOURAGE_OP_SUCCESS)return this.errstr="SCRIPT_ERR_DISCOURAGE_OP_SUCCESS",!1;return!0}if(e.length>Interpreter.MAX_STACK_SIZE)return this.errstr="SCRIPT_ERR_STACK_SIZE",!1}if(e.length&&e.some(t=>t.length>Interpreter.MAX_SCRIPT_ELEMENT_SIZE))return this.errstr="SCRIPT_ERR_PUSH_SIZE",!1;if(this.initialize(),this.set({script:t,stack:e,sigversion:i,satoshis:n,flags:s,execdata:o}),!this.evaluate())return!1;if(1!==this.stack.length)return this.errstr="SCRIPT_ERR_EVAL_FALSE",!1;var u=this.stack[this.stack.length-1];return!!Interpreter.castToBool(u)||(this.errstr="SCRIPT_ERR_EVAL_FALSE_IN_STACK",!1)},Interpreter.prototype.verify=function(t,e,n,a,u,c,y){var g,m=i(98507);if(s.isUndefined(n)&&(n=new m),s.isUndefined(a)&&(a=0),s.isUndefined(u)&&(u=0),s.isUndefined(c)&&(c=null),s.isUndefined(y)&&(y=0),this.set({script:t,tx:n,nin:a,sigversion:p.Version.BASE,satoshis:0,flags:u}),(u&Interpreter.SCRIPT_VERIFY_SIGPUSHONLY)!=0&&!t.isPushOnly())return this.errstr="SCRIPT_ERR_SIG_PUSHONLY",!1;if(!this.evaluate())return!1;u&Interpreter.SCRIPT_VERIFY_P2SH&&(g=this.stack.slice());var b=this.stack;if(this.initialize(),this.set({script:e,stack:b,tx:n,nin:a,flags:u}),!this.evaluate())return!1;if(0===this.stack.length)return this.errstr="SCRIPT_ERR_EVAL_FALSE_NO_RESULT",!1;var S=this.stack[this.stack.length-1];if(!Interpreter.castToBool(S))return this.errstr="SCRIPT_ERR_EVAL_FALSE_IN_STACK",!1;var v=!1;if(u&Interpreter.SCRIPT_VERIFY_WITNESS){var _={};if(e.isWitnessProgram(_)){if(v=!0,0!==t.toBuffer().length)return this.errstr="SCRIPT_ERR_WITNESS_MALLEATED",!1;if(!this.verifyWitnessProgram(_.version,_.program,c,y,this.flags,!1))return!1}}if(u&Interpreter.SCRIPT_VERIFY_P2SH&&e.isScriptHashOut()){if(!t.isPushOnly())return this.errstr="SCRIPT_ERR_SIG_PUSHONLY",!1;if(0===g.length)throw Error("internal error - stack copy empty");var P=g[g.length-1],w=o.fromBuffer(P);if(g.pop(),this.initialize(),this.set({script:w,stack:g,tx:n,nin:a,flags:u}),!this.evaluate())return!1;if(0===g.length)return this.errstr="SCRIPT_ERR_EVAL_FALSE_NO_P2SH_STACK",!1;if(!Interpreter.castToBool(g[g.length-1]))return this.errstr="SCRIPT_ERR_EVAL_FALSE_IN_P2SH_STACK",!1;if(u&Interpreter.SCRIPT_VERIFY_WITNESS){var E={};if(w.isWitnessProgram(E)){v=!0;var I=new o;if(I.add(w.toBuffer()),t.toHex()!==I.toHex())return this.errstr="SCRIPT_ERR_WITNESS_MALLEATED_P2SH",!1;if(!this.verifyWitnessProgram(E.version,E.program,c,y,this.flags,!0))return!1;b=[b[0]]}}}if((this.flags&Interpreter.SCRIPT_VERIFY_CLEANSTACK)!=0){if((this.flags&Interpreter.SCRIPT_VERIFY_P2SH)==0||(this.flags&Interpreter.SCRIPT_VERIFY_WITNESS)==0)throw"flags & SCRIPT_VERIFY_P2SH";if(1!=g.length)return this.errstr="SCRIPT_ERR_CLEANSTACK",!1}return!(this.flags&Interpreter.SCRIPT_VERIFY_WITNESS)||!!v||!(c.length>0)||(this.errstr="SCRIPT_ERR_WITNESS_UNEXPECTED",!1)},t.exports=Interpreter,Interpreter.prototype.initialize=function(t){this.stack=[],this.altstack=[],this.pc=0,this.satoshis=0,this.sigversion=p.Version.BASE,this.pbegincodehash=0,this.nOpCount=0,this.vfExec=[],this.errstr="",this.flags=0,this.execdata={}},Interpreter.prototype.set=function(t){this.script=t.script||this.script,this.tx=t.tx||this.tx,this.nin=void 0===t.nin?this.nin:parseInt(t.nin),this.stack=t.stack||this.stack,this.altstack=t.altstack||this.altstack,this.pc=void 0===t.pc?this.pc:t.pc,this.pbegincodehash=void 0===t.pbegincodehash?this.pbegincodehash:t.pbegincodehash,this.sigversion=void 0===t.sigversion?this.sigversion:t.sigversion,this.satoshis=void 0===t.satoshis?this.satoshis:t.satoshis,this.nOpCount=void 0===t.nOpCount?this.nOpCount:t.nOpCount,this.vfExec=t.vfExec||this.vfExec,this.errstr=t.errstr||this.errstr,this.flags=void 0===t.flags?this.flags:t.flags,this.execdata=void 0===t.execdata?this.execdata:t.execdata||{}},Interpreter.true=n.from([1]),Interpreter.false=n.from([]),Interpreter.MAX_SCRIPT_SIZE=1e4,Interpreter.MAX_STACK_SIZE=1e3,Interpreter.MAX_SCRIPT_ELEMENT_SIZE=520,Interpreter.LOCKTIME_THRESHOLD=5e8,Interpreter.LOCKTIME_THRESHOLD_BN=new u(Interpreter.LOCKTIME_THRESHOLD),Interpreter.SCRIPT_VERIFY_NONE=0,Interpreter.SCRIPT_VERIFY_P2SH=1,Interpreter.SCRIPT_VERIFY_STRICTENC=2,Interpreter.SCRIPT_VERIFY_DERSIG=4,Interpreter.SCRIPT_VERIFY_LOW_S=8,Interpreter.SCRIPT_VERIFY_NULLDUMMY=16,Interpreter.SCRIPT_VERIFY_SIGPUSHONLY=32,Interpreter.SCRIPT_VERIFY_MINIMALDATA=64,Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS=128,Interpreter.SCRIPT_VERIFY_CLEANSTACK=256,Interpreter.SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY=512,Interpreter.SCRIPT_VERIFY_CHECKSEQUENCEVERIFY=1024,Interpreter.SCRIPT_VERIFY_WITNESS=2048,Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM=4096,Interpreter.SCRIPT_VERIFY_MINIMALIF=8192,Interpreter.SCRIPT_VERIFY_NULLFAIL=16384,Interpreter.SCRIPT_VERIFY_WITNESS_PUBKEYTYPE=32768,Interpreter.SCRIPT_ENABLE_SIGHASH_FORKID=65536,Interpreter.SCRIPT_ENABLE_REPLAY_PROTECTION=131072,Interpreter.SCRIPT_VERIFY_CONST_SCRIPTCODE=65536,Interpreter.SCRIPT_VERIFY_TAPROOT=131072,Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_TAPROOT_VERSION=262144,Interpreter.SCRIPT_VERIFY_DISCOURAGE_OP_SUCCESS=524288,Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_PUBKEYTYPE=1048576,Interpreter.SEQUENCE_LOCKTIME_DISABLE_FLAG=-2147483648,Interpreter.SEQUENCE_LOCKTIME_TYPE_FLAG=4194304,Interpreter.SEQUENCE_LOCKTIME_MASK=65535,Interpreter.WITNESS_V0_SCRIPTHASH_SIZE=32,Interpreter.WITNESS_V0_KEYHASH_SIZE=20,Interpreter.WITNESS_V1_TAPROOT_SIZE=32,Interpreter.TAPROOT_LEAF_MASK=254,Interpreter.TAPROOT_LEAF_TAPSCRIPT=192,Interpreter.TAPROOT_CONTROL_BASE_SIZE=33,Interpreter.TAPROOT_CONTROL_NODE_SIZE=32,Interpreter.TAPROOT_CONTROL_MAX_NODE_COUNT=128,Interpreter.TAPROOT_CONTROL_MAX_SIZE=Interpreter.TAPROOT_CONTROL_BASE_SIZE+Interpreter.TAPROOT_CONTROL_NODE_SIZE*Interpreter.TAPROOT_CONTROL_MAX_NODE_COUNT,Interpreter.PROTOCOL_VERSION=70016,Interpreter.castToBool=function(t){for(var e=0;e<t.length;e++)if(0!==t[e]){if(e===t.length-1&&128===t[e])return!1;return!0}return!1},Interpreter.prototype.checkSignatureEncoding=function(t){if(0==t.length)return!0;if((this.flags&(Interpreter.SCRIPT_VERIFY_DERSIG|Interpreter.SCRIPT_VERIFY_LOW_S|Interpreter.SCRIPT_VERIFY_STRICTENC))!=0&&!p.isTxDER(t))return this.errstr="SCRIPT_ERR_SIG_DER_INVALID_FORMAT",!1;if((this.flags&Interpreter.SCRIPT_VERIFY_LOW_S)!=0){if(!p.fromTxFormat(t).hasLowS())return this.errstr="SCRIPT_ERR_SIG_DER_HIGH_S",!1}else if((this.flags&Interpreter.SCRIPT_VERIFY_STRICTENC)!=0&&!p.fromTxFormat(t).hasDefinedHashtype())return this.errstr="SCRIPT_ERR_SIG_HASHTYPE",!1;return!0},Interpreter.prototype.checkPubkeyEncoding=function(t){return(this.flags&Interpreter.SCRIPT_VERIFY_STRICTENC)==0||y.isValid(t)?(this.flags&Interpreter.SCRIPT_VERIFY_WITNESS_PUBKEYTYPE)==0||this.sigversion!=p.Version.WITNESS_V0||!!y.fromBuffer(t).compressed||(this.errstr="SCRIPT_ERR_WITNESS_PUBKEYTYPE",!1):(this.errstr="SCRIPT_ERR_PUBKEYTYPE",!1)},Interpreter.prototype.checkEcdsaSignature=function(t,e,i,n,s){var o=n.toBuffer(),a=new S;a.writeVarintNum(o.length),a.write(o),g.checkState(JSUtil.isNaturalNumber(s));var c=new S().writeUInt64LEBN(new u(s)).toBuffer();return m.verify(this,t,e,i,a.toBuffer(),c)},Interpreter.prototype.checkSchnorrSignature=function(t,e,i,s){if(g.checkArgument(t&&n.isBuffer(t),"Missing sig"),g.checkArgument(e&&n.isBuffer(e),"Missing pubkey"),g.checkArgument(i,"Missing sigversion"),g.checkArgument(s,"Missing execdata"),g.checkArgument(32===e.length,"Schnorr signatures have 32-byte public keys. The caller is responsible for enforcing this."),!(64===t.length||65===t.length))return this.errstr="SCRIPT_ERR_SCHNORR_SIG_SIZE",!1;if(65===t.length&&t[t.length-1]===p.SIGHASH_DEFAULT)return this.errstr="SCRIPT_ERR_SCHNORR_SIG_HASHTYPE",!1;t=p.fromSchnorr(t);let o=b.verify(this.tx,t,e,i,this.nin,s);return o},Interpreter.prototype._evalChecksigPreTapscript=function(t,e){g.checkArgument(this.sigversion===p.Version.BASE||this.sigversion===p.Version.WITNESS_V0,"sigversion must be base or witness_v0");let i={success:!1,result:!1},n=new o().set({chunks:this.script.chunks.slice(this.pbegincodehash)});if(this.sigversion===p.Version.BASE){let e=new o().add(t),s=n.chunks.length;if(n.findAndDelete(e),(s=s==n.chunks.length+1)&&this.flags&Interpreter.SCRIPT_VERIFY_CONST_SCRIPTCODE)return this.errstr="SCRIPT_ERR_SIG_FINDANDDELETE",i}if(!this.checkSignatureEncoding(t)||!this.checkPubkeyEncoding(e))return i;try{let s=p.fromTxFormat(t),o=y.fromBuffer(e,!1);i.success=this.tx.verifySignature(s,o,this.nin,n,this.sigversion,this.satoshis)}catch(t){i.success=!1}return!i.success&&this.flags&Interpreter.SCRIPT_VERIFY_NULLFAIL&&t.length?this.errstr="SCRIPT_ERR_SIG_NULLFAIL":i.result=!0,i},Interpreter.prototype._evalChecksigTapscript=function(t,e){g.checkArgument(this.sigversion==p.Version.TAPSCRIPT,"this.sigversion must by TAPSCRIPT");let i={success:t.length>0,result:!1};if(i.success&&(g.checkState(this.execdata.validationWeightLeftInit,"validationWeightLeftInit is false"),this.execdata.validationWeightLeft-=o.VALIDATION_WEIGHT_PER_SIGOP_PASSED,this.execdata.validationWeightLeft<0))return this.errstr="SCRIPT_ERR_TAPSCRIPT_VALIDATION_WEIGHT",i;if(0===e.length)return this.errstr="SCRIPT_ERR_PUBKEYTYPE",i;if(32==e.length){if(i.success&&!this.tx.checkSchnorrSignature(t,e,this.nin,this.sigversion,this.execdata))return this.errstr="SCRIPT_ERR_SCHNORR_SIG",i}else if((this.flags&Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_PUBKEYTYPE)!=0)return this.errstr="SCRIPT_ERR_DISCOURAGE_UPGRADABLE_PUBKEYTYPE",i;return i.result=!0,i},Interpreter.prototype._evalCheckSig=function(t,e){switch(this.sigversion){case p.Version.BASE:case p.Version.WITNESS_V0:return this._evalChecksigPreTapscript(t,e);case p.Version.TAPSCRIPT:return this._evalChecksigTapscript(t,e);case p.Version.TAPROOT:throw Error("Called evalCheckSig with a TAPROOT sigversion. Check your implementation")}},Interpreter.prototype.evaluate=function(){if(g.checkArgument(this.sigversion==p.Version.BASE||this.sigversion==p.Version.WITNESS_V0||this.sigversion==p.Version.TAPSCRIPT,"invalid sigversion"),(this.sigversion==p.Version.BASE||this.sigversion==p.Version.WITNESS_V0)&&this.script.toBuffer().length>Interpreter.MAX_SCRIPT_SIZE)return this.errstr="SCRIPT_ERR_SCRIPT_SIZE",!1;try{for(;this.pc<this.script.chunks.length;)if(!this.step())return!1}catch(t){return this.errstr="SCRIPT_ERR_UNKNOWN_ERROR: "+t,!1}return!(this.vfExec.length>0)||(this.errstr="SCRIPT_ERR_UNBALANCED_CONDITIONAL",!1)},Interpreter.prototype.checkLockTime=function(t){return!(!(this.tx.nLockTime<Interpreter.LOCKTIME_THRESHOLD&&t.lt(Interpreter.LOCKTIME_THRESHOLD_BN)||this.tx.nLockTime>=Interpreter.LOCKTIME_THRESHOLD&&t.gte(Interpreter.LOCKTIME_THRESHOLD_BN))||t.gt(new u(this.tx.nLockTime)))&&!!this.tx.inputs[this.nin].isFinal()},Interpreter.prototype.checkSequence=function(t){var e=this.tx.inputs[this.nin].sequenceNumber;if(this.tx.version<2||e&Interpreter.SEQUENCE_LOCKTIME_DISABLE_FLAG)return!1;var i=Interpreter.SEQUENCE_LOCKTIME_TYPE_FLAG|Interpreter.SEQUENCE_LOCKTIME_MASK,n=new u(e&i),s=t.and(new u(i)),o=new u(Interpreter.SEQUENCE_LOCKTIME_TYPE_FLAG);return!!(n.lt(o)&&s.lt(o)||n.gte(o)&&s.gte(o))&&s.lte(n)},Interpreter.computeTapleafHash=function(t,e){let i=v.TAPLEAF;return i.writeUInt8(t),i.writeVarintNum(e.length),i.write(e),i.finalize()},Interpreter.computeTaprootMerkleRoot=function(t,e){let i=(t.length-Interpreter.TAPROOT_CONTROL_BASE_SIZE)/Interpreter.TAPROOT_CONTROL_NODE_SIZE,s=e;for(let e=0;e<i;++e){let i=v.TAPBRANCH,o=Interpreter.TAPROOT_CONTROL_BASE_SIZE+Interpreter.TAPROOT_CONTROL_NODE_SIZE*e,a=t.slice(o,o+Interpreter.TAPROOT_CONTROL_NODE_SIZE);-1===n.compare(s,a)?(i.write(s),i.write(a)):(i.write(a),i.write(s)),s=i.finalize()}return s},Interpreter.verifyTaprootCommitment=function(t,e,i){g.checkArgument(t.length>=Interpreter.TAPROOT_CONTROL_BASE_SIZE,"control too short"),g.checkArgument(e.length>=32,"program is too short");try{let n=y.fromX(!1,t.slice(1,Interpreter.TAPROOT_CONTROL_BASE_SIZE)),s=y.fromX(!1,e),o=Interpreter.computeTaprootMerkleRoot(t,i);return s.checkTapTweak(n,o,t)}catch(t){return!1}},Interpreter.prototype.step=function(){var t=(this.flags&Interpreter.SCRIPT_VERIFY_MINIMALDATA)!=0,e=-1===this.vfExec.indexOf(!1);this.execdata=this.execdata||{},this.execdata.codeseparatorPosInit||(this.execdata.codeseparatorPos=new u(4294967295),this.execdata.codeseparatorPosInit=!0);var i=this.script.chunks[this.pc];this.pc++;var n=i.opcodenum;if(s.isUndefined(n))return this.errstr="SCRIPT_ERR_UNDEFINED_OPCODE",!1;if(i.buf&&i.buf.length>Interpreter.MAX_SCRIPT_ELEMENT_SIZE)return this.errstr="SCRIPT_ERR_PUSH_SIZE",!1;if((this.sigversion===p.Version.BASE||this.sigversion===p.Version.WITNESS_V0)&&n>a.OP_16&&++this.nOpCount>201)return this.errstr="SCRIPT_ERR_OP_COUNT",!1;if(n===a.OP_CAT||n===a.OP_SUBSTR||n===a.OP_LEFT||n===a.OP_RIGHT||n===a.OP_INVERT||n===a.OP_AND||n===a.OP_OR||n===a.OP_XOR||n===a.OP_2MUL||n===a.OP_2DIV||n===a.OP_MUL||n===a.OP_DIV||n===a.OP_MOD||n===a.OP_LSHIFT||n===a.OP_RSHIFT)return this.errstr="SCRIPT_ERR_DISABLED_OPCODE",!1;if(n==a.OP_CODESEPARATOR&&this.sigversion===p.Version.BASE&&this.flags&Interpreter.SCRIPT_VERIFY_CONST_SCRIPTCODE)return this.errstr="SCRIPT_ERR_OP_CODESEPARATOR",!1;if(e&&0<=n&&n<=a.OP_PUSHDATA4){if(t&&!this.script.checkMinimalPush(this.pc-1))return this.errstr="SCRIPT_ERR_MINIMALDATA",!1;if(i.buf){if(i.len!==i.buf.length)throw Error("Length of push value not equal to length of data");this.stack.push(i.buf)}else this.stack.push(Interpreter.false)}else if(e||a.OP_IF<=n&&n<=a.OP_ENDIF)switch(n){case a.OP_1NEGATE:case a.OP_1:case a.OP_2:case a.OP_3:case a.OP_4:case a.OP_5:case a.OP_6:case a.OP_7:case a.OP_8:case a.OP_9:case a.OP_10:case a.OP_11:case a.OP_12:case a.OP_13:case a.OP_14:case a.OP_15:case a.OP_16:T=n-(a.OP_1-1),P=new u(T).toScriptNumBuffer(),this.stack.push(P);break;case a.OP_NOP:break;case a.OP_NOP2:case a.OP_CHECKLOCKTIMEVERIFY:if(!(this.flags&Interpreter.SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY)){if(this.flags&Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS)return this.errstr="SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS",!1;break}if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;var g=u.fromScriptNumBuffer(this.stack[this.stack.length-1],t,5);if(g.lt(new u(0)))return this.errstr="SCRIPT_ERR_NEGATIVE_LOCKTIME",!1;if(!this.checkLockTime(g))return this.errstr="SCRIPT_ERR_UNSATISFIED_LOCKTIME",!1;break;case a.OP_NOP3:case a.OP_CHECKSEQUENCEVERIFY:if(!(this.flags&Interpreter.SCRIPT_VERIFY_CHECKSEQUENCEVERIFY)){if(this.flags&Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS)return this.errstr="SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS",!1;break}if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;var m=u.fromScriptNumBuffer(this.stack[this.stack.length-1],t,5);if(m.lt(new u(0)))return this.errstr="SCRIPT_ERR_NEGATIVE_LOCKTIME",!1;if((m&Interpreter.SEQUENCE_LOCKTIME_DISABLE_FLAG)!=0)break;if(!this.checkSequence(m))return this.errstr="SCRIPT_ERR_UNSATISFIED_LOCKTIME",!1;break;case a.OP_NOP1:case a.OP_NOP4:case a.OP_NOP5:case a.OP_NOP6:case a.OP_NOP7:case a.OP_NOP8:case a.OP_NOP9:case a.OP_NOP10:if(this.flags&Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS)return this.errstr="SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS",!1;break;case a.OP_IF:case a.OP_NOTIF:if(K=!1,e){if(this.stack.length<1)return this.errstr="SCRIPT_ERR_UNBALANCED_CONDITIONAL",!1;if(P=this.stack[this.stack.length-1],this.sigversion===p.Version.TAPSCRIPT&&(P.length>1||1===P.length&&1!==P[0]))return this.errstr="SCRIPT_ERR_TAPSCRIPT_MINIMALIF",!1;if(this.sigversion===p.Version.WITNESS_V0&&this.flags&Interpreter.SCRIPT_VERIFY_MINIMALIF&&((P=this.stack[this.stack.length-1]).length>1||1==P.length&&1!=P[0]))return this.errstr="SCRIPT_ERR_MINIMALIF",!1;K=Interpreter.castToBool(P),n===a.OP_NOTIF&&(K=!K),this.stack.pop()}this.vfExec.push(K);break;case a.OP_ELSE:if(0===this.vfExec.length)return this.errstr="SCRIPT_ERR_UNBALANCED_CONDITIONAL",!1;this.vfExec[this.vfExec.length-1]=!this.vfExec[this.vfExec.length-1];break;case a.OP_ENDIF:if(0===this.vfExec.length)return this.errstr="SCRIPT_ERR_UNBALANCED_CONDITIONAL",!1;this.vfExec.pop();break;case a.OP_VERIFY:if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;if(P=this.stack[this.stack.length-1],!(K=Interpreter.castToBool(P)))return this.errstr="SCRIPT_ERR_VERIFY",!1;this.stack.pop();break;case a.OP_RETURN:return this.errstr="SCRIPT_ERR_OP_RETURN",!1;case a.OP_TOALTSTACK:if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.altstack.push(this.stack.pop());break;case a.OP_FROMALTSTACK:if(this.altstack.length<1)return this.errstr="SCRIPT_ERR_INVALID_ALTSTACK_OPERATION",!1;this.stack.push(this.altstack.pop());break;case a.OP_2DROP:if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.pop(),this.stack.pop();break;case a.OP_2DUP:if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;w=this.stack[this.stack.length-2],E=this.stack[this.stack.length-1],this.stack.push(w),this.stack.push(E);break;case a.OP_3DUP:if(this.stack.length<3)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;w=this.stack[this.stack.length-3],E=this.stack[this.stack.length-2];var b=this.stack[this.stack.length-1];this.stack.push(w),this.stack.push(E),this.stack.push(b);break;case a.OP_2OVER:if(this.stack.length<4)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;w=this.stack[this.stack.length-4],E=this.stack[this.stack.length-3],this.stack.push(w),this.stack.push(E);break;case a.OP_2ROT:if(this.stack.length<6)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;I=this.stack.splice(this.stack.length-6,2),this.stack.push(I[0]),this.stack.push(I[1]);break;case a.OP_2SWAP:if(this.stack.length<4)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;I=this.stack.splice(this.stack.length-4,2),this.stack.push(I[0]),this.stack.push(I[1]);break;case a.OP_IFDUP:if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;P=this.stack[this.stack.length-1],(K=Interpreter.castToBool(P))&&this.stack.push(P);break;case a.OP_DEPTH:P=new u(this.stack.length).toScriptNumBuffer(),this.stack.push(P);break;case a.OP_DROP:if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.pop();break;case a.OP_DUP:if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.push(this.stack[this.stack.length-1]);break;case a.OP_NIP:if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.splice(this.stack.length-2,1);break;case a.OP_OVER:if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.push(this.stack[this.stack.length-2]);break;case a.OP_PICK:case a.OP_ROLL:if(this.stack.length<2||(P=this.stack[this.stack.length-1],T=(O=u.fromScriptNumBuffer(P,t)).toNumber(),this.stack.pop(),T<0||T>=this.stack.length))return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;P=this.stack[this.stack.length-T-1],n===a.OP_ROLL&&this.stack.splice(this.stack.length-T-1,1),this.stack.push(P);break;case a.OP_ROT:if(this.stack.length<3)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;k=this.stack[this.stack.length-3],A=this.stack[this.stack.length-2];var S=this.stack[this.stack.length-1];this.stack[this.stack.length-3]=A,this.stack[this.stack.length-2]=S,this.stack[this.stack.length-1]=k;break;case a.OP_SWAP:if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;k=this.stack[this.stack.length-2],A=this.stack[this.stack.length-1],this.stack[this.stack.length-2]=A,this.stack[this.stack.length-1]=k;break;case a.OP_TUCK:if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.splice(this.stack.length-2,0,this.stack[this.stack.length-1]);break;case a.OP_SIZE:if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;O=new u(this.stack[this.stack.length-1].length),this.stack.push(O.toScriptNumBuffer());break;case a.OP_EQUAL:case a.OP_EQUALVERIFY:if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;w=this.stack[this.stack.length-2],E=this.stack[this.stack.length-1];var v=w.toString("hex")===E.toString("hex");if(this.stack.pop(),this.stack.pop(),this.stack.push(v?Interpreter.true:Interpreter.false),n===a.OP_EQUALVERIFY){if(!v)return this.errstr="SCRIPT_ERR_EQUALVERIFY",!1;this.stack.pop()}break;case a.OP_1ADD:case a.OP_1SUB:case a.OP_NEGATE:case a.OP_ABS:case a.OP_NOT:case a.OP_0NOTEQUAL:if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;switch(P=this.stack[this.stack.length-1],O=u.fromScriptNumBuffer(P,t),n){case a.OP_1ADD:O=O.add(u.One);break;case a.OP_1SUB:O=O.sub(u.One);break;case a.OP_NEGATE:O=O.neg();break;case a.OP_ABS:0>O.cmp(u.Zero)&&(O=O.neg());break;case a.OP_NOT:O=new u((0===O.cmp(u.Zero))+0);break;case a.OP_0NOTEQUAL:O=new u((0!==O.cmp(u.Zero))+0)}this.stack.pop(),this.stack.push(O.toScriptNumBuffer());break;case a.OP_ADD:case a.OP_SUB:case a.OP_BOOLAND:case a.OP_BOOLOR:case a.OP_NUMEQUAL:case a.OP_NUMEQUALVERIFY:case a.OP_NUMNOTEQUAL:case a.OP_LESSTHAN:case a.OP_GREATERTHAN:case a.OP_LESSTHANOREQUAL:case a.OP_GREATERTHANOREQUAL:case a.OP_MIN:case a.OP_MAX:if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;switch(B=u.fromScriptNumBuffer(this.stack[this.stack.length-2],t),N=u.fromScriptNumBuffer(this.stack[this.stack.length-1],t),O=new u(0),n){case a.OP_ADD:O=B.add(N);break;case a.OP_SUB:O=B.sub(N);break;case a.OP_BOOLAND:O=new u((0!==B.cmp(u.Zero)&&0!==N.cmp(u.Zero))+0);break;case a.OP_BOOLOR:O=new u((0!==B.cmp(u.Zero)||0!==N.cmp(u.Zero))+0);break;case a.OP_NUMEQUAL:case a.OP_NUMEQUALVERIFY:O=new u((0===B.cmp(N))+0);break;case a.OP_NUMNOTEQUAL:O=new u((0!==B.cmp(N))+0);break;case a.OP_LESSTHAN:O=new u((0>B.cmp(N))+0);break;case a.OP_GREATERTHAN:O=new u((B.cmp(N)>0)+0);break;case a.OP_LESSTHANOREQUAL:O=new u((0>=B.cmp(N))+0);break;case a.OP_GREATERTHANOREQUAL:O=new u((B.cmp(N)>=0)+0);break;case a.OP_MIN:O=0>B.cmp(N)?B:N;break;case a.OP_MAX:O=B.cmp(N)>0?B:N}if(this.stack.pop(),this.stack.pop(),this.stack.push(O.toScriptNumBuffer()),n===a.OP_NUMEQUALVERIFY){if(!Interpreter.castToBool(this.stack[this.stack.length-1]))return this.errstr="SCRIPT_ERR_NUMEQUALVERIFY",!1;this.stack.pop()}break;case a.OP_WITHIN:if(this.stack.length<3)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;B=u.fromScriptNumBuffer(this.stack[this.stack.length-3],t),N=u.fromScriptNumBuffer(this.stack[this.stack.length-2],t);var _=u.fromScriptNumBuffer(this.stack[this.stack.length-1],t);K=0>=N.cmp(B)&&0>B.cmp(_),this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(K?Interpreter.true:Interpreter.false);break;case a.OP_RIPEMD160:case a.OP_SHA1:case a.OP_SHA256:case a.OP_HASH160:case a.OP_HASH256:if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;P=this.stack[this.stack.length-1],n===a.OP_RIPEMD160?D=c.ripemd160(P):n===a.OP_SHA1?D=c.sha1(P):n===a.OP_SHA256?D=c.sha256(P):n===a.OP_HASH160?D=c.sha256ripemd160(P):n===a.OP_HASH256&&(D=c.sha256sha256(P)),this.stack.pop(),this.stack.push(D);break;case a.OP_CODESEPARATOR:this.pbegincodehash=this.pc,this.execdata.codeseparatorPos=this.pc-1;break;case a.OP_CHECKSIG:case a.OP_CHECKSIGVERIFY:{if(this.stack.length<2)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;R=this.stack[this.stack.length-2],H=this.stack[this.stack.length-1];let{success:t,result:e}=this._evalCheckSig(R,H);if(!e)return!1;if(this.stack.pop(),this.stack.pop(),this.stack.push(t?Interpreter.true:Interpreter.false),n===a.OP_CHECKSIGVERIFY){if(!t)return this.errstr="SCRIPT_ERR_CHECKSIGVERIFY",!1;this.stack.pop()}}break;case a.OP_CHECKSIGADD:{if(this.sigversion==p.Version.BASE||this.sigversion==p.Version.WITNESS_V0)return this.errstr="SCRIPT_ERR_BAD_OPCODE",!1;if(this.stack.length<3)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;let e=this.stack[this.stack.length-3],i=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1];i=u.fromScriptNumBuffer(i,t);let{success:s,result:o}=this._evalCheckSig(e,n);if(!o)return!1;this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(i.addn(s?1:0).toScriptNumBuffer())}break;case a.OP_CHECKMULTISIG:case a.OP_CHECKMULTISIGVERIFY:var P,w,E,I,T,k,A,O,B,N,R,H,x,C,M,K,U,D,L,F=1;if(this.stack.length<F)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;var V=u.fromScriptNumBuffer(this.stack[this.stack.length-F],t).toNumber();if(V<0||V>20)return this.errstr="SCRIPT_ERR_PUBKEY_COUNT",!1;if(this.nOpCount+=V,this.nOpCount>201)return this.errstr="SCRIPT_ERR_OP_COUNT",!1;var W=++F;F+=V;var j=V+2;if(this.stack.length<F)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;var G=u.fromScriptNumBuffer(this.stack[this.stack.length-F],t).toNumber();if(G<0||G>V)return this.errstr="SCRIPT_ERR_SIG_COUNT",!1;var z=++F;if(F+=G,this.stack.length<F)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;x=new o().set({chunks:this.script.chunks.slice(this.pbegincodehash)});for(var q=0;q<G;q++)R=this.stack[this.stack.length-z-q],x.findAndDelete(new o().add(R));for(U=!0;U&&G>0;){if(R=this.stack[this.stack.length-z],H=this.stack[this.stack.length-W],!this.checkSignatureEncoding(R)||!this.checkPubkeyEncoding(H))return!1;try{C=p.fromTxFormat(R),M=y.fromBuffer(H,!1),L=this.tx.verifySignature(C,M,this.nin,x,this.sigversion,this.satoshis,this.execdata)}catch(t){L=!1}L&&(z++,G--),W++,G>--V&&(U=!1)}for(;F-- >1;){if(!U&&this.flags&Interpreter.SCRIPT_VERIFY_NULLFAIL&&!j&&this.stack[this.stack.length-1].length)return this.errstr="SCRIPT_ERR_NULLFAIL",!1;j>0&&j--,this.stack.pop()}if(this.stack.length<1)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;if(this.flags&Interpreter.SCRIPT_VERIFY_NULLDUMMY&&this.stack[this.stack.length-1].length)return this.errstr="SCRIPT_ERR_SIG_NULLDUMMY",!1;if(this.stack.pop(),this.stack.push(U?Interpreter.true:Interpreter.false),n===a.OP_CHECKMULTISIGVERIFY){if(!U)return this.errstr="SCRIPT_ERR_CHECKMULTISIGVERIFY",!1;this.stack.pop()}break;default:return this.errstr="SCRIPT_ERR_BAD_OPCODE",!1}return!(this.stack.length+this.altstack.length>Interpreter.MAX_STACK_SIZE)||(this.errstr="SCRIPT_ERR_STACK_SIZE",!1)}},88508:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(53),o=i(10992),a=i(64926),u=i(66812),c=i(76244),p=i(39521),y=i(72571),g=i(6742),m=i(79460),b=i(96486),S=i(10862),v=i(19153),_=i(29854);let P=i(83868);var Script=function Script(t){return this instanceof Script?(this.chunks=[],v.isBuffer(t))?Script.fromBuffer(t):t instanceof s?Script.fromAddress(t):t instanceof Script?Script.fromBuffer(t.toBuffer()):"string"==typeof t?Script.fromString(t):void(b.isObject(t)&&Array.isArray(t.chunks)&&this.set(t)):new Script(t)};Script.prototype.set=function(t){return m.checkArgument(b.isObject(t)),m.checkArgument(Array.isArray(t.chunks)),this.chunks=t.chunks,this},Script.fromBuffer=function(t){var e=new Script;e.chunks=[];for(var i=new o(t);!i.finished();)try{var n,s,a=i.readUInt8();a>0&&a<c.OP_PUSHDATA1?(n=a,e.chunks.push({buf:i.read(n),len:n,opcodenum:a})):a===c.OP_PUSHDATA1?(n=i.readUInt8(),s=i.read(n),e.chunks.push({buf:s,len:n,opcodenum:a})):a===c.OP_PUSHDATA2?(n=i.readUInt16LE(),s=i.read(n),e.chunks.push({buf:s,len:n,opcodenum:a})):a===c.OP_PUSHDATA4?(n=i.readUInt32LE(),s=i.read(n),e.chunks.push({buf:s,len:n,opcodenum:a})):c.isOpSuccess(a)?(n=(s=i.readAll()).length,e.chunks.push({buf:s,len:n,opcodenum:a})):e.chunks.push({opcodenum:a})}catch(e){if(e instanceof RangeError)throw new S.Script.InvalidBuffer(t.toString("hex"));throw e}return e},Script.prototype.toBuffer=function(){for(var t=new a,e=0;e<this.chunks.length;e++){var i=this.chunks[e],n=i.opcodenum;t.writeUInt8(i.opcodenum),i.buf&&(n<c.OP_PUSHDATA1||(n===c.OP_PUSHDATA1?t.writeUInt8(i.len):n===c.OP_PUSHDATA2?t.writeUInt16LE(i.len):n===c.OP_PUSHDATA4&&t.writeUInt32LE(i.len)),t.write(i.buf))}return t.concat()},Script.fromASM=function(t){var e=new Script;e.chunks=[];for(var i=t.split(" "),s=0;s<i.length;){var o=c(i[s]).toNumber();if(null==o){var a=n.from(i[s],"hex");e.chunks.push({buf:a,len:a.length,opcodenum:a.length}),s+=1}else o===c.OP_PUSHDATA1||o===c.OP_PUSHDATA2||o===c.OP_PUSHDATA4?(e.chunks.push({buf:n.from(i[s+2],"hex"),len:parseInt(i[s+1]),opcodenum:o}),s+=3):(e.chunks.push({opcodenum:o}),s+=1)}return e},Script.fromHex=function(t){return new Script(n.from(t,"hex"))},Script.fromString=function(t){if(_.isHexa(t)||0===t.length)return new Script(n.from(t,"hex"));var e=new Script;e.chunks=[];for(var i=t.split(" "),s=0;s<i.length;){var o=i[s],a=c(o).toNumber();if(null==a){if((a=parseInt(o))>0&&a<c.OP_PUSHDATA1)e.chunks.push({buf:n.from(i[s+1].slice(2),"hex"),len:a,opcodenum:a}),s+=2;else throw Error("Invalid script: "+JSON.stringify(t))}else if(a===c.OP_PUSHDATA1||a===c.OP_PUSHDATA2||a===c.OP_PUSHDATA4){if("0x"!==i[s+2].slice(0,2))throw Error("Pushdata data must start with 0x");e.chunks.push({buf:n.from(i[s+2].slice(2),"hex"),len:parseInt(i[s+1]),opcodenum:a}),s+=3}else e.chunks.push({opcodenum:a}),s+=1}return e},Script.prototype._chunkToString=function(t,e){var i=t.opcodenum,n="asm"===e,s="";if(t.buf)(n||i!==c.OP_PUSHDATA1)&&i!==c.OP_PUSHDATA2&&i!==c.OP_PUSHDATA4||(s=s+" "+c(i).toString()),t.len>0&&(s=n?s+" "+t.buf.toString("hex"):s+" "+t.len+" 0x"+t.buf.toString("hex"));else if(void 0!==c.reverseMap[i])n?0===i?s+=" 0":79===i?s+=" -1":s=s+" "+c(i).toString():s=s+" "+c(i).toString();else{var o=i.toString(16);o.length%2!=0&&(o="0"+o),s=n?s+" "+o:s+" 0x"+o}return s},Script.prototype.toASM=function(){for(var t="",e=0;e<this.chunks.length;e++){var i=this.chunks[e];t+=this._chunkToString(i,"asm")}return t.substr(1)},Script.prototype.toString=function(){for(var t="",e=0;e<this.chunks.length;e++){var i=this.chunks[e];t+=this._chunkToString(i)}return t.substr(1)},Script.prototype.toHex=function(){return this.toBuffer().toString("hex")},Script.prototype.inspect=function(){return"<Script: "+this.toString()+">"},Script.prototype.isPublicKeyHashOut=function(){return!!(5===this.chunks.length&&this.chunks[0].opcodenum===c.OP_DUP&&this.chunks[1].opcodenum===c.OP_HASH160&&this.chunks[2].buf&&20===this.chunks[2].buf.length&&this.chunks[3].opcodenum===c.OP_EQUALVERIFY&&this.chunks[4].opcodenum===c.OP_CHECKSIG)},Script.prototype.isPublicKeyHashIn=function(){if(2===this.chunks.length){var t=this.chunks[0].buf,e=this.chunks[1].buf;if(t&&t.length&&48===t[0]&&e&&e.length){var i=e[0];if((4===i||6===i||7===i)&&65===e.length||(3===i||2===i)&&33===e.length)return!0}}return!1},Script.prototype.getPublicKey=function(){return m.checkState(this.isPublicKeyOut(),"Can't retrieve PublicKey from a non-PK output"),this.chunks[0].buf},Script.prototype.getPublicKeyHash=function(){if(this.isPublicKeyHashOut())return this.chunks[2].buf;if(this.isWitnessPublicKeyHashOut()||this.isTaproot())return this.chunks[1].buf;throw Error("Can't retrieve PublicKeyHash from a non-PKH output")},Script.prototype.isPublicKeyOut=function(){if(2===this.chunks.length&&this.chunks[0].buf&&this.chunks[0].buf.length&&this.chunks[1].opcodenum===c.OP_CHECKSIG){var t=this.chunks[0].buf,e=t[0],i=!1;if((4===e||6===e||7===e)&&65===t.length?i=!0:(3===e||2===e)&&33===t.length&&(i=!0),i)return p.isValid(t)}return!1},Script.prototype.isPublicKeyIn=function(){if(1===this.chunks.length){var t=this.chunks[0].buf;if(t&&t.length&&48===t[0])return!0}return!1},Script.prototype.isScriptHashOut=function(){var t=this.toBuffer();return 23===t.length&&t[0]===c.OP_HASH160&&20===t[1]&&t[t.length-1]===c.OP_EQUAL},Script.prototype.isWitnessScriptHashOut=function(){var t=this.toBuffer();return 34===t.length&&t[0]===c.OP_0&&32===t[1]},Script.prototype.isWitnessPublicKeyHashOut=function(){var t=this.toBuffer();return 22===t.length&&t[0]===c.OP_0&&20===t[1]},Script.prototype.isTaproot=function(){var t=this.toBuffer();return 34===t.length&&t[0]===c.OP_1&&32===t[1]},Script.prototype.isWitnessProgram=function(t){t||(t={});var e=this.toBuffer();return!(e.length<4)&&!(e.length>42)&&(e[0]===c.OP_0||!!(e[0]>=c.OP_1&&e[0]<=c.OP_16))&&e.length===e[1]+2&&(t.version=c.decodeOpN(e[0]),t.program=e.slice(2,e.length),!0)},Script.prototype.isScriptHashIn=function(){if(this.chunks.length<=1)return!1;var t,e=this.chunks[this.chunks.length-1].buf;if(!e)return!1;try{t=Script.fromBuffer(e)}catch(t){if(t instanceof S.Script.InvalidBuffer)return!1;throw t}return t.classify()!==Script.types.UNKNOWN},Script.prototype.isMultisigOut=function(){return this.chunks.length>3&&c.isSmallIntOp(this.chunks[0].opcodenum)&&this.chunks.slice(1,this.chunks.length-2).every(function(t){return t.buf&&v.isBuffer(t.buf)})&&c.isSmallIntOp(this.chunks[this.chunks.length-2].opcodenum)&&this.chunks[this.chunks.length-1].opcodenum===c.OP_CHECKMULTISIG},Script.prototype.isMultisigIn=function(){return this.chunks.length>=2&&0===this.chunks[0].opcodenum&&this.chunks.slice(1,this.chunks.length).every(function(t){return t.buf&&v.isBuffer(t.buf)&&y.isTxDER(t.buf)})},Script.prototype.isDataOut=function(){return this.chunks.length>=1&&this.chunks[0].opcodenum===c.OP_RETURN&&(1===this.chunks.length||2===this.chunks.length&&this.chunks[1].buf&&this.chunks[1].buf.length<=Script.OP_RETURN_STANDARD_SIZE&&this.chunks[1].length===this.chunks.len)},Script.prototype.getData=function(){if(this.isDataOut()||this.isScriptHashOut()||this.isWitnessScriptHashOut()||this.isWitnessPublicKeyHashOut()||this.isTaproot())return null==this.chunks[1]?n.alloc(0):n.from(this.chunks[1].buf);if(this.isPublicKeyHashOut())return n.from(this.chunks[2].buf);throw Error("Unrecognized script type to get data from")},Script.prototype.isPushOnly=function(){return this.chunks.every(function(t){return t.opcodenum<=c.OP_16})},Script.types={},Script.types.UNKNOWN="Unknown",Script.types.PUBKEY_OUT="Pay to public key",Script.types.PUBKEY_IN="Spend from public key",Script.types.PUBKEYHASH_OUT="Pay to public key hash",Script.types.PUBKEYHASH_IN="Spend from public key hash",Script.types.SCRIPTHASH_OUT="Pay to script hash",Script.types.SCRIPTHASH_IN="Spend from script hash",Script.types.MULTISIG_OUT="Pay to multisig",Script.types.MULTISIG_IN="Spend from multisig",Script.types.DATA_OUT="Data push",Script.OP_RETURN_STANDARD_SIZE=80,Script.ANNEX_TAG=80,Script.VALIDATION_WEIGHT_PER_SIGOP_PASSED=50,Script.VALIDATION_WEIGHT_OFFSET=50,Script.prototype.classify=function(){if(this._isInput)return this.classifyInput();if(this._isOutput)return this.classifyOutput();var t=this.classifyOutput();return t!=Script.types.UNKNOWN?t:this.classifyInput()},Script.outputIdentifiers={},Script.outputIdentifiers.PUBKEY_OUT=Script.prototype.isPublicKeyOut,Script.outputIdentifiers.PUBKEYHASH_OUT=Script.prototype.isPublicKeyHashOut,Script.outputIdentifiers.MULTISIG_OUT=Script.prototype.isMultisigOut,Script.outputIdentifiers.SCRIPTHASH_OUT=Script.prototype.isScriptHashOut,Script.outputIdentifiers.DATA_OUT=Script.prototype.isDataOut,Script.prototype.classifyOutput=function(){for(var t in Script.outputIdentifiers)if(Script.outputIdentifiers[t].bind(this)())return Script.types[t];return Script.types.UNKNOWN},Script.inputIdentifiers={},Script.inputIdentifiers.PUBKEY_IN=Script.prototype.isPublicKeyIn,Script.inputIdentifiers.PUBKEYHASH_IN=Script.prototype.isPublicKeyHashIn,Script.inputIdentifiers.MULTISIG_IN=Script.prototype.isMultisigIn,Script.inputIdentifiers.SCRIPTHASH_IN=Script.prototype.isScriptHashIn,Script.prototype.classifyInput=function(){for(var t in Script.inputIdentifiers)if(Script.inputIdentifiers[t].bind(this)())return Script.types[t];return Script.types.UNKNOWN},Script.prototype.isStandard=function(){return this.classify()!==Script.types.UNKNOWN},Script.prototype.prepend=function(t){return this._addByType(t,!0),this},Script.prototype.equals=function(t){var e;if(m.checkState(t instanceof Script,"Must provide another script"),this.chunks.length!==t.chunks.length)return!1;for(e=0;e<this.chunks.length;e++)if(v.isBuffer(this.chunks[e].buf)&&!v.isBuffer(t.chunks[e].buf)||v.isBuffer(this.chunks[e].buf)&&!v.equals(this.chunks[e].buf,t.chunks[e].buf)||this.chunks[e].opcodenum!==t.chunks[e].opcodenum)return!1;return!0},Script.prototype.add=function(t){return this._addByType(t,!1),this},Script.prototype._addByType=function(t,e){if("string"==typeof t)this._addOpcode(t,e);else if("number"==typeof t)this._addOpcode(t,e);else if(t instanceof c)this._addOpcode(t,e);else if(v.isBuffer(t))this._addBuffer(t,e);else if(t instanceof Script)this.chunks=this.chunks.concat(t.chunks);else if("object"==typeof t)this._insertAtPosition(t,e);else throw Error("Invalid script chunk")},Script.prototype._insertAtPosition=function(t,e){e?this.chunks.unshift(t):this.chunks.push(t)},Script.prototype._addOpcode=function(t,e){var i;return i="number"==typeof t?t:t instanceof c?t.toNumber():c(t).toNumber(),this._insertAtPosition({opcodenum:i},e),this},Script.prototype._addBuffer=function(t,e){var i,n=t.length;if(n>=0&&n<c.OP_PUSHDATA1)i=n;else if(n<256)i=c.OP_PUSHDATA1;else if(n<65536)i=c.OP_PUSHDATA2;else if(n<4294967296)i=c.OP_PUSHDATA4;else throw Error("You can't push that much data");return this._insertAtPosition({buf:t,len:n,opcodenum:i},e),this},Script.prototype.hasCodeseparators=function(){for(var t=0;t<this.chunks.length;t++)if(this.chunks[t].opcodenum===c.OP_CODESEPARATOR)return!0;return!1},Script.prototype.removeCodeseparators=function(){for(var t=[],e=0;e<this.chunks.length;e++)this.chunks[e].opcodenum!==c.OP_CODESEPARATOR&&t.push(this.chunks[e]);return this.chunks=t,this},Script.buildMultisigOut=function(t,e,i){m.checkArgument(e<=t.length,"Number of required signatures must be less than or equal to the number of public keys"),i=i||{};var n=new Script;n.add(c.smallInt(e));var s=t=t.map(p);i.noSorting||(s=b.sortBy(t,function(t){return t.toString("hex")}));for(var o=0;o<s.length;o++){var a=s[o];n.add(a.toBuffer())}return n.add(c.smallInt(t.length)),n.add(c.OP_CHECKMULTISIG),n},Script.buildWitnessMultisigOutFromScript=function(t){if(t instanceof Script){var e=new Script;return e.add(c.OP_0),e.add(u.sha256(t.toBuffer())),e}throw TypeError("First argument is expected to be a p2sh script")},Script.buildMultisigIn=function(t,e,i,n){m.checkArgument(Array.isArray(t)),m.checkArgument(!isNaN(e)),m.checkArgument(Array.isArray(i)),n=n||{};var s=new Script;for(let t of(s.add(c.OP_0),i))m.checkArgument(v.isBuffer(t),"Signatures must be an array of Buffers"),s.add(t);return s},Script.buildP2SHMultisigIn=function(t,e,i,n){m.checkArgument(Array.isArray(t)),m.checkArgument(!isNaN(e)),m.checkArgument(Array.isArray(i)),n=n||{};var s=new Script;for(let t of(s.add(c.OP_0),i))m.checkArgument(v.isBuffer(t),"Signatures must be an array of Buffers"),s.add(t);return s.add((n.cachedMultisig||Script.buildMultisigOut(t,e,n)).toBuffer()),s},Script.buildPublicKeyHashOut=function(t){m.checkArgument(null!=t),m.checkArgument(t instanceof p||t instanceof s||"string"==typeof t),t instanceof p?t=t.toAddress():"string"==typeof t&&(t=new s(t));var e=new Script;return e.add(c.OP_DUP).add(c.OP_HASH160).add(t.hashBuffer).add(c.OP_EQUALVERIFY).add(c.OP_CHECKSIG),e._network=t.network,e},Script.buildWitnessV0Out=function(t){m.checkArgument(null!=t),m.checkArgument(t instanceof p||t instanceof s||"string"==typeof t),t instanceof p?t=t.toAddress(null,s.PayToWitnessPublicKeyHash):"string"==typeof t&&(t=new s(t));var e=new Script;return e.add(c.OP_0).add(t.hashBuffer),e._network=t.network,e},Script.buildWitnessV1Out=function(t,e){let i;if(m.checkArgument(t instanceof p||t instanceof s||"string"==typeof t),m.checkArgument(!e||Array.isArray(e)||!!e.script),"string"==typeof t)try{t=p.fromTaproot(t)}catch{t=s.fromString(t)}let o=null;if(e){let[t,i]=function buildTree(t){if(Array.isArray(t)){let[e,i]=buildTree(t[0]),[n,s]=buildTree(t[1]),o=[[[e[0],e[1]],s],[[n[0],n[1]],i]],a=P.TAPBRANCH;return 1===i.compare(s)?(a.write(s),a.write(i)):(a.write(i),a.write(s)),[o,a.finalize()]}{let{leafVersion:e,script:i}=t,s=new Script(i).toBuffer(),o=P.TAPLEAF;o.writeUInt8(e),o.writeUInt8(s.length),o.write(s);let a=o.finalize();return[[n.from([e]),s],a]}}(e);o=i}i=t instanceof p?t.createTapTweak(o).tweakedPubKey:t.hashBuffer;let a=new Script;return a.add(c.OP_1),a.add(i),a},Script.buildPublicKeyOut=function(t){m.checkArgument(t instanceof p);var e=new Script;return e.add(t.toBuffer()).add(c.OP_CHECKSIG),e},Script.buildDataOut=function(t,e){m.checkArgument(null==t||"string"==typeof t||v.isBuffer(t)),"string"==typeof t&&(t=n.from(t,e));var i=new Script;return i.add(c.OP_RETURN),null!=t&&i.add(t),i},Script.buildScriptHashOut=function(t){m.checkArgument(t instanceof Script||t instanceof s&&t.isPayToScriptHash());var e=new Script;return e.add(c.OP_HASH160).add(t instanceof s?t.hashBuffer:u.sha256ripemd160(t.toBuffer())).add(c.OP_EQUAL),e._network=t._network||t.network,e},Script.buildPublicKeyIn=function(t,e){m.checkArgument(t instanceof y||v.isBuffer(t)),m.checkArgument(null==e||!isNaN(e)),t instanceof y&&(t=t.toBuffer());var i=new Script;return i.add(v.concat([t,v.integerAsSingleByteBuffer(e||y.SIGHASH_ALL)])),i},Script.buildPublicKeyHashIn=function(t,e,i){return m.checkArgument(e instanceof y||v.isBuffer(e)),m.checkArgument(null==i||!isNaN(i)),e instanceof y&&(e=e.toBuffer()),new Script().add(v.concat([e,v.integerAsSingleByteBuffer(i||y.SIGHASH_ALL)])).add(new p(t).toBuffer())},Script.empty=function(){return new Script},Script.prototype.toScriptHashOut=function(){return Script.buildScriptHashOut(this)},Script.fromAddress=function(t){if((t=s(t)).isPayToScriptHash())return Script.buildScriptHashOut(t);if(t.isPayToPublicKeyHash())return Script.buildPublicKeyHashOut(t);if(t.isPayToWitnessPublicKeyHash()||t.isPayToWitnessScriptHash())return Script.buildWitnessV0Out(t);if(t.isPayToTaproot())return Script.buildWitnessV1Out(t);throw new S.Script.UnrecognizedAddress(t)},Script.prototype.getAddressInfo=function(t){return this._isInput?this._getInputAddressInfo():this._isOutput?this._getOutputAddressInfo():this._getOutputAddressInfo()||this._getInputAddressInfo()},Script.prototype._getOutputAddressInfo=function(){var t={};if(this.isScriptHashOut())t.hashBuffer=this.getData(),t.type=s.PayToScriptHash;else if(this.isPublicKeyHashOut())t.hashBuffer=this.getData(),t.type=s.PayToPublicKeyHash;else if(this.isWitnessScriptHashOut())t.hashBuffer=this.getData(),t.type=s.PayToWitnessScriptHash;else if(this.isWitnessPublicKeyHashOut())t.hashBuffer=this.getData(),t.type=s.PayToWitnessPublicKeyHash;else{if(!this.isTaproot())return!1;t.hashBuffer=this.getData(),t.type=s.PayToTaproot}return t},Script.prototype._getInputAddressInfo=function(){var t={};if(this.isPublicKeyHashIn())t.hashBuffer=u.sha256ripemd160(this.chunks[1].buf),t.type=s.PayToPublicKeyHash;else{if(!this.isScriptHashIn())return!1;t.hashBuffer=u.sha256ripemd160(this.chunks[this.chunks.length-1].buf),t.type=s.PayToScriptHash}return t},Script.prototype.toAddress=function(t){var e=this.getAddressInfo();return!!e&&(e.network=g.get(t)||this._network||g.defaultNetwork,new s(e))},Script.prototype.findAndDelete=function(t){for(var e=t.toBuffer().toString("hex"),i=0;i<this.chunks.length;i++)e===Script({chunks:[this.chunks[i]]}).toBuffer().toString("hex")&&this.chunks.splice(i,1);return this},Script.prototype.checkMinimalPush=function(t){var e=this.chunks[t],i=e.buf,n=e.opcodenum;return!i||(0===i.length?n===c.OP_0:1===i.length&&i[0]>=1&&i[0]<=16?n===c.OP_1+(i[0]-1):1===i.length&&129===i[0]?n===c.OP_1NEGATE:i.length<=75?n===i.length:i.length<=255?n===c.OP_PUSHDATA1:!(i.length<=65535)||n===c.OP_PUSHDATA2)},Script.prototype.getSignatureOperationsCount=function(t){t=null==t||t;var e=0,i=c.OP_INVALIDOPCODE;for(let s of this.chunks){var n=s.opcodenum;n==c.OP_CHECKSIG||n==c.OP_CHECKSIGVERIFY?e++:(n==c.OP_CHECKMULTISIG||n==c.OP_CHECKMULTISIGVERIFY)&&(t&&i>=c.OP_1&&i<=c.OP_16?e+=c.decodeOpN(i):e+=20),i=n}return e},t.exports=Script},98507:function(t,e,i){t.exports=i(4634),t.exports.Input=i(99045),t.exports.Output=i(4257),t.exports.UnspentOutput=i(22876),t.exports.Signature=i(47230),t.exports.Sighash=i(254),t.exports.SighashWitness=i(96857)},99045:function(t,e,i){t.exports=i(27455),t.exports.PublicKey=i(92603),t.exports.PublicKeyHash=i(82056),t.exports.MultiSig=i(73747),t.exports.MultiSigScriptHash=i(98976),t.exports.Taproot=i(55486)},27455:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(79460);let a=i(10862);var u=i(64926);i(48764);var c=i(19153),p=i(29854),y=i(64502),g=i(254),m=i(4257);function Input(t){return this instanceof Input?t?this._fromObject(t):void 0:new Input(t)}Input.MAXINT=4294967295,Input.DEFAULT_SEQNUMBER=4294967295,Input.DEFAULT_LOCKTIME_SEQNUMBER=4294967294,Input.DEFAULT_RBF_SEQNUMBER=4294967293,Input.SEQUENCE_LOCKTIME_TYPE_FLAG=4194304,Object.defineProperty(Input.prototype,"script",{configurable:!1,enumerable:!0,get:function(){return this.isNull()?null:(this._script||(this._script=new y(this._scriptBuffer),this._script._isInput=!0),this._script)}}),Input.fromObject=function(t){return o.checkArgument(s.isObject(t)),new Input()._fromObject(t)},Input.prototype._fromObject=function(t){var e;if(e="string"==typeof t.prevTxId&&p.isHexa(t.prevTxId)?n.from(t.prevTxId,"hex"):t.prevTxId,this.witnesses=[],this.output=t.output?t.output instanceof m?t.output:new m(t.output):void 0,this.prevTxId=e||t.txidbuf,this.outputIndex=null==t.outputIndex?t.txoutnum:t.outputIndex,this.sequenceNumber=null==t.sequenceNumber?null==t.seqnum?4294967295:t.seqnum:t.sequenceNumber,void 0===t.script&&void 0===t.scriptBuffer)throw new a.Transaction.Input.MissingScript;return this.setScript(t.scriptBuffer||t.script),this},Input.prototype.toObject=Input.prototype.toJSON=function(){var t={prevTxId:this.prevTxId.toString("hex"),outputIndex:this.outputIndex,sequenceNumber:this.sequenceNumber,script:this._scriptBuffer.toString("hex")};return this.script&&(t.scriptString=this.script.toString()),this.output&&(t.output=this.output.toObject()),t},Input.fromBufferReader=function(t){var e=new Input;return e.prevTxId=t.readReverse(32),e.outputIndex=t.readUInt32LE(),e._scriptBuffer=t.readVarLengthBuffer(),e.sequenceNumber=t.readUInt32LE(),e},Input.prototype.toBufferWriter=function(t){t||(t=new u),t.writeReverse(this.prevTxId),t.writeUInt32LE(this.outputIndex);var e=this._scriptBuffer;return t.writeVarintNum(e.length),t.write(e),t.writeUInt32LE(this.sequenceNumber),t},Input.prototype.setScript=function(t){if(this._script=null,t instanceof y)this._script=t,this._script._isInput=!0,this._scriptBuffer=t.toBuffer();else if(p.isHexa(t))this._scriptBuffer=n.from(t,"hex");else if(s.isString(t))this._script=new y(t),this._script._isInput=!0,this._scriptBuffer=this._script.toBuffer();else if(c.isBuffer(t))this._scriptBuffer=n.from(t);else throw TypeError("Invalid argument type: script");return this},Input.prototype.getSignatures=function(){throw new a.AbstractMethodInvoked("Trying to sign unsupported output type (only P2PKH and P2SH multisig inputs are supported) for input: "+JSON.stringify(this))},Input.prototype.getSatoshisBuffer=function(){return o.checkState(this.output instanceof m),o.checkState(this.output._satoshisBN),new u().writeUInt64LEBN(this.output._satoshisBN).toBuffer()},Input.prototype.isFullySigned=function(){throw new a.AbstractMethodInvoked("Input#isFullySigned")},Input.prototype.isFinal=function(){return this.sequenceNumber!==Input.MAXINT},Input.prototype.addSignature=function(){throw new a.AbstractMethodInvoked("Input#addSignature")},Input.prototype.clearSignatures=function(){throw new a.AbstractMethodInvoked("Input#clearSignatures")},Input.prototype.hasWitnesses=function(){return!!this.witnesses&&this.witnesses.length>0},Input.prototype.getWitnesses=function(){return this.witnesses},Input.prototype.setWitnesses=function(t){this.witnesses=t},Input.prototype.isValidSignature=function(t,e,i){return i=i||"ecdsa",e.signature.nhashtype=e.sigtype,g.verify(t,e.signature,e.publicKey,e.inputIndex,this.output.script)},Input.prototype.isNull=function(){return"0000000000000000000000000000000000000000000000000000000000000000"===this.prevTxId.toString("hex")&&4294967295===this.outputIndex},Input.prototype._estimateSize=function(){return this.toBufferWriter().toBuffer().length},Input.prototype._getBaseSize=function(){return 40},Input.prototype.lockForSeconds=function(t){if(o.checkArgument(s.isNumber(t)),t<0||t>=33553920)throw new a.Transaction.Input.LockTimeRange;return t=parseInt(Math.floor(t/512)),this.sequenceNumber=4194304|t,this},Input.prototype.lockUntilBlockHeight=function(t){if(o.checkArgument(s.isNumber(t)),t<0||t>=65535)throw new a.Transaction.Input.BlockHeightOutOfRange;return this.sequenceNumber=t,this},Input.prototype.getLockTime=function(){return 2147483648&this.sequenceNumber?null:4194304&this.sequenceNumber?512*(65535&this.sequenceNumber):65535&this.sequenceNumber},t.exports=Input},73747:function(t,e,i){"use strict";var n=i(96486),s=i(9213);i(4634);var o=i(27455),a=i(4257),u=i(79460),c=i(64502),p=i(72571),y=i(254);i(39521);var g=i(19153),m=i(47230);function MultiSigInput(t,e,i,s,a){a=a||{},o.apply(this,arguments);var p=this;e=e||t.publicKeys,i=i||t.threshold,s=s||t.signatures,a.noSorting?this.publicKeys=e:this.publicKeys=n.sortBy(e,function(t){return t.toString("hex")}),u.checkState(c.buildMultisigOut(this.publicKeys,i).equals(this.output.script),"Provided public keys don't match to the provided output script"),this.publicKeyIndex={},n.each(this.publicKeys,function(t,e){p.publicKeyIndex[t.toString()]=e}),this.threshold=i,this.signatures=s?this._deserializeSignatures(s):Array(this.publicKeys.length)}s(MultiSigInput,o),MultiSigInput.prototype.toObject=function(){var t=o.prototype.toObject.apply(this,arguments);return t.threshold=this.threshold,t.publicKeys=n.map(this.publicKeys,function(t){return t.toString()}),t.signatures=this._serializeSignatures(),t},MultiSigInput.prototype._deserializeSignatures=function(t){return n.map(t,function(t){if(t)return new m(t)})},MultiSigInput.prototype._serializeSignatures=function(){return n.map(this.signatures,function(t){if(t)return t.toObject()})},MultiSigInput.prototype.getSignatures=function(t,e,i,n,s,o,c){u.checkState(this.output instanceof a),n=n||p.SIGHASH_ALL,o=o||"ecdsa";let g=[];for(let s of this.publicKeys||[])s.toString()===e.publicKey.toString()&&g.push(new m({publicKey:e.publicKey,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:i,signature:y.sign(t,e,n,i,this.output.script),sigtype:n}));return g},MultiSigInput.prototype.addSignature=function(t,e,i){return u.checkState(!this.isFullySigned(),"All needed signatures have already been added"),u.checkArgument(!n.isUndefined(this.publicKeyIndex[e.publicKey.toString()],"Signature Undefined"),"Signature has no matching public key"),u.checkState(this.isValidSignature(t,e,i),"Invalid Signature"),this.signatures[this.publicKeyIndex[e.publicKey.toString()]]=e,this._updateScript(),this},MultiSigInput.prototype._updateScript=function(){return this.setScript(c.buildMultisigIn(this.publicKeys,this.threshold,this._createSignatures())),this},MultiSigInput.prototype._createSignatures=function(){return n.map(n.filter(this.signatures,function(t){return!n.isUndefined(t)}),function(t){return g.concat([t.signature.toDER(),g.integerAsSingleByteBuffer(t.sigtype)])})},MultiSigInput.prototype.clearSignatures=function(){this.signatures=Array(this.publicKeys.length),this._updateScript()},MultiSigInput.prototype.isFullySigned=function(){return this.countSignatures()===this.threshold},MultiSigInput.prototype.countMissingSignatures=function(){return this.threshold-this.countSignatures()},MultiSigInput.prototype.countSignatures=function(){return n.reduce(this.signatures,function(t,e){return t+!!e},0)},MultiSigInput.prototype.publicKeysWithoutSignature=function(){var t=this;return n.filter(this.publicKeys,function(e){return!t.signatures[t.publicKeyIndex[e.toString()]]})},MultiSigInput.prototype.isValidSignature=function(t,e,i){return i=i||"ecdsa",e.signature.nhashtype=e.sigtype,y.verify(t,e.signature,e.publicKey,e.inputIndex,this.output.script)},MultiSigInput.normalizeSignatures=function(t,e,i,n,s,o){return o=o||"ecdsa",s.map(function(s){var o=null;return n=n.filter(function(n){if(o)return!0;var a=new m({signature:p.fromTxFormat(n),publicKey:s,prevTxId:e.prevTxId,outputIndex:e.outputIndex,inputIndex:i,sigtype:p.SIGHASH_ALL});return a.signature.nhashtype=a.sigtype,!y.verify(t,a.signature,a.publicKey,a.inputIndex,e.output.script)||(o=a,!1)}),o||null})},MultiSigInput.OPCODES_SIZE=1,MultiSigInput.SIGNATURE_SIZE=73,MultiSigInput.prototype._estimateSize=function(){return this._getBaseSize()+MultiSigInput.OPCODES_SIZE+this.threshold*MultiSigInput.SIGNATURE_SIZE},t.exports=MultiSigInput},98976:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(9213),a=i(27455),u=i(4257),c=i(79460),p=i(53),y=i(64502),g=i(72571),m=i(254),b=i(96857),S=i(64926),v=i(19153),_=i(47230);function MultiSigScriptHashInput(t,e,i,n,o){o=o||{},a.apply(this,arguments),e=e||t.publicKeys,i=i||t.threshold,n=n||t.signatures,o.noSorting?this.publicKeys=e:this.publicKeys=s.sortBy(e,function(t){return t.toString("hex")}),this.redeemScript=y.buildMultisigOut(this.publicKeys,i,o);var u=y.buildWitnessMultisigOutFromScript(this.redeemScript);if(u.equals(this.output.script))this.nestedWitness=!1,this.type=p.PayToWitnessScriptHash;else if(y.buildScriptHashOut(u).equals(this.output.script))this.nestedWitness=!0,this.type=p.PayToScriptHash;else if(y.buildScriptHashOut(this.redeemScript).equals(this.output.script))this.nestedWitness=!1,this.type=p.PayToScriptHash;else throw Error("Provided public keys don't hash to the provided output");if(this.nestedWitness){var c=new y;c.add(u.toBuffer()),this.setScript(c)}this.publicKeyIndex={};for(let t=0;t<this.publicKeys.length;t++){let e=this.publicKeys[t];this.publicKeyIndex[e.toString()]=t}this.threshold=i,this.signatures=n?this._deserializeSignatures(n):Array(this.publicKeys.length)}o(MultiSigScriptHashInput,a),MultiSigScriptHashInput.prototype.toObject=function(){var t=a.prototype.toObject.apply(this,arguments);return t.threshold=this.threshold,t.publicKeys=this.publicKeys.map(function(t){return t.toString()}),t.signatures=this._serializeSignatures(),t},MultiSigScriptHashInput.prototype._deserializeSignatures=function(t){return t.map(function(t){if(t)return new _(t)})},MultiSigScriptHashInput.prototype._serializeSignatures=function(){return this.signatures.map(function(t){if(t)return t.toObject()})},MultiSigScriptHashInput.prototype.getScriptCode=function(){var t=new S;if(this.redeemScript.hasCodeseparators())throw Error("@TODO");var e=this.redeemScript.toBuffer();return t.writeVarintNum(e.length),t.write(e),t.toBuffer()},MultiSigScriptHashInput.prototype.getSighash=function(t,e,i,n){var s;if(this.nestedWitness||this.type===p.PayToWitnessScriptHash){var o=this.getScriptCode(),a=this.getSatoshisBuffer();s=b.sighash(t,n,i,o,a)}else s=m.sighash(t,n,i,this.redeemScript);return s},MultiSigScriptHashInput.prototype.getSignatures=function(t,e,i,n,s,o,a){c.checkState(this.output instanceof u),n=n||g.SIGHASH_ALL,o=o||"ecdsa";let y=[];for(let s of this.publicKeys)if(s.toString()===e.publicKey.toString()){var S;if(this.nestedWitness||this.type===p.PayToWitnessScriptHash){var v=this.getScriptCode(),P=this.getSatoshisBuffer();S=b.sign(t,e,n,i,v,P)}else S=m.sign(t,e,n,i,this.redeemScript);y.push(new _({publicKey:e.publicKey,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:i,signature:S,sigtype:n}))}return y},MultiSigScriptHashInput.prototype.addSignature=function(t,e,i){return c.checkState(!this.isFullySigned(),"All needed signatures have already been added"),c.checkArgument(null!=this.publicKeyIndex[e.publicKey.toString()],"Signature has no matching public key"),c.checkState(this.isValidSignature(t,e,i),"Invalid Signature!"),this.signatures[this.publicKeyIndex[e.publicKey.toString()]]=e,this._updateScript(),this},MultiSigScriptHashInput.prototype._updateScript=function(){if(this.nestedWitness||this.type===p.PayToWitnessScriptHash){for(var t=[n.alloc(0)],e=this._createSignatures(),i=0;i<e.length;i++)t.push(e[i]);t.push(this.redeemScript.toBuffer()),this.setWitnesses(t)}else{var s=y.buildP2SHMultisigIn(this.publicKeys,this.threshold,this._createSignatures(),{cachedMultisig:this.redeemScript});this.setScript(s)}return this},MultiSigScriptHashInput.prototype._createSignatures=function(){return this.signatures.filter(function(t){return null!=t}).map(function(t){return v.concat([t.signature.toDER(),v.integerAsSingleByteBuffer(t.sigtype)])})},MultiSigScriptHashInput.prototype.clearSignatures=function(){this.signatures=Array(this.publicKeys.length),this._updateScript()},MultiSigScriptHashInput.prototype.isFullySigned=function(){return this.countSignatures()===this.threshold},MultiSigScriptHashInput.prototype.countMissingSignatures=function(){return this.threshold-this.countSignatures()},MultiSigScriptHashInput.prototype.countSignatures=function(){return this.signatures.reduce(function(t,e){return t+!!e},0)},MultiSigScriptHashInput.prototype.publicKeysWithoutSignature=function(){return this.publicKeys.filter(t=>!this.signatures[this.publicKeyIndex[t.toString()]])},MultiSigScriptHashInput.prototype.isValidSignature=function(t,e,i){if(i=i||"ecdsa",!this.nestedWitness&&this.type!==p.PayToWitnessScriptHash)return e.signature.nhashtype=e.sigtype,m.verify(t,e.signature,e.publicKey,e.inputIndex,this.redeemScript);e.signature.nhashtype=e.sigtype;var n=this.getScriptCode(),s=this.getSatoshisBuffer();return b.verify(t,e.signature,e.publicKey,e.inputIndex,n,s)},MultiSigScriptHashInput.MAX_OPCODES_SIZE=8,MultiSigScriptHashInput.MAX_SIGNATURE_SIZE=74,MultiSigScriptHashInput.MAX_PUBKEY_SIZE=34,MultiSigScriptHashInput.REDEEM_SCRIPT_SIZE=34,MultiSigScriptHashInput.prototype._estimateSize=function(){let t=this._getBaseSize(),e=MultiSigScriptHashInput.MAX_OPCODES_SIZE+this.threshold*MultiSigScriptHashInput.MAX_SIGNATURE_SIZE+this.publicKeys.length*MultiSigScriptHashInput.MAX_PUBKEY_SIZE;return this.type===p.PayToWitnessScriptHash?t+=e/4:this.nestedWitness?t+=e/4+MultiSigScriptHashInput.REDEEM_SCRIPT_SIZE:t+=e,t},t.exports=MultiSigScriptHashInput},92603:function(t,e,i){"use strict";var n=i(9213),s=i(79460);i(19153);var o=i(27455),a=i(4257),u=i(254),c=i(64502),p=i(72571),y=i(47230);function PublicKeyInput(){o.apply(this,arguments)}n(PublicKeyInput,o),PublicKeyInput.prototype.getSignatures=function(t,e,i,n,o,c){s.checkState(this.output instanceof a),n=n||p.SIGHASH_ALL,c=c||"ecdsa";var g=e.toPublicKey();return g.toString()===this.output.script.getPublicKey().toString("hex")?[new y({publicKey:g,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:i,signature:u.sign(t,e,n,i,this.output.script),sigtype:n})]:[]},PublicKeyInput.prototype.addSignature=function(t,e,i){return s.checkState(this.isValidSignature(t,e,i),"Signature is invalid"),this.setScript(c.buildPublicKeyIn(e.signature.toDER(),e.sigtype)),this},PublicKeyInput.prototype.clearSignatures=function(){return this.setScript(c.empty()),this},PublicKeyInput.prototype.isFullySigned=function(){return this.script.isPublicKeyIn()},PublicKeyInput.SCRIPT_MAX_SIZE=73,PublicKeyInput.prototype._estimateSize=function(){return this._getBaseSize()+PublicKeyInput.SCRIPT_MAX_SIZE},t.exports=PublicKeyInput},82056:function(t,e,i){"use strict";var n=i(9213),s=i(79460),o=i(19153);i(53);var a=i(66812),u=i(27455),c=i(4257),p=i(254),y=i(96857),g=i(64926),o=i(19153),m=i(64502),b=i(72571),S=i(47230);function PublicKeyHashInput(){u.apply(this,arguments)}n(PublicKeyHashInput,u),PublicKeyHashInput.prototype.getRedeemScript=function(t){if(!this.redeemScript){var e=m.buildWitnessV0Out(t);if(m.buildScriptHashOut(e).equals(this.output.script)){var i=new m;i.add(e.toBuffer()),this.setScript(i),this.redeemScript=e}}return this.redeemScript},PublicKeyHashInput.prototype.getScriptCode=function(t){var e,i=new g;e=this.output.script.isScriptHashOut()?this.getRedeemScript(t):this.output.script;var n=m.buildPublicKeyHashOut(e.toAddress()).toBuffer();return i.writeVarintNum(n.length),i.write(n),i.toBuffer()},PublicKeyHashInput.prototype.getSighash=function(t,e,i,n){var s=this.getScriptCode(e),o=this.getSatoshisBuffer();return y.sighash(t,n,i,s,o)},PublicKeyHashInput.prototype.getSignatures=function(t,e,i,n,u,g,m){if(s.checkState(this.output instanceof c),u=u||a.sha256ripemd160(e.publicKey.toBuffer()),n=n||b.SIGHASH_ALL,g=g||"ecdsa",(v=this.output.script.isScriptHashOut()?this.getRedeemScript(e.publicKey):this.output.script)&&o.equals(u,v.getPublicKeyHash())){if(v.isWitnessPublicKeyHashOut()){var v,_,P=this.getSatoshisBuffer(),w=this.getScriptCode(e.publicKey);_=y.sign(t,e,n,i,w,P)}else _=p.sign(t,e,n,i,this.output.script);return[new S({publicKey:e.publicKey,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:i,signature:_,sigtype:n})]}return[]},PublicKeyHashInput.prototype.addSignature=function(t,e,i){return s.checkState(this.isValidSignature(t,e,i),"Signature is invalid"),this.output.script.isWitnessPublicKeyHashOut()||this.output.script.isScriptHashOut()?this.setWitnesses([o.concat([e.signature.toDER(),o.integerAsSingleByteBuffer(e.sigtype)]),e.publicKey.toBuffer()]):this.setScript(m.buildPublicKeyHashIn(e.publicKey,e.signature.toDER(),e.sigtype)),this},PublicKeyHashInput.prototype.clearSignatures=function(){return this.setScript(m.empty()),this.setWitnesses([]),this},PublicKeyHashInput.prototype.isFullySigned=function(){return this.script.isPublicKeyHashIn()||this.hasWitnesses()},PublicKeyHashInput.prototype.isValidSignature=function(t,e,i){if(i=i||"ecdsa",e.signature.nhashtype=e.sigtype,!(this.output.script.isWitnessPublicKeyHashOut()||this.output.script.isScriptHashOut()))return p.verify(t,e.signature,e.publicKey,e.inputIndex,this.output.script);var n=this.getScriptCode(),s=this.getSatoshisBuffer();return y.verify(t,e.signature,e.publicKey,e.inputIndex,n,s)},PublicKeyHashInput.SCRIPT_MAX_SIZE=107,PublicKeyHashInput.REDEEM_SCRIPT_SIZE=23,PublicKeyHashInput.prototype._estimateSize=function(){let t=this._getBaseSize();t+=1;let e=PublicKeyHashInput.SCRIPT_MAX_SIZE/4;return this.output.script.isWitnessPublicKeyHashOut()?t+=e:this.output.script.isScriptHashOut()?t+=e+PublicKeyHashInput.REDEEM_SCRIPT_SIZE:t+=PublicKeyHashInput.SCRIPT_MAX_SIZE,t},t.exports=PublicKeyHashInput},55486:function(t,e,i){let n=i(9213),s=i(79460),o=i(82056),a=i(9977),u=i(72571),c=i(47230),p=i(4257);function TaprootInput(){o.apply(this,arguments)}i(57867),n(TaprootInput,o),TaprootInput.prototype.getSignatures=function(t,e,i,n,o,y,g){s.checkState(this.output instanceof p),n=n||u.SIGHASH_DEFAULT;let m=t.inputs.indexOf(this),b=e.createTapTweak(g).tweakedPrivKey,S=a.sign(t,b,n,m,u.Version.TAPROOT,null);if(!S)return[];let v=new c({publicKey:e.publicKey,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:m,signature:u.fromSchnorr(S),sigtype:n});return this.isValidSignature(t,v)?[v]:[]},TaprootInput.prototype.isValidSignature=function(t,e){return s.checkState(t.inputs.indexOf(this)>=0,"Signature has no matching input"),s.checkState(this.output instanceof p,"output is not instance of Output"),!!this.output.script.isTaproot()&&a.verify(t,e.signature,this.output.script.chunks[1].buf,u.Version.TAPROOT,t.inputs.indexOf(this),null)},TaprootInput.prototype.isFullySigned=function(){return this.output.script.isTaproot()&&this.hasWitnesses()},TaprootInput.prototype.addSignature=function(t,e){return this.isValidSignature(t,e)&&this.setWitnesses([e.signature.toBuffer()]),this},TaprootInput.SCRIPT_MAX_SIZE=66,TaprootInput.prototype._estimateSize=function(){let t=this._getBaseSize();t+=1;let e=TaprootInput.SCRIPT_MAX_SIZE/4;return t+e},t.exports=TaprootInput},4257:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(35418),a=i(19153),u=i(29854),c=i(64926),p=i(64502),y=i(79460),g=i(10862);let m=i(80156),b=i(83868);function Output(t){if(!(this instanceof Output))return new Output(t);if(s.isObject(t)){if(this.satoshis=t.satoshis,a.isBuffer(t.script))this.setScriptFromBuffer(t.script);else{var e;e=s.isString(t.script)&&u.isHexa(t.script)?n.from(t.script,"hex"):t.script,this.setScript(e)}"taproot"===t.type&&(this.branch=[],Object.defineProperty(this,"isValid",{configurable:!1,enumerable:!1,get:function(){this._isValid||this._branch.length},set:function(t){this._isValid=t}}),Object.defineProperty(this,"isComplete",{configurable:!1,enumerable:!1,get:function(){return this.isValid&&(0===this._branch.length||1===this._branch.length&&!!this._branch[0])}}))}else throw TypeError("Unrecognized argument for Output")}Object.defineProperty(Output.prototype,"script",{configurable:!1,enumerable:!0,get:function(){return this._script||this.setScriptFromBuffer(this._scriptBuffer),this._script}}),Object.defineProperty(Output.prototype,"satoshis",{configurable:!1,enumerable:!0,get:function(){return this._satoshis},set:function(t){t instanceof o?(this._satoshisBN=t,this._satoshis=t.toNumber()):s.isString(t)?(this._satoshis=parseInt(t),this._satoshisBN=o.fromNumber(this._satoshis)):(y.checkArgument(u.isNaturalNumber(t),"Output satoshis is not a natural number"),this._satoshisBN=o.fromNumber(t),this._satoshis=t),y.checkState(u.isNaturalNumber(this._satoshis),"Output satoshis is not a natural number")}}),Output.prototype.invalidSatoshis=function(){return this._satoshis>9007199254740991?"transaction txout satoshis greater than max safe integer":this._satoshis!==this._satoshisBN.toNumber()?"transaction txout satoshis has corrupted value":this._satoshis<0&&"transaction txout negative"},Output.prototype.toObject=Output.prototype.toJSON=function(){var t={satoshis:this.satoshis};return t.script=this._scriptBuffer.toString("hex"),t},Output.fromObject=function(t){return new Output(t)},Output.prototype.setScriptFromBuffer=function(t){this._scriptBuffer=t;try{this._script=p.fromBuffer(this._scriptBuffer),this._script._isOutput=!0}catch(t){if(t instanceof g.Script.InvalidBuffer)this._script=null;else throw t}},Output.prototype.setScript=function(t){if(t instanceof p)this._scriptBuffer=t.toBuffer(),this._script=t,this._script._isOutput=!0;else if(s.isString(t))this._script=p.fromString(t),this._scriptBuffer=this._script.toBuffer(),this._script._isOutput=!0;else if(a.isBuffer(t))this.setScriptFromBuffer(t);else throw TypeError("Invalid argument type: script");return this},Output.prototype.inspect=function(){var t;return t=this.script?this.script.inspect():this._scriptBuffer.toString("hex"),"<Output ("+this.satoshis+" sats) "+t+">"},Output.fromBufferReader=function(t){var e={};e.satoshis=t.readUInt64LEBN();var i=t.readVarintNum();return 0!==i?e.script=t.read(i):e.script=n.from([]),new Output(e)},Output.prototype.toBufferWriter=function(t){t||(t=new c),t.writeUInt64LEBN(this._satoshisBN);var e=this._scriptBuffer;return t.writeVarintNum(e.length),t.write(e),t},Output.prototype.calculateSize=function(){return 8+c.varintBufNum(this._scriptBuffer.length).length+this._scriptBuffer.length},Output.prototype.add=function(t,e,i,n=!0){if(y.checkArgument((i&~m.TAPROOT_LEAF_MASK)==0,"invalid leafVersion"),!this.isValid)return;let s={hash:b.TAPLEAF.writeUInt8(i).write(e.toBuffer()).finalize(),leaves:[]};return n&&s.leaves.push({script:e,leafVersion:i,merkleBranch:[]}),this._insertNode(s,t),this},Output.prototype._insertNode=function(t,e){if(y.checkArgument(e>=0&&e<=m.TAPROOT_CONTROL_MAX_NODE_COUNT,"invalid depth"),e+1<this._branch.length){this.isValid=!1;return}for(;this.isValid&&this._branch.length>e&&this._branch[e];)t=this._combineNodes(t,this._branch[e]),this._branch=this._branch.slice(0,this._branch.length-2),0==e&&(this.isValid=!1),e--;this.isValid&&(this._branch.length<=e&&(this._branch=this._branch.slice(0,e+1)),y.checkState(!this._nodes[e]),m_branch[e]=t)},Output.prototype._combineNodes=function(t,e){let i={hash:null,leaves:[]};for(let n of t.leaves)n.merkleBranch.push(e.hash),i.leaves.push(n);for(let n of e.leaves)n.merkleBranch.push(t.hash),i.leaves.push(n);return -1===t.hash.compare(e.hash)?i.hash=b.TAPBRANCH.write(t.hash).write(e.hash).finalize():i.hash=b.TAPBRANCH.write(e.hash).write(t.hash).finalize(),i},Output.prototype.finalize=function(t){y.checkState(!0===this.isComplete,"finalize can only be called when isComplete is true"),t.createTapTweak(0===this._branch.length?null:this._branch[0].hash)},t.exports=Output},254:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(72571),o=i(64502),a=i(4257),u=i(10992),c=i(64926),p=i(35418),y=i(66812),g=i(30044),m=i(79460),b=i(96486),sighash=function(t,e,g,m){var b,S=i(4634),v=i(99045);g=parseInt(g);var _=S.shallowCopy(t);for((m=new o(m)).removeCodeseparators(),b=0;b<_.inputs.length;b++)_.inputs[b]=new v(_.inputs[b]).setScript(o.empty());if(_.inputs[g]=new v(_.inputs[g]).setScript(m),(31&e)===s.SIGHASH_NONE||(31&e)===s.SIGHASH_SINGLE)for(b=0;b<_.inputs.length;b++)b!==g&&(_.inputs[b].sequenceNumber=0);if((31&e)===s.SIGHASH_NONE)_.outputs=[];else if((31&e)===s.SIGHASH_SINGLE){if(g>=_.outputs.length)return n.from("0000000000000000000000000000000000000000000000000000000000000001","hex");for(b=0,_.outputs.length=g+1;b<g;b++)_.outputs[b]=new a({satoshis:p.fromBuffer(n.from("ffffffffffffffff","hex")),script:o.empty()})}e&s.SIGHASH_ANYONECANPAY&&(_.inputs=[_.inputs[g]]);var P=new c().write(_.toBuffer()).writeInt32LE(e).toBuffer(),w=y.sha256sha256(P);return new u(w).readReverse()};t.exports={sighash:sighash,sign:function(t,e,i,n,s){let o=sighash(t,i,n,s),a=g.sign(o,e,{endian:"little"});return a.nhashtype=i,a},verify:function(t,e,i,n,s){m.checkArgument(!b.isUndefined(t),"Transaction Undefined"),m.checkArgument(!b.isUndefined(e)&&!b.isUndefined(e.nhashtype),"Signature Undefined");let o=sighash(t,e.nhashtype,n,s);return g.verify(o,e,i,{endian:"little"})}}},9977:function(t,e,i){"use strict";var n=i(48764).Buffer;let s=i(72571),o=i(64926),a=i(66812),u=i(84118),c=i(79460),p=i(83868);function _signatureHash(t,e,i,n,u){let y,g;switch(n){case s.Version.TAPROOT:y=0;break;case s.Version.TAPSCRIPT:y=1,g=0;break;default:return!1}c.checkArgument(i<t.inputs.length,"inputNumber is greater than number of inputs");let m=p.TAPSIGHASH;m.writeUInt8(0);let b=e==s.SIGHASH_DEFAULT?s.SIGHASH_ALL:e&s.SIGHASH_OUTPUT_MASK,S=e&s.SIGHASH_INPUT_MASK;if(!(e<=3||e>=129&&e<=131))return!1;if(m.writeUInt8(e),m.writeInt32LE(t.version),m.writeUInt32LE(t.nLockTime),S!==s.SIGHASH_ANYONECANPAY){let e=new o,i=new o,n=new o,s=new o;for(let o of t.inputs){e.writeReverse(o.prevTxId),e.writeInt32LE(o.outputIndex),i.writeUInt64LEBN(o.output._satoshisBN);let t=o.output.script.toBuffer();n.writeUInt8(t.length),n.write(t),s.writeUInt32LE(o.sequenceNumber)}let u=a.sha256(e.toBuffer());m.write(u);let c=a.sha256(i.toBuffer());m.write(c);let p=a.sha256(n.toBuffer());m.write(p);let y=a.sha256(s.toBuffer());m.write(y)}if(b===s.SIGHASH_ALL){let e=new o;for(let i of t.outputs)e.write(i.toBufferWriter().toBuffer());let i=a.sha256(e.toBuffer());m.write(i)}c.checkArgument(u.annexInit,"missing or invalid annexInit");let v=(y<<1)+(u.annexPresent?1:0);if(m.writeUInt8(v),S===s.SIGHASH_ANYONECANPAY){let e=new o;e.writeReverse(t.inputs[i].prevTxId),e.writeInt32LE(t.inputs[i].outputIndex),m.write(e.toBuffer()),m.write(t.inputs[i].output.toBufferWriter().toBuffer()),m.writeUInt32LE(t.inputs[i].sequenceNumber)}else m.writeUInt32LE(i);if(u.annexPresent&&m.write(u.annexHash),b===s.SIGHASH_SINGLE){if(i>=t.outputs.length)return!1;let e=new o;e.writeUInt64LEBN(t.outputs[i]._satoshisBN);let n=t.outputs[i].script.toBuffer();e.writeVarintNum(n.length),e.write(n),m.write(a.sha256(e.toBuffer()))}return n==s.Version.TAPSCRIPT&&(c.checkArgument(u.tapleafHashInit,"missing or invalid tapleafHashInit"),m.write(u.tapleafHash),m.writeUInt8(g),c.checkArgument(u.codeseparatorPosInit,"missing or invalid codeseparatorPosInit"),m.writeUInt32LE(u.codeseparatorPos)),m.finalize()}function _getExecData(t,e){let i={annexInit:!0,annexPresent:!1};if(t===s.Version.TAPSCRIPT){if(i.codeseparatorPosInit=!0,i.codeseparatorPos=4294967295,!e)return!1;i.tapleafHashInit=!0,i.tapleafHash=e}return i}i(57867),t.exports={sign:function(t,e,i,o,a,p){c.checkArgument(a===s.Version.TAPROOT||a===s.Version.TAPSCRIPT,"Invalid sigversion");let y=_getExecData(a,p),g=_signatureHash(t,i,o,a,y);if(!g)return!1;let m=u.sign(e,g);return i!==s.SIGHASH_DEFAULT?n.concat([m,n.from([i])]):m},verify:function(t,e,i,s,o,a){if(c.checkArgument(null!=t,"Transaction Undefined"),!a||n.isBuffer(a)){let t=a;a=_getExecData(s,t)}c.checkArgument(a.annexInit,"invalid execdata");let p=_signatureHash(t,e.nhashtype,o,s,a);if(!p)return!1;let y=u.verify(i,p,e);return y}}},96857:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(72571);i(64502);var o=i(10992),a=i(64926),u=i(66812),c=i(30044),p=i(79460),y=i(96486),sighash=function(t,e,i,c,p){var y=n.alloc(32),g=n.alloc(32),m=n.alloc(32);if(!(e&s.SIGHASH_ANYONECANPAY)){for(var b=[],S=0;S<t.inputs.length;S++){var v=t.inputs[S],_=new o(v.prevTxId).readReverse();b.push(_);var P=n.alloc(4);P.writeUInt32LE(v.outputIndex,0),b.push(P)}y=u.sha256sha256(n.concat(b))}if(!(e&s.SIGHASH_ANYONECANPAY)&&(31&e)!==s.SIGHASH_SINGLE&&(31&e)!==s.SIGHASH_NONE){for(var w=[],E=0;E<t.inputs.length;E++){var I=n.alloc(4);I.writeUInt32LE(t.inputs[E].sequenceNumber,0),w.push(I)}g=u.sha256sha256(n.concat(w))}var T=new a;if((31&e)!==s.SIGHASH_SINGLE&&(31&e)!==s.SIGHASH_NONE){for(var k=0;k<t.outputs.length;k++)t.outputs[k].toBufferWriter(T);m=u.sha256sha256(T.toBuffer())}else(31&e)===s.SIGHASH_SINGLE&&i<t.outputs.length&&(t.outputs[i].toBufferWriter(T),m=u.sha256sha256(T.toBuffer()));var A=new a;A.writeUInt32LE(t.version),A.write(y),A.write(g);var O=new o(t.inputs[i].prevTxId).readReverse();return A.write(O),A.writeUInt32LE(t.inputs[i].outputIndex),A.write(c),A.write(p),A.writeUInt32LE(t.inputs[i].sequenceNumber),A.write(m),A.writeUInt32LE(t.nLockTime),A.writeInt32LE(e),u.sha256sha256(A.toBuffer())};t.exports={sighash:sighash,sign:function(t,e,i,n,s,o){let a=sighash(t,i,n,s,o);return c.sign(a,e).set({nhashtype:i})},verify:function(t,e,i,n,s,o){p.checkArgument(!y.isUndefined(t),"Transaction Undefined"),p.checkArgument(!y.isUndefined(e)&&!y.isUndefined(e.nhashtype),"Signature Undefined");let a=sighash(t,e.nhashtype,n,s,o);return c.verify(a,e,i)}}},47230:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(79460),o=i(9213),a=i(19153),u=i(29854),c=i(39521),p=i(10862),y=i(72571);function TransactionSignature(t){if(!(this instanceof TransactionSignature))return new TransactionSignature(t);if(t instanceof TransactionSignature)return t;if(t&&"object"==typeof t)return this._fromObject(t);throw new p.InvalidArgument("TransactionSignatures must be instantiated from an object")}o(TransactionSignature,y),TransactionSignature.prototype._fromObject=function(t){return this._checkObjectArgs(t),this.publicKey=new c(t.publicKey),this.prevTxId=a.isBuffer(t.prevTxId)?t.prevTxId:n.from(t.prevTxId,"hex"),this.outputIndex=t.outputIndex,this.inputIndex=t.inputIndex,this.signature=t.signature instanceof y?t.signature:a.isBuffer(t.signature)?y.fromBuffer(t.signature):y.fromString(t.signature),this.sigtype=t.sigtype,this},TransactionSignature.prototype._checkObjectArgs=function(t){s.checkArgument(c(t.publicKey),"invalid publicKey"),s.checkArgument(null!=t.inputIndex,"missing inputIndex"),s.checkArgument(null!=t.outputIndex,"missing outputIndex"),s.checkState(!isNaN(t.inputIndex),"inputIndex must be a number"),s.checkState(!isNaN(t.outputIndex),"outputIndex must be a number"),s.checkArgument(t.signature,"missing signature"),s.checkArgument(t.prevTxId,"missing prevTxId"),s.checkState(t.signature instanceof y||a.isBuffer(t.signature)||u.isHexa(t.signature),"signature must be a buffer or hexa value"),s.checkState(a.isBuffer(t.prevTxId)||u.isHexa(t.prevTxId),"prevTxId must be a buffer or hexa value"),s.checkArgument(null!=t.sigtype,"missing sigtype"),s.checkState(!isNaN(t.sigtype),"sigtype must be a number")},TransactionSignature.prototype.toObject=TransactionSignature.prototype.toJSON=function(){return{publicKey:this.publicKey.toString(),prevTxId:this.prevTxId.toString("hex"),outputIndex:this.outputIndex,inputIndex:this.inputIndex,signature:this.signature.toString(),sigtype:this.sigtype}},TransactionSignature.fromObject=function(t){return s.checkArgument(t),new TransactionSignature(t)},t.exports=TransactionSignature},4634:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(96486),o=i(79460),a=i(48764),u=n.compare||i(17406),c=i(10862),p=i(19153),y=i(29854),g=i(10992),m=i(64926),b=i(66812),S=i(72571),v=i(254),_=i(96857);let P=i(9977);var w=i(53),E=i(22876),I=i(99045),T=I.PublicKeyHash,k=I.PublicKey,A=I.MultiSigScriptHash,O=I.MultiSig;let B=I.Taproot;var N=i(4257),R=i(64502),H=i(57867),x=i(35418);function Transaction(t,e){if(!(this instanceof Transaction))return new Transaction(t);if(this.inputs=[],this.outputs=[],this._inputAmount=void 0,this._outputAmount=void 0,t){if(t instanceof Transaction)return Transaction.shallowCopy(t);if(y.isHexa(t))this.fromString(t);else if(p.isBuffer(t))this.fromBuffer(t);else if(s.isObject(t))this.fromObject(t,e);else throw new c.InvalidArgument("Must provide an object or string to deserialize a transaction")}else this._newTransaction()}Transaction.DUST_AMOUNT=546,Transaction.FEE_SECURITY_MARGIN=150,Transaction.MAX_MONEY=21e6*1e8,Transaction.NLOCKTIME_BLOCKHEIGHT_LIMIT=5e8,Transaction.NLOCKTIME_MAX_VALUE=4294967295,Transaction.FEE_PER_KB=1e5,Transaction.CHANGE_OUTPUT_MAX_SIZE=62,Transaction.MAXIMUM_EXTRA_SIZE=26,Transaction.shallowCopy=function(t){return new Transaction(t.toBuffer())};var C={configurable:!1,enumerable:!0,get:function(){return this._hash=new g(this._getHash()).readReverse().toString("hex"),this._hash}};Object.defineProperty(Transaction.prototype,"witnessHash",{configurable:!1,enumerable:!0,get:function(){return new g(this._getWitnessHash()).readReverse().toString("hex")}}),Object.defineProperty(Transaction.prototype,"hash",C),Object.defineProperty(Transaction.prototype,"id",C);var M={configurable:!1,enumerable:!0,get:function(){return this._getInputAmount()}};Object.defineProperty(Transaction.prototype,"inputAmount",M),M.get=function(){return this._getOutputAmount()},Object.defineProperty(Transaction.prototype,"outputAmount",M),Object.defineProperty(Transaction.prototype,"size",{configurable:!1,enumerable:!1,get:function(){return this._calculateSize()}}),Object.defineProperty(Transaction.prototype,"vsize",{configurable:!1,enumerable:!1,get:function(){return this._calculateVSize()}}),Object.defineProperty(Transaction.prototype,"weight",{configurable:!1,enumerable:!1,get:function(){return this._calculateWeight()}}),Transaction.prototype._getHash=function(){return b.sha256sha256(this.toBuffer(!0))},Transaction.prototype._getWitnessHash=function(){return b.sha256sha256(this.toBuffer(!1))},Transaction.prototype.serialize=function(t){return!0===t||t&&t.disableAll?this.uncheckedSerialize():this.checkedSerialize(t)},Transaction.prototype.uncheckedSerialize=Transaction.prototype.toString=function(){return this.toBuffer().toString("hex")},Transaction.prototype.checkedSerialize=function(t){var e=this.getSerializationError(t);if(e)throw e.message+=" - For more information please see: https://github.com/bitpay/bitcore/blob/master/packages/bitcore-lib/docs/transaction.md#serialization-checks",e;return this.uncheckedSerialize()},Transaction.prototype.invalidSatoshis=function(){for(var t=!1,e=0;e<this.outputs.length;e++)this.outputs[e].invalidSatoshis()&&(t=!0);return t},Transaction.prototype.getSerializationError=function(t){if(t=t||{},this.invalidSatoshis())return new c.Transaction.InvalidSatoshis;var e,i=this._getUnspentValue();return i<0?t.disableMoreOutputThanInput||(e=new c.Transaction.InvalidOutputAmountSum):e=this._hasFeeError(t,i),e||this._hasDustOutputs(t)||this._isMissingSignatures(t)},Transaction.prototype._hasFeeError=function(t,e){if(null!=this._fee&&this._fee!==e)return new c.Transaction.FeeError.Different("Unspent value is "+e+" but specified fee is "+this._fee);if(!t.disableLargeFees){var i=Math.floor(Transaction.FEE_SECURITY_MARGIN*this._estimateFee());if(e>i)return this._missingChange()?new c.Transaction.ChangeAddressMissing("Fee is too large and no change address was provided"):new c.Transaction.FeeError.TooLarge("expected less than "+i+" but got "+e)}if(!t.disableSmallFees){var n=Math.ceil(this._estimateFee()/Transaction.FEE_SECURITY_MARGIN);if(e<n)return new c.Transaction.FeeError.TooSmall("expected more than "+n+" but got "+e)}},Transaction.prototype._missingChange=function(){return!this._changeScript},Transaction.prototype._hasDustOutputs=function(t){var e,i;if(!t.disableDustOutputs){for(e in this.outputs)if((i=this.outputs[e]).satoshis<Transaction.DUST_AMOUNT&&!i.script.isDataOut())return new c.Transaction.DustOutputs}},Transaction.prototype._isMissingSignatures=function(t){if(!t.disableIsFullySigned&&!this.isFullySigned())return new c.Transaction.MissingSignatures},Transaction.prototype.inspect=function(){return"<Transaction: "+this.uncheckedSerialize()+">"},Transaction.prototype.toBuffer=function(t){var e=new m;return this.toBufferWriter(e,t).toBuffer()},Transaction.prototype.hasWitnesses=function(){for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].hasWitnesses())return!0;return!1},Transaction.prototype.toBufferWriter=function(t,e){t.writeInt32LE(this.version);let i=this.hasWitnesses();for(let s of(i&&!e&&t.write(n.from("0001","hex")),t.writeVarintNum(this.inputs?this.inputs.length:0),this.inputs||[]))s.toBufferWriter(t);for(let e of(t.writeVarintNum(this.outputs?this.outputs.length:0),this.outputs||[]))e.toBufferWriter(t);if(i&&!e)for(let e of this.inputs){let i=e.getWitnesses();t.writeVarintNum(i.length);for(let e=0;e<i.length;e++)t.writeVarintNum(i[e].length),t.write(i[e])}return t.writeUInt32LE(this.nLockTime),t},Transaction.prototype.fromBuffer=function(t){var e=new g(t);return this.fromBufferReader(e)},Transaction.prototype.fromBufferReader=function(t){o.checkArgument(!t.finished(),"No transaction data received"),this.version=t.readInt32LE();var e=t.readVarintNum(),i=!1;0===e&&0!==t.buf[t.pos]&&(t.pos+=1,i=!0,e=t.readVarintNum());for(var n=0;n<e;n++){var s=I.fromBufferReader(t);this.inputs.push(s)}for(var a=t.readVarintNum(),u=0;u<a;u++)this.outputs.push(N.fromBufferReader(t));if(i)for(var c=0;c<e;c++){for(var p=t.readVarintNum(),y=[],g=0;g<p;g++){var m=t.readVarintNum(),b=t.read(m);y.push(b)}this.inputs[c].setWitnesses(y)}return this.nLockTime=t.readUInt32LE(),this},Transaction.prototype.toObject=Transaction.prototype.toJSON=function(){var t=[];this.inputs.forEach(function(e){t.push(e.toObject())});var e=[];this.outputs.forEach(function(t){e.push(t.toObject())});var i={hash:this.hash,version:this.version,inputs:t,outputs:e,nLockTime:this.nLockTime};return this._changeScript&&(i.changeScript=this._changeScript.toString()),null!=this._changeIndex&&(i.changeIndex=this._changeIndex),null!=this._fee&&(i.fee=this._fee),i},Transaction.prototype.fromObject=function(t,e){for(let u of(o.checkArgument(s.isObject(t)||t instanceof Transaction),(i=t instanceof Transaction?t.toObject():t).inputs||[])){if(!u.output||!u.output.script){this.uncheckedAddInput(new I(u));continue}var i,n,a=new R(u.output.script);if((a.isScriptHashOut()||a.isWitnessScriptHashOut())&&u.publicKeys&&u.threshold)n=new I.MultiSigScriptHash(u,u.publicKeys,u.threshold,u.signatures,e);else if(a.isPublicKeyHashOut()||a.isWitnessPublicKeyHashOut()||a.isScriptHashOut())n=new I.PublicKeyHash(u);else if(a.isPublicKeyOut())n=new I.PublicKey(u);else throw new c.Transaction.Input.UnsupportedScript(u.output.script);this.addInput(n)}for(let t of i.outputs||[])this.addOutput(new N(t));return i.changeIndex&&(this._changeIndex=i.changeIndex),i.changeScript&&(this._changeScript=new R(i.changeScript)),i.fee&&(this._fee=i.fee),this.nLockTime=i.nLockTime,this.version=i.version,this._checkConsistency(t),this},Transaction.prototype._checkConsistency=function(t){null!=this._changeIndex&&(o.checkState(this._changeScript,"Change script is expected."),o.checkState(this.outputs[this._changeIndex],"Change index points to undefined output."),o.checkState(this.outputs[this._changeIndex].script.toString()===this._changeScript.toString(),"Change output has an unexpected script.")),t&&t.hash&&o.checkState(t.hash===this.hash,"Hash in object does not match transaction hash.")},Transaction.prototype.lockUntilDate=function(t){if(o.checkArgument(t),!isNaN(t)&&t<Transaction.NLOCKTIME_BLOCKHEIGHT_LIMIT)throw new c.Transaction.LockTimeTooEarly;s.isDate(t)&&(t=t.getTime()/1e3);for(var e=0;e<this.inputs.length;e++)this.inputs[e].sequenceNumber===I.DEFAULT_SEQNUMBER&&(this.inputs[e].sequenceNumber=I.DEFAULT_LOCKTIME_SEQNUMBER);return this.nLockTime=t,this},Transaction.prototype.lockUntilBlockHeight=function(t){if(o.checkArgument(!isNaN(t)),t>=Transaction.NLOCKTIME_BLOCKHEIGHT_LIMIT)throw new c.Transaction.BlockHeightTooHigh;if(t<0)throw new c.Transaction.NLockTimeOutOfRange;for(var e=0;e<this.inputs.length;e++)this.inputs[e].sequenceNumber===I.DEFAULT_SEQNUMBER&&(this.inputs[e].sequenceNumber=I.DEFAULT_LOCKTIME_SEQNUMBER);return this.nLockTime=t,this},Transaction.prototype.getLockTime=function(){return this.nLockTime?this.nLockTime<Transaction.NLOCKTIME_BLOCKHEIGHT_LIMIT?this.nLockTime:new Date(1e3*this.nLockTime):null},Transaction.prototype.fromString=function(t){this.fromBuffer(a.Buffer.from(t,"hex"))},Transaction.prototype._newTransaction=function(){this.version=2,this.nLockTime=0},Transaction.prototype.from=function(t,e,i,n){if(Array.isArray(t)){for(let s of t)this.from(s,e,i,n);return this}let s=this.inputs.some(function(e){return e.prevTxId.toString("hex")===t.txId&&e.outputIndex===t.outputIndex});return s||(e&&i?this._fromMultisigUtxo(t,e,i,n):this._fromNonP2SH(t,n)),this},Transaction.prototype.associateInputs=function(t,e,i,n={}){let s=[];for(let o of t){let t=this.inputs.findIndex(t=>t.prevTxId.toString("hex")===o.txId&&t.outputIndex===o.outputIndex);if(s.push(t),t>=0){let s=this.inputs[t].sequenceNumber;this.inputs[t]=this._getInputFrom(o,e,i,n),this.inputs[t].sequenceNumber=s}}return s},Transaction.prototype._selectInputType=function(t,e,i){var n;return t=new E(t),e&&i?t.script.isMultisigOut()?n=O:(t.script.isScriptHashOut()||t.script.isWitnessScriptHashOut())&&(n=A):n=t.script.isPublicKeyHashOut()||t.script.isWitnessPublicKeyHashOut()||t.script.isScriptHashOut()?T:t.script.isTaproot()?B:t.script.isPublicKeyOut()?k:I,n},Transaction.prototype._getInputFrom=function(t,e,i,n={}){t=new E(t);let s=this._selectInputType(t,e,i),o={output:new N({script:t.script,satoshis:t.satoshis}),prevTxId:t.txId,outputIndex:t.outputIndex,sequenceNumber:n.sequenceNumber,script:R.empty()},a=e&&i?[e,i,!1,n]:[];return new s(o,...a)},Transaction.prototype._fromNonP2SH=function(t,e){let i=this._getInputFrom(t,null,null,e);this.addInput(i)},Transaction.prototype._fromMultisigUtxo=function(t,e,i,n){o.checkArgument(i<=e.length,"Number of required signatures must be greater than the number of public keys");let s=this._getInputFrom(t,e,i,n);this.addInput(s)},Transaction.prototype.addInput=function(t,e,i){if(o.checkArgumentType(t,I,"input"),!t.output&&(null==e||null==i))throw new c.Transaction.NeedMoreInfo("Need information about the UTXO script and satoshis");return!t.output&&e&&null!=i&&(e=e instanceof R?e:new R(e),o.checkArgumentType(i,"number","satoshis"),t.output=new N({script:e,satoshis:i})),this.uncheckedAddInput(t)},Transaction.prototype.uncheckedAddInput=function(t){return o.checkArgumentType(t,I,"input"),this.inputs.push(t),this._inputAmount=void 0,this._updateChangeOutput(),this},Transaction.prototype.hasAllUtxoInfo=function(){return this.inputs.every(function(t){return!!t.output})},Transaction.prototype.fee=function(t){return o.checkArgument(!isNaN(t),"amount must be a number"),this._fee=t,this._updateChangeOutput(),this},Transaction.prototype.feePerKb=function(t){return o.checkArgument(!isNaN(t),"amount must be a number"),this._feePerKb=t,this._updateChangeOutput(),this},Transaction.prototype.feePerByte=function(t){return o.checkArgument(!isNaN(t),"amount must be a number"),this._feePerByte=t,this._updateChangeOutput(),this},Transaction.prototype.change=function(t){return o.checkArgument(t,"address is required"),this._changeScript=R.fromAddress(t),this._updateChangeOutput(),this},Transaction.prototype.getChangeOutput=function(){return null!=this._changeIndex?this.outputs[this._changeIndex]:null},Transaction.prototype.to=function(t,e){if(Array.isArray(t)){for(let e of t)this.to(e.address,e.satoshis);return this}return o.checkArgument(y.isNaturalNumber(e),"Amount is expected to be a positive integer"),this.addOutput(new N({script:R(new w(t)),satoshis:e})),this},Transaction.prototype.addData=function(t){return this.addOutput(new N({script:R.buildDataOut(t),satoshis:0})),this},Transaction.prototype.addOutput=function(t){return o.checkArgumentType(t,N,"output"),this._addOutput(t),this._updateChangeOutput(),this},Transaction.prototype.clearOutputs=function(){return this.outputs=[],this._clearSignatures(),this._outputAmount=void 0,this._changeIndex=void 0,this._updateChangeOutput(),this},Transaction.prototype._addOutput=function(t){this.outputs.push(t),this._outputAmount=void 0},Transaction.prototype._getOutputAmount=function(){if(null==this._outputAmount)for(let t of(this._outputAmount=0,this.outputs||[]))this._outputAmount+=t.satoshis;return this._outputAmount},Transaction.prototype._getInputAmount=function(){return null==this._inputAmount&&(this._inputAmount=s.sumBy(this.inputs,function(t){if(null==t.output)throw new c.Transaction.Input.MissingPreviousOutput;return t.output.satoshis})),this._inputAmount},Transaction.prototype._updateChangeOutput=function(t){if(this._changeScript){t||this._clearSignatures(),null!=this._changeIndex&&this._removeOutput(this._changeIndex);var e=this._getUnspentValue()-this.getFee();e>Transaction.DUST_AMOUNT?(this._changeIndex=this.outputs.length,this._addOutput(new N({script:this._changeScript,satoshis:e}))):this._changeIndex=void 0}},Transaction.prototype.getFee=function(){return this.isCoinbase()?0:null!=this._fee?this._fee:this._changeScript?this._estimateFee():this._getUnspentValue()},Transaction.prototype._estimateFee=function(){let t=this._estimateSize(),e=this._getUnspentValue(),i=this._feePerByte||(this._feePerKb||Transaction.FEE_PER_KB)/1e3,n=Math.ceil(t*i+this._estimateSizeOfChangeOutput()*i);return!this._changeScript||e<=n?Math.ceil(t*i):n},Transaction.prototype._estimateSizeOfChangeOutput=function(){if(!this._changeScript)return 0;let t=this._changeScript.toBuffer().length;return 8+m.varintBufNum(t).length+t},Transaction.prototype._getUnspentValue=function(){return this._getInputAmount()-this._getOutputAmount()},Transaction.prototype._clearSignatures=function(){for(let t of this.inputs||[])t.clearSignatures()},Transaction.prototype._estimateSize=function(){let t=4;for(let e of(this.hasWitnesses()&&(t+=.5),t+=m.varintBufNum(this.inputs.length).length,this.inputs||[]))t+=e._estimateSize();for(let e of(t+=m.varintBufNum(this.outputs.length).length,this.outputs||[]))t+=e.calculateSize();return Math.ceil(t+=4)},Transaction.prototype._calculateSize=function(){return this.toBuffer().length},Transaction.prototype._calculateVSize=function(t){let e=this._calculateWeight()/4;return t?e:Math.ceil(e)},Transaction.prototype._calculateWeight=function(){return 3*this.toBuffer(!0).length+this.toBuffer(!1).length},Transaction.prototype._removeOutput=function(t){var e=this.outputs[t];this.outputs=s.without(this.outputs,e),this._outputAmount=void 0},Transaction.prototype.removeOutput=function(t){this._removeOutput(t),this._updateChangeOutput()},Transaction.prototype.sort=function(){return this.sortInputs(function(t){var e=Array.prototype.concat.apply([],t);let i=0;return e.forEach(t=>{t.i=i++}),e.sort(function(t,e){return u(t.prevTxId,e.prevTxId)||t.outputIndex-e.outputIndex||t.i-e.i}),e}),this.sortOutputs(function(t){var e=Array.prototype.concat.apply([],t);let i=0;return e.forEach(t=>{t.i=i++}),e.sort(function(t,e){return t.satoshis-e.satoshis||u(t.script.toBuffer(),e.script.toBuffer())||t.i-e.i}),e}),this},Transaction.prototype.shuffleOutputs=function(){return this.sortOutputs(s.shuffle)},Transaction.prototype.sortOutputs=function(t){var e=t(this.outputs);return this._newOutputOrder(e)},Transaction.prototype.sortInputs=function(t){return this.inputs=t(this.inputs),this._clearSignatures(),this},Transaction.prototype._newOutputOrder=function(t){if(this.outputs.length!==t.length||0!==s.difference(this.outputs,t).length)throw new c.Transaction.InvalidSorting;if(null!=this._changeIndex){var e=this.outputs[this._changeIndex];this._changeIndex=t.indexOf(e)}return this.outputs=t,this},Transaction.prototype.removeInput=function(t,e){if((i=e||isNaN(t)?this.inputs.findIndex(function(i){return i.prevTxId.toString("hex")===t&&i.outputIndex===e}):t)<0||i>=this.inputs.length)throw new c.Transaction.InvalidIndex(i,this.inputs.length);var i,n=this.inputs[i];this.inputs=s.without(this.inputs,n),this._inputAmount=void 0,this._updateChangeOutput()},Transaction.prototype.sign=function(t,e,i,n){if(o.checkState(this.hasAllUtxoInfo(),"Not all utxo information is available to sign the transaction."),Array.isArray(t)){for(let s of t)this.sign(s,e,i,n);return this}for(let s of this.getSignatures(t,e,i,n))this.applySignature(s,i);return this},Transaction.prototype.getSignatures=function(t,e,i,s){"string"==typeof s&&(s=n.from(s,"hex")),t=new H(t);let o=[],a=b.sha256ripemd160(t.publicKey.toBuffer());for(let n=0;n<this.inputs.length;n++){let u=this.inputs[n];for(let c of u.getSignatures(this,t,n,e,a,i,s))o.push(c)}return o},Transaction.prototype.applySignature=function(t,e){return this.inputs[t.inputIndex].addSignature(this,t,e),this},Transaction.prototype.isFullySigned=function(){for(let t of this.inputs||[])if(t.isFullySigned===I.prototype.isFullySigned)throw new c.Transaction.UnableToVerifySignature("Unrecognized script kind, or not enough information to execute script.This usually happens when creating a transaction from a serialized transaction");return this.inputs.every(function(t){return t.isFullySigned()})},Transaction.prototype.isValidSignature=function(t,e){if(this.inputs[t.inputIndex].isValidSignature===I.prototype.isValidSignature)throw new c.Transaction.UnableToVerifySignature("Unrecognized script kind, or not enough information to execute script.This usually happens when creating a transaction from a serialized transaction");return this.inputs[t.inputIndex].isValidSignature(this,t,e)},Transaction.prototype.checkEcdsaSignature=function(t,e,i,n,s){var a,u=n.toBuffer(),c=new m;return c.writeVarintNum(u.length),c.write(u),s?(o.checkState(y.isNaturalNumber(s),"satoshis needs to be a natural number"),a=new m().writeUInt64LEBN(new x(s)).toBuffer()):a=this.inputs[i].getSatoshisBuffer(),_.verify(this,t,e,i,c.toBuffer(),a)},Transaction.prototype.checkSchnorrSignature=function(t,e,i,s,a){if(o.isType(e,"PublicKey")&&(e=e.point.x.toBuffer()),o.checkArgument(e&&32===e.length,"Schnorr signatures have 32-byte public keys. The caller is responsible for enforcing this."),n.isBuffer(t)){if(64!==t.length&&65!==t.length)return!1;t=S.fromSchnorr(t)}return o.checkArgument(t.isSchnorr,"Signature must be schnorr"),!!P.verify(this,t,e,s,i,a)},Transaction.prototype.verifySignature=function(t,e,i,n,s,o,a){switch(null==s&&(s=S.Version.BASE),s){case S.Version.WITNESS_V0:return this.checkEcdsaSignature(t,e,i,n,o);case S.Version.TAPROOT:case S.Version.TAPSCRIPT:return this.checkSchnorrSignature(t,e,i,s,a);case S.Version.BASE:default:return v.verify(this,t,e,i,n)}},Transaction.prototype.verify=function(){if(0===this.inputs.length)return"transaction txins empty";if(0===this.outputs.length)return"transaction txouts empty";for(var t=new x(0),e=0;e<this.outputs.length;e++){var i=this.outputs[e];if(i.invalidSatoshis())return"transaction txout "+e+" satoshis is invalid";if(i._satoshisBN.gt(new x(Transaction.MAX_MONEY,10)))return"transaction txout "+e+" greater than MAX_MONEY";if((t=t.add(i._satoshisBN)).gt(new x(Transaction.MAX_MONEY)))return"transaction txout "+e+" total output greater than MAX_MONEY"}if(this.toBuffer().length>1e6)return"transaction over the maximum block size";var n={};for(e=0;e<this.inputs.length;e++){var s=this.inputs[e],o=s.prevTxId+":"+s.outputIndex;if(null!=n[o])return"transaction input "+e+" duplicate input";n[o]=!0}if(this.isCoinbase()){var a=this.inputs[0]._scriptBuffer;if(a.length<2||a.length>100)return"coinbase transaction script size invalid"}else for(e=0;e<this.inputs.length;e++)if(this.inputs[e].isNull())return"transaction input "+e+" has null input";return!0},Transaction.prototype.isCoinbase=function(){return 1===this.inputs.length&&this.inputs[0].isNull()},Transaction.prototype.isRBF=function(){for(var t=0;t<this.inputs.length;t++)if(this.inputs[t].sequenceNumber<I.MAXINT-1)return!0;return!1},Transaction.prototype.enableRBF=function(){for(var t=0;t<this.inputs.length;t++){var e=this.inputs[t];e.sequenceNumber>=I.MAXINT-1&&(e.sequenceNumber=I.DEFAULT_RBF_SEQNUMBER)}return this},Transaction.prototype.setVersion=function(t){return o.checkArgument(y.isNaturalNumber(t)&&t<=2,"Wrong version number"),this.version=t,this},t.exports=Transaction},22876:function(t,e,i){"use strict";var n=i(96486),s=i(79460),o=i(29854),a=i(64502),u=i(53),c=i(88222);function UnspentOutput(t){if(!(this instanceof UnspentOutput))return new UnspentOutput(t);s.checkArgument(n.isObject(t),"Must provide an object from where to extract data");var e=t.address?new u(t.address):void 0,i=t.txid?t.txid:t.txId;if(!i||!o.isHexaString(i)||i.length>64)throw Error("Invalid TXID in object",t);var p=n.isUndefined(t.vout)?t.outputIndex:t.vout;if(!n.isNumber(p))throw Error("Invalid outputIndex, received "+p);s.checkArgument(!n.isUndefined(t.scriptPubKey)||!n.isUndefined(t.script),"Must provide the scriptPubKey for that output!");var y=new a(t.scriptPubKey||t.script);s.checkArgument(!n.isUndefined(t.amount)||!n.isUndefined(t.satoshis),"Must provide an amount for the output");var g=n.isUndefined(t.amount)?t.satoshis:new c.fromBTC(t.amount).toSatoshis();s.checkArgument(n.isNumber(g),"Amount must be a number"),o.defineImmutable(this,{address:e,txId:i,outputIndex:p,script:y,satoshis:g})}UnspentOutput.prototype.inspect=function(){return"<UnspentOutput: "+this.txId+":"+this.outputIndex+", satoshis: "+this.satoshis+", address: "+this.address+">"},UnspentOutput.prototype.toString=function(){return this.txId+":"+this.outputIndex},UnspentOutput.fromObject=function(t){return new UnspentOutput(t)},UnspentOutput.prototype.toObject=UnspentOutput.prototype.toJSON=function(){return{address:this.address?this.address.toString():void 0,txid:this.txId,vout:this.outputIndex,scriptPubKey:this.script.toBuffer().toString("hex"),amount:c.fromSatoshis(this.satoshis).toBTC()}},t.exports=UnspentOutput},88222:function(t,e,i){"use strict";var n=i(96486),s=i(10862),o=i(79460),a={BTC:[1e8,8],mBTC:[1e5,5],uBTC:[100,2],bits:[100,2],satoshis:[1,0]};function Unit(t,e){if(!(this instanceof Unit))return new Unit(t,e);if(n.isNumber(e)){if(e<=0)throw new s.Unit.InvalidRate(e);t/=e,e=Unit.BTC}this._value=this._from(t,e);var i=this;Object.keys(a).forEach(function(t){Object.defineProperty(i,t,{get:function(){return i.to(t)},enumerable:!0})})}Object.keys(a).forEach(function(t){Unit[t]=t}),Unit.fromObject=function(t){return o.checkArgument(n.isObject(t),"Argument is expected to be an object"),new Unit(t.amount,t.code)},Unit.fromBTC=function(t){return new Unit(t,Unit.BTC)},Unit.fromMillis=Unit.fromMilis=function(t){return new Unit(t,Unit.mBTC)},Unit.fromMicros=Unit.fromBits=function(t){return new Unit(t,Unit.bits)},Unit.fromSatoshis=function(t){return new Unit(t,Unit.satoshis)},Unit.fromFiat=function(t,e){return new Unit(t,e)},Unit.prototype._from=function(t,e){if(!a[e])throw new s.Unit.UnknownCode(e);return parseInt((t*a[e][0]).toFixed())},Unit.prototype.to=function(t){if(n.isNumber(t)){if(t<=0)throw new s.Unit.InvalidRate(t);return parseFloat((this.BTC*t).toFixed(2))}if(!a[t])throw new s.Unit.UnknownCode(t);return parseFloat((this._value/a[t][0]).toFixed(a[t][1]))},Unit.prototype.toBTC=function(){return this.to(Unit.BTC)},Unit.prototype.toMillis=Unit.prototype.toMilis=function(){return this.to(Unit.mBTC)},Unit.prototype.toMicros=Unit.prototype.toBits=function(){return this.to(Unit.bits)},Unit.prototype.toSatoshis=function(){return this.to(Unit.satoshis)},Unit.prototype.atRate=function(t){return this.to(t)},Unit.prototype.toString=function(){return this.satoshis+" satoshis"},Unit.prototype.toObject=Unit.prototype.toJSON=function(){return{amount:this.BTC,code:Unit.BTC}},Unit.prototype.inspect=function(){return"<Unit: "+this.toString()+">"},t.exports=Unit},7839:function(t,e,i){"use strict";var n=i(96486),s=i(11987),o=i(53),a=i(88222),URI=function(t,e){if(!(this instanceof URI))return new URI(t,e);if(this.extras={},this.knownParams=e||[],this.address=this.network=this.amount=this.message=null,"string"==typeof t){var i=URI.parse(t);i.amount&&(i.amount=this._parseAmount(i.amount)),this._fromObject(i)}else if("object"==typeof t)this._fromObject(t);else throw TypeError("Unrecognized data format.")};URI.fromString=function(t){if("string"!=typeof t)throw TypeError("Expected a string");return new URI(t)},URI.fromObject=function(t){return new URI(t)},URI.isValid=function(t,e){try{new URI(t,e)}catch(t){return!1}return!0},URI.parse=function(t){var e=s.parse(t,!0);if("bitcoin:"!==e.protocol)throw TypeError("Invalid bitcoin URI");var i=/[^:]*:\/?\/?([^?]*)/.exec(t);return e.query.address=i&&i[1]||void 0,e.query},URI.Members=["address","amount","message","label","r"],URI.prototype._fromObject=function(t){if(!o.isValid(t.address))throw TypeError("Invalid bitcoin address");for(var e in this.address=new o(t.address),this.network=this.address.network,this.amount=t.amount,t)if("address"!==e&&"amount"!==e){if(/^req-/.exec(e)&&-1===this.knownParams.indexOf(e))throw Error("Unknown required argument "+e);(URI.Members.indexOf(e)>-1?this:this.extras)[e]=t[e]}},URI.prototype._parseAmount=function(t){if(isNaN(t=Number(t)))throw TypeError("Invalid amount");return a.fromBTC(t).toSatoshis()},URI.prototype.toObject=URI.prototype.toJSON=function(){for(var t={},e=0;e<URI.Members.length;e++){var i=URI.Members[e];this.hasOwnProperty(i)&&void 0!==this[i]&&(t[i]=this[i].toString())}return n.extend(t,this.extras),t},URI.prototype.toString=function(){var t={};return this.amount&&(t.amount=a.fromSatoshis(this.amount).toBTC()),this.message&&(t.message=this.message),this.label&&(t.label=this.label),this.r&&(t.r=this.r),n.extend(t,this.extras),s.format({protocol:"bitcoin:",host:this.address,query:t})},URI.prototype.inspect=function(){return"<URI: "+this.toString()+">"},t.exports=URI},19153:function(t,e,i){"use strict";var n=i(48764).Buffer,s=i(48764);i(69282),i(29854);var o=i(79460);function equals(t,e){if(t.length!==e.length)return!1;for(var i=t.length,n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}t.exports={fill:function(t,e){o.checkArgumentType(t,"Buffer","buffer"),o.checkArgumentType(e,"number","value");for(var i=t.length,n=0;n<i;n++)t[n]=e;return t},copy:function(t){var e=n.alloc(t.length);return t.copy(e),e},isBuffer:function(t){return s.Buffer.isBuffer(t)||t instanceof Uint8Array},emptyBuffer:function(t){o.checkArgumentType(t,"number","bytes");for(var e=n.alloc(t),i=0;i<t;i++)e.write("\x00",i);return e},concat:s.Buffer.concat,equals:equals,equal:equals,integerAsSingleByteBuffer:function(t){return o.checkArgumentType(t,"number","integer"),n.from([255&t])},integerAsBuffer:function(t){o.checkArgumentType(t,"number","integer");var e=[];return e.push(t>>24&255),e.push(t>>16&255),e.push(t>>8&255),e.push(255&t),n.from(e)},integerFromBuffer:function(t){return o.checkArgumentType(t,"Buffer","buffer"),t[0]<<24|t[1]<<16|t[2]<<8|t[3]},integerFromSingleByteBuffer:function(t){return o.checkArgumentType(t,"Buffer","buffer"),t[0]},bufferToHex:function(t){return o.checkArgumentType(t,"Buffer","buffer"),t.toString("hex")},reverse:function(t){return n.from(t).reverse()}},t.exports.NULL_HASH=t.exports.fill(n.alloc(32),0),t.exports.EMPTY_BUFFER=n.alloc(0)},29854:function(t,e,i){"use strict";var n=i(96486),isHexa=function(t){return!!n.isString(t)&&/^[0-9a-fA-F]+$/.test(t)};t.exports={isValidJSON:function(t){var e;if(!n.isString(t))return!1;try{e=JSON.parse(t)}catch(t){return!1}return"object"==typeof e},isHexa:isHexa,isHexaString:isHexa,cloneArray:function(t){return[].concat(t)},defineImmutable:function(t,e){return Object.keys(e).forEach(function(i){Object.defineProperty(t,i,{configurable:!1,enumerable:!0,value:e[i]})}),t},isNaturalNumber:function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t&&t>=0}}},79460:function(t,e,i){"use strict";var n=i(10862),s=i(96486);t.exports={checkState:function(t,e){if(!t)throw new n.InvalidState(e)},checkArgument:function(t,e,i,s){if(!t)throw new n.InvalidArgument(e,i,s)},checkArgumentType:function(t,e,o){if(o=o||"(unknown name)",s.isString(e)){if("Buffer"===e){if(!i(48764).Buffer.isBuffer(t))throw new n.InvalidArgumentType(t,e,o)}else if(typeof t!==e&&t&&t.constructor&&t.constructor.name!==e)throw new n.InvalidArgumentType(t,e,o)}else if(!(t instanceof e))throw new n.InvalidArgumentType(t,e.name,o)},isType:function(t,e,i){try{return this.checkArgumentType(t,e,i),!0}catch{return!1}}}},77026:function(t,e,i){!function(t,e){"use strict";function assert(t,e){if(!t)throw Error(e||"Assertion failed")}function inherits(t,e){t.super_=e;var TempCtor=function(){};TempCtor.prototype=e.prototype,t.prototype=new TempCtor,t.prototype.constructor=t}function BN(t,e,i){if(BN.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&(("le"===e||"be"===e)&&(i=e,e=10),this._init(t||0,e||10,i||"be"))}"object"==typeof t?t.exports=BN:e.BN=BN,BN.BN=BN,BN.wordSize=26;try{n=i(2594).Buffer}catch(t){}function parseHex(t,e,i){for(var n=0,s=Math.min(t.length,i),o=e;o<s;o++){var a=t.charCodeAt(o)-48;n<<=4,a>=49&&a<=54?n|=a-49+10:a>=17&&a<=22?n|=a-17+10:n|=15&a}return n}function parseBase(t,e,i,n){for(var s=0,o=Math.min(t.length,i),a=e;a<o;a++){var u=t.charCodeAt(a)-48;s*=n,u>=49?s+=u-49+10:u>=17?s+=u-17+10:s+=u}return s}BN.isBN=function(t){return t instanceof BN||null!==t&&"object"==typeof t&&t.constructor.wordSize===BN.wordSize&&Array.isArray(t.words)},BN.max=function(t,e){return t.cmp(e)>0?t:e},BN.min=function(t,e){return 0>t.cmp(e)?t:e},BN.prototype._init=function(t,e,i){if("number"==typeof t)return this._initNumber(t,e,i);if("object"==typeof t)return this._initArray(t,e,i);"hex"===e&&(e=16),assert(e===(0|e)&&e>=2&&e<=36);var n=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&n++,16===e?this._parseHex(t,n):this._parseBase(t,e,n),"-"===t[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),e,i)},BN.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(assert(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),e,i)},BN.prototype._initArray=function(t,e,i){if(assert("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=Array(this.length);for(var n,s,o=0;o<this.length;o++)this.words[o]=0;var a=0;if("be"===i)for(o=t.length-1,n=0;o>=0;o-=3)s=t[o]|t[o-1]<<8|t[o-2]<<16,this.words[n]|=s<<a&67108863,this.words[n+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,n++);else if("le"===i)for(o=0,n=0;o<t.length;o+=3)s=t[o]|t[o+1]<<8|t[o+2]<<16,this.words[n]|=s<<a&67108863,this.words[n+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,n++);return this.strip()},BN.prototype._parseHex=function(t,e){this.length=Math.ceil((t.length-e)/6),this.words=Array(this.length);for(var i,n,s=0;s<this.length;s++)this.words[s]=0;var o=0;for(s=t.length-6,i=0;s>=e;s-=6)n=parseHex(t,s,s+6),this.words[i]|=n<<o&67108863,this.words[i+1]|=n>>>26-o&4194303,(o+=24)>=26&&(o-=26,i++);s+6!==e&&(n=parseHex(t,e,s+6),this.words[i]|=n<<o&67108863,this.words[i+1]|=n>>>26-o&4194303),this.strip()},BN.prototype._parseBase=function(t,e,i){this.words=[0],this.length=1;for(var n=0,s=1;s<=67108863;s*=e)n++;n--,s=s/e|0;for(var o=t.length-i,a=o%n,u=Math.min(o,o-a)+i,c=0,p=i;p<u;p+=n)c=parseBase(t,p,p+n,e),this.imuln(s),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==a){var y=1;for(c=parseBase(t,p,t.length,e),p=0;p<a;p++)y*=e;this.imuln(y),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}},BN.prototype.copy=function(t){t.words=Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},BN.prototype.clone=function(){var t=new BN(null);return this.copy(t),t},BN.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},BN.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},BN.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},BN.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var n,s=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],o=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],a=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function smallMulTo(t,e,i){i.negative=e.negative^t.negative;var n=t.length+e.length|0;i.length=n,n=n-1|0;var s=0|t.words[0],o=0|e.words[0],a=s*o,u=67108863&a,c=a/67108864|0;i.words[0]=u;for(var p=1;p<n;p++){for(var y=c>>>26,g=67108863&c,m=Math.min(p,e.length-1),b=Math.max(0,p-t.length+1);b<=m;b++){var S=p-b|0;y+=(a=(s=0|t.words[S])*(o=0|e.words[b])+g)/67108864|0,g=67108863&a}i.words[p]=0|g,c=0|y}return 0!==c?i.words[p]=0|c:i.length--,i.strip()}BN.prototype.toString=function(t,e){if(e=0|e||1,16===(t=t||10)||"hex"===t){i="";for(var i,n=0,u=0,c=0;c<this.length;c++){var p=this.words[c],y=((p<<n|u)&16777215).toString(16);i=0!=(u=p>>>24-n&16777215)||c!==this.length-1?s[6-y.length]+y+i:y+i,(n+=2)>=26&&(n-=26,c--)}for(0!==u&&(i=u.toString(16)+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(t===(0|t)&&t>=2&&t<=36){var g=o[t],m=a[t];i="";var b=this.clone();for(b.negative=0;!b.isZero();){var S=b.modn(m).toString(t);i=(b=b.idivn(m)).isZero()?S+i:s[g-S.length]+S+i}for(this.isZero()&&(i="0"+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}assert(!1,"Base should be between 2 and 36")},BN.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&assert(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},BN.prototype.toJSON=function(){return this.toString(16)},BN.prototype.toBuffer=function(t,e){return assert(void 0!==n),this.toArrayLike(n,t,e)},BN.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},BN.prototype.toArrayLike=function(t,e,i){var n,s,o=this.byteLength(),a=i||Math.max(1,o);assert(o<=a,"byte array longer than desired length"),assert(a>0,"Requested array length <= 0"),this.strip();var u=new t(a),c=this.clone();if("le"===e){for(s=0;!c.isZero();s++)n=c.andln(255),c.iushrn(8),u[s]=n;for(;s<a;s++)u[s]=0}else{for(s=0;s<a-o;s++)u[s]=0;for(s=0;!c.isZero();s++)n=c.andln(255),c.iushrn(8),u[a-s-1]=n}return u},Math.clz32?BN.prototype._countBits=function(t){return 32-Math.clz32(t)}:BN.prototype._countBits=function(t){var e=t,i=0;return e>=4096&&(i+=13,e>>>=13),e>=64&&(i+=7,e>>>=7),e>=8&&(i+=4,e>>>=4),e>=2&&(i+=2,e>>>=2),i+e},BN.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,i=0;return(8191&e)==0&&(i+=13,e>>>=13),(127&e)==0&&(i+=7,e>>>=7),(15&e)==0&&(i+=4,e>>>=4),(3&e)==0&&(i+=2,e>>>=2),(1&e)==0&&i++,i},BN.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return(this.length-1)*26+e},BN.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var i=this._zeroBits(this.words[e]);if(t+=i,26!==i)break}return t},BN.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},BN.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},BN.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},BN.prototype.isNeg=function(){return 0!==this.negative},BN.prototype.neg=function(){return this.clone().ineg()},BN.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},BN.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},BN.prototype.ior=function(t){return assert((this.negative|t.negative)==0),this.iuor(t)},BN.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},BN.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},BN.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var i=0;i<e.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=e.length,this.strip()},BN.prototype.iand=function(t){return assert((this.negative|t.negative)==0),this.iuand(t)},BN.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},BN.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},BN.prototype.iuxor=function(t){this.length>t.length?(e=this,i=t):(e=t,i=this);for(var e,i,n=0;n<i.length;n++)this.words[n]=e.words[n]^i.words[n];if(this!==e)for(;n<e.length;n++)this.words[n]=e.words[n];return this.length=e.length,this.strip()},BN.prototype.ixor=function(t){return assert((this.negative|t.negative)==0),this.iuxor(t)},BN.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},BN.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},BN.prototype.inotn=function(t){assert("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),i=t%26;this._expand(e),i>0&&e--;for(var n=0;n<e;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},BN.prototype.notn=function(t){return this.clone().inotn(t)},BN.prototype.setn=function(t,e){assert("number"==typeof t&&t>=0);var i=t/26|0,n=t%26;return this._expand(i+1),e?this.words[i]=this.words[i]|1<<n:this.words[i]=this.words[i]&~(1<<n),this.strip()},BN.prototype.iadd=function(t){if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(i=this,n=t):(i=t,n=this);for(var e,i,n,s=0,o=0;o<n.length;o++)e=(0|i.words[o])+(0|n.words[o])+s,this.words[o]=67108863&e,s=e>>>26;for(;0!==s&&o<i.length;o++)e=(0|i.words[o])+s,this.words[o]=67108863&e,s=e>>>26;if(this.length=i.length,0!==s)this.words[this.length]=s,this.length++;else if(i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this},BN.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},BN.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e,i,n=this.iadd(t);return t.negative=1,n._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var s=this.cmp(t);if(0===s)return this.negative=0,this.length=1,this.words[0]=0,this;s>0?(e=this,i=t):(e=t,i=this);for(var o=0,a=0;a<i.length;a++)o=(n=(0|e.words[a])-(0|i.words[a])+o)>>26,this.words[a]=67108863&n;for(;0!==o&&a<e.length;a++)o=(n=(0|e.words[a])+o)>>26,this.words[a]=67108863&n;if(0===o&&a<e.length&&e!==this)for(;a<e.length;a++)this.words[a]=e.words[a];return this.length=Math.max(this.length,a),e!==this&&(this.negative=1),this.strip()},BN.prototype.sub=function(t){return this.clone().isub(t)};var comb10MulTo=function(t,e,i){var n,s,o,a=t.words,u=e.words,c=i.words,p=0,y=0|a[0],g=8191&y,m=y>>>13,b=0|a[1],S=8191&b,v=b>>>13,_=0|a[2],P=8191&_,w=_>>>13,E=0|a[3],I=8191&E,T=E>>>13,k=0|a[4],A=8191&k,O=k>>>13,B=0|a[5],N=8191&B,R=B>>>13,H=0|a[6],x=8191&H,C=H>>>13,M=0|a[7],K=8191&M,U=M>>>13,D=0|a[8],L=8191&D,F=D>>>13,V=0|a[9],W=8191&V,j=V>>>13,G=0|u[0],z=8191&G,q=G>>>13,Y=0|u[1],X=8191&Y,Z=Y>>>13,Q=0|u[2],$=8191&Q,J=Q>>>13,tt=0|u[3],te=8191&tt,tr=tt>>>13,ti=0|u[4],tn=8191&ti,ts=ti>>>13,to=0|u[5],ta=8191&to,tu=to>>>13,tc=0|u[6],tf=8191&tc,th=tc>>>13,tl=0|u[7],tp=8191&tl,td=tl>>>13,ty=0|u[8],tg=8191&ty,tm=ty>>>13,tb=0|u[9],tS=8191&tb,tv=tb>>>13;i.negative=t.negative^e.negative,i.length=19;var t_=(p+(n=Math.imul(g,z))|0)+((8191&(s=(s=Math.imul(g,q))+Math.imul(m,z)|0))<<13)|0;p=((o=Math.imul(m,q))+(s>>>13)|0)+(t_>>>26)|0,t_&=67108863,n=Math.imul(S,z),s=(s=Math.imul(S,q))+Math.imul(v,z)|0,o=Math.imul(v,q);var tP=(p+(n=n+Math.imul(g,X)|0)|0)+((8191&(s=(s=s+Math.imul(g,Z)|0)+Math.imul(m,X)|0))<<13)|0;p=((o=o+Math.imul(m,Z)|0)+(s>>>13)|0)+(tP>>>26)|0,tP&=67108863,n=Math.imul(P,z),s=(s=Math.imul(P,q))+Math.imul(w,z)|0,o=Math.imul(w,q),n=n+Math.imul(S,X)|0,s=(s=s+Math.imul(S,Z)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Z)|0;var tw=(p+(n=n+Math.imul(g,$)|0)|0)+((8191&(s=(s=s+Math.imul(g,J)|0)+Math.imul(m,$)|0))<<13)|0;p=((o=o+Math.imul(m,J)|0)+(s>>>13)|0)+(tw>>>26)|0,tw&=67108863,n=Math.imul(I,z),s=(s=Math.imul(I,q))+Math.imul(T,z)|0,o=Math.imul(T,q),n=n+Math.imul(P,X)|0,s=(s=s+Math.imul(P,Z)|0)+Math.imul(w,X)|0,o=o+Math.imul(w,Z)|0,n=n+Math.imul(S,$)|0,s=(s=s+Math.imul(S,J)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,J)|0;var tE=(p+(n=n+Math.imul(g,te)|0)|0)+((8191&(s=(s=s+Math.imul(g,tr)|0)+Math.imul(m,te)|0))<<13)|0;p=((o=o+Math.imul(m,tr)|0)+(s>>>13)|0)+(tE>>>26)|0,tE&=67108863,n=Math.imul(A,z),s=(s=Math.imul(A,q))+Math.imul(O,z)|0,o=Math.imul(O,q),n=n+Math.imul(I,X)|0,s=(s=s+Math.imul(I,Z)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Z)|0,n=n+Math.imul(P,$)|0,s=(s=s+Math.imul(P,J)|0)+Math.imul(w,$)|0,o=o+Math.imul(w,J)|0,n=n+Math.imul(S,te)|0,s=(s=s+Math.imul(S,tr)|0)+Math.imul(v,te)|0,o=o+Math.imul(v,tr)|0;var tI=(p+(n=n+Math.imul(g,tn)|0)|0)+((8191&(s=(s=s+Math.imul(g,ts)|0)+Math.imul(m,tn)|0))<<13)|0;p=((o=o+Math.imul(m,ts)|0)+(s>>>13)|0)+(tI>>>26)|0,tI&=67108863,n=Math.imul(N,z),s=(s=Math.imul(N,q))+Math.imul(R,z)|0,o=Math.imul(R,q),n=n+Math.imul(A,X)|0,s=(s=s+Math.imul(A,Z)|0)+Math.imul(O,X)|0,o=o+Math.imul(O,Z)|0,n=n+Math.imul(I,$)|0,s=(s=s+Math.imul(I,J)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,J)|0,n=n+Math.imul(P,te)|0,s=(s=s+Math.imul(P,tr)|0)+Math.imul(w,te)|0,o=o+Math.imul(w,tr)|0,n=n+Math.imul(S,tn)|0,s=(s=s+Math.imul(S,ts)|0)+Math.imul(v,tn)|0,o=o+Math.imul(v,ts)|0;var tT=(p+(n=n+Math.imul(g,ta)|0)|0)+((8191&(s=(s=s+Math.imul(g,tu)|0)+Math.imul(m,ta)|0))<<13)|0;p=((o=o+Math.imul(m,tu)|0)+(s>>>13)|0)+(tT>>>26)|0,tT&=67108863,n=Math.imul(x,z),s=(s=Math.imul(x,q))+Math.imul(C,z)|0,o=Math.imul(C,q),n=n+Math.imul(N,X)|0,s=(s=s+Math.imul(N,Z)|0)+Math.imul(R,X)|0,o=o+Math.imul(R,Z)|0,n=n+Math.imul(A,$)|0,s=(s=s+Math.imul(A,J)|0)+Math.imul(O,$)|0,o=o+Math.imul(O,J)|0,n=n+Math.imul(I,te)|0,s=(s=s+Math.imul(I,tr)|0)+Math.imul(T,te)|0,o=o+Math.imul(T,tr)|0,n=n+Math.imul(P,tn)|0,s=(s=s+Math.imul(P,ts)|0)+Math.imul(w,tn)|0,o=o+Math.imul(w,ts)|0,n=n+Math.imul(S,ta)|0,s=(s=s+Math.imul(S,tu)|0)+Math.imul(v,ta)|0,o=o+Math.imul(v,tu)|0;var tk=(p+(n=n+Math.imul(g,tf)|0)|0)+((8191&(s=(s=s+Math.imul(g,th)|0)+Math.imul(m,tf)|0))<<13)|0;p=((o=o+Math.imul(m,th)|0)+(s>>>13)|0)+(tk>>>26)|0,tk&=67108863,n=Math.imul(K,z),s=(s=Math.imul(K,q))+Math.imul(U,z)|0,o=Math.imul(U,q),n=n+Math.imul(x,X)|0,s=(s=s+Math.imul(x,Z)|0)+Math.imul(C,X)|0,o=o+Math.imul(C,Z)|0,n=n+Math.imul(N,$)|0,s=(s=s+Math.imul(N,J)|0)+Math.imul(R,$)|0,o=o+Math.imul(R,J)|0,n=n+Math.imul(A,te)|0,s=(s=s+Math.imul(A,tr)|0)+Math.imul(O,te)|0,o=o+Math.imul(O,tr)|0,n=n+Math.imul(I,tn)|0,s=(s=s+Math.imul(I,ts)|0)+Math.imul(T,tn)|0,o=o+Math.imul(T,ts)|0,n=n+Math.imul(P,ta)|0,s=(s=s+Math.imul(P,tu)|0)+Math.imul(w,ta)|0,o=o+Math.imul(w,tu)|0,n=n+Math.imul(S,tf)|0,s=(s=s+Math.imul(S,th)|0)+Math.imul(v,tf)|0,o=o+Math.imul(v,th)|0;var tA=(p+(n=n+Math.imul(g,tp)|0)|0)+((8191&(s=(s=s+Math.imul(g,td)|0)+Math.imul(m,tp)|0))<<13)|0;p=((o=o+Math.imul(m,td)|0)+(s>>>13)|0)+(tA>>>26)|0,tA&=67108863,n=Math.imul(L,z),s=(s=Math.imul(L,q))+Math.imul(F,z)|0,o=Math.imul(F,q),n=n+Math.imul(K,X)|0,s=(s=s+Math.imul(K,Z)|0)+Math.imul(U,X)|0,o=o+Math.imul(U,Z)|0,n=n+Math.imul(x,$)|0,s=(s=s+Math.imul(x,J)|0)+Math.imul(C,$)|0,o=o+Math.imul(C,J)|0,n=n+Math.imul(N,te)|0,s=(s=s+Math.imul(N,tr)|0)+Math.imul(R,te)|0,o=o+Math.imul(R,tr)|0,n=n+Math.imul(A,tn)|0,s=(s=s+Math.imul(A,ts)|0)+Math.imul(O,tn)|0,o=o+Math.imul(O,ts)|0,n=n+Math.imul(I,ta)|0,s=(s=s+Math.imul(I,tu)|0)+Math.imul(T,ta)|0,o=o+Math.imul(T,tu)|0,n=n+Math.imul(P,tf)|0,s=(s=s+Math.imul(P,th)|0)+Math.imul(w,tf)|0,o=o+Math.imul(w,th)|0,n=n+Math.imul(S,tp)|0,s=(s=s+Math.imul(S,td)|0)+Math.imul(v,tp)|0,o=o+Math.imul(v,td)|0;var tO=(p+(n=n+Math.imul(g,tg)|0)|0)+((8191&(s=(s=s+Math.imul(g,tm)|0)+Math.imul(m,tg)|0))<<13)|0;p=((o=o+Math.imul(m,tm)|0)+(s>>>13)|0)+(tO>>>26)|0,tO&=67108863,n=Math.imul(W,z),s=(s=Math.imul(W,q))+Math.imul(j,z)|0,o=Math.imul(j,q),n=n+Math.imul(L,X)|0,s=(s=s+Math.imul(L,Z)|0)+Math.imul(F,X)|0,o=o+Math.imul(F,Z)|0,n=n+Math.imul(K,$)|0,s=(s=s+Math.imul(K,J)|0)+Math.imul(U,$)|0,o=o+Math.imul(U,J)|0,n=n+Math.imul(x,te)|0,s=(s=s+Math.imul(x,tr)|0)+Math.imul(C,te)|0,o=o+Math.imul(C,tr)|0,n=n+Math.imul(N,tn)|0,s=(s=s+Math.imul(N,ts)|0)+Math.imul(R,tn)|0,o=o+Math.imul(R,ts)|0,n=n+Math.imul(A,ta)|0,s=(s=s+Math.imul(A,tu)|0)+Math.imul(O,ta)|0,o=o+Math.imul(O,tu)|0,n=n+Math.imul(I,tf)|0,s=(s=s+Math.imul(I,th)|0)+Math.imul(T,tf)|0,o=o+Math.imul(T,th)|0,n=n+Math.imul(P,tp)|0,s=(s=s+Math.imul(P,td)|0)+Math.imul(w,tp)|0,o=o+Math.imul(w,td)|0,n=n+Math.imul(S,tg)|0,s=(s=s+Math.imul(S,tm)|0)+Math.imul(v,tg)|0,o=o+Math.imul(v,tm)|0;var tB=(p+(n=n+Math.imul(g,tS)|0)|0)+((8191&(s=(s=s+Math.imul(g,tv)|0)+Math.imul(m,tS)|0))<<13)|0;p=((o=o+Math.imul(m,tv)|0)+(s>>>13)|0)+(tB>>>26)|0,tB&=67108863,n=Math.imul(W,X),s=(s=Math.imul(W,Z))+Math.imul(j,X)|0,o=Math.imul(j,Z),n=n+Math.imul(L,$)|0,s=(s=s+Math.imul(L,J)|0)+Math.imul(F,$)|0,o=o+Math.imul(F,J)|0,n=n+Math.imul(K,te)|0,s=(s=s+Math.imul(K,tr)|0)+Math.imul(U,te)|0,o=o+Math.imul(U,tr)|0,n=n+Math.imul(x,tn)|0,s=(s=s+Math.imul(x,ts)|0)+Math.imul(C,tn)|0,o=o+Math.imul(C,ts)|0,n=n+Math.imul(N,ta)|0,s=(s=s+Math.imul(N,tu)|0)+Math.imul(R,ta)|0,o=o+Math.imul(R,tu)|0,n=n+Math.imul(A,tf)|0,s=(s=s+Math.imul(A,th)|0)+Math.imul(O,tf)|0,o=o+Math.imul(O,th)|0,n=n+Math.imul(I,tp)|0,s=(s=s+Math.imul(I,td)|0)+Math.imul(T,tp)|0,o=o+Math.imul(T,td)|0,n=n+Math.imul(P,tg)|0,s=(s=s+Math.imul(P,tm)|0)+Math.imul(w,tg)|0,o=o+Math.imul(w,tm)|0;var tN=(p+(n=n+Math.imul(S,tS)|0)|0)+((8191&(s=(s=s+Math.imul(S,tv)|0)+Math.imul(v,tS)|0))<<13)|0;p=((o=o+Math.imul(v,tv)|0)+(s>>>13)|0)+(tN>>>26)|0,tN&=67108863,n=Math.imul(W,$),s=(s=Math.imul(W,J))+Math.imul(j,$)|0,o=Math.imul(j,J),n=n+Math.imul(L,te)|0,s=(s=s+Math.imul(L,tr)|0)+Math.imul(F,te)|0,o=o+Math.imul(F,tr)|0,n=n+Math.imul(K,tn)|0,s=(s=s+Math.imul(K,ts)|0)+Math.imul(U,tn)|0,o=o+Math.imul(U,ts)|0,n=n+Math.imul(x,ta)|0,s=(s=s+Math.imul(x,tu)|0)+Math.imul(C,ta)|0,o=o+Math.imul(C,tu)|0,n=n+Math.imul(N,tf)|0,s=(s=s+Math.imul(N,th)|0)+Math.imul(R,tf)|0,o=o+Math.imul(R,th)|0,n=n+Math.imul(A,tp)|0,s=(s=s+Math.imul(A,td)|0)+Math.imul(O,tp)|0,o=o+Math.imul(O,td)|0,n=n+Math.imul(I,tg)|0,s=(s=s+Math.imul(I,tm)|0)+Math.imul(T,tg)|0,o=o+Math.imul(T,tm)|0;var tR=(p+(n=n+Math.imul(P,tS)|0)|0)+((8191&(s=(s=s+Math.imul(P,tv)|0)+Math.imul(w,tS)|0))<<13)|0;p=((o=o+Math.imul(w,tv)|0)+(s>>>13)|0)+(tR>>>26)|0,tR&=67108863,n=Math.imul(W,te),s=(s=Math.imul(W,tr))+Math.imul(j,te)|0,o=Math.imul(j,tr),n=n+Math.imul(L,tn)|0,s=(s=s+Math.imul(L,ts)|0)+Math.imul(F,tn)|0,o=o+Math.imul(F,ts)|0,n=n+Math.imul(K,ta)|0,s=(s=s+Math.imul(K,tu)|0)+Math.imul(U,ta)|0,o=o+Math.imul(U,tu)|0,n=n+Math.imul(x,tf)|0,s=(s=s+Math.imul(x,th)|0)+Math.imul(C,tf)|0,o=o+Math.imul(C,th)|0,n=n+Math.imul(N,tp)|0,s=(s=s+Math.imul(N,td)|0)+Math.imul(R,tp)|0,o=o+Math.imul(R,td)|0,n=n+Math.imul(A,tg)|0,s=(s=s+Math.imul(A,tm)|0)+Math.imul(O,tg)|0,o=o+Math.imul(O,tm)|0;var tH=(p+(n=n+Math.imul(I,tS)|0)|0)+((8191&(s=(s=s+Math.imul(I,tv)|0)+Math.imul(T,tS)|0))<<13)|0;p=((o=o+Math.imul(T,tv)|0)+(s>>>13)|0)+(tH>>>26)|0,tH&=67108863,n=Math.imul(W,tn),s=(s=Math.imul(W,ts))+Math.imul(j,tn)|0,o=Math.imul(j,ts),n=n+Math.imul(L,ta)|0,s=(s=s+Math.imul(L,tu)|0)+Math.imul(F,ta)|0,o=o+Math.imul(F,tu)|0,n=n+Math.imul(K,tf)|0,s=(s=s+Math.imul(K,th)|0)+Math.imul(U,tf)|0,o=o+Math.imul(U,th)|0,n=n+Math.imul(x,tp)|0,s=(s=s+Math.imul(x,td)|0)+Math.imul(C,tp)|0,o=o+Math.imul(C,td)|0,n=n+Math.imul(N,tg)|0,s=(s=s+Math.imul(N,tm)|0)+Math.imul(R,tg)|0,o=o+Math.imul(R,tm)|0;var tx=(p+(n=n+Math.imul(A,tS)|0)|0)+((8191&(s=(s=s+Math.imul(A,tv)|0)+Math.imul(O,tS)|0))<<13)|0;p=((o=o+Math.imul(O,tv)|0)+(s>>>13)|0)+(tx>>>26)|0,tx&=67108863,n=Math.imul(W,ta),s=(s=Math.imul(W,tu))+Math.imul(j,ta)|0,o=Math.imul(j,tu),n=n+Math.imul(L,tf)|0,s=(s=s+Math.imul(L,th)|0)+Math.imul(F,tf)|0,o=o+Math.imul(F,th)|0,n=n+Math.imul(K,tp)|0,s=(s=s+Math.imul(K,td)|0)+Math.imul(U,tp)|0,o=o+Math.imul(U,td)|0,n=n+Math.imul(x,tg)|0,s=(s=s+Math.imul(x,tm)|0)+Math.imul(C,tg)|0,o=o+Math.imul(C,tm)|0;var tC=(p+(n=n+Math.imul(N,tS)|0)|0)+((8191&(s=(s=s+Math.imul(N,tv)|0)+Math.imul(R,tS)|0))<<13)|0;p=((o=o+Math.imul(R,tv)|0)+(s>>>13)|0)+(tC>>>26)|0,tC&=67108863,n=Math.imul(W,tf),s=(s=Math.imul(W,th))+Math.imul(j,tf)|0,o=Math.imul(j,th),n=n+Math.imul(L,tp)|0,s=(s=s+Math.imul(L,td)|0)+Math.imul(F,tp)|0,o=o+Math.imul(F,td)|0,n=n+Math.imul(K,tg)|0,s=(s=s+Math.imul(K,tm)|0)+Math.imul(U,tg)|0,o=o+Math.imul(U,tm)|0;var tM=(p+(n=n+Math.imul(x,tS)|0)|0)+((8191&(s=(s=s+Math.imul(x,tv)|0)+Math.imul(C,tS)|0))<<13)|0;p=((o=o+Math.imul(C,tv)|0)+(s>>>13)|0)+(tM>>>26)|0,tM&=67108863,n=Math.imul(W,tp),s=(s=Math.imul(W,td))+Math.imul(j,tp)|0,o=Math.imul(j,td),n=n+Math.imul(L,tg)|0,s=(s=s+Math.imul(L,tm)|0)+Math.imul(F,tg)|0,o=o+Math.imul(F,tm)|0;var tK=(p+(n=n+Math.imul(K,tS)|0)|0)+((8191&(s=(s=s+Math.imul(K,tv)|0)+Math.imul(U,tS)|0))<<13)|0;p=((o=o+Math.imul(U,tv)|0)+(s>>>13)|0)+(tK>>>26)|0,tK&=67108863,n=Math.imul(W,tg),s=(s=Math.imul(W,tm))+Math.imul(j,tg)|0,o=Math.imul(j,tm);var tU=(p+(n=n+Math.imul(L,tS)|0)|0)+((8191&(s=(s=s+Math.imul(L,tv)|0)+Math.imul(F,tS)|0))<<13)|0;p=((o=o+Math.imul(F,tv)|0)+(s>>>13)|0)+(tU>>>26)|0,tU&=67108863;var tD=(p+(n=Math.imul(W,tS))|0)+((8191&(s=(s=Math.imul(W,tv))+Math.imul(j,tS)|0))<<13)|0;return p=((o=Math.imul(j,tv))+(s>>>13)|0)+(tD>>>26)|0,tD&=67108863,c[0]=t_,c[1]=tP,c[2]=tw,c[3]=tE,c[4]=tI,c[5]=tT,c[6]=tk,c[7]=tA,c[8]=tO,c[9]=tB,c[10]=tN,c[11]=tR,c[12]=tH,c[13]=tx,c[14]=tC,c[15]=tM,c[16]=tK,c[17]=tU,c[18]=tD,0!==p&&(c[19]=p,i.length++),i};function jumboMulTo(t,e,i){return new FFTM().mulp(t,e,i)}function FFTM(t,e){this.x=t,this.y=e}Math.imul||(comb10MulTo=smallMulTo),BN.prototype.mulTo=function(t,e){var i=this.length+t.length;return 10===this.length&&10===t.length?comb10MulTo(this,t,e):i<63?smallMulTo(this,t,e):i<1024?function(t,e,i){i.negative=e.negative^t.negative,i.length=t.length+e.length;for(var n=0,s=0,o=0;o<i.length-1;o++){var a=s;s=0;for(var u=67108863&n,c=Math.min(o,e.length-1),p=Math.max(0,o-t.length+1);p<=c;p++){var y=o-p,g=(0|t.words[y])*(0|e.words[p]),m=67108863&g;a=a+(g/67108864|0)|0,u=67108863&(m=m+u|0),s+=(a=a+(m>>>26)|0)>>>26,a&=67108863}i.words[o]=u,n=a,a=s}return 0!==n?i.words[o]=n:i.length--,i.strip()}(this,t,e):jumboMulTo(this,t,e)},FFTM.prototype.makeRBT=function(t){for(var e=Array(t),i=BN.prototype._countBits(t)-1,n=0;n<t;n++)e[n]=this.revBin(n,i,t);return e},FFTM.prototype.revBin=function(t,e,i){if(0===t||t===i-1)return t;for(var n=0,s=0;s<e;s++)n|=(1&t)<<e-s-1,t>>=1;return n},FFTM.prototype.permute=function(t,e,i,n,s,o){for(var a=0;a<o;a++)n[a]=e[t[a]],s[a]=i[t[a]]},FFTM.prototype.transform=function(t,e,i,n,s,o){this.permute(o,t,e,i,n,s);for(var a=1;a<s;a<<=1)for(var u=a<<1,c=Math.cos(2*Math.PI/u),p=Math.sin(2*Math.PI/u),y=0;y<s;y+=u)for(var g=c,m=p,b=0;b<a;b++){var S=i[y+b],v=n[y+b],_=i[y+b+a],P=n[y+b+a],w=g*_-m*P;P=g*P+m*_,_=w,i[y+b]=S+_,n[y+b]=v+P,i[y+b+a]=S-_,n[y+b+a]=v-P,b!==u&&(w=c*g-p*m,m=c*m+p*g,g=w)}},FFTM.prototype.guessLen13b=function(t,e){var i=1|Math.max(e,t),n=1&i,s=0;for(i=i/2|0;i;i>>>=1)s++;return 1<<s+1+n},FFTM.prototype.conjugate=function(t,e,i){if(!(i<=1))for(var n=0;n<i/2;n++){var s=t[n];t[n]=t[i-n-1],t[i-n-1]=s,s=e[n],e[n]=-e[i-n-1],e[i-n-1]=-s}},FFTM.prototype.normalize13b=function(t,e){for(var i=0,n=0;n<e/2;n++){var s=8192*Math.round(t[2*n+1]/e)+Math.round(t[2*n]/e)+i;t[n]=67108863&s,i=s<67108864?0:s/67108864|0}return t},FFTM.prototype.convert13b=function(t,e,i,n){for(var s=0,o=0;o<e;o++)s+=0|t[o],i[2*o]=8191&s,s>>>=13,i[2*o+1]=8191&s,s>>>=13;for(o=2*e;o<n;++o)i[o]=0;assert(0===s),assert((-8192&s)==0)},FFTM.prototype.stub=function(t){for(var e=Array(t),i=0;i<t;i++)e[i]=0;return e},FFTM.prototype.mulp=function(t,e,i){var n=2*this.guessLen13b(t.length,e.length),s=this.makeRBT(n),o=this.stub(n),a=Array(n),u=Array(n),c=Array(n),p=Array(n),y=Array(n),g=Array(n),m=i.words;m.length=n,this.convert13b(t.words,t.length,a,n),this.convert13b(e.words,e.length,p,n),this.transform(a,o,u,c,n,s),this.transform(p,o,y,g,n,s);for(var b=0;b<n;b++){var S=u[b]*y[b]-c[b]*g[b];c[b]=u[b]*g[b]+c[b]*y[b],u[b]=S}return this.conjugate(u,c,n),this.transform(u,c,m,o,n,s),this.conjugate(m,o,n),this.normalize13b(m,n),i.negative=t.negative^e.negative,i.length=t.length+e.length,i.strip()},BN.prototype.mul=function(t){var e=new BN(null);return e.words=Array(this.length+t.length),this.mulTo(t,e)},BN.prototype.mulf=function(t){var e=new BN(null);return e.words=Array(this.length+t.length),jumboMulTo(this,t,e)},BN.prototype.imul=function(t){return this.clone().mulTo(t,this)},BN.prototype.imuln=function(t){assert("number"==typeof t),assert(t<67108864);for(var e=0,i=0;i<this.length;i++){var n=(0|this.words[i])*t,s=(67108863&n)+(67108863&e);e>>=26,e+=(n/67108864|0)+(s>>>26),this.words[i]=67108863&s}return 0!==e&&(this.words[i]=e,this.length++),this},BN.prototype.muln=function(t){return this.clone().imuln(t)},BN.prototype.sqr=function(){return this.mul(this)},BN.prototype.isqr=function(){return this.imul(this.clone())},BN.prototype.pow=function(t){var e=function(t){for(var e=Array(t.bitLength()),i=0;i<e.length;i++){var n=i/26|0,s=i%26;e[i]=(t.words[n]&1<<s)>>>s}return e}(t);if(0===e.length)return new BN(1);for(var i=this,n=0;n<e.length&&0===e[n];n++,i=i.sqr());if(++n<e.length)for(var s=i.sqr();n<e.length;n++,s=s.sqr())0!==e[n]&&(i=i.mul(s));return i},BN.prototype.iushln=function(t){assert("number"==typeof t&&t>=0);var e,i=t%26,n=(t-i)/26,s=67108863>>>26-i<<26-i;if(0!==i){var o=0;for(e=0;e<this.length;e++){var a=this.words[e]&s,u=(0|this.words[e])-a<<i;this.words[e]=u|o,o=a>>>26-i}o&&(this.words[e]=o,this.length++)}if(0!==n){for(e=this.length-1;e>=0;e--)this.words[e+n]=this.words[e];for(e=0;e<n;e++)this.words[e]=0;this.length+=n}return this.strip()},BN.prototype.ishln=function(t){return assert(0===this.negative),this.iushln(t)},BN.prototype.iushrn=function(t,e,i){assert("number"==typeof t&&t>=0),n=e?(e-e%26)/26:0;var n,s=t%26,o=Math.min((t-s)/26,this.length),a=67108863^67108863>>>s<<s;if(n-=o,n=Math.max(0,n),i){for(var u=0;u<o;u++)i.words[u]=this.words[u];i.length=o}if(0===o);else if(this.length>o)for(this.length-=o,u=0;u<this.length;u++)this.words[u]=this.words[u+o];else this.words[0]=0,this.length=1;var c=0;for(u=this.length-1;u>=0&&(0!==c||u>=n);u--){var p=0|this.words[u];this.words[u]=c<<26-s|p>>>s,c=p&a}return i&&0!==c&&(i.words[i.length++]=c),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},BN.prototype.ishrn=function(t,e,i){return assert(0===this.negative),this.iushrn(t,e,i)},BN.prototype.shln=function(t){return this.clone().ishln(t)},BN.prototype.ushln=function(t){return this.clone().iushln(t)},BN.prototype.shrn=function(t){return this.clone().ishrn(t)},BN.prototype.ushrn=function(t){return this.clone().iushrn(t)},BN.prototype.testn=function(t){assert("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;return!(this.length<=i)&&!!(this.words[i]&1<<e)},BN.prototype.imaskn=function(t){assert("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;return(assert(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)?this:(0!==e&&i++,this.length=Math.min(i,this.length),0!==e&&(this.words[this.length-1]&=67108863^67108863>>>e<<e),this.strip())},BN.prototype.maskn=function(t){return this.clone().imaskn(t)},BN.prototype.iaddn=function(t){return(assert("number"==typeof t),assert(t<67108864),t<0)?this.isubn(-t):0!==this.negative?(1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(t),this.negative=1),this):this._iaddn(t)},BN.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},BN.prototype.isubn=function(t){if(assert("number"==typeof t),assert(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},BN.prototype.addn=function(t){return this.clone().iaddn(t)},BN.prototype.subn=function(t){return this.clone().isubn(t)},BN.prototype.iabs=function(){return this.negative=0,this},BN.prototype.abs=function(){return this.clone().iabs()},BN.prototype._ishlnsubmul=function(t,e,i){var n,s,o=t.length+i;this._expand(o);var a=0;for(n=0;n<t.length;n++){s=(0|this.words[n+i])+a;var u=(0|t.words[n])*e;s-=67108863&u,a=(s>>26)-(u/67108864|0),this.words[n+i]=67108863&s}for(;n<this.length-i;n++)a=(s=(0|this.words[n+i])+a)>>26,this.words[n+i]=67108863&s;if(0===a)return this.strip();for(assert(-1===a),a=0,n=0;n<this.length;n++)a=(s=-(0|this.words[n])+a)>>26,this.words[n]=67108863&s;return this.negative=1,this.strip()},BN.prototype._wordDiv=function(t,e){var i,n=this.length-t.length,s=this.clone(),o=t,a=0|o.words[o.length-1];0!=(n=26-this._countBits(a))&&(o=o.ushln(n),s.iushln(n),a=0|o.words[o.length-1]);var u=s.length-o.length;if("mod"!==e){(i=new BN(null)).length=u+1,i.words=Array(i.length);for(var c=0;c<i.length;c++)i.words[c]=0}var p=s.clone()._ishlnsubmul(o,1,u);0===p.negative&&(s=p,i&&(i.words[u]=1));for(var y=u-1;y>=0;y--){var g=(0|s.words[o.length+y])*67108864+(0|s.words[o.length+y-1]);for(g=Math.min(g/a|0,67108863),s._ishlnsubmul(o,g,y);0!==s.negative;)g--,s.negative=0,s._ishlnsubmul(o,1,y),s.isZero()||(s.negative^=1);i&&(i.words[y]=g)}return i&&i.strip(),s.strip(),"div"!==e&&0!==n&&s.iushrn(n),{div:i||null,mod:s}},BN.prototype.divmod=function(t,e,i){var n,s,o;return(assert(!t.isZero()),this.isZero())?{div:new BN(0),mod:new BN(0)}:0!==this.negative&&0===t.negative?(o=this.neg().divmod(t,e),"mod"!==e&&(n=o.div.neg()),"div"!==e&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(t)),{div:n,mod:s}):0===this.negative&&0!==t.negative?(o=this.divmod(t.neg(),e),"mod"!==e&&(n=o.div.neg()),{div:n,mod:o.mod}):(this.negative&t.negative)!=0?(o=this.neg().divmod(t.neg(),e),"div"!==e&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(t)),{div:o.div,mod:s}):t.length>this.length||0>this.cmp(t)?{div:new BN(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new BN(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new BN(this.modn(t.words[0]))}:this._wordDiv(t,e)},BN.prototype.div=function(t){return this.divmod(t,"div",!1).div},BN.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},BN.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},BN.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var i=0!==e.div.negative?e.mod.isub(t):e.mod,n=t.ushrn(1),s=t.andln(1),o=i.cmp(n);return o<0||1===s&&0===o?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},BN.prototype.modn=function(t){assert(t<=67108863);for(var e=67108864%t,i=0,n=this.length-1;n>=0;n--)i=(e*i+(0|this.words[n]))%t;return i},BN.prototype.idivn=function(t){assert(t<=67108863);for(var e=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*e;this.words[i]=n/t|0,e=n%t}return this.strip()},BN.prototype.divn=function(t){return this.clone().idivn(t)},BN.prototype.egcd=function(t){assert(0===t.negative),assert(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n=new BN(1),s=new BN(0),o=new BN(0),a=new BN(1),u=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++u;for(var c=i.clone(),p=e.clone();!e.isZero();){for(var y=0,g=1;(e.words[0]&g)==0&&y<26;++y,g<<=1);if(y>0)for(e.iushrn(y);y-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(c),s.isub(p)),n.iushrn(1),s.iushrn(1);for(var m=0,b=1;(i.words[0]&b)==0&&m<26;++m,b<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||a.isOdd())&&(o.iadd(c),a.isub(p)),o.iushrn(1),a.iushrn(1);e.cmp(i)>=0?(e.isub(i),n.isub(o),s.isub(a)):(i.isub(e),o.isub(n),a.isub(s))}return{a:o,b:a,gcd:i.iushln(u)}},BN.prototype._invmp=function(t){assert(0===t.negative),assert(!t.isZero());var e,i=this,n=t.clone();i=0!==i.negative?i.umod(t):i.clone();for(var s=new BN(1),o=new BN(0),a=n.clone();i.cmpn(1)>0&&n.cmpn(1)>0;){for(var u=0,c=1;(i.words[0]&c)==0&&u<26;++u,c<<=1);if(u>0)for(i.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(a),s.iushrn(1);for(var p=0,y=1;(n.words[0]&y)==0&&p<26;++p,y<<=1);if(p>0)for(n.iushrn(p);p-- >0;)o.isOdd()&&o.iadd(a),o.iushrn(1);i.cmp(n)>=0?(i.isub(n),s.isub(o)):(n.isub(i),o.isub(s))}return 0>(e=0===i.cmpn(1)?s:o).cmpn(0)&&e.iadd(t),e},BN.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),i=t.clone();e.negative=0,i.negative=0;for(var n=0;e.isEven()&&i.isEven();n++)e.iushrn(1),i.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;i.isEven();)i.iushrn(1);var s=e.cmp(i);if(s<0){var o=e;e=i,i=o}else if(0===s||0===i.cmpn(1))break;e.isub(i)}return i.iushln(n)},BN.prototype.invm=function(t){return this.egcd(t).a.umod(t)},BN.prototype.isEven=function(){return(1&this.words[0])==0},BN.prototype.isOdd=function(){return(1&this.words[0])==1},BN.prototype.andln=function(t){return this.words[0]&t},BN.prototype.bincn=function(t){assert("number"==typeof t);var e=t%26,i=(t-e)/26,n=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var s=n,o=i;0!==s&&o<this.length;o++){var a=0|this.words[o];a+=s,s=a>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},BN.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},BN.prototype.cmpn=function(t){var e,i=t<0;if(0!==this.negative&&!i)return -1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)e=1;else{i&&(t=-t),assert(t<=67108863,"Number is too big");var n=0|this.words[0];e=n===t?0:n<t?-1:1}return 0!==this.negative?0|-e:e},BN.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return -1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},BN.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return -1;for(var e=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],s=0|t.words[i];if(n!==s){n<s?e=-1:n>s&&(e=1);break}}return e},BN.prototype.gtn=function(t){return 1===this.cmpn(t)},BN.prototype.gt=function(t){return 1===this.cmp(t)},BN.prototype.gten=function(t){return this.cmpn(t)>=0},BN.prototype.gte=function(t){return this.cmp(t)>=0},BN.prototype.ltn=function(t){return -1===this.cmpn(t)},BN.prototype.lt=function(t){return -1===this.cmp(t)},BN.prototype.lten=function(t){return 0>=this.cmpn(t)},BN.prototype.lte=function(t){return 0>=this.cmp(t)},BN.prototype.eqn=function(t){return 0===this.cmpn(t)},BN.prototype.eq=function(t){return 0===this.cmp(t)},BN.red=function(t){return new Red(t)},BN.prototype.toRed=function(t){return assert(!this.red,"Already a number in reduction context"),assert(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},BN.prototype.fromRed=function(){return assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},BN.prototype._forceRed=function(t){return this.red=t,this},BN.prototype.forceRed=function(t){return assert(!this.red,"Already a number in reduction context"),this._forceRed(t)},BN.prototype.redAdd=function(t){return assert(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},BN.prototype.redIAdd=function(t){return assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},BN.prototype.redSub=function(t){return assert(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},BN.prototype.redISub=function(t){return assert(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},BN.prototype.redShl=function(t){return assert(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},BN.prototype.redMul=function(t){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},BN.prototype.redIMul=function(t){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},BN.prototype.redSqr=function(){return assert(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},BN.prototype.redISqr=function(){return assert(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},BN.prototype.redSqrt=function(){return assert(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},BN.prototype.redInvm=function(){return assert(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},BN.prototype.redNeg=function(){return assert(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},BN.prototype.redPow=function(t){return assert(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var u={k256:null,p224:null,p192:null,p25519:null};function MPrime(t,e){this.name=t,this.p=new BN(e,16),this.n=this.p.bitLength(),this.k=new BN(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Red(t){if("string"==typeof t){var e=BN._prime(t);this.m=e.p,this.prime=e}else assert(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function Mont(t){Red.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new BN(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}MPrime.prototype._tmp=function(){var t=new BN(null);return t.words=Array(Math.ceil(this.n/13)),t},MPrime.prototype.ireduce=function(t){var e,i=t;do this.split(i,this.tmp),e=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength();while(e>this.n);var n=e<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):i.strip(),i},MPrime.prototype.split=function(t,e){t.iushrn(this.n,0,e)},MPrime.prototype.imulK=function(t){return t.imul(this.k)},inherits(K256,MPrime),K256.prototype.split=function(t,e){for(var i=Math.min(t.length,9),n=0;n<i;n++)e.words[n]=t.words[n];if(e.length=i,t.length<=9){t.words[0]=0,t.length=1;return}var s=t.words[9];for(n=10,e.words[e.length++]=4194303&s;n<t.length;n++){var o=0|t.words[n];t.words[n-10]=(4194303&o)<<4|s>>>22,s=o}s>>>=22,t.words[n-10]=s,0===s&&t.length>10?t.length-=10:t.length-=9},K256.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,i=0;i<t.length;i++){var n=0|t.words[i];e+=977*n,t.words[i]=67108863&e,e=64*n+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},inherits(P224,MPrime),inherits(P192,MPrime),inherits(P25519,MPrime),P25519.prototype.imulK=function(t){for(var e=0,i=0;i<t.length;i++){var n=(0|t.words[i])*19+e,s=67108863&n;n>>>=26,t.words[i]=s,e=n}return 0!==e&&(t.words[t.length++]=e),t},BN._prime=function(t){var e;if(u[t])return u[t];if("k256"===t)e=new K256;else if("p224"===t)e=new P224;else if("p192"===t)e=new P192;else if("p25519"===t)e=new P25519;else throw Error("Unknown prime "+t);return u[t]=e,e},Red.prototype._verify1=function(t){assert(0===t.negative,"red works only with positives"),assert(t.red,"red works only with red numbers")},Red.prototype._verify2=function(t,e){assert((t.negative|e.negative)==0,"red works only with positives"),assert(t.red&&t.red===e.red,"red works only with red numbers")},Red.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},Red.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},Red.prototype.add=function(t,e){this._verify2(t,e);var i=t.add(e);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},Red.prototype.iadd=function(t,e){this._verify2(t,e);var i=t.iadd(e);return i.cmp(this.m)>=0&&i.isub(this.m),i},Red.prototype.sub=function(t,e){this._verify2(t,e);var i=t.sub(e);return 0>i.cmpn(0)&&i.iadd(this.m),i._forceRed(this)},Red.prototype.isub=function(t,e){this._verify2(t,e);var i=t.isub(e);return 0>i.cmpn(0)&&i.iadd(this.m),i},Red.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},Red.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},Red.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},Red.prototype.isqr=function(t){return this.imul(t,t.clone())},Red.prototype.sqr=function(t){return this.mul(t,t)},Red.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(assert(e%2==1),3===e){var i=this.m.add(new BN(1)).iushrn(2);return this.pow(t,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);assert(!n.isZero());var o=new BN(1).toRed(this),a=o.redNeg(),u=this.m.subn(1).iushrn(1),c=this.m.bitLength();for(c=new BN(2*c*c).toRed(this);0!==this.pow(c,u).cmp(a);)c.redIAdd(a);for(var p=this.pow(c,n),y=this.pow(t,n.addn(1).iushrn(1)),g=this.pow(t,n),m=s;0!==g.cmp(o);){for(var b=g,S=0;0!==b.cmp(o);S++)b=b.redSqr();assert(S<m);var v=this.pow(p,new BN(1).iushln(m-S-1));y=y.redMul(v),p=v.redSqr(),g=g.redMul(p),m=S}return y},Red.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},Red.prototype.pow=function(t,e){if(e.isZero())return new BN(1).toRed(this);if(0===e.cmpn(1))return t.clone();var i=Array(16);i[0]=new BN(1).toRed(this),i[1]=t;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],t);var s=i[0],o=0,a=0,u=e.bitLength()%26;for(0===u&&(u=26),n=e.length-1;n>=0;n--){for(var c=e.words[n],p=u-1;p>=0;p--){var y=c>>p&1;if(s!==i[0]&&(s=this.sqr(s)),0===y&&0===o){a=0;continue}o<<=1,o|=y,(4==++a||0===n&&0===p)&&(s=this.mul(s,i[o]),a=0,o=0)}u=26}return s},Red.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},Red.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},BN.mont=function(t){return new Mont(t)},inherits(Mont,Red),Mont.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},Mont.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},Mont.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(e),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=i.isub(n).iushrn(this.shift),o=s;return s.cmp(this.m)>=0?o=s.isub(this.m):0>s.cmpn(0)&&(o=s.iadd(this.m)),o._forceRed(this)},Mont.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new BN(0)._forceRed(this);var i=t.mul(e),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=i.isub(n).iushrn(this.shift),o=s;return s.cmp(this.m)>=0?o=s.isub(this.m):0>s.cmpn(0)&&(o=s.iadd(this.m)),o._forceRed(this)},Mont.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(t=i.nmd(t),this)},9384:function(t,e,i){var n=i(58162);t.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},9213:function(t){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var TempCtor=function(){};TempCtor.prototype=e.prototype,t.prototype=new TempCtor,t.prototype.constructor=t}},77191:function(t,e,i){let n=i(78247);t.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},78247:function(t){"use strict";t.exports=function(t){if(t.length>=255)throw TypeError("Alphabet too long");for(var e=new Uint8Array(256),i=0;i<e.length;i++)e[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(255!==e[o])throw TypeError(s+" is ambiguous");e[o]=n}var a=t.length,u=t.charAt(0),c=Math.log(a)/Math.log(256),p=Math.log(256)/Math.log(a);function decodeUnsafe(t){if("string"!=typeof t)throw TypeError("Expected String");if(0===t.length)return new Uint8Array;for(var i=0,n=0,s=0;t[i]===u;)n++,i++;for(var o=(t.length-i)*c+1>>>0,p=new Uint8Array(o);t[i];){var y=e[t.charCodeAt(i)];if(255===y)return;for(var g=0,m=o-1;(0!==y||g<s)&&-1!==m;m--,g++)y+=a*p[m]>>>0,p[m]=y%256>>>0,y=y/256>>>0;if(0!==y)throw Error("Non-zero carry");s=g,i++}for(var b=o-s;b!==o&&0===p[b];)b++;for(var S=new Uint8Array(n+(o-b)),v=n;b!==o;)S[v++]=p[b++];return S}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===e.length)return"";for(var i=0,n=0,s=0,o=e.length;s!==o&&0===e[s];)s++,i++;for(var c=(o-s)*p+1>>>0,y=new Uint8Array(c);s!==o;){for(var g=e[s],m=0,b=c-1;(0!==g||m<n)&&-1!==b;b--,m++)g+=256*y[b]>>>0,y[b]=g%a>>>0,g=g/a>>>0;if(0!==g)throw Error("Non-zero carry");n=m,s++}for(var S=c-n;S!==c&&0===y[S];)S++;for(var v=u.repeat(i);S<c;++S)v+=t.charAt(y[S]);return v},decodeUnsafe:decodeUnsafe,decode:function(t){var e=decodeUnsafe(t);if(e)return e;throw Error("Non-base"+a+" character")}}}},53310:function(t,e,i){"use strict";var n=i(91518),s=i(89509).Buffer;t.exports=function(t){function decodeRaw(e){var i=e.slice(0,-4),n=e.slice(-4),s=t(i);if(!(n[0]^s[0]|n[1]^s[1]|n[2]^s[2]|n[3]^s[3]))return i}return{encode:function(e){var i=t(e);return n.encode(s.concat([e,i],e.length+4))},decode:function(e){var i=decodeRaw(n.decode(e),t);if(!i)throw Error("Invalid checksum");return i},decodeUnsafe:function(t){var e=n.decodeUnsafe(t);if(e)return decodeRaw(e)}}}},58334:function(t,e,i){"use strict";var n=i(23482),s=i(53310);t.exports=s(function(t){var e=n("sha256").update(t).digest();return n("sha256").update(e).digest()})},91518:function(t,e,i){var n=i(58162);t.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},17406:function(t){t.exports=function(t,e){if("function"==typeof t.compare)return t.compare(e);if(t===e)return 0;for(var i=t.length,n=e.length,s=0,o=Math.min(i,n);s<o&&t[s]===e[s];)++s;return(s!==o&&(i=t[s],n=e[s]),i<n)?-1:n<i?1:0}},8055:function(t,e,i){"use strict";var n=i(48764).Buffer;t.exports=function(t,e){if(!n.isBuffer(t)||!n.isBuffer(e))throw TypeError("Arguments must be Buffers");if(t===e)return!0;if("function"==typeof t.equals)return t.equals(e);if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}},86428:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.ECPairFactory=e.networks=void 0;let s=i(14644);e.networks=s;let o=i(4844),a=i(61798),u=i(37174),c=i(25049),p=o.typeforce.maybe(o.typeforce.compile({compressed:o.maybe(o.Boolean),network:o.maybe(o.Network)})),toXOnly=t=>32===t.length?t:t.slice(1,33);e.ECPairFactory=function(t){function fromPrivateKey(e,i){if(o.typeforce(o.Buffer256bit,e),!t.isPrivate(e))throw TypeError("Private key not in range [1, n)");return o.typeforce(p,i),new ECPair(e,void 0,i)}function fromPublicKey(e,i){return o.typeforce(t.isPoint,e),o.typeforce(p,i),new ECPair(void 0,e,i)}(0,c.testEcc)(t);let ECPair=class ECPair{__D;__Q;compressed;network;lowR;constructor(e,i,o){this.__D=e,this.__Q=i,this.lowR=!1,void 0===o&&(o={}),this.compressed=void 0===o.compressed||o.compressed,this.network=o.network||s.bitcoin,void 0!==i&&(this.__Q=n.from(t.pointCompress(i,this.compressed)))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){let e=t.pointFromScalar(this.__D,this.compressed);this.__Q=n.from(e)}return this.__Q}toWIF(){if(!this.__D)throw Error("Missing private key");return u.encode(this.network.wif,this.__D,this.compressed)}tweak(t){return this.privateKey?this.tweakFromPrivateKey(t):this.tweakFromPublicKey(t)}sign(e,i){if(!this.__D)throw Error("Missing private key");if(void 0===i&&(i=this.lowR),!1===i)return n.from(t.sign(e,this.__D));{let i=t.sign(e,this.__D),s=n.alloc(32,0),o=0;for(;i[0]>127;)o++,s.writeUIntLE(o,0,6),i=t.sign(e,this.__D,s);return n.from(i)}}signSchnorr(e){if(!this.privateKey)throw Error("Missing private key");if(!t.signSchnorr)throw Error("signSchnorr not supported by ecc library");return n.from(t.signSchnorr(e,this.privateKey))}verify(e,i){return t.verify(e,this.publicKey,i)}verifySchnorr(e,i){if(!t.verifySchnorr)throw Error("verifySchnorr not supported by ecc library");return t.verifySchnorr(e,this.publicKey.subarray(1,33),i)}tweakFromPublicKey(e){let i=toXOnly(this.publicKey),s=t.xOnlyPointAddTweak(i,e);if(!s||null===s.xOnlyPubkey)throw Error("Cannot tweak public key!");let o=n.from([0===s.parity?2:3]);return fromPublicKey(n.concat([o,s.xOnlyPubkey]),{network:this.network,compressed:this.compressed})}tweakFromPrivateKey(e){let i=3===this.publicKey[0]||4===this.publicKey[0]&&(1&this.publicKey[64])==1,s=i?t.privateNegate(this.privateKey):this.privateKey,o=t.privateAdd(s,e);if(!o)throw Error("Invalid tweaked private key!");return fromPrivateKey(n.from(o),{network:this.network,compressed:this.compressed})}};return{isPoint:function(e){return t.isPoint(e)},fromPrivateKey,fromPublicKey,fromWIF:function(t,e){let i=u.decode(t),n=i.version;if(o.Array(e)){if(!(e=e.filter(t=>n===t.wif).pop()))throw Error("Unknown network version")}else if(n!==(e=e||s.bitcoin).wif)throw Error("Invalid network version");return fromPrivateKey(i.privateKey,{compressed:i.compressed,network:e})},makeRandom:function(e){let i;o.typeforce(p,e),void 0===e&&(e={});let n=e.rng||a;do i=n(32),o.typeforce(o.Buffer256bit,i);while(!t.isPrivate(i));return fromPrivateKey(i,e)}}}},45217:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.networks=e.ECPairFactory=e.default=void 0;var n=i(86428);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return n.ECPairFactory}}),Object.defineProperty(e,"ECPairFactory",{enumerable:!0,get:function(){return n.ECPairFactory}}),Object.defineProperty(e,"networks",{enumerable:!0,get:function(){return n.networks}})},14644:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.testnet=e.bitcoin=void 0,e.bitcoin={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},e.testnet={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},25049:function(t,e,i){"use strict";var n=i(48764).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.testEcc=void 0;let h=t=>n.from(t,"hex");function assert(t){if(!t)throw Error("ecc library invalid")}e.testEcc=function(t){assert(t.isPoint(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(!t.isPoint(h("030000000000000000000000000000000000000000000000000000000000000005"))),assert(t.isPrivate(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(t.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),assert(!t.isPrivate(h("0000000000000000000000000000000000000000000000000000000000000000"))),assert(!t.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),assert(!t.isPrivate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),assert(n.from(t.privateAdd(h("0000000000000000000000000000000000000000000000000000000000000001"),h("0000000000000000000000000000000000000000000000000000000000000000"))).equals(h("0000000000000000000000000000000000000000000000000000000000000001"))),assert(null===t.privateAdd(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),h("0000000000000000000000000000000000000000000000000000000000000003"))),assert(n.from(t.privateAdd(h("e211078564db65c3ce7704f08262b1f38f1ef412ad15b5ac2d76657a63b2c500"),h("b51fbb69051255d1becbd683de5848242a89c229348dd72896a87ada94ae8665"))).equals(h("9730c2ee69edbb958d42db7460bafa18fef9d955325aec99044c81c8282b0a24"))),assert(n.from(t.privateNegate(h("0000000000000000000000000000000000000000000000000000000000000001"))).equals(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),assert(n.from(t.privateNegate(h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(h("0000000000000000000000000000000000000000000000000000000000000003"))),assert(n.from(t.privateNegate(h("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(h("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792"))),assert(n.from(t.pointCompress(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(n.from(t.pointCompress(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),assert(n.from(t.pointCompress(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),assert(n.from(t.pointCompress(h("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(h("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),assert(n.from(t.pointFromScalar(h("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(h("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),assert(null===t.xOnlyPointAddTweak(h("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140")));let e=t.xOnlyPointAddTweak(h("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),h("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));assert(n.from(e.xOnlyPubkey).equals(h("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&1===e.parity),e=t.xOnlyPointAddTweak(h("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),h("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47")),assert(n.from(e.xOnlyPubkey).equals(h("9534f8dc8c6deda2dc007655981c78b49c5d96c778fbf363462a11ec9dfd948c"))&&0===e.parity),assert(n.from(t.sign(h("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),h("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(h("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),assert(t.verify(h("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),h("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),h("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),t.signSchnorr&&assert(n.from(t.signSchnorr(h("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),h("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),h("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(h("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),t.verifySchnorr&&assert(t.verifySchnorr(h("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),h("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),h("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}},4844:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.maybe=e.Boolean=e.Array=e.Buffer256bit=e.Network=e.typeforce=void 0,e.typeforce=i(2401),e.Network=e.typeforce.compile({messagePrefix:e.typeforce.oneOf(e.typeforce.Buffer,e.typeforce.String),bip32:{public:e.typeforce.UInt32,private:e.typeforce.UInt32},pubKeyHash:e.typeforce.UInt8,scriptHash:e.typeforce.UInt8,wif:e.typeforce.UInt8}),e.Buffer256bit=e.typeforce.BufferN(32),e.Array=e.typeforce.Array,e.Boolean=e.typeforce.Boolean,e.maybe=e.typeforce.maybe},89133:function(t,e,i){var n;!function(e,s){var o={};s(o);var a=o.default;for(var u in o)a[u]=o[u];"object"==typeof t.exports?t.exports=a:void 0!==(n=(function(){return a}).call(o,i,o,t))&&(t.exports=n)}(0,function(t){"use strict";t.__esModule=!0,t.digestLength=32,t.blockSize=64;var e=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function hashBlocks(t,i,n,s,o){for(var a,u,c,p,y,g,m,b,S,v,_,P,w;o>=64;){for(v=0,a=i[0],u=i[1],c=i[2],p=i[3],y=i[4],g=i[5],m=i[6],b=i[7];v<16;v++)_=s+4*v,t[v]=(255&n[_])<<24|(255&n[_+1])<<16|(255&n[_+2])<<8|255&n[_+3];for(v=16;v<64;v++)P=((S=t[v-2])>>>17|S<<15)^(S>>>19|S<<13)^S>>>10,w=((S=t[v-15])>>>7|S<<25)^(S>>>18|S<<14)^S>>>3,t[v]=(P+t[v-7]|0)+(w+t[v-16]|0);for(v=0;v<64;v++)P=(((y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7))+(y&g^~y&m)|0)+(b+(e[v]+t[v]|0)|0)|0,w=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&u^a&c^u&c)|0,b=m,m=g,g=y,y=p+P|0,p=c,c=u,u=a,a=P+w|0;i[0]+=a,i[1]+=u,i[2]+=c,i[3]+=p,i[4]+=y,i[5]+=g,i[6]+=m,i[7]+=b,s+=64,o-=64}return s}var i=function(){function Hash(){this.digestLength=t.digestLength,this.blockSize=t.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return Hash.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},Hash.prototype.clean=function(){for(var t=0;t<this.buffer.length;t++)this.buffer[t]=0;for(var t=0;t<this.temp.length;t++)this.temp[t]=0;this.reset()},Hash.prototype.update=function(t,e){if(void 0===e&&(e=t.length),this.finished)throw Error("SHA256: can't update because hash was finished.");var i=0;if(this.bytesHashed+=e,this.bufferLength>0){for(;this.bufferLength<64&&e>0;)this.buffer[this.bufferLength++]=t[i++],e--;64===this.bufferLength&&(hashBlocks(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(e>=64&&(i=hashBlocks(this.temp,this.state,t,i,e),e%=64);e>0;)this.buffer[this.bufferLength++]=t[i++],e--;return this},Hash.prototype.finish=function(t){if(!this.finished){var e=this.bytesHashed,i=this.bufferLength,n=e/536870912|0,s=e<<3,o=e%64<56?64:128;this.buffer[i]=128;for(var a=i+1;a<o-8;a++)this.buffer[a]=0;this.buffer[o-8]=n>>>24&255,this.buffer[o-7]=n>>>16&255,this.buffer[o-6]=n>>>8&255,this.buffer[o-5]=n>>>0&255,this.buffer[o-4]=s>>>24&255,this.buffer[o-3]=s>>>16&255,this.buffer[o-2]=s>>>8&255,this.buffer[o-1]=s>>>0&255,hashBlocks(this.temp,this.state,this.buffer,0,o),this.finished=!0}for(var a=0;a<8;a++)t[4*a+0]=this.state[a]>>>24&255,t[4*a+1]=this.state[a]>>>16&255,t[4*a+2]=this.state[a]>>>8&255,t[4*a+3]=this.state[a]>>>0&255;return this},Hash.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},Hash.prototype._saveState=function(t){for(var e=0;e<this.state.length;e++)t[e]=this.state[e]},Hash.prototype._restoreState=function(t,e){for(var i=0;i<this.state.length;i++)this.state[i]=t[i];this.bytesHashed=e,this.finished=!1,this.bufferLength=0},Hash}();t.Hash=i;var n=function(){function HMAC(t){this.inner=new i,this.outer=new i,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var e=new Uint8Array(this.blockSize);if(t.length>this.blockSize)new i().update(t).finish(e).clean();else for(var n=0;n<t.length;n++)e[n]=t[n];for(var n=0;n<e.length;n++)e[n]^=54;this.inner.update(e);for(var n=0;n<e.length;n++)e[n]^=106;this.outer.update(e),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var n=0;n<e.length;n++)e[n]=0}return HMAC.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},HMAC.prototype.clean=function(){for(var t=0;t<this.istate.length;t++)this.ostate[t]=this.istate[t]=0;this.inner.clean(),this.outer.clean()},HMAC.prototype.update=function(t){return this.inner.update(t),this},HMAC.prototype.finish=function(t){return this.outer.finished?this.outer.finish(t):(this.inner.finish(t),this.outer.update(t,this.digestLength).finish(t)),this},HMAC.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},HMAC}();function hash(t){var e=new i().update(t),n=e.digest();return e.clean(),n}function hmac(t,e){var i=new n(t).update(e),s=i.digest();return i.clean(),s}t.HMAC=n,t.hash=hash,t.default=hash,t.hmac=hmac;var s=new Uint8Array(t.digestLength);t.hkdf=function(t,e,i,o){void 0===e&&(e=s),void 0===o&&(o=32);for(var a=new Uint8Array([1]),u=hmac(e,t),c=new n(u),p=new Uint8Array(c.digestLength),y=p.length,g=new Uint8Array(o),m=0;m<o;m++)y===p.length&&(function(t,e,i,n){var s=n[0];if(0===s)throw Error("hkdf: cannot expand more");e.reset(),s>1&&e.update(t),i&&e.update(i),e.update(n),e.finish(t),n[0]++}(p,c,i,a),y=0),g[m]=p[y++];return c.clean(),p.fill(0),a.fill(0),g},t.pbkdf2=function(t,e,i,s){for(var o=new n(t),a=o.digestLength,u=new Uint8Array(4),c=new Uint8Array(a),p=new Uint8Array(a),y=new Uint8Array(s),g=0;g*a<s;g++){var m=g+1;u[0]=m>>>24&255,u[1]=m>>>16&255,u[2]=m>>>8&255,u[3]=m>>>0&255,o.reset(),o.update(e),o.update(u),o.finish(p);for(var b=0;b<a;b++)c[b]=p[b];for(var b=2;b<=i;b++){o.reset(),o.update(p).finish(p);for(var S=0;S<a;S++)c[S]^=p[S]}for(var b=0;b<a&&g*a+b<s;b++)y[g*a+b]=c[b]}for(var g=0;g<a;g++)c[g]=p[g]=0;for(var g=0;g<4;g++)u[g]=0;return o.clean(),y}})},11987:function(t,e,i){!function(){var e={452:function(t){"use strict";t.exports=i(97334)}},n={};function __nccwpck_require__(t){var i=n[t];if(void 0!==i)return i.exports;var s=n[t]={exports:{}},o=!0;try{e[t](s,s.exports,__nccwpck_require__),o=!1}finally{o&&delete n[t]}return s.exports}__nccwpck_require__.ab="//";var s={};!function(){var t,e=(t=__nccwpck_require__(452))&&"object"==typeof t&&"default"in t?t.default:t,i=/https?|ftp|gopher|file/;function r(t){"string"==typeof t&&(t=d(t));var n,s,o,a,u,c,p,y,g,m=(s=(n=t).auth,o=n.hostname,a=n.protocol||"",u=n.pathname||"",c=n.hash||"",p=n.query||"",y=!1,s=s?encodeURIComponent(s).replace(/%3A/i,":")+"@":"",n.host?y=s+n.host:o&&(y=s+(~o.indexOf(":")?"["+o+"]":o),n.port&&(y+=":"+n.port)),p&&"object"==typeof p&&(p=e.encode(p)),g=n.search||p&&"?"+p||"",a&&":"!==a.substr(-1)&&(a+=":"),n.slashes||(!a||i.test(a))&&!1!==y?(y="//"+(y||""),u&&"/"!==u[0]&&(u="/"+u)):y||(y=""),c&&"#"!==c[0]&&(c="#"+c),g&&"?"!==g[0]&&(g="?"+g),{protocol:a,host:y,pathname:u=u.replace(/[?#]/g,encodeURIComponent),search:g=g.replace("#","%23"),hash:c});return""+m.protocol+m.host+m.pathname+m.search+m.hash}var n="http://",o=n+"w.w",a=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,u=/https?|ftp|gopher|file/;function h(t,e){var i="string"==typeof t?d(t):t;t="object"==typeof t?r(t):t;var s=d(e),c="";i.protocol&&!i.slashes&&(c=i.protocol,t=t.replace(i.protocol,""),c+="/"===e[0]||"/"===t[0]?"/":""),c&&s.protocol&&(c="",s.slashes||(c=s.protocol,e=e.replace(s.protocol,"")));var p=t.match(a);p&&!s.protocol&&(t=t.substr((c=p[1]+(p[2]||"")).length),/^\/\/[^/]/.test(e)&&(c=c.slice(0,-1)));var y=new URL(t,o+"/"),g=new URL(e,y).toString().replace(o,""),m=s.protocol||i.protocol;return m+=i.slashes||s.slashes?"//":"",!c&&m?g=g.replace(n,m):c&&(g=g.replace(n,"")),u.test(g)||~e.indexOf(".")||"/"===t.slice(-1)||"/"===e.slice(-1)||"/"!==g.slice(-1)||(g=g.slice(0,-1)),c&&(g=c+("/"===g[0]?g.substr(1):g)),g}function l(){}l.prototype.parse=d,l.prototype.format=r,l.prototype.resolve=h,l.prototype.resolveObject=h;var c=/^https?|ftp|gopher|file/,p=/^(.*?)([#?].*)/,y=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,g=/^([a-z0-9.+-]*:)?\/\/\/*/i,m=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i;function d(t,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),t&&"object"==typeof t&&t instanceof l)return t;var s=(t=t.trim()).match(p);t=s?s[1].replace(/\\/g,"/")+s[2]:t.replace(/\\/g,"/"),m.test(t)&&"/"!==t.slice(-1)&&(t+="/");var a=!/(^javascript)/.test(t)&&t.match(y),u=g.test(t),b="";a&&(c.test(a[1])||(b=a[1].toLowerCase(),t=""+a[2]+a[3]),a[2]||(u=!1,c.test(a[1])?(b=a[1],t=""+a[3]):t="//"+a[3]),3!==a[2].length&&1!==a[2].length||(b=a[1],t="/"+a[3]));var S,v=(s?s[1]:t).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),_=v&&v[1],P=new l,w="",E="";try{S=new URL(t)}catch(e){w=e,b||n||!/^\/\//.test(t)||/^\/\/.+[@.]/.test(t)||(E="/",t=t.substr(1));try{S=new URL(t,o)}catch(t){return P.protocol=b,P.href=b,P}}P.slashes=u&&!E,P.host="w.w"===S.host?"":S.host,P.hostname="w.w"===S.hostname?"":S.hostname.replace(/(\[|\])/g,""),P.protocol=w?b||null:S.protocol,P.search=S.search.replace(/\\/g,"%5C"),P.hash=S.hash.replace(/\\/g,"%5C");var I=t.split("#");!P.search&&~I[0].indexOf("?")&&(P.search="?"),P.hash||""!==I[1]||(P.hash="#"),P.query=i?e.decode(S.search.substr(1)):P.search.substr(1),P.pathname=E+(a?S.pathname.replace(/['^|`]/g,function(t){return"%"+t.charCodeAt().toString(16).toUpperCase()}).replace(/((?:%[0-9A-F]{2})+)/g,function(t,e){try{return decodeURIComponent(e).split("").map(function(t){var e=t.charCodeAt();return e>256||/^[a-z0-9]$/i.test(t)?t:"%"+e.toString(16).toUpperCase()}).join("")}catch(t){return e}}):S.pathname),"about:"===P.protocol&&"blank"===P.pathname&&(P.protocol="",P.pathname=""),w&&"/"!==t[0]&&(P.pathname=P.pathname.substr(1)),b&&!c.test(b)&&"/"!==t.slice(-1)&&"/"===P.pathname&&(P.pathname=""),P.path=P.pathname+P.search,P.auth=[S.username,S.password].map(decodeURIComponent).filter(Boolean).join(":"),P.port=S.port,_&&!P.host.endsWith(_)&&(P.host+=_,P.port=_.slice(1)),P.href=E?""+P.pathname+P.search+P.hash:r(P);var T=/^(file)/.test(P.href)?["host","hostname"]:[];return Object.keys(P).forEach(function(t){~T.indexOf(t)||(P[t]=P[t]||null)}),P}s.parse=d,s.format=r,s.resolve=h,s.resolveObject=function(t,e){return d(h(t,e))},s.Url=l}(),t.exports=s}()},97334:function(t){!function(){"use strict";var e={815:function(t){t.exports=function(t,i,n,s){i=i||"&",n=n||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(i);var u=1e3;s&&"number"==typeof s.maxKeys&&(u=s.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var p=0;p<c;++p){var y,g,m,b,S=t[p].replace(a,"%20"),v=S.indexOf(n);(v>=0?(y=S.substr(0,v),g=S.substr(v+1)):(y=S,g=""),m=decodeURIComponent(y),b=decodeURIComponent(g),Object.prototype.hasOwnProperty.call(o,m))?e(o[m])?o[m].push(b):o[m]=[o[m],b]:o[m]=b}return o};var e=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},577:function(t){var stringifyPrimitive=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,n,s,o){return(n=n||"&",s=s||"=",null===t&&(t=void 0),"object"==typeof t)?map(i(t),function(i){var o=encodeURIComponent(stringifyPrimitive(i))+s;return e(t[i])?map(t[i],function(t){return o+encodeURIComponent(stringifyPrimitive(t))}).join(n):o+encodeURIComponent(stringifyPrimitive(t[i]))}).join(n):o?encodeURIComponent(stringifyPrimitive(o))+s+encodeURIComponent(stringifyPrimitive(t)):""};var e=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function map(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var i=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}}},i={};function __nccwpck_require__(t){var n=i[t];if(void 0!==n)return n.exports;var s=i[t]={exports:{}},o=!0;try{e[t](s,s.exports,__nccwpck_require__),o=!1}finally{o&&delete i[t]}return s.exports}__nccwpck_require__.ab="//";var n={};n.decode=n.parse=__nccwpck_require__(815),n.encode=n.stringify=__nccwpck_require__(577),t.exports=n}()},96647:function(t,e,i){var n=i(30247);function getTypeName(t){return t.name||t.toString().match(/function (.*?)\s*\(/)[1]}function getValueTypeName(t){return n.Nil(t)?"":getTypeName(t.constructor)}function captureStackTrace(t,e){Error.captureStackTrace&&Error.captureStackTrace(t,e)}function tfJSON(t){return n.Function(t)?t.toJSON?t.toJSON():getTypeName(t):n.Array(t)?"Array":t&&n.Object(t)?"Object":void 0!==t?t:""}function tfErrorString(t,e,i){var s=n.Function(e)?"":n.String(e)?JSON.stringify(e):e&&n.Object(e)?"":e;return"Expected "+tfJSON(t)+", got"+(""!==i?" "+i:"")+(""!==s?" "+s:"")}function TfTypeError(t,e,i){i=i||getValueTypeName(e),this.message=tfErrorString(t,e,i),captureStackTrace(this,TfTypeError),this.__type=t,this.__value=e,this.__valueTypeName=i}function TfPropertyTypeError(t,e,i,n,s){if(t){var o;s=s||getValueTypeName(n),this.message=(o='" of type ',"key"===i&&(o='" with key type '),tfErrorString('property "'+tfJSON(e)+o+tfJSON(t),n,s))}else this.message='Unexpected property "'+e+'"';captureStackTrace(this,TfTypeError),this.__label=i,this.__property=e,this.__type=t,this.__value=n,this.__valueTypeName=s}TfTypeError.prototype=Object.create(Error.prototype),TfTypeError.prototype.constructor=TfTypeError,TfPropertyTypeError.prototype=Object.create(Error.prototype),TfPropertyTypeError.prototype.constructor=TfTypeError,t.exports={TfTypeError:TfTypeError,TfPropertyTypeError:TfPropertyTypeError,tfCustomError:function(t,e){return new TfTypeError(t,{},e)},tfSubError:function(t,e,i){return t instanceof TfPropertyTypeError?(e=e+"."+t.__property,t=new TfPropertyTypeError(t.__type,e,t.__label,t.__value,t.__valueTypeName)):t instanceof TfTypeError&&(t=new TfPropertyTypeError(t.__type,e,i,t.__value,t.__valueTypeName)),captureStackTrace(t),t},tfJSON:tfJSON,getValueTypeName:getValueTypeName}},74307:function(t,e,i){var n=i(48764).Buffer,s=i(30247),o=i(96647);function _Buffer(t){return n.isBuffer(t)}function Hex(t){return"string"==typeof t&&/^([0-9a-f]{2})+$/i.test(t)}function _LengthN(t,e){var i=t.toJSON();function Length(n){if(!t(n))return!1;if(n.length===e)return!0;throw o.tfCustomError(i+"(Length: "+e+")",i+"(Length: "+n.length+")")}return Length.toJSON=function(){return i},Length}var a=_LengthN.bind(null,s.Array),u=_LengthN.bind(null,_Buffer),c=_LengthN.bind(null,Hex),p={ArrayN:a,Buffer:_Buffer,BufferN:u,Finite:function(t){return"number"==typeof t&&isFinite(t)},Hex:Hex,HexN:c,Int8:function(t){return t<<24>>24===t},Int16:function(t){return t<<16>>16===t},Int32:function(t){return(0|t)===t},Int53:function(t){return"number"==typeof t&&t>=-9007199254740991&&t<=9007199254740991&&Math.floor(t)===t},Range:function(t,e,i){function _range(n,s){return i(n,s)&&n>t&&n<e}return i=i||s.Number,_range.toJSON=function(){return`${i.toJSON()} between [${t}, ${e}]`},_range},StringN:_LengthN.bind(null,s.String),UInt8:function(t){return(255&t)===t},UInt16:function(t){return(65535&t)===t},UInt32:function(t){return t>>>0===t},UInt53:function(t){return"number"==typeof t&&t>=0&&t<=9007199254740991&&Math.floor(t)===t}};for(var y in p)p[y].toJSON=(function(t){return t}).bind(null,y);t.exports=p},2401:function(t,e,i){var n=i(96647),s=i(30247),o=n.tfJSON,a=n.TfTypeError,u=n.TfPropertyTypeError,c=n.tfSubError,p=n.getValueTypeName,y={arrayOf:function(t,e){function _arrayOf(i,n){return!(!s.Array(i)||s.Nil(i))&&(void 0===e.minLength||!(i.length<e.minLength))&&(void 0===e.maxLength||!(i.length>e.maxLength))&&(void 0===e.length||i.length===e.length)&&i.every(function(e,i){try{return typeforce(t,e,n)}catch(t){throw c(t,i)}})}return t=compile(t),e=e||{},_arrayOf.toJSON=function(){var i="["+o(t)+"]";return void 0!==e.length?i+="{"+e.length+"}":(void 0!==e.minLength||void 0!==e.maxLength)&&(i+="{"+(void 0===e.minLength?0:e.minLength)+","+(void 0===e.maxLength?1/0:e.maxLength)+"}"),i},_arrayOf},maybe:function maybe(t){function _maybe(e,i){return s.Nil(e)||t(e,i,maybe)}return t=compile(t),_maybe.toJSON=function(){return"?"+o(t)},_maybe},map:function(t,e){function _map(i,n){if(!s.Object(i)||s.Nil(i))return!1;for(var o in i){try{e&&typeforce(e,o,n)}catch(t){throw c(t,o,"key")}try{var a=i[o];typeforce(t,a,n)}catch(t){throw c(t,o)}}return!0}return t=compile(t),e&&(e=compile(e)),e?_map.toJSON=function(){return"{"+o(e)+": "+o(t)+"}"}:_map.toJSON=function(){return"{"+o(t)+"}"},_map},object:function(t){var e={};for(var i in t)e[i]=compile(t[i]);function _object(t,i){if(!s.Object(t)||s.Nil(t))return!1;try{for(n in e){var n,o=e[n],a=t[n];typeforce(o,a,i)}}catch(t){throw c(t,n)}if(i){for(n in t)if(!e[n])throw new u(void 0,n)}return!0}return _object.toJSON=function(){return o(e)},_object},anyOf:function(){var t=[].slice.call(arguments).map(compile);function _anyOf(e,i){return t.some(function(t){try{return typeforce(t,e,i)}catch(t){return!1}})}return _anyOf.toJSON=function(){return t.map(o).join("|")},_anyOf},allOf:function(){var t=[].slice.call(arguments).map(compile);function _allOf(e,i){return t.every(function(t){try{return typeforce(t,e,i)}catch(t){return!1}})}return _allOf.toJSON=function(){return t.map(o).join(" & ")},_allOf},quacksLike:function(t){function _quacksLike(e){return t===p(e)}return _quacksLike.toJSON=function(){return t},_quacksLike},tuple:function(){var t=[].slice.call(arguments).map(compile);function _tuple(e,i){return!(s.Nil(e)||s.Nil(e.length))&&(!i||e.length===t.length)&&t.every(function(t,n){try{return typeforce(t,e[n],i)}catch(t){throw c(t,n)}})}return _tuple.toJSON=function(){return"("+t.map(o).join(", ")+")"},_tuple},value:function(t){function _value(e){return e===t}return _value.toJSON=function(){return t},_value}};function compile(t){if(s.String(t))return"?"===t[0]?y.maybe(t.slice(1)):s[t]||y.quacksLike(t);if(t&&s.Object(t)){if(s.Array(t)){if(1!==t.length)throw TypeError("Expected compile() parameter of type Array of length 1");return y.arrayOf(t[0])}return y.object(t)}return s.Function(t)?t:y.value(t)}function typeforce(t,e,i,n){if(s.Function(t)){if(t(e,i))return!0;throw new a(n||t,e)}return typeforce(compile(t),e,i)}for(var g in y.oneOf=y.anyOf,s)typeforce[g]=s[g];for(g in y)typeforce[g]=y[g];var m=i(74307);for(g in m)typeforce[g]=m[g];typeforce.compile=compile,typeforce.TfTypeError=a,typeforce.TfPropertyTypeError=u,t.exports=typeforce},30247:function(t){var e={Array:function(t){return null!=t&&t.constructor===Array},Boolean:function(t){return"boolean"==typeof t},Function:function(t){return"function"==typeof t},Nil:function(t){return null==t},Number:function(t){return"number"==typeof t},Object:function(t){return"object"==typeof t},String:function(t){return"string"==typeof t},"":function(){return!0}};for(var i in e.Null=e.Nil,e)e[i].toJSON=(function(t){return t}).bind(null,i);t.exports=e},57795:function(t,e,i){"use strict";var n=i(89509).Buffer;function checkUInt53(t){if(t<0||t>9007199254740991||t%1!=0)throw RangeError("value out of range")}function encode(t,e,i){if(checkUInt53(t),e||(e=n.allocUnsafe(encodingLength(t))),!n.isBuffer(e))throw TypeError("buffer must be a Buffer instance");return i||(i=0),t<253?(e.writeUInt8(t,i),encode.bytes=1):t<=65535?(e.writeUInt8(253,i),e.writeUInt16LE(t,i+1),encode.bytes=3):t<=4294967295?(e.writeUInt8(254,i),e.writeUInt32LE(t,i+1),encode.bytes=5):(e.writeUInt8(255,i),e.writeUInt32LE(t>>>0,i+1),e.writeUInt32LE(t/4294967296|0,i+5),encode.bytes=9),e}function decode(t,e){if(!n.isBuffer(t))throw TypeError("buffer must be a Buffer instance");e||(e=0);var i=t.readUInt8(e);if(i<253)return decode.bytes=1,i;if(253===i)return decode.bytes=3,t.readUInt16LE(e+1);if(254===i)return decode.bytes=5,t.readUInt32LE(e+1);decode.bytes=9;var s=t.readUInt32LE(e+1),o=4294967296*t.readUInt32LE(e+5)+s;return checkUInt53(o),o}function encodingLength(t){return checkUInt53(t),t<253?1:t<=65535?3:t<=4294967295?5:9}t.exports={encode:encode,decode:decode,encodingLength:encodingLength}},37174:function(t,e,i){var n=i(48764).Buffer,s=i(58334);function decodeRaw(t,e){if(void 0!==e&&t[0]!==e)throw Error("Invalid network version");if(33===t.length)return{version:t[0],privateKey:t.slice(1,33),compressed:!1};if(34!==t.length)throw Error("Invalid WIF length");if(1!==t[33])throw Error("Invalid compression flag");return{version:t[0],privateKey:t.slice(1,33),compressed:!0}}function encodeRaw(t,e,i){var s=new n(i?34:33);return s.writeUInt8(t,0),e.copy(s,1),i&&(s[33]=1),s}t.exports={decode:function(t,e){return decodeRaw(s.decode(t),e)},decodeRaw:decodeRaw,encode:function(t,e,i){return"number"==typeof t?s.encode(encodeRaw(t,e,i)):s.encode(encodeRaw(t.version,t.privateKey,t.compressed))},encodeRaw:encodeRaw}},4690:function(t,e,i){"use strict";i.a(t,async function(t,n){try{i.r(e),i.d(e,{__initializeContext:function(){return __initializeContext},isPoint:function(){return isPoint},isPointCompressed:function(){return isPointCompressed},isPrivate:function(){return isPrivate},isXOnlyPoint:function(){return isXOnlyPoint},pointAdd:function(){return pointAdd},pointAddScalar:function(){return pointAddScalar},pointCompress:function(){return pointCompress},pointFromScalar:function(){return pointFromScalar},pointMultiply:function(){return pointMultiply},privateAdd:function(){return privateAdd},privateNegate:function(){return privateNegate},privateSub:function(){return privateSub},recover:function(){return recover},sign:function(){return sign},signRecoverable:function(){return signRecoverable},signSchnorr:function(){return signSchnorr},verify:function(){return verify},verifySchnorr:function(){return verifySchnorr},xOnlyPointAddTweak:function(){return xOnlyPointAddTweak},xOnlyPointAddTweakCheck:function(){return xOnlyPointAddTweakCheck},xOnlyPointFromPoint:function(){return xOnlyPointFromPoint},xOnlyPointFromScalar:function(){return xOnlyPointFromScalar}});var s=i(95193),o=i(97136),a=i(75337),u=t([a]);a=(u.then?(await u)():u)[0];let c=new Uint8Array(a.Z.memory.buffer),p=a.Z.PRIVATE_INPUT.value,y=a.Z.PUBLIC_KEY_INPUT.value,g=a.Z.PUBLIC_KEY_INPUT2.value,m=a.Z.X_ONLY_PUBLIC_KEY_INPUT.value,b=a.Z.X_ONLY_PUBLIC_KEY_INPUT2.value,S=a.Z.TWEAK_INPUT.value,v=a.Z.HASH_INPUT.value,_=a.Z.EXTRA_DATA_INPUT.value,P=a.Z.SIGNATURE_INPUT.value,w=c.subarray(p,p+o.Yl),E=c.subarray(y,y+o.Bl),I=c.subarray(g,g+o.Bl),T=c.subarray(m,m+o.Vt),k=c.subarray(b,b+o.Vt),A=c.subarray(S,S+o.jx),O=c.subarray(v,v+o.ZM),B=c.subarray(_,_+o.P0),N=c.subarray(P,P+o.fJ);function assumeCompression(t,e){return void 0===t?void 0!==e?e.length:o.XM:t?o.XM:o.Bl}function _isPoint(t){try{return E.set(t),1===a.Z.isPoint(t.length)}finally{E.fill(0)}}function __initializeContext(){a.Z.initializeContext()}function isPoint(t){return o.DV(t)&&_isPoint(t)}function isPointCompressed(t){return o.rH(t)&&_isPoint(t)}function isXOnlyPoint(t){return o.vC(t)&&_isPoint(t)}function isPrivate(t){return o.hv(t)}function pointAdd(t,e,i){o.yE(t),o.yE(e);let n=assumeCompression(i,t);try{return E.set(t),I.set(e),1===a.Z.pointAdd(t.length,e.length,n)?E.slice(0,n):null}finally{E.fill(0),I.fill(0)}}function pointAddScalar(t,e,i){o.yE(t),o.Cm(e);let n=assumeCompression(i,t);try{return E.set(t),A.set(e),1===a.Z.pointAddScalar(t.length,n)?E.slice(0,n):null}finally{E.fill(0),A.fill(0)}}function pointCompress(t,e){o.yE(t);let i=assumeCompression(e,t);try{return E.set(t),a.Z.pointCompress(t.length,i),E.slice(0,i)}finally{E.fill(0)}}function pointFromScalar(t,e){o.bl(t);let i=assumeCompression(e);try{return w.set(t),1===a.Z.pointFromScalar(i)?E.slice(0,i):null}finally{w.fill(0),E.fill(0)}}function xOnlyPointFromScalar(t){o.bl(t);try{return w.set(t),a.Z.xOnlyPointFromScalar(),T.slice(0,o.Vt)}finally{w.fill(0),T.fill(0)}}function xOnlyPointFromPoint(t){o.yE(t);try{return E.set(t),a.Z.xOnlyPointFromPoint(t.length),T.slice(0,o.Vt)}finally{E.fill(0),T.fill(0)}}function pointMultiply(t,e,i){o.yE(t),o.Cm(e);let n=assumeCompression(i,t);try{return E.set(t),A.set(e),1===a.Z.pointMultiply(t.length,n)?E.slice(0,n):null}finally{E.fill(0),A.fill(0)}}function privateAdd(t,e){o.bl(t),o.Cm(e);try{return w.set(t),A.set(e),1===a.Z.privateAdd()?w.slice(0,o.Yl):null}finally{w.fill(0),A.fill(0)}}function privateSub(t,e){if(o.bl(t),o.Cm(e),o.Fr(e))return new Uint8Array(t);try{return w.set(t),A.set(e),1===a.Z.privateSub()?w.slice(0,o.Yl):null}finally{w.fill(0),A.fill(0)}}function privateNegate(t){o.bl(t);try{return w.set(t),a.Z.privateNegate(),w.slice(0,o.Yl)}finally{w.fill(0)}}function xOnlyPointAddTweak(t,e){o.$Q(t),o.Cm(e);try{T.set(t),A.set(e);let i=a.Z.xOnlyPointAddTweak();return -1!==i?{parity:i,xOnlyPubkey:T.slice(0,o.Vt)}:null}finally{T.fill(0),A.fill(0)}}function xOnlyPointAddTweakCheck(t,e,i,n){o.$Q(t),o.$Q(i),o.Cm(e);let u=void 0!==n;u&&o.Y6(n);try{if(T.set(t),k.set(i),A.set(e),u)return 1===a.Z.xOnlyPointAddTweakCheck(n);{a.Z.xOnlyPointAddTweak();let t=T.slice(0,o.Vt);return 0===(0,s.qu)(t,i)}}finally{T.fill(0),k.fill(0),A.fill(0)}}function sign(t,e,i){o.ax(t),o.bl(e),o.IB(i);try{return O.set(t),w.set(e),void 0!==i&&B.set(i),a.Z.sign(void 0===i?0:1),N.slice(0,o.fJ)}finally{O.fill(0),w.fill(0),void 0!==i&&B.fill(0),N.fill(0)}}function signRecoverable(t,e,i){o.ax(t),o.bl(e),o.IB(i);try{O.set(t),w.set(e),void 0!==i&&B.set(i);let n=a.Z.signRecoverable(void 0===i?0:1),s=N.slice(0,o.fJ);return{signature:s,recoveryId:n}}finally{O.fill(0),w.fill(0),void 0!==i&&B.fill(0),N.fill(0)}}function signSchnorr(t,e,i){o.ax(t),o.bl(e),o.IB(i);try{return O.set(t),w.set(e),void 0!==i&&B.set(i),a.Z.signSchnorr(void 0===i?0:1),N.slice(0,o.fJ)}finally{O.fill(0),w.fill(0),void 0!==i&&B.fill(0),N.fill(0)}}function verify(t,e,i,n=!1){o.ax(t),o.yE(e),o.pB(i);try{return O.set(t),E.set(e),N.set(i),1===a.Z.verify(e.length,!0===n?1:0)}finally{O.fill(0),E.fill(0),N.fill(0)}}function recover(t,e,i,n=!1){o.ax(t),o.pB(e),o.XS(e),2&i&&o.K7(e),o.yT(()=>isXOnlyPoint(e.subarray(0,32)));let s=assumeCompression(n);try{return O.set(t),N.set(e),1===a.Z.recover(s,i)?E.slice(0,s):null}finally{O.fill(0),N.fill(0),E.fill(0)}}function verifySchnorr(t,e,i){o.ax(t),o.$Q(e),o.pB(i);try{return O.set(t),T.set(e),N.set(i),1===a.Z.verifySchnorr()}finally{O.fill(0),T.fill(0),N.fill(0)}}n()}catch(t){n(t)}})},50612:function(t,e,i){"use strict";function generateInt32(){let t=function(){let t=new Uint8Array(4);if("undefined"==typeof crypto)throw Error("The crypto object is unavailable. This may occur if your environment does not support the Web Cryptography API.");return crypto.getRandomValues(t),t}();return(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3]}i.d(e,{L:function(){return generateInt32}})},97136:function(t,e,i){"use strict";i.d(e,{$Q:function(){return validateXOnlyPoint},Bl:function(){return a},Cm:function(){return validateTweak},DV:function(){return isDERPoint},Fr:function(){return isZero},IB:function(){return validateExtraData},K7:function(){return validateSigrPMinusN},P0:function(){return y},Vt:function(){return u},XM:function(){return o},XS:function(){return validateSignatureNonzeroRS},Y6:function(){return validateParity},Yl:function(){return s},ZM:function(){return p},ax:function(){return validateHash},bl:function(){return validatePrivate},fJ:function(){return g},hv:function(){return isPrivate},jx:function(){return c},pB:function(){return validateSignature},rH:function(){return isPointCompressed},vC:function(){return isXOnlyPoint},yE:function(){return validatePoint},yT:function(){return validateSignatureCustom}});var n=i(99612);let s=32,o=33,a=65,u=32,c=32,p=32,y=32,g=64,m=new Uint8Array(32),b=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65]),S=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,69,81,35,25,80,183,95,196,64,45,161,114,47,201,186,238]);function isUint8Array(t){return t instanceof Uint8Array}function cmpBN32(t,e){for(let i=0;i<32;++i)if(t[i]!==e[i])return t[i]<e[i]?-1:1;return 0}function isZero(t){return 0===cmpBN32(t,m)}function isPrivate(t){return isUint8Array(t)&&t.length===s&&cmpBN32(t,m)>0&&0>cmpBN32(t,b)}function isXOnlyPoint(t){return isUint8Array(t)&&t.length===u}function isDERPoint(t){return isUint8Array(t)&&(t.length===o||t.length===a)}function isPointCompressed(t){return isUint8Array(t)&&t.length===o}function validateParity(t){0!==t&&1!==t&&(0,n._y)(n.al)}function validatePrivate(t){isPrivate(t)||(0,n._y)(n.Y2)}function validatePoint(t){isUint8Array(t)&&(t.length===o||t.length===a||t.length===u)||(0,n._y)(n.Gy)}function validateXOnlyPoint(t){isXOnlyPoint(t)||(0,n._y)(n.Gy)}function validateTweak(t){isUint8Array(t)&&t.length===c&&0>cmpBN32(t,b)||(0,n._y)(n.NQ)}function validateHash(t){isUint8Array(t)&&t.length===p||(0,n._y)(n.AI)}function validateExtraData(t){void 0===t||isUint8Array(t)&&t.length===y||(0,n._y)(n.B6)}function validateSignature(t){isUint8Array(t)&&64===t.length&&0>cmpBN32(t.subarray(0,32),b)&&0>cmpBN32(t.subarray(32,64),b)||(0,n._y)(n.bf)}function validateSignatureCustom(t){t()||(0,n._y)(n.bf)}function validateSignatureNonzeroRS(t){isZero(t.subarray(0,32))&&(0,n._y)(n.bf),isZero(t.subarray(32,64))&&(0,n._y)(n.bf)}function validateSigrPMinusN(t){isUint8Array(t)&&64===t.length&&0>cmpBN32(t.subarray(0,32),S)||(0,n._y)(n.X2)}},99612:function(t,e,i){"use strict";i.d(e,{AI:function(){return a},B6:function(){return c},Gy:function(){return s},NQ:function(){return o},X2:function(){return y},Y2:function(){return n},_y:function(){return throwError},al:function(){return p},bf:function(){return u}});let n=0,s=1,o=2,a=3,u=4,c=5,p=6,y=7,g={[n.toString()]:"Expected Private",[s.toString()]:"Expected Point",[o.toString()]:"Expected Tweak",[a.toString()]:"Expected Hash",[u.toString()]:"Expected Signature",[c.toString()]:"Expected Extra Data (32 bytes)",[p.toString()]:"Expected Parity (1 | 0)",[y.toString()]:"Bad Recovery Id"};function throwError(t){let e=g[t.toString()]||`Unknow error code: ${t}`;throw TypeError(e)}},75337:function(t,e,i){"use strict";i.a(t,async function(t,n){try{var s=i(8914),o=t([s]);s=(o.then?(await o)():o)[0],e.Z=s,n()}catch(t){n(t)}})},95193:function(t,e,i){"use strict";i.d(e,{qu:function(){return compare}});let n="0123456789abcdefABCDEF";function compare(t,e){let i=Math.min(t.length,e.length);for(let n=0;n<i;++n)if(t[n]!==e[n])return t[n]<e[n]?-1:1;return t.length===e.length?0:t.length>e.length?1:-1}n.split("").map(t=>t.codePointAt(0)),Array(256).fill(!0).map((t,e)=>{let i=String.fromCodePoint(e),s=n.indexOf(i);return s<0?void 0:s<16?s:s-6}),new TextEncoder,new TextDecoder("ascii")},46625:function(t){"use strict";t.exports={i8:"10.7.0"}},8914:function(t,e,i){"use strict";var n=i(50612),s=i(99612);t.exports=i.v(e,t.id,"39d1d7e196300322",{"./rand.js":{generateInt32:n.L},"./validate_error.js":{throwError:s._y}})}}]);
//# sourceMappingURL=935.753e6b1c3bc8d638.js.map